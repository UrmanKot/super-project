{"version":3,"file":"src_app_qc_qc_module_ts.js","mappings":"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","sources":["./src/app/procurement/models/invoice-product.ts","./src/app/qc/components/protocols/protocols.component.ts","./src/app/qc/components/protocols/protocols.component.html","./src/app/qc/components/qc-invoice/qc-invoice.component.ts","./src/app/qc/components/qc-invoice/qc-invoice.component.html","./src/app/qc/components/qc-layout/qc-layout.component.ts","./src/app/qc/components/qc-layout/qc-layout.component.html","./src/app/qc/components/qc-list/qc-list.component.ts","./src/app/qc/components/qc-list/qc-list.component.html","./src/app/qc/components/qc-order/qc-order.component.ts","./src/app/qc/components/qc-order/qc-order.component.html","./src/app/qc/modals/create-edit-protocol/create-edit-protocol.component.ts","./src/app/qc/modals/create-edit-protocol/create-edit-protocol.component.html","./src/app/qc/modals/move-qc-with-protocol/move-qc-with-protocol.component.ts","./src/app/qc/modals/move-qc-with-protocol/move-qc-with-protocol.component.html","./src/app/qc/modals/move-qc-with-serial/move-qc-with-serial.component.ts","./src/app/qc/modals/move-qc-with-serial/move-qc-with-serial.component.html","./src/app/qc/modals/nomenclature-protocol-picker/nomenclature-protocol-picker.component.ts","./src/app/qc/modals/nomenclature-protocol-picker/nomenclature-protocol-picker.component.html","./src/app/qc/modals/quality-control-modal/quality-control-modal.component.ts","./src/app/qc/modals/quality-control-modal/quality-control-modal.component.html","./src/app/qc/modals/quality-control-technical-equipment/quality-control-technical-equipment.component.ts","./src/app/qc/modals/quality-control-technical-equipment/quality-control-technical-equipment.component.html","./src/app/qc/qc.module.ts","./src/app/qc/qc.routing.ts","./src/app/qc/services/protocol.service.ts","./src/app/qc/services/qc.service.ts"],"sourcesContent":["import {Nomenclature} from '@shared/models/nomenclature';\r\nimport {Invoice} from './invoice';\r\nimport {Locator} from '../../warehouse/models/locator';\r\nimport {Technology} from '../../product-structure/models/technology';\r\n\r\nexport class InvoiceProduct {\r\n  readonly id: number;\r\n  price: string;\r\n  quantity: number;\r\n  passed_quantity: number;\r\n  not_passed_quantity: number;\r\n  accepted_quantity?: number;\r\n  invoice: number | Invoice;\r\n  description: string;\r\n  quality_control: string;\r\n  unit_price?: string;\r\n  ddv?: number;\r\n  discount?: string;\r\n  supplier_unit_price?: string;\r\n  isSelected?: boolean;\r\n  checkedForGeneration?: boolean;\r\n  nomenclature?: Nomenclature;\r\n  products: InvoiceProduct[];\r\n  serial_numbers: any;\r\n  exists_on_locators: Locator[];\r\n  invoiceProducts?: InvoiceProduct[];\r\n  current_technology?: Technology;\r\n  totalQuantity?: number;\r\n  totalQuantityPassed?: number;\r\n  totalQuantityNotPassed?: number;\r\n  totalSerialNumbers: any[];\r\n}\r\n\r\nexport enum EInvoiceProductQualityControl {\r\n  NOT_PASSED = 0,\r\n  PASSED = 1,\r\n  PARTLY_PASSED = 2,\r\n}\r\n","import {Component, OnInit, ViewChild} from '@angular/core';\r\nimport {Paginator} from 'primeng/paginator';\r\nimport {Table} from 'primeng/table';\r\nimport {QcProtocol} from '../../models/protocol';\r\nimport {QuerySearch} from '@shared/models/other';\r\nimport {ProtocolService} from '../../services/protocol.service';\r\nimport {BehaviorSubject, iif, Observable, switchMap} from 'rxjs';\r\nimport {filter, map, tap} from 'rxjs/operators';\r\nimport {UntilDestroy, untilDestroyed} from '@ngneat/until-destroy';\r\nimport {MenuItem} from 'primeng/api';\r\nimport {ModalService} from '@shared/services/modal.service';\r\n\r\n@UntilDestroy()\r\n@Component({\r\n  selector: 'pek-protocols',\r\n  templateUrl: './protocols.component.html',\r\n  styleUrls: ['./protocols.component.scss']\r\n})\r\nexport class ProtocolsComponent implements OnInit {\r\n  @ViewChild('paginator') paginator: Paginator;\r\n  @ViewChild('dt') dt: Table;\r\n\r\n  search$: BehaviorSubject<void> = new BehaviorSubject<void>(null);\r\n\r\n  menuItems: MenuItem[] = [{\r\n    label: 'Selected Protocol',\r\n    items: [\r\n      {\r\n        label: 'Edit',\r\n        icon: 'pi pi-pencil',\r\n        command: () => this.editProtocol()\r\n      },\r\n      {\r\n        label: 'Remove',\r\n        icon: 'pi pi-trash',\r\n        command: () => this.removeProtocol()\r\n      }\r\n    ]\r\n  }];\r\n\r\n  isLoading = true;\r\n  isShowAll = false;\r\n\r\n  protocolsCount = 0;\r\n  isStartFirstPage = false;\r\n\r\n  selectedProtocol: QcProtocol;\r\n\r\n  currentPage = 1;\r\n\r\n  query: QuerySearch[] = [\r\n    {name: 'paginated', value: true},\r\n    {name: 'page', value: this.currentPage},\r\n  ];\r\n\r\n  protocols$: Observable<QcProtocol[]> = this.search$.pipe(\r\n    tap(() => this.isLoading = true),\r\n    tap(() => this.prepareForSearch()),\r\n    switchMap(() =>\r\n      iif(() =>\r\n          !this.isShowAll,\r\n        this.protocolService.getForPagination(this.query).pipe(\r\n          tap(response => this.protocolsCount = response.count),\r\n          map(response => response.results),\r\n        ),\r\n        this.protocolService.get(this.query).pipe(\r\n          tap(products => this.protocolsCount = products.length),\r\n          map(protocols => protocols)\r\n        )\r\n      ),\r\n    ),\r\n    tap(() => this.isLoading = false),\r\n    untilDestroyed(this),\r\n  );\r\n\r\n  constructor(\r\n    private readonly protocolService: ProtocolService,\r\n    private readonly modalService: ModalService,\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  paginate(event: any) {\r\n    if (!this.isStartFirstPage) {\r\n      this.currentPage = event.page + 1;\r\n      this.search$.next();\r\n    }\r\n  }\r\n\r\n  onShowAll(value: boolean) {\r\n    this.isShowAll = value;\r\n\r\n    if (!this.isShowAll) {\r\n      this.currentPage = 1;\r\n    }\r\n\r\n    this.search$.next();\r\n  }\r\n\r\n  private prepareForSearch() {\r\n    this.selectedProtocol = null;\r\n\r\n    this.query = [\r\n      {name: 'page', value: this.currentPage},\r\n    ];\r\n\r\n    if (!this.isShowAll) {\r\n      this.query.push({name: 'paginated', value: true});\r\n    }\r\n  }\r\n\r\n  removeProtocol() {\r\n    this.modalService.confirm('danger').subscribe(res => {\r\n      if (res) {\r\n        this.protocolService.deleteProtocol(this.selectedProtocol.id).subscribe(() => this.search$.next());\r\n        this.selectedProtocol = null;\r\n      }\r\n    });\r\n  }\r\n\r\n  onCreateProtocol() {\r\n    this.protocolService.createEditProtocolModal('create').pipe(\r\n      filter(value => Boolean(value)),\r\n      tap(() => this.search$.next())\r\n    ).subscribe()\r\n  }\r\n\r\n  editProtocol() {\r\n    this.protocolService.createEditProtocolModal('edit', this.selectedProtocol).pipe(\r\n      filter(value => Boolean(value)),\r\n      tap(() => this.search$.next())\r\n    ).subscribe()\r\n  }\r\n}\r\n","<div class=\"page\">\r\n  <div class=\"page__header\">\r\n    <div class=\"page__title\">\r\n      <pek-module-icon [module]=\"'quality-control'\" [isActive]=\"true\"></pek-module-icon>\r\n      <h1>Protocols</h1>\r\n    </div>\r\n    <div class=\"page__tools\">\r\n      <button pButton type=\"button\" icon=\"pi pi-plus\" label=\"New Protocol\" (click)=\"onCreateProtocol()\"></button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"page__content\">\r\n  <div class=\"page__card\">\r\n    <form>\r\n      <div class=\"d-flex\">\r\n        <p class=\"subtitle\" *ngIf=\"!selectedProtocol\">Choose the Protocol to edit</p>\r\n        <p-menubar class=\"ml-auto\" [model]=\"menuItems\" [class.disabled]=\"!selectedProtocol\"></p-menubar>\r\n      </div>\r\n    </form>\r\n    <div class=\"table-pagination-preloader\">\r\n      <p-table\r\n        #dt\r\n        [value]=\"protocols$ | async\"\r\n        [rows]=\"10\"\r\n        [scrollable]=\"true\"\r\n        selectionMode=\"single\"\r\n        [(selection)]=\"selectedProtocol\"\r\n        scrollHeight=\"calc(100vh - 19rem)\"\r\n      >\r\n        <ng-template pTemplate=\"header\">\r\n          <tr>\r\n            <th style=\"width: 5%\" class=\"text-center\">#</th>\r\n            <th style=\"width: 45%\">Name</th>\r\n            <th style=\"width: 50%\">Comment</th>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"body\" let-protocol let-i=\"rowIndex\">\r\n          <tr [pSelectableRow]=\"protocol\">\r\n            <td style=\"width: 5%\" class=\"text-center\">{{i + 1}}</td>\r\n            <td style=\"width: 45%\">{{protocol.name}}</td>\r\n            <td style=\"width: 50%\">{{protocol.comment}}</td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"emptymessage\">\r\n          <tr>\r\n            <td class=\"text-center p-4\" [attr.colspan]=\"6\">\r\n              <i *ngIf=\"isLoading\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n              <span *ngIf=\"!isLoading\">No Records Found</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n      </p-table>\r\n      <div class=\"pagination-preloader pagination-preloader_bord\" *ngIf=\"isLoading\">\r\n        <i class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n      </div>\r\n    </div>\r\n    <div\r\n      class=\"paginator-wrapper\"\r\n      *ngIf=\"!isShowAll\"\r\n      [class.paginator-wrapper_hide]=\"protocolsCount === 0\"\r\n    >\r\n      <p-paginator\r\n        #paginator\r\n        [rows]=\"10\"\r\n        [totalRecords]=\"protocolsCount\"\r\n        (onPageChange)=\"paginate($event)\"\r\n      >\r\n      </p-paginator>\r\n      <p-button\r\n        (click)=\"onShowAll(true)\"\r\n        class=\"paginator-all\"\r\n        type=\"button\"\r\n        styleClass=\"p-button-text\"\r\n      >\r\n        All\r\n      </p-button>\r\n    </div>\r\n\r\n    <div *ngIf=\"isShowAll\" class=\"paginator-return-pagination\">\r\n      <p-button\r\n        type=\"button\"\r\n        (click)=\"onShowAll(false)\"\r\n        styleClass=\"p-button-text\"\r\n      >\r\n        Return pagination\r\n      </p-button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {Invoice} from '../../../procurement/models/invoice';\r\nimport {InvoiceService} from '../../../procurement/services/invoice.service';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {filter, map, tap} from 'rxjs/operators';\r\nimport {OrderProductService} from '../../../procurement/services/order-product.service';\r\nimport {OrderTechnicalEquipment} from '../../../warehouse/models/order-technical-equipment';\r\nimport {EInvoiceProductQualityControl, InvoiceProduct} from '../../../procurement/models/invoice-product';\r\nimport {InvoiceProductService} from '../../../procurement/services/invoice-product.service';\r\nimport {QrCodeService} from '../../../qr-code/qr-code.service';\r\nimport {ModalService} from '@shared/services/modal.service';\r\nimport {QcService} from '../../services/qc.service';\r\nimport {AlbumService} from '@shared/services/album.service';\r\nimport {environment} from '@env/environment';\r\nimport {deepCopy} from 'deep-copy-ts';\r\n\r\n@Component({\r\n  selector: 'pek-qc-invoice',\r\n  templateUrl: './qc-invoice.component.html',\r\n  styleUrls: ['./qc-invoice.component.scss']\r\n})\r\nexport class QcInvoiceComponent implements OnInit {\r\n  link = environment.link_url + 'dash/';\r\n\r\n  isLoading = true;\r\n  isLoadingProducts = false;\r\n  isLoadingTechnicalEquipment = true;\r\n  isGenerating = false;\r\n  isCancellation = false;\r\n  isCompletingProducts = false;\r\n  isCompleting = false;\r\n\r\n  invoice: Invoice;\r\n  invoiceId: number;\r\n\r\n  invoiceProducts: InvoiceProduct[] = [];\r\n  selectedInvoiceProducts: InvoiceProduct[] = [];\r\n\r\n  technicalEquipments: OrderTechnicalEquipment[] = [];\r\n  selectedTechnicalEquipment: OrderTechnicalEquipment;\r\n\r\n  invoiceCanBeCompleted = false;\r\n\r\n  constructor(\r\n    private readonly invoiceService: InvoiceService,\r\n    private readonly orderProductService: OrderProductService,\r\n    private readonly invoiceProductService: InvoiceProductService,\r\n    private readonly qrCodeService: QrCodeService,\r\n    private readonly qcService: QcService,\r\n    private readonly route: ActivatedRoute,\r\n    private readonly modalService: ModalService,\r\n    public readonly albumService: AlbumService,\r\n    private readonly router: Router,\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.route.paramMap.pipe(\r\n      map(params => params.get('id')),\r\n      tap(id => this.invoiceId = +id),\r\n      tap(() => this.getInvoice()),\r\n      tap(() => this.getInvoiceProducts()),\r\n    ).subscribe();\r\n  }\r\n\r\n  getInvoice() {\r\n    this.invoiceService.getById(this.invoiceId).pipe(\r\n      tap(invoice => this.invoice = invoice),\r\n      tap(() => this.getTechnicalEquipmentToQc()),\r\n      tap(() => this.isLoading = false)\r\n    ).subscribe();\r\n  }\r\n\r\n  getInvoiceProducts() {\r\n    this.invoiceProducts = [];\r\n    this.selectedInvoiceProducts = [];\r\n    this.isLoadingProducts = true;\r\n\r\n    this.invoiceProductService.getInvoiceProducts(this.invoiceId).pipe(\r\n      tap(products => {\r\n        products.forEach(product => {\r\n          const technologyId = product.current_technology?.id;\r\n          const nomenclatureId = product.nomenclature.id;\r\n          const existing = this.invoiceProducts.find(el =>\r\n            el.nomenclature.id === nomenclatureId &&\r\n            el.current_technology?.id === technologyId);\r\n          if (existing) {\r\n            existing.totalQuantity = existing.totalQuantity += product.quantity;\r\n            existing.totalQuantityPassed = existing.totalQuantityPassed += product.passed_quantity;\r\n            existing.totalQuantityNotPassed = existing.totalQuantityNotPassed += product.not_passed_quantity;\r\n            existing.totalSerialNumbers.push(...product.serial_numbers);\r\n            existing.invoiceProducts.push(product);\r\n          } else {\r\n            product.invoiceProducts = [deepCopy(product)];\r\n            product.totalQuantity = product.quantity;\r\n            product.totalQuantityPassed = product.passed_quantity;\r\n            product.totalQuantityNotPassed = product.not_passed_quantity;\r\n            product.totalSerialNumbers = [...product.serial_numbers];\r\n            this.invoiceProducts.push(product);\r\n          }\r\n        });\r\n        this.invoiceProducts.forEach(product => {\r\n          if (product.totalQuantityPassed === product.totalQuantity) {\r\n            product.quality_control = EInvoiceProductQualityControl.PASSED.toString();\r\n          } else if (product.totalQuantityNotPassed === product.totalQuantity) {\r\n            product.quality_control = EInvoiceProductQualityControl.NOT_PASSED.toString();\r\n          } else if (product.totalQuantityNotPassed + product.totalQuantityPassed === product.totalQuantity) {\r\n            product.quality_control = EInvoiceProductQualityControl.PARTLY_PASSED.toString();\r\n          }\r\n        });\r\n        this.invoiceProducts = [...this.invoiceProducts];\r\n      }),\r\n      tap(products => this.invoiceCanBeCompleted = Boolean(products.find(p => p.quality_control))),\r\n      tap(() => this.isLoadingProducts = false)\r\n    ).subscribe();\r\n  }\r\n\r\n  getTechnicalEquipmentToQc() {\r\n    this.isLoadingTechnicalEquipment = true;\r\n    this.technicalEquipments = [];\r\n\r\n    if (this.invoice.order) {\r\n      this.orderProductService.getTechnicalEquipmentToQC(this.invoice.order.id).pipe(\r\n        tap(equipment => this.technicalEquipments = equipment),\r\n        tap(() => this.isLoadingTechnicalEquipment = false)\r\n      ).subscribe();\r\n    }\r\n  }\r\n\r\n  onGenerateQrCodes() {\r\n    this.isGenerating = true;\r\n\r\n    const send = {\r\n      by_nomenclatures_list: [],\r\n    };\r\n\r\n    this.selectedInvoiceProducts.forEach(invoiceProduct => {\r\n      invoiceProduct.invoiceProducts.forEach(p => {\r\n        if (p.nomenclature.bulk_or_serial === '1') {\r\n          send.by_nomenclatures_list.push({\r\n            nomenclature_id: p.nomenclature.id,\r\n            serial_number_ids:\r\n              p.nomenclature.bulk_or_serial === '1' ?\r\n                p.serial_numbers.map(s => +s.id) : [],\r\n            order_product_ids: [p.id],\r\n            invoice_product_ids: [],\r\n          });\r\n        } else {\r\n          const exists = send.by_nomenclatures_list.findIndex(el => el.nomenclature_id === p.nomenclature.id) >= 0;\r\n          if (!exists) {\r\n            send.by_nomenclatures_list.push({\r\n              nomenclature_id: p.nomenclature.id,\r\n              serial_number_ids: [],\r\n              order_product_ids: [p.id],\r\n              invoice_product_ids: [],\r\n            });\r\n          }\r\n        }\r\n\r\n      })\r\n    });\r\n    this.qrCodeService.generateQrCodes(send, this.invoice.order.id, this.invoice.self_serial_number).subscribe(() => this.isGenerating = false);\r\n  }\r\n\r\n  onCancellation() {\r\n    this.modalService.confirm('danger', 'Confirm').pipe(\r\n      filter(confirm => confirm),\r\n    ).subscribe(() => {\r\n      this.isCancellation = true;\r\n      this.invoiceService.cancellation(this.invoiceId).subscribe(() => {\r\n        this.isCancellation = false;\r\n        this.router.navigate(['../../'], {relativeTo: this.route});\r\n      });\r\n    });\r\n  }\r\n\r\n  onComplete() {\r\n    this.modalService.confirm('success').pipe(\r\n      filter(confirm => confirm)\r\n    ).subscribe(() => {\r\n      const send = {id: this.invoice.id, qc_completed: true};\r\n      this.isCompleting = true;\r\n      this.invoiceService.updatePartly(send).subscribe(() => {\r\n        this.isCompleting = false;\r\n        this.router.navigate(['../../'], {relativeTo: this.route});\r\n      });\r\n    });\r\n  }\r\n\r\n  onCompleteItems() {\r\n    this.modalService.confirm('success').pipe(\r\n      filter(confirm => confirm)\r\n    ).subscribe(() => {\r\n      const send = [];\r\n      const sendProducts = [];\r\n      this.selectedInvoiceProducts.forEach(product => {\r\n        const products = product.invoiceProducts.filter(p => !p.nomenclature.qc_protocol && p.nomenclature.bulk_or_serial === '0');\r\n        sendProducts.push(...products);\r\n      });\r\n\r\n      sendProducts.forEach(product => {\r\n        send.push({\r\n          id: product.id,\r\n          not_passed_quantity: 0,\r\n          passed_quantity: product.quantity,\r\n          quality_control: 1\r\n        });\r\n      });\r\n\r\n      this.isCompletingProducts = true;\r\n\r\n      this.invoiceProductService.severalUpdatePartly(send).pipe(\r\n        tap(() => this.getInvoiceProducts()),\r\n        tap(() => this.isCompletingProducts = false)\r\n      ).subscribe();\r\n    });\r\n  }\r\n\r\n  onShowImages() {\r\n    this.modalService.showImageGallery([], this.selectedInvoiceProducts[0].nomenclature.id, 1).subscribe();\r\n  }\r\n\r\n  onQualityControl() {\r\n    if (this.selectedInvoiceProducts[0].nomenclature.qc_protocol && this.selectedInvoiceProducts[0].nomenclature.bulk_or_serial === '1') {\r\n      let currentCount = 1;\r\n\r\n      if (this.selectedInvoiceProducts[0].passed_quantity) currentCount += this.selectedInvoiceProducts[0].totalQuantityPassed;\r\n      if (this.selectedInvoiceProducts[0].not_passed_quantity) currentCount += this.selectedInvoiceProducts[0].totalQuantityNotPassed;\r\n\r\n      this.qcService.withProtocolControlProduct(this.selectedInvoiceProducts[0], currentCount, this.selectedInvoiceProducts[0].totalQuantity, 'invoice').subscribe(res => {\r\n        if (res) {\r\n          this.selectedInvoiceProducts = [];\r\n          this.getInvoiceProducts();\r\n        }\r\n      });\r\n    } else if (!this.selectedInvoiceProducts[0].nomenclature.qc_protocol && this.selectedInvoiceProducts[0].nomenclature.bulk_or_serial === '1') {\r\n      let currentCount = 1;\r\n\r\n      if (this.selectedInvoiceProducts[0].passed_quantity) currentCount += this.selectedInvoiceProducts[0].totalQuantityPassed;\r\n      if (this.selectedInvoiceProducts[0].not_passed_quantity) currentCount += this.selectedInvoiceProducts[0].totalQuantityNotPassed;\r\n\r\n      this.qcService.serializedControlProduct(this.selectedInvoiceProducts[0], currentCount, this.selectedInvoiceProducts[0].totalQuantity, 'invoice').subscribe(res => {\r\n        if (res) {\r\n          this.selectedInvoiceProducts = [];\r\n          this.getInvoiceProducts();\r\n        }\r\n      });\r\n    } else {\r\n      this.qcService.controlProduct(this.selectedInvoiceProducts[0]).subscribe(res => {\r\n        if (res) {\r\n          this.selectedInvoiceProducts = null;\r\n          this.getInvoiceProducts();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  onPrintAlbum() {\r\n    this.albumService.getNomenclaturesImages((this.selectedInvoiceProducts.map(p => p?.nomenclature)));\r\n  }\r\n\r\n  goToOrder() {\r\n    let link: string;\r\n    const order = this.invoice.order;\r\n\r\n    switch (order.accounting_type) {\r\n      case 1:\r\n        link = '/procurement/chains/order/' + order.id;\r\n        break;\r\n      case 2:\r\n        link = '/outsourcing/chains/order/' + order.id;\r\n        break;\r\n      case 3:\r\n        link = `${this.link}production/orders/order/` + order.id;\r\n        break;\r\n    }\r\n\r\n    window.open(link, '_blank');\r\n  }\r\n\r\n  onQualityControlTechnicalEquipment() {\r\n    this.qcService.controlTechnicalEquipment(this.selectedTechnicalEquipment, true).subscribe(res => {\r\n      if (res) {\r\n        this.getTechnicalEquipmentToQc();\r\n        this.selectedTechnicalEquipment = null;\r\n      }\r\n    });\r\n  }\r\n}\r\n","<div class=\"page\">\r\n  <div class=\"page__header\">\r\n    <div class=\"page__title\">\r\n      <pek-module-icon [module]=\"'warehouse'\" [isActive]=\"true\"></pek-module-icon>\r\n      <h1>\r\n        Order ID <ng-container *ngIf=\"isLoading; else orderLink\">...</ng-container>\r\n      </h1>\r\n    </div>\r\n    <div class=\"page__tools\">\r\n      <button\r\n        class=\"mr-2 p-button-icon\"\r\n        pButton\r\n        type=\"button\"\r\n        icon=\"pi pi-print\"\r\n        label=\"Print Album\"\r\n        [loading]=\"albumService.loading$ | async\"\r\n        (click)=\"onPrintAlbum()\"\r\n        [disabled]=\"selectedInvoiceProducts.length === 0\"\r\n      >\r\n      </button>\r\n      <button\r\n        class=\"mr-2 p-button-icon\"\r\n        pButton\r\n        type=\"button\"\r\n        icon=\"pi pi-qrcode\"\r\n        label=\"Generate QR Codes\"\r\n        [loading]=\"isGenerating\"\r\n        (click)=\"onGenerateQrCodes()\"\r\n        [disabled]=\"selectedInvoiceProducts.length === 0\"\r\n      >\r\n      </button>\r\n      <button\r\n        pButton\r\n        type=\"button\"\r\n        class=\"p-button-icon mr-2\"\r\n        icon=\"pi pi-check\"\r\n        label=\"Complete Products\"\r\n        [loading]=\"isCompletingProducts\"\r\n        [disabled]=\"selectedInvoiceProducts.length === 0\"\r\n        (click)=\"onCompleteItems()\"\r\n      >\r\n      </button>\r\n      <button\r\n        pButton\r\n        type=\"button\"\r\n        class=\"p-button-icon p-button-danger mr-2\"\r\n        icon=\"pi pi-times\"\r\n        [loading]=\"isCancellation\"\r\n        label=\"Cancellation\"\r\n        (click)=\"onCancellation()\"\r\n        [disabled]=\"isLoading\"\r\n      >\r\n      </button>\r\n      <button\r\n        pButton\r\n        type=\"button\"\r\n        class=\"p-button-icon p-button-success\"\r\n        icon=\"pi pi-check\"\r\n        label=\"Complete\"\r\n        [loading]=\"isCompleting\"\r\n        (click)=\"onComplete()\"\r\n        [disabled]=\"!invoiceCanBeCompleted\"\r\n      >\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"page__content\">\r\n  <div class=\"page__card\">\r\n    <div class=\"page__table\">\r\n      <p-table\r\n        #dt\r\n        scrollHeight=\"calc(100vh - 19rem)\"\r\n        [scrollable]=\"true\"\r\n        [paginator]=\"!isLoadingProducts\"\r\n        dataKey=\"id\"\r\n        [rows]=\"10\"\r\n        [value]=\"invoiceProducts\"\r\n        [(selection)]=\"selectedInvoiceProducts\"\r\n      >\r\n        <ng-template pTemplate=\"header\">\r\n          <tr>\r\n            <th style=\"width: 3%\">\r\n              <p-tableHeaderCheckbox></p-tableHeaderCheckbox>\r\n            </th>\r\n            <th class=\"index-header text-center\" style=\"width: 5%\">#</th>\r\n            <th style=\"width: 15%\">Code</th>\r\n            <th style=\"width: 17%\">Name</th>\r\n            <th style=\"width: 15%\" class=\"text-center\">Technology</th>\r\n            <th style=\"width: 5%\" class=\"text-center\">UOM</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Quantity</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Not Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Status</th>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"caption\">\r\n          <div class=\"d-flex\">\r\n            <p class=\"subtitle\" *ngIf=\"selectedInvoiceProducts.length === 0\">Choose the Product to edit</p>\r\n            <button\r\n              pButton\r\n              type=\"button\"\r\n              class=\"p-button-icon ml-auto mr-2\"\r\n              icon=\"pi pi-images\"\r\n              label=\"Show Images\"\r\n              (click)=\"onShowImages()\"\r\n              [disabled]=\"isLoadingProducts || selectedInvoiceProducts.length === 0 || selectedInvoiceProducts.length > 1\"\r\n            >\r\n            </button>\r\n            <button\r\n              pButton\r\n              type=\"button\"\r\n              class=\"p-button-icon\"\r\n              icon=\"pi pi-angle-double-right\"\r\n              label=\"Quality Control\"\r\n              [disabled]=\"isLoadingProducts || selectedInvoiceProducts.length === 0 || selectedInvoiceProducts.length > 1\"\r\n              (click)=\"onQualityControl()\"\r\n            >\r\n            </button>\r\n          </div>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"body\" let-product let-i=\"rowIndex\">\r\n          <tr [pSelectableRow]=\"product\">\r\n            <td style=\"width: 3%\">\r\n              <p-tableCheckbox [value]=\"product\"></p-tableCheckbox>\r\n            </td>\r\n            <td style=\"width: 5%\" class=\"text-center\">{{i + 1}}</td>\r\n            <td style=\"width: 15%\">\r\n              {{product.nomenclature.code}}\r\n            </td>\r\n            <td style=\"width: 17%\">\r\n              {{product.nomenclature.name}}\r\n            </td>\r\n            <td style=\"width: 15%\" class=\"text-center\">\r\n              {{product.current_technology?.name}}\r\n            </td>\r\n            <td style=\"width: 5%\" class=\"text-center\">\r\n              {{product.nomenclature.category ? product.nomenclature.category.unit_of_measure.symbol : 'Pcs'}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.totalQuantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.totalQuantityPassed}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.totalQuantityNotPassed}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              <span *ngIf=\"product.quality_control == 1\" class=\"badge badge_success\">PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 2\" class=\"badge badge_warning\">PARTLY PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 0\" class=\"badge badge_danger\">NOT PASSED</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"emptymessage\">\r\n          <tr>\r\n            <td class=\"text-center p-4\" [attr.colspan]=\"11\">\r\n              <i *ngIf=\"isLoadingProducts\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n              <span *ngIf=\"!isLoadingProducts\">No Records Found</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"paginatorright\">\r\n          <p-button\r\n            type=\"button\"\r\n            (click)=\"dt.paginator=false\"\r\n            styleClass=\"p-button-text\"\r\n          >All\r\n          </p-button>\r\n        </ng-template>\r\n      </p-table>\r\n    </div>\r\n    <div *ngIf=\"!dt.paginator && !isLoading\" class=\"paginator-return-pagination\">\r\n      <p-button\r\n        type=\"button\"\r\n        (click)=\"dt.paginator=true\"\r\n        styleClass=\"p-button-text\"\r\n      >\r\n        Return pagination\r\n      </p-button>\r\n    </div>\r\n  </div>\r\n\r\n  <h2 class=\"mt-4 mb-4\">Technical Equipment</h2>\r\n\r\n  <div class=\"page__card\">\r\n    <div class=\"page__table\">\r\n      <p-table\r\n        #st\r\n        selectionMode=\"single\"\r\n        scrollHeight=\"calc(100vh - 19rem)\"\r\n        [scrollable]=\"true\"\r\n        [paginator]=\"!isLoadingTechnicalEquipment && technicalEquipments.length > 0\"\r\n        dataKey=\"id\"\r\n        [rows]=\"10\"\r\n        [value]=\"technicalEquipments\"\r\n        [(selection)]=\"selectedTechnicalEquipment\"\r\n      >\r\n        <ng-template pTemplate=\"header\">\r\n          <tr>\r\n            <th class=\"index-header text-center\" style=\"width: 8%\">#</th>\r\n            <th style=\"width: 15%\">Code</th>\r\n            <th style=\"width: 32%\">Name</th>\r\n            <th style=\"width: 5%\" class=\"text-center\">UOM</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Quantity</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Not Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Status</th>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"caption\">\r\n          <div class=\"d-flex\">\r\n            <p class=\"subtitle\" *ngIf=\"!selectedTechnicalEquipment\">Choose the Technical Equipment to Quality Control</p>\r\n            <button\r\n              pButton\r\n              type=\"button\"\r\n              class=\"ml-auto p-button-icon\"\r\n              icon=\"pi pi-angle-double-right\"\r\n              label=\"Quality Control\"\r\n              [disabled]=\"isLoadingTechnicalEquipment || !selectedTechnicalEquipment\"\r\n              (click)=\"onQualityControlTechnicalEquipment()\"\r\n            >\r\n            </button>\r\n          </div>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"body\" let-product let-i=\"rowIndex\">\r\n          <tr [pSelectableRow]=\"product\">\r\n            <td style=\"width: 8%\" class=\"text-center\">{{i + 1}}</td>\r\n            <td style=\"width: 15%\">\r\n              {{product.nomenclature.code}}\r\n            </td>\r\n            <td style=\"width: 32%\">\r\n              {{product.nomenclature.name}}\r\n            </td>\r\n            <td style=\"width: 5%\" class=\"text-center\">\r\n              {{product.nomenclature.category ? product.nomenclature.category.unit_of_measure.symbol : 'Pcs'}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.quantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.passed_quantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.not_passed_quantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              <span *ngIf=\"product.quality_control == 1\" class=\"badge badge_success\">PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 2\" class=\"badge badge_warning\">PARTLY PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 0\" class=\"badge badge_danger\">NOT PASSED</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"emptymessage\">\r\n          <tr>\r\n            <td class=\"text-center p-4\" [attr.colspan]=\"11\">\r\n              <i *ngIf=\"isLoadingTechnicalEquipment\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n              <span *ngIf=\"!isLoadingTechnicalEquipment\">No Records Found</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"paginatorright\">\r\n          <p-button\r\n            type=\"button\"\r\n            (click)=\"st.paginator=false\"\r\n            styleClass=\"p-button-text\"\r\n          >All\r\n          </p-button>\r\n        </ng-template>\r\n      </p-table>\r\n    </div>\r\n    <div *ngIf=\"!st.paginator && !isLoadingTechnicalEquipment && technicalEquipments.length > 0\" class=\"paginator-return-pagination\">\r\n      <p-button\r\n        type=\"button\"\r\n        (click)=\"st.paginator=true\"\r\n        styleClass=\"p-button-text\"\r\n      >\r\n        Return pagination\r\n      </p-button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #orderLink>\r\n  <a class=\"order-link\" (click)=\"goToOrder()\">{{invoice?.order?.id}}</a>\r\n</ng-template>\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {NavigationLink} from '../../../layout/navigation-route';\r\n\r\n@Component({\r\n  selector: 'pek-qc-layout',\r\n  templateUrl: './qc-layout.component.html',\r\n  styleUrls: ['./qc-layout.component.scss']\r\n})\r\nexport class QcLayoutComponent implements OnInit {\r\n\r\n  routes: NavigationLink[] = [\r\n    {label: 'Invoices', commands: ['list']},\r\n  ];\r\n\r\n  settingRoutes: NavigationLink[] = [\r\n    {label: 'Protocols', commands: ['protocols']},\r\n  ];\r\n\r\n  constructor() {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n}\r\n","<pek-header\r\n  [module]=\"'Quality Control'\"\r\n  [routes]=\"routes\"\r\n  [settingsRoutes]=\"settingRoutes\"\r\n></pek-header>\r\n\r\n<router-outlet></router-outlet>\r\n\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {FormBuilder, FormGroup} from '@angular/forms';\r\nimport {Invoice} from '../../../procurement/models/invoice';\r\nimport {TreeNode} from 'primeng/api';\r\nimport {InvoiceService} from '../../../procurement/services/invoice.service';\r\nimport {Order} from '../../../procurement/models/order';\r\nimport {OrderService} from '../../../procurement/services/order.service';\r\nimport {ProductStructureCategoryService} from '../../../product-structure/services/product-structure-category.service';\r\nimport {Category} from '../../../product-structure/models/category';\r\nimport {AdapterService} from '@shared/services/adapter.service';\r\nimport {Subject, takeUntil} from 'rxjs';\r\nimport {QuerySearch} from '@shared/models/other';\r\nimport * as cloneDeep from 'lodash/cloneDeep';\r\n\r\ntype ViewType = 'list' | 'hierarchy'\r\n\r\n@Component({\r\n  selector: 'pek-qc-list',\r\n  templateUrl: './qc-list.component.html',\r\n  styleUrls: ['./qc-list.component.scss']\r\n})\r\nexport class QcListComponent implements OnInit {\r\n  invoices: Invoice[];\r\n  orders: Order[];\r\n\r\n  selectedInvoiceNode: TreeNode<Invoice>;\r\n  selectedOrderNode: TreeNode<Order>;\r\n  selectedPurchasedInvoiceNode: TreeNode<Invoice>;\r\n\r\n  invoicesViewType: ViewType = 'hierarchy';\r\n  invoicesOrderType: ViewType = 'hierarchy';\r\n  invoicesPurchasedType: ViewType = 'hierarchy';\r\n\r\n  invoiceManufacturedTree: TreeNode<Invoice>[];\r\n  invoicePurchasedTree: TreeNode<Invoice>[];\r\n  ownProductionCategorizedList: TreeNode[];\r\n\r\n  invoiceTree: TreeNode<Invoice>[];\r\n  orderTree: TreeNode<Invoice>[];\r\n\r\n  isLoadingInvoices = true;\r\n  isLoadingOrders = true;\r\n\r\n  showClosedInvoices = false;\r\n  showClosedOrders = false;\r\n\r\n  categories: TreeNode<Category>[];\r\n\r\n  invoicesList: Invoice[] = [];\r\n  ordersList: Order[] = [];\r\n  purchasedInvoicesList: Invoice[] = [];\r\n\r\n  selectedInvoice: Invoice;\r\n  selectedInvoiceItem: Invoice;\r\n  selectedInvoicePurchaseItem: Invoice;\r\n  selectedOrderItem: Order;\r\n\r\n  expanseMap = {};\r\n\r\n  private destroyInvoices$ = new Subject();\r\n  private destroyOrders$ = new Subject();\r\n\r\n  invoicesQuery: QuerySearch[] = [\r\n    {name: 'needs_qc', value: true},\r\n    {name: 'by_qc_module_permission', value: true}\r\n  ];\r\n\r\n  ordersQuery: QuerySearch[] = [\r\n    {name: 'needs_qc', value: true},\r\n    {name: 'by_qc_module_permission', value: true}\r\n  ];\r\n\r\n  searchForm: FormGroup = this.fb.group({    \r\n    supplier: [null],\r\n    qc_closed_date_after: [null],\r\n    qc_closed_date_before: [null],\r\n    accounting_type: [null],\r\n    material_or_service: [null],\r\n    purchase_categories: [null],\r\n    status: [null]\r\n  });\r\n\r\n  constructor(\r\n    private invoiceService: InvoiceService,\r\n    private orderService: OrderService,\r\n    private productStructureCategoryService: ProductStructureCategoryService,\r\n    private adapterService: AdapterService,\r\n    private fb: FormBuilder,\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.getCategories();\r\n    this.getInvoices();\r\n    this.getServices();\r\n  }\r\n\r\n  searchItems() {\r\n    this.searchInvoices();\r\n    this.searchServices();\r\n  }\r\n\r\n  searchInvoices() {\r\n    this.isLoadingInvoices = true;\r\n    this.destroyInvoices$.next(true);\r\n    this.invoices = [];\r\n    this.selectedInvoice = null;\r\n    this.invoicesQuery = [\r\n      {name: 'by_qc_module_permission', value: true}\r\n    ];\r\n\r\n    if (!this.searchForm.get('qc_closed_date_after').value \r\n        && !this.searchForm.get('qc_closed_date_before').value) {\r\n      this.invoicesQuery.push({\r\n        name: 'needs_qc', value: true\r\n      })\r\n      this.showClosedInvoices = false;\r\n    } else {\r\n      this.showClosedInvoices = true;\r\n    }\r\n\r\n    if (this.searchForm.get('qc_closed_date_after').value) {\r\n      this.invoicesQuery.push({\r\n        name: 'qc_closed_date_after',\r\n        value: this.adapterService.dateAdapter(this.searchForm.get('qc_closed_date_after').value)\r\n      });\r\n    }\r\n\r\n    if (this.searchForm.get('qc_closed_date_before').value) {\r\n      this.invoicesQuery.push({\r\n        name: 'qc_closed_date_before',\r\n        value: this.adapterService.dateAdapter(this.searchForm.get('qc_closed_date_before').value)\r\n      });\r\n    }\r\n    this.getInvoices();\r\n  }\r\n\r\n  searchServices() {\r\n    this.isLoadingOrders = true;\r\n    this.destroyOrders$.next(true);\r\n    this.orders = [];\r\n    this.selectedOrderItem = null;\r\n    this.ordersQuery = [\r\n      {name: 'by_qc_module_permission', value: true}\r\n    ];\r\n\r\n    if (!this.searchForm.get('qc_closed_date_after').value \r\n        && !this.searchForm.get('qc_closed_date_before').value) {\r\n      this.ordersQuery.push({\r\n        name: 'needs_qc', value: true\r\n      })\r\n      this.showClosedOrders = false;\r\n    } else {\r\n      this.showClosedOrders = true;\r\n    }\r\n\r\n    if (this.searchForm.get('qc_closed_date_after').value) {\r\n      this.ordersQuery.push({\r\n        name: 'qc_closed_date_after',\r\n        value: this.adapterService.dateAdapter(this.searchForm.get('qc_closed_date_after').value)\r\n      });\r\n    }\r\n\r\n    if (this.searchForm.get('qc_closed_date_before').value) {\r\n      this.ordersQuery.push({\r\n        name: 'qc_closed_date_before',\r\n        value: this.adapterService.dateAdapter(this.searchForm.get('qc_closed_date_before').value)\r\n      });\r\n    }\r\n    this.getServices();\r\n  }\r\n\r\n  mapExpansion() {\r\n    this.categories.forEach(element => {\r\n      this.createExpanseMap(element);\r\n    });\r\n  }\r\n\r\n  createExpanseMap(node: TreeNode<Category>) {\r\n    if (node.expanded) {\r\n      this.expanseMap[node.data.id] = node.expanded;\r\n    } else {\r\n      this.expanseMap[node.data.id] = false;\r\n    }\r\n    if (node.children) {\r\n      node.children.forEach(element => {\r\n        this.createExpanseMap(element);\r\n      });\r\n    }\r\n  }\r\n\r\n  getCategories() {\r\n    this.productStructureCategoryService.get().pipe(\r\n      takeUntil(this.destroyInvoices$)\r\n    ).subscribe((categories) => {\r\n      if (this.categories) {\r\n        this.mapExpansion();\r\n      }\r\n      this.createTree(categories);\r\n    });\r\n  }\r\n\r\n  getInvoices() {\r\n    this.invoiceService.get(this.invoicesQuery).pipe(\r\n      takeUntil(this.destroyInvoices$)\r\n    ).subscribe(invoices => {\r\n      this.invoices = invoices;\r\n      this.makeUniqueProductionPlansInvoice(),\r\n      this.resetProductPaymentTree(),\r\n      this.resetInvoicesList(),\r\n      this.isLoadingInvoices = false\r\n    });\r\n  }\r\n\r\n  getServices(): void {\r\n    this.orderService.get(this.ordersQuery).pipe(\r\n      takeUntil(this.destroyOrders$)\r\n    ).subscribe(orders => {\r\n      this.orders = orders;\r\n      this.makeUniqueProductionPlans(),\r\n      this.fillOwnProductionWithData(),\r\n      this.resetOrdersList(),\r\n      this.isLoadingOrders = false\r\n    });\r\n  }\r\n\r\n  resetInvoicesList(): void {\r\n    this.purchasedInvoicesList = this.invoices.filter(i => i.purchase_category);\r\n    this.invoicesList = this.invoices.filter(i => !i.purchase_category);\r\n  }\r\n\r\n  resetOrdersList(): void {\r\n    this.ordersList = this.orders;\r\n  }\r\n\r\n  resetProductPaymentTree(): void {\r\n    const categories: { name: string, description: string, id: number, level?: number }[] = [];\r\n    this.invoices.forEach(invoice => {\r\n      const purchaseCategory = invoice.purchase_category;\r\n\r\n      if (purchaseCategory) {\r\n        const isAdded = categories.findIndex(el => el.id === purchaseCategory.id);\r\n        if (isAdded < 0) {\r\n          categories.push({\r\n            name: purchaseCategory.name,\r\n            id: purchaseCategory.id,\r\n            description: purchaseCategory.description,\r\n          });\r\n        }\r\n      } else {\r\n        if (invoice.order?.accounting_type === 1) {\r\n          const isAdded = categories.findIndex(el => el.id === -2);\r\n          if (isAdded < 0) {\r\n            categories.push({name: 'Production Lists Procurement', id: -2, description: '', level: 0});\r\n          }\r\n        }\r\n        if (invoice.order?.accounting_type === 2) {\r\n          const isAdded = categories.findIndex(el => el.id === -1);\r\n          if (isAdded < 0) {\r\n            categories.push({name: 'Outsourcing', id: -1, description: '', level: 0});\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    categories.sort((a, b) => a.id - b.id);\r\n    this.invoiceTree = [];\r\n    categories.forEach(cat => {\r\n      this.invoiceTree.push({\r\n        data: <any>cat,\r\n        expanded: false,\r\n        parent: null\r\n      });\r\n    });\r\n\r\n    this.createPaymentTree();\r\n  }\r\n\r\n  createPaymentTree() {\r\n    this.invoiceTree = this.invoiceTree.map(node => {\r\n      return {\r\n        ...node,\r\n        children: []\r\n      };\r\n    });\r\n\r\n    this.invoiceTree.forEach(node => {\r\n      // Preparing Purchased Invoices\r\n      this.invoices.filter(invoice => invoice.purchase_category).forEach(invoice => {\r\n\r\n        const purchaseCategory = invoice.purchase_category;\r\n        if (purchaseCategory) {\r\n          if (purchaseCategory.id === node.data.id) {\r\n            node.children.push({\r\n              data: invoice,\r\n              expanded: false,\r\n              children: []\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      // Preparing Manufacturing Procurement\r\n      if (node.data.id === -2) {\r\n        const manProc = this.invoices.filter(invoice => !invoice.purchase_category && invoice.order?.accounting_type === 1);\r\n        node.children = cloneDeep(this.categories);\r\n        this.prepareInnerTreeCategories(manProc, node);\r\n      }\r\n\r\n      // Preparing Outsourcing\r\n      if (node.data.id === -1) {\r\n        const outsourcing = this.invoices.filter(invoice => !invoice.purchase_category && invoice.order?.accounting_type === 2);\r\n        node.children = cloneDeep(this.categories);\r\n        this.prepareInnerTreeCategories(outsourcing, node);\r\n      }\r\n    });\r\n\r\n    this.separatePurchasedAndManufactured();\r\n  }\r\n\r\n  prepareInnerTreeCategories(invoices, nodeInner: TreeNode): void {\r\n    const categoriesTemp: { id: number, level: number, parentId: number, name: string }[] = [];\r\n    invoices.forEach(order => {\r\n      order.unique_root_production_plans.forEach(plan => {\r\n        if (plan.root_nomenclature && plan.root_nomenclature.root_category) {\r\n          const rootCatId = plan.root_nomenclature.root_category.id;\r\n          const rootCatName = plan.root_nomenclature.root_category.name;\r\n          const rootLevel = 1;\r\n\r\n          const catId = plan.root_nomenclature.id;\r\n          const catName = plan.root_nomenclature.name;\r\n          const catLevel = 2;\r\n\r\n          const rootExistsIndex = categoriesTemp.findIndex(cat => cat.id === rootCatId && rootLevel === cat.level);\r\n\r\n          if (rootExistsIndex < 0) {\r\n            categoriesTemp.push({\r\n              id: rootCatId,\r\n              level: rootLevel,\r\n              name: rootCatName,\r\n              parentId: null\r\n            });\r\n          }\r\n\r\n          const catExistsIndex = categoriesTemp.findIndex(cat => cat.id === catId && catLevel === cat.level);\r\n\r\n          if (catExistsIndex < 0) {\r\n            categoriesTemp.push({\r\n              id: catId,\r\n              level: catLevel,\r\n              name: catName,\r\n              parentId: rootCatId\r\n            });\r\n          }\r\n        } else {\r\n          const indexNoNomenclature = categoriesTemp.findIndex(cat => cat.id === -2);\r\n          if (indexNoNomenclature < 0) {\r\n            categoriesTemp.push({\r\n              id: -2,\r\n              level: 1,\r\n              name: 'No root nomenclature',\r\n              parentId: null\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      if (order.unique_root_production_plans.length < 1) {\r\n        const noCategoryIndex = nodeInner.children.findIndex(node => node.data.id === -1);\r\n\r\n        if (noCategoryIndex < 0) {\r\n          nodeInner.children.push({\r\n            data: {\r\n              id: -1,\r\n              level: 0,\r\n              name: 'No Root List',\r\n              parentId: null\r\n            },\r\n            expanded: false,\r\n            children: [\r\n              {\r\n                data: {order, plan: null, level: 4},\r\n                expanded: false,\r\n                children: []\r\n              }]\r\n          });\r\n        } else {\r\n          nodeInner.children[noCategoryIndex].children.push(\r\n            {\r\n              data: {order, plan: null, level: 4},\r\n              expanded: false,\r\n              children: []\r\n            }\r\n          );\r\n        }\r\n      }\r\n    });\r\n\r\n    const temp = cloneDeep(nodeInner.children);\r\n    temp.forEach(node => {\r\n      this.appendCategories(node, categoriesTemp);\r\n    });\r\n\r\n    temp.forEach(node => {\r\n      this.fillWithTheData(node, invoices);\r\n    });\r\n\r\n    temp.forEach(node => {\r\n      this.removeUpdateEmptyCategories(node);\r\n    });\r\n\r\n    nodeInner.children = temp;\r\n  }\r\n\r\n  separatePurchasedAndManufactured(): void {\r\n    this.invoicePurchasedTree = this.invoiceTree.filter(invoice => invoice.data.id >= 0);\r\n    this.invoiceManufacturedTree = this.invoiceTree.filter(invoice => invoice.data.id < 0);\r\n  }\r\n\r\n  makeUniqueProductionPlans(): void {\r\n    this.orders.forEach(order => {\r\n      order.unique_root_production_plans = [];\r\n      order.root_production_plans.forEach(plan => {\r\n        if (plan.root_nomenclature) {\r\n          const nomenclatureId = plan.root_nomenclature.id;\r\n          const existingIndex =\r\n            order.unique_root_production_plans\r\n              .findIndex(unPlan => unPlan.root_nomenclature.id === nomenclatureId);\r\n\r\n          if (existingIndex < 0) {\r\n            order.unique_root_production_plans.push(plan);\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  makeUniqueProductionPlansInvoice(): void {\r\n    this.invoices.forEach(invoice => {\r\n      invoice.unique_root_production_plans = [];\r\n      invoice.root_production_plans.forEach(plan => {\r\n        if (plan.root_nomenclature) {\r\n          const nomenclatureId = plan.root_nomenclature.id;\r\n          const existingIndex =\r\n            invoice.unique_root_production_plans\r\n              .findIndex(unPlan => unPlan.root_nomenclature.id === nomenclatureId);\r\n\r\n          if (existingIndex < 0) {\r\n            invoice.unique_root_production_plans.push(plan);\r\n          }\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  createTree(data) {\r\n    const dd = [];\r\n    data.forEach(element => {\r\n      const ins = {data: element, expanded: false};\r\n      if (this.expanseMap) {\r\n        ins.expanded = this.expanseMap[element.id];\r\n      }\r\n      dd.push(ins);\r\n    });\r\n    const root = [];\r\n    const idMapping = dd.reduce((acc, el, i) => {\r\n      acc[el.data.id] = i;\r\n      return acc;\r\n    }, {});\r\n    dd.forEach(el => {\r\n      if (el.data.parent === null) {\r\n        root.push(el);\r\n        return;\r\n      }\r\n      const parentEl = dd[idMapping[el.data.parent]];\r\n      parentEl.children = [...(parentEl.children || []), el];\r\n      if (parentEl.children.length === 0) {\r\n        delete parentEl.children;\r\n      }\r\n\r\n    });\r\n    this.categories = root;\r\n    this.ownProductionCategorizedList = cloneDeep(this.categories);\r\n  }\r\n\r\n  private fillOwnProductionWithData() {\r\n    this.fillCategorizedTree();\r\n  }\r\n\r\n  fillCategorizedTree(): void {\r\n    this.ownProductionCategorizedList = cloneDeep(this.categories);\r\n    const categoriesTemp: { id: number, level: number, parentId: number, name: string }[] = [];\r\n\r\n    this.orders.forEach(order => {\r\n      order.unique_root_production_plans.forEach(plan => {\r\n        if (plan.root_nomenclature && plan.root_nomenclature.root_category) {\r\n          const rootCatId = plan.root_nomenclature.root_category.id;\r\n          const rootCatName = plan.root_nomenclature.root_category.name;\r\n          const rootLevel = 1;\r\n\r\n          const catId = plan.root_nomenclature.id;\r\n          const catName = plan.root_nomenclature.name;\r\n          const catLevel = 2;\r\n\r\n          const rootExistsIndex = categoriesTemp.findIndex(cat => cat.id === rootCatId && rootLevel === cat.level);\r\n\r\n          if (rootExistsIndex < 0) {\r\n            categoriesTemp.push({\r\n              id: rootCatId,\r\n              level: rootLevel,\r\n              name: rootCatName,\r\n              parentId: null\r\n            });\r\n          }\r\n\r\n          const catExistsIndex = categoriesTemp.findIndex(cat => cat.id === catId && catLevel === cat.level);\r\n\r\n          if (catExistsIndex < 0) {\r\n            categoriesTemp.push({\r\n              id: catId,\r\n              level: catLevel,\r\n              name: catName,\r\n              parentId: rootCatId\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      if (order.unique_root_production_plans.length < 1) {\r\n        const noCategoryIndex = this.ownProductionCategorizedList.findIndex(nodeInner => nodeInner.data.id === -1);\r\n\r\n        if (noCategoryIndex < 0) {\r\n          this.ownProductionCategorizedList.push({\r\n            data: {\r\n              id: -1,\r\n              level: 0,\r\n              name: 'No Root List',\r\n              parentId: null\r\n            },\r\n            expanded: false,\r\n            children: [\r\n              {\r\n                data: {order, plan: null, level: 4},\r\n                expanded: false,\r\n                children: []\r\n              }]\r\n          });\r\n        } else {\r\n          this.ownProductionCategorizedList[noCategoryIndex].children.push(\r\n            {\r\n              data: {order, plan: null, level: 4},\r\n              expanded: false,\r\n              children: []\r\n            }\r\n          );\r\n        }\r\n      }\r\n    });\r\n\r\n    if (this.ownProductionCategorizedList) {\r\n      const temp = cloneDeep(this.ownProductionCategorizedList);\r\n      temp.forEach(node => {\r\n        this.appendCategories(node, categoriesTemp);\r\n      });\r\n\r\n      temp.forEach(node => {\r\n        this.fillWithTheData(node, this.orders);\r\n      });\r\n\r\n      temp.forEach(node => {\r\n        this.removeUpdateEmptyCategories(node);\r\n      });\r\n\r\n      this.ownProductionCategorizedList = temp;\r\n      this.isLoadingOrders = false;\r\n    }\r\n  }\r\n\r\n  appendCategories(node: TreeNode, categoriesTemp: { id: number, level: number, parentId: number, name: string }[]): void {\r\n    if (!node.children) {\r\n      node.children = [];\r\n    }\r\n\r\n    categoriesTemp.forEach(cat => {\r\n      if (cat.parentId === node.data.id) {\r\n        node.children.push({\r\n          data: {\r\n            id: cat.id,\r\n            name: cat.name,\r\n            level: cat.level,\r\n            parentId: cat.parentId,\r\n            isCategory: true,\r\n            categories: 0\r\n          },\r\n          expanded: false,\r\n          children: []\r\n        });\r\n      }\r\n    });\r\n\r\n    if (node.children) {\r\n      node.children.forEach(childNode => {\r\n        this.appendCategories(childNode, categoriesTemp);\r\n      });\r\n    }\r\n  }\r\n\r\n  fillWithTheData(node: TreeNode, orders): void {\r\n    if (!node.children) {\r\n      node.children = [];\r\n    }\r\n\r\n    if (node.data.isCategory) {\r\n      orders.forEach(order => {\r\n        order.unique_root_production_plans.forEach(plan => {\r\n          if (plan.root_nomenclature) {\r\n            const catId = plan.root_nomenclature.id;\r\n            if (node.data.id === catId) {\r\n              const existingCatChildIndex = node.children.findIndex(cat => cat.data.id === plan.list_product.nomenclature.id);\r\n\r\n              if (existingCatChildIndex < 0) {\r\n                node.children.push({\r\n                  data: {\r\n                    id: plan.list_product.nomenclature.id,\r\n                    name: plan.list_product.nomenclature.name,\r\n                    level: 3,\r\n                    categories: 0,\r\n                  },\r\n                  expanded: false,\r\n                  children: [{\r\n                    data: {order, plan, level: 4},\r\n                    expanded: false,\r\n                    children: []\r\n                  }]\r\n                });\r\n              } else {\r\n                node.children[existingCatChildIndex].children.push({\r\n                  data: {order, plan, level: 4},\r\n                  expanded: false,\r\n                  children: []\r\n                });\r\n              }\r\n            }\r\n          }\r\n        });\r\n      });\r\n    }\r\n    if (node.children) {\r\n      node.children.forEach(childNode => {\r\n        this.fillWithTheData(childNode, orders);\r\n      });\r\n    }\r\n  }\r\n\r\n  removeUpdateEmptyCategories(node: TreeNode): void {\r\n    if (!node.data.isCategory && !node.data.order) {\r\n      let hideFromTable = true;\r\n      const hasContent = node.children.filter(child => child.data.order).length > 0;\r\n      if (hasContent) {\r\n        hideFromTable = false;\r\n      }\r\n\r\n      node.children.forEach(childNode => {\r\n        checkForContent(childNode);\r\n      });\r\n\r\n      function checkForContent(childNode) {\r\n        if (hideFromTable) {\r\n          const hasContentInner = childNode.children.filter(child => child.data.order).length > 0;\r\n          if (hasContentInner) {\r\n            hideFromTable = false;\r\n          }\r\n        }\r\n        childNode.children.forEach(childNode2 => {\r\n          checkForContent(childNode2);\r\n        });\r\n      }\r\n\r\n      node.data.hideFromTable = hideFromTable;\r\n    }\r\n\r\n    node.data.categories = node.children.length;\r\n    if (node.children) {\r\n      node.children.forEach((childNode, indexChild) => {\r\n        this.removeUpdateEmptyCategories(childNode);\r\n      });\r\n    }\r\n  }\r\n\r\n  expandCollapseAllInvoices(isToExpand = true): void {\r\n    const temp = cloneDeep(this.invoiceManufacturedTree);\r\n    temp.forEach(node => {\r\n      this.expandCollapseRecursive(node, isToExpand);\r\n    });\r\n    this.invoiceManufacturedTree = temp;\r\n  }\r\n\r\n  expandCollapseRecursive(node: TreeNode, isExpand: boolean): void {\r\n    node.expanded = isExpand;\r\n    if (node.children) {\r\n      node.children.forEach(childNode => {\r\n        this.expandCollapseRecursive(childNode, isExpand);\r\n      });\r\n    }\r\n  }\r\n\r\n  expandCollapsePurchasedInvoices(isToExpand = true): void {\r\n    const temp = cloneDeep(this.invoicePurchasedTree);\r\n    temp.forEach(node => {\r\n      this.expandCollapseRecursive(node, isToExpand);\r\n    });\r\n    this.invoicePurchasedTree = temp;\r\n  }\r\n\r\n  expandCollapseAllOrders(isToExpand = true): void {\r\n    const temp = cloneDeep(this.ownProductionCategorizedList);\r\n    temp.forEach(node => {\r\n      this.expandCollapseRecursive(node, isToExpand);\r\n    });\r\n    this.ownProductionCategorizedList = temp;\r\n  }\r\n\r\n  onSelectInvoiceType(view: ViewType) {\r\n    this.invoicesViewType = view;\r\n  }\r\n\r\n  onSelectOrderType(view: ViewType) {\r\n    this.invoicesOrderType = view;\r\n  }\r\n\r\n  onSelectPurchaseType(view: ViewType) {\r\n    this.invoicesPurchasedType = view;\r\n  }\r\n}\r\n","<div class=\"page\">\r\n  <div class=\"page__header\">\r\n    <div class=\"page__title\">\r\n      <pek-module-icon [module]=\"'quality-control'\" [isActive]=\"true\"></pek-module-icon>\r\n      <h1>Invoices</h1>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"page__content\">\r\n  <div class=\"page__tabs\">\r\n    <form\r\n      [formGroup]=\"searchForm\"\r\n      class=\"form mb-3\"\r\n    >\r\n      <div class=\"row\">\r\n        <div class=\"col-3\">\r\n          <div class=\"form-group\">\r\n            <label>QC Closed Date From</label>\r\n            <p-calendar\r\n              formControlName=\"qc_closed_date_after\"\r\n              dateFormat=\"dd/mm/yy\"\r\n              dataType=\"date\"\r\n              [readonlyInput]=\"true\"\r\n              (ngModelChange)=\"searchItems()\"\r\n              [showButtonBar]=\"true\"\r\n            >\r\n            </p-calendar>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"col-3\">\r\n          <div class=\"form-group\">\r\n            <label>QC Closed Date To</label>\r\n            <p-calendar\r\n              formControlName=\"qc_closed_date_before\"\r\n              dateFormat=\"dd/mm/yy\"\r\n              dataType=\"date\"\r\n              [readonlyInput]=\"true\"\r\n              (ngModelChange)=\"searchItems()\"\r\n              [showButtonBar]=\"true\"\r\n            >\r\n            </p-calendar>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n    <p-tabView class=\"custom-tabs\">\r\n      <p-tabPanel\r\n        [header]=\"'Production Lists Procurement and Outsourcing Invoices'\"\r\n        [selected]=\"true\"\r\n      >\r\n        <ng-container *ngIf=\"invoicesViewType === 'list'\">\r\n          <div class=\"page__table\">\r\n            <p-table\r\n              #dt\r\n              selectionMode=\"single\"\r\n              scrollHeight=\"calc(100vh - 18.8rem)\"\r\n              dataKey=\"id\"\r\n              [scrollable]=\"true\"\r\n              [paginator]=\"invoicesList.length > 0\"\r\n              [rows]=\"10\"\r\n              [(selection)]=\"selectedInvoiceItem\"\r\n              [value]=\"invoicesList\"\r\n            >\r\n              <ng-template pTemplate=\"caption\">\r\n                <div class=\"d-flex\">\r\n                  <p\r\n                    class=\"subtitle\"\r\n                    *ngIf=\"!selectedInvoiceItem\">\r\n                    Choose the Production Lists Procurement or Outsourcing Invoice to view Items\r\n                  </p>\r\n                  <a\r\n                    pButton\r\n                    type=\"button\"\r\n                    icon=\"pi pi-bars\"\r\n                    label=\"Items\"\r\n                    class=\"ml-auto mr-2\"\r\n                    [class.disabled]=\"!selectedInvoiceItem\"\r\n                    [routerLink]=\"['../', 'invoice', selectedInvoiceItem?.id]\"\r\n                    target=\"_blank\"\r\n                  ></a>\r\n                  <button\r\n                    [disabled]=\"invoicesViewType === 'list'\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    class=\"mr-2\"\r\n                    label=\"List\"\r\n                    icon=\"pi pi-list\"\r\n                    (click)=\"onSelectInvoiceType('list')\"\r\n                  ></button>\r\n                  <button\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Hierarchy\"\r\n                    icon=\"pi pi-table\"\r\n                    (click)=\"onSelectInvoiceType('hierarchy')\"\r\n                  ></button>\r\n                </div>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"header\">\r\n                <tr>\r\n                  <th style=\"width: 5%;\" class=\"text-center\">#</th>\r\n                  <th style=\"width: 20%\" class=\"text-center\">QC Started Date</th>\r\n                  <th style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">QC Closed Date</th>\r\n                  <th style=\"width: 10%\" class=\"text-center\">Invoice Number</th>\r\n                  <th style=\"width: 15%\" class=\"text-center\">Supplier</th>\r\n                  <th style=\"width: 10%\" class=\"text-center\">Order ID</th>\r\n                  <th style=\"width: 15%\" class=\"text-center\">Items Reception Date</th>\r\n                  <th style=\"width: 20%\">Root List</th>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"body\" let-invoice let-i=\"rowIndex\">\r\n                <tr [pSelectableRow]=\"invoice\">\r\n                  <td style=\"width: 5%\" class=\"text-center\">\r\n                    {{i + 1}}\r\n                  </td>\r\n                  <td style=\"width: 20%\" class=\"text-center\">\r\n                    {{(invoice.order?.qc_started_date ? invoice.order?.qc_started_date : invoice.system_creation_date) | date:'dd/MM/yyyy HH:mm'}}\r\n                  </td>\r\n                  <td style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">\r\n                    {{invoice.order?.qc_closed_date | date:'dd/MM/yyyy HH:mm'}}\r\n                  </td>\r\n                  <td style=\"width: 10%\" class=\"text-center\">\r\n                    {{invoice.self_serial_number}} {{invoice.self_proforma_serial_number}}\r\n                  </td>\r\n                  <td style=\"width: 15%\" class=\"text-center\">\r\n                    {{invoice.supplier?.name}}\r\n                  </td>\r\n                  <td style=\"width: 10%\" class=\"text-center\">\r\n                    {{invoice.order?.id}}\r\n                  </td>\r\n                  <td style=\"width: 15%\" class=\"text-center\">\r\n                    {{invoice.items_reception_date | date: 'dd/MM/yyyy'}}\r\n                  </td>\r\n                  <td style=\"width: 20%\">\r\n                    <ng-container *ngIf=\"invoice.root_production_plans.length > 0\">\r\n                      {{invoice.root_production_plans[0].list_product.nomenclature.code}}\r\n                      ~{{invoice.root_production_plans[0].list_product.nomenclature.name}}\r\n                    </ng-container>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"emptymessage\">\r\n                <tr>\r\n                  <td class=\"text-center p-4\" [attr.colspan]=\"7\">\r\n                    <i *ngIf=\"isLoadingInvoices\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n                    <span *ngIf=\"!isLoadingInvoices\">No Records Found</span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"paginatorright\">\r\n                <p-button\r\n                  type=\"button\"\r\n                  (click)=\"dt.paginator=false\"\r\n                  styleClass=\"p-button-text\"\r\n                >All\r\n                </p-button>\r\n              </ng-template>\r\n            </p-table>\r\n          </div>\r\n          <div *ngIf=\"!dt.paginator && !isLoadingInvoices && invoicesList.length > 0\" class=\"paginator-return-pagination\">\r\n            <p-button\r\n              type=\"button\"\r\n              (click)=\"dt.paginator=true\"\r\n              styleClass=\"p-button-text\"\r\n            >\r\n              Return pagination\r\n            </p-button>\r\n          </div>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"invoicesViewType === 'hierarchy'\">\r\n          <div class=\"page__table\">\r\n            <p-treeTable\r\n              #dt\r\n              selectionMode=\"single\"\r\n              [value]=\"invoiceManufacturedTree\"\r\n              [(selection)]=\"selectedInvoiceNode\"\r\n              scrollHeight=\"calc(100vh - 22rem)\"\r\n              [scrollable]=\"true\"\r\n            >\r\n              <ng-template pTemplate=\"header\">\r\n                <tr>\r\n                  <th style=\"width: 20%; padding-left: 19px\">\r\n                    QC Started Date\r\n                  </th>\r\n                  <th style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">\r\n                    QC Closed Date\r\n                  </th>\r\n                  <th style=\"width: 15%\" class=\"text-center\">Invoice Number</th>\r\n                  <th style=\"width: 10%\" class=\"text-center\">Order ID</th>\r\n                  <th style=\"width: 20%\" class=\"text-center\">Supplier</th>\r\n                  <th style=\"width: 15%;\" class=\"text-center\">Items Reception Date</th>\r\n                  <th style=\"width: 20%;\" class=\"text-center\">Root List</th>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"caption\">\r\n                <div class=\"d-flex\">\r\n                  <p\r\n                    class=\"subtitle\"\r\n                    *ngIf=\"!selectedInvoiceNode\">\r\n                    Choose the Production Lists Procurement or Outsourcing Invoice to view Items\r\n                  </p>\r\n                  <a\r\n                    [class.disabled]=\"!selectedInvoiceNode\"\r\n                    [routerLink]=\"['../', 'invoice', selectedInvoiceNode?.data.order ?\r\n        selectedInvoiceNode?.data.order.id :\r\n        selectedInvoiceNode?.data.id]\"\r\n                    target=\"_blank\"\r\n                    class=\"ml-auto mr-2\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    icon=\"pi pi-bars\"\r\n                    label=\"Items\"\r\n                  >\r\n                  </a>\r\n                  <button\r\n                    [disabled]=\"isLoadingInvoices\"\r\n                    class=\"mr-2\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Expand All\"\r\n                    icon=\"pi pi-angle-down\"\r\n                    (click)=\"expandCollapseAllInvoices()\"\r\n                  ></button>\r\n                  <button\r\n                    [disabled]=\"isLoadingInvoices\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    class=\"mr-2\"\r\n                    label=\"Collapse All\"\r\n                    icon=\"pi pi-angle-up\"\r\n                    (click)=\"expandCollapseAllInvoices(false)\"\r\n                  ></button>\r\n                  <button\r\n                    pButton\r\n                    type=\"button\"\r\n                    class=\"mr-2\"\r\n                    label=\"List\"\r\n                    icon=\"pi pi-list\"\r\n                    (click)=\"onSelectInvoiceType('list')\"\r\n                  ></button>\r\n                  <button\r\n                    [disabled]=\"invoicesViewType === 'hierarchy'\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Hierarchy\"\r\n                    icon=\"pi pi-table\"\r\n                    (click)=\"onSelectInvoiceType('hierarchy')\"\r\n                  ></button>\r\n                </div>\r\n              </ng-template>\r\n              <ng-template\r\n                pTemplate=\"body\"\r\n                let-invoiceNode\r\n                let-invoice=\"rowData\"\r\n                let-i=\"rowIndex\"\r\n              >\r\n                <tr\r\n                  [ttRow]=\"invoiceNode\"\r\n                  [ttSelectableRowDisabled]=\"!invoice.order && !invoice.level || invoice.level < 4\"\r\n                  [ttSelectableRow]=\"invoiceNode\"\r\n                    *ngIf=\"!invoice.hideFromTable\"\r\n                >\r\n                  <td  style=\"width: 20%\" [class.text-center]=\"invoice.order\">\r\n                    <div class=\"table-toggle\">\r\n                      <p-treeTableToggler [rowNode]=\"invoiceNode\"></p-treeTableToggler>\r\n                      <ng-container *ngIf=\"!invoice.order\">\r\n                        <span [class.category-name]=\"invoice.level === 0 && invoice.hideFromTable !== false\">\r\n                          {{invoice.name}}\r\n                          <span *ngIf=\"invoice.description\">({{invoice.description}})</span>\r\n                          <i *ngIf=\"invoice.level < 4 && invoice.level > 0\" style=\"font-style: normal\">({{invoice.categories}})</i>\r\n                        </span>\r\n                      </ng-container>\r\n                      <span *ngIf=\"invoice.level === 4\">\r\n                        {{(invoice.order?.order?.qc_started_date ? invoice.order?.order?.qc_started_date :\r\n                        invoice.order.system_creation_date) |date:'dd/MM/yyyy HH:mm'}}\r\n                        </span>\r\n                    </div>\r\n                  </td>\r\n                  <td  style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">\r\n                    <span *ngIf=\"invoice.level === 4\">\r\n                      {{invoice.order?.order?.qc_closed_date |date:'dd/MM/yyyy HH:mm'}} \r\n                    </span>\r\n                  </td>\r\n                  <td  style=\"width: 15%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      {{invoice.self_serial_number}} {{invoice.self_proforma_serial_number}}\r\n                    </ng-container>\r\n                    <span\r\n                      *ngIf=\"invoice.level === 4\"\r\n                      [class.text-warning]=\"invoice.order.unique_root_production_plans.length > 1\"\r\n                    >\r\n                    {{invoice.order.self_serial_number}} {{invoice.order.self_proforma_serial_number}}\r\n                    </span>\r\n                  </td>\r\n                  <td  style=\"width: 10%\" class=\"text-center\">\r\n                    <span *ngIf=\"invoice.level === 4\">\r\n                      {{invoice.order?.order?.id}}\r\n                    </span>\r\n                  </td>\r\n                  <td  style=\"width: 20%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      {{invoice.supplier?.name}}\r\n                    </ng-container>\r\n                    <span *ngIf=\"invoice.level === 4\">\r\n                      {{invoice.order.supplier?.name}}\r\n                    </span>\r\n                  </td>\r\n                  <td  style=\"width: 15%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      {{invoice.items_reception_date | date: 'dd/MM/yyyy'}}\r\n                    </ng-container>\r\n                    <span *ngIf=\"invoice.level === 4\">\r\n                      {{invoice.order.items_reception_date | date: 'dd/MM/yyyy'}}\r\n                    </span>\r\n                  </td>\r\n                  <td style=\"width: 20%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      <div *ngFor=\"let root_list of invoice.unique_root_production_plans\">\r\n                        {{root_list.list_product.nomenclature.name}}\r\n                      </div>\r\n                    </ng-container>\r\n                    <span *ngIf=\"invoice.level === 4 && invoice.plan\">\r\n                      {{invoice.plan.list_product.nomenclature.code}}~{{invoice.plan.list_product.nomenclature.name}}\r\n                      <span>({{invoice.plan.required_quantity}})</span>\r\n                </span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"emptymessage\">\r\n                <tr>\r\n                  <td class=\"text-center p-4\" [attr.colspan]=\"7\">\r\n                    <i *ngIf=\"isLoadingInvoices\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n                    <span *ngIf=\"!isLoadingInvoices\">No Records Found</span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n            </p-treeTable>\r\n          </div>\r\n        </ng-container>\r\n      </p-tabPanel>\r\n      <p-tabPanel\r\n        [header]=\"'Own Production'\"\r\n      >\r\n      \r\n        <ng-container *ngIf=\"invoicesOrderType === 'list'\">\r\n          <div class=\"page__table\">\r\n            <p-table\r\n              #ot\r\n              selectionMode=\"single\"\r\n              scrollHeight=\"calc(100vh - 18.8rem)\"\r\n              dataKey=\"id\"\r\n              [scrollable]=\"true\"\r\n              [paginator]=\"ordersList.length > 0\"\r\n              [rows]=\"10\"\r\n              [(selection)]=\"selectedOrderItem\"\r\n              [value]=\"ordersList\"\r\n            >\r\n              <ng-template pTemplate=\"caption\">\r\n                <div class=\"d-flex\">\r\n                  <p\r\n                    class=\"subtitle\"\r\n                    *ngIf=\"!selectedOrderItem\">\r\n                    hoose the Own Production Invoice to view Items\r\n                  </p>\r\n\r\n                  <a\r\n                    pButton\r\n                    type=\"button\"\r\n                    icon=\"pi pi-bars\"\r\n                    label=\"Items\"\r\n                    class=\"ml-auto mr-2\"\r\n                    [class.disabled]=\"!selectedOrderItem\"\r\n                    [routerLink]=\"['../', 'order', selectedOrderItem?.id]\"\r\n                    target=\"_blank\"\r\n                  ></a>\r\n                  <button\r\n                    [disabled]=\"invoicesOrderType === 'list'\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    class=\"mr-2\"\r\n                    label=\"List\"\r\n                    icon=\"pi pi-list\"\r\n                    (click)=\"onSelectOrderType('list')\"\r\n                  ></button>\r\n                  <button\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Hierarchy\"\r\n                    icon=\"pi pi-table\"\r\n                    (click)=\"onSelectOrderType('hierarchy')\"\r\n                  ></button>\r\n                </div>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"header\">\r\n                <tr>\r\n                  <th style=\"width: 5%;\" class=\"text-center\">#</th>\r\n                  <th style=\"width: 25%\" class=\"text-center\">\r\n                    QC Started Date\r\n                  </th>\r\n                  <th style=\"width: 25%\" class=\"text-center\" *ngIf=\"showClosedOrders\">\r\n                    QC Closed Date\r\n                  </th>\r\n                  <th style=\"width: 10%\" class=\"text-center\">Order ID</th>\r\n                  <th style=\"width: 15%;\" class=\"text-center\">Items Reception Date</th>\r\n                  <th style=\"width: 20%;\">Root List</th>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"body\" let-order let-i=\"rowIndex\">\r\n                <tr [pSelectableRow]=\"order\">\r\n                  <td class=\"text-center\">{{i + 1}}</td>\r\n                  <td style=\"width: 25%\" class=\"text-center\">\r\n                    {{(order?.qc_started_date ? order?.qc_started_date : order?.created) | date:'dd/MM/yyyy HH:mm'}}\r\n                  </td>\r\n                  <td style=\"width: 25%\" class=\"text-center\">\r\n                    {{order?.qc_closed_date | date:'dd/MM/yyyy HH:mm'}}\r\n                  </td>\r\n                  <td style=\"width: 10%\" class=\"text-center\">\r\n                    {{order.id}}\r\n                  </td>\r\n                  <td style=\"width: 15%;\" class=\"text-center\">\r\n                    {{order.items_reception_date | date: 'dd/MM/yyyy'}}\r\n                  </td>\r\n\r\n                  <td style=\"width: 20%;\">\r\n                    <div *ngFor=\"let root_plan of order.unique_root_production_plans\">\r\n                      {{root_plan.list_product.nomenclature.code}}~{{root_plan.list_product.nomenclature.name}}\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"emptymessage\">\r\n                <tr>\r\n                  <td class=\"text-center p-4\" [attr.colspan]=\"7\">\r\n                    <i *ngIf=\"isLoadingOrders\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n                    <span *ngIf=\"!isLoadingOrders\">No Records Found</span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"paginatorright\">\r\n                <p-button\r\n                  type=\"button\"\r\n                  (click)=\"ot.paginator=false\"\r\n                  styleClass=\"p-button-text\"\r\n                >All\r\n                </p-button>\r\n              </ng-template>\r\n            </p-table>\r\n          </div>\r\n          <div *ngIf=\"!ot.paginator && !isLoadingOrders && ordersList.length > 0\" class=\"paginator-return-pagination\">\r\n            <p-button\r\n              type=\"button\"\r\n              (click)=\"ot.paginator=true\"\r\n              styleClass=\"p-button-text\"\r\n            >\r\n              Return pagination\r\n            </p-button>\r\n          </div>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"invoicesOrderType === 'hierarchy'\">\r\n          <div class=\"page__table\">\r\n            <p-treeTable\r\n              #dt\r\n              selectionMode=\"single\"\r\n              [value]=\"ownProductionCategorizedList\"\r\n              [(selection)]=\"selectedOrderNode\"\r\n              [scrollable]=\"true\"\r\n              scrollHeight=\"calc(100vh - 22rem)\"\r\n            >\r\n              <ng-template pTemplate=\"header\">\r\n                <tr>\r\n                  <th style=\"width: 20%; padding-left: 19px\">QC Started Date</th>\r\n                  <th style=\"width: 20%;\" class=\"text-center\" *ngIf=\"showClosedOrders\">QC Closed Date</th>\r\n                  <th style=\"width: 15%;\" class=\"text-center\">Order ID</th>\r\n                  <th style=\"width: 45%;\" class=\"text-center\">Items Reception Date</th>\r\n                  <th style=\"width: 20%;\" class=\"text-center\">Root List</th>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"caption\">\r\n                <div class=\"d-flex\">\r\n                  <p\r\n                    class=\"subtitle\"\r\n                    *ngIf=\"!selectedOrderNode\">\r\n                    Choose Own Production Item to view Items\r\n                  </p>\r\n                  <a\r\n                    [class.disabled]=\"!selectedOrderNode\"\r\n                    [routerLink]=\"['../', 'order', selectedOrderNode?.data.order.id]\"\r\n                    class=\"ml-auto mr-2\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    icon=\"pi pi-bars\"\r\n                    label=\"Items\"\r\n                    target=\"_blank\"\r\n                  >\r\n                  </a>\r\n                  <button\r\n                    [disabled]=\"isLoadingOrders\"\r\n                    (click)=\"expandCollapseAllOrders()\"\r\n                    class=\"mr-2\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Expand All\"\r\n                    icon=\"pi pi-angle-down\"\r\n                  ></button>\r\n                  <button\r\n                    [disabled]=\"isLoadingOrders\"\r\n                    (click)=\"expandCollapseAllOrders(false)\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Collapse All\"\r\n                    class=\"mr-2\"\r\n                    icon=\"pi pi-angle-up\"\r\n                  ></button>\r\n                  <button\r\n                    pButton\r\n                    type=\"button\"\r\n                    class=\"mr-2\"\r\n                    label=\"List\"\r\n                    icon=\"pi pi-list\"\r\n                    (click)=\"onSelectOrderType('list')\"\r\n                  ></button>\r\n                  <button\r\n                    [disabled]=\"invoicesOrderType === 'hierarchy'\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Hierarchy\"\r\n                    icon=\"pi pi-table\"\r\n                    (click)=\"onSelectOrderType('hierarchy')\"\r\n                  ></button>\r\n                </div>\r\n              </ng-template>\r\n              <ng-template\r\n                pTemplate=\"body\"\r\n                let-rowNode\r\n                let-rowData=\"rowData\"\r\n              >\r\n                <tr [ttRow]=\"rowNode\" [ttSelectableRow]=\"rowNode\" [ttSelectableRowDisabled]=\"rowData.level < 4\" *ngIf=\"!rowData.hideFromTable\">\r\n                  <td style=\"width: 20%;\">\r\n                    <div  class=\"table-toggle\">\r\n                      <p-treeTableToggler [rowNode]=\"rowNode\"></p-treeTableToggler>\r\n                      <span [class.category-name]=\"rowData.level === 0\">\r\n                          {{rowData.name}}\r\n                        <i *ngIf=\"rowData.level < 4\" style=\"font-style: normal\">({{rowData.categories}})</i>\r\n                  </span>\r\n                      <span *ngIf=\"rowData.order\">\r\n                    {{(rowData.order.qc_started_date? rowData.order.qc_started_date : rowData.order.created) | date: 'dd/MM/yyyy HH:mm'}}\r\n                </span>\r\n                    </div>\r\n                  </td>\r\n                  <td style=\"width: 20%;\" class=\"text-center\" *ngIf=\"showClosedOrders\">\r\n                    <span *ngIf=\"rowData.order\">\r\n                      {{rowData.order.qc_closed_date | date:'dd/MM/yyyy HH:mm'}}\r\n                    </span>\r\n                  </td>\r\n                  <td style=\"width: 15%;\" class=\"text-center\">\r\n                <span *ngIf=\"rowData.order\" [class.text-warning]=\"rowData.order.unique_root_production_plans.length > 1\">\r\n                  {{rowData.order.id}}\r\n                </span>\r\n                  </td>\r\n                  <td style=\"width: 45%;\" class=\"text-center\">\r\n              <span *ngIf=\"rowData.order\">\r\n                {{rowData.order.items_reception_date | date: 'dd/MM/yyyy'}}\r\n              </span>\r\n                  </td>\r\n                  <td style=\"width: 20%;\" class=\"text-center\">\r\n                <span *ngIf=\"rowData.order && rowData.plan\"  >\r\n                  {{rowData.plan.list_product.nomenclature.code}}~{{rowData.plan.list_product.nomenclature.name}}\r\n                </span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"emptymessage\">\r\n                <tr>\r\n                  <td class=\"text-center p-4\" [attr.colspan]=\"5\">\r\n                    <i *ngIf=\"isLoadingOrders\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n                    <span *ngIf=\"!isLoadingOrders\">No Records Found</span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n            </p-treeTable>\r\n          </div>\r\n        </ng-container>\r\n      </p-tabPanel>\r\n      <p-tabPanel\r\n        [header]=\"'General Procurement Invoices'\"\r\n      >\r\n        <ng-container *ngIf=\"invoicesPurchasedType === 'list'\">\r\n          <div class=\"page__table\">\r\n            <p-table\r\n              #pt\r\n              selectionMode=\"single\"\r\n              scrollHeight=\"calc(100vh - 18.8rem)\"\r\n              dataKey=\"id\"\r\n              [scrollable]=\"true\"\r\n              [paginator]=\"purchasedInvoicesList.length > 0\"\r\n              [rows]=\"10\"\r\n              [(selection)]=\"selectedInvoicePurchaseItem\"\r\n              [value]=\"purchasedInvoicesList\"\r\n            >\r\n              <ng-template pTemplate=\"caption\">\r\n                <div class=\"d-flex\">\r\n                  <p\r\n                    class=\"subtitle\"\r\n                    *ngIf=\"!selectedInvoicePurchaseItem\">\r\n                    Choose the General Procurement Invoice to view Items\r\n                  </p>\r\n\r\n                  <a\r\n                    pButton\r\n                    type=\"button\"\r\n                    icon=\"pi pi-bars\"\r\n                    label=\"Items\"\r\n                    class=\"ml-auto mr-2\"\r\n                    [class.disabled]=\"!selectedInvoicePurchaseItem\"\r\n                    [routerLink]=\"['../', 'invoice', selectedInvoicePurchaseItem?.id]\"\r\n                    target=\"_blank\"\r\n                  ></a>\r\n                  <button\r\n                    [disabled]=\"invoicesPurchasedType=== 'list'\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    class=\"mr-2\"\r\n                    label=\"List\"\r\n                    icon=\"pi pi-list\"\r\n                    (click)=\"onSelectPurchaseType('list')\"\r\n                  ></button>\r\n                  <button\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Hierarchy\"\r\n                    icon=\"pi pi-table\"\r\n                    (click)=\"onSelectPurchaseType('hierarchy')\"\r\n                  ></button>\r\n                </div>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"header\">\r\n                <tr>\r\n                  <th style=\"width: 5%;\" class=\"text-center\">#</th>\r\n                  <th style=\"width: 20%\" class=\"text-center\">QC Started Date</th>\r\n                  <th style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">QC Closed Date</th>\r\n                  <th style=\"width: 10%\" class=\"text-center\">Invoice Number</th>\r\n                  <th style=\"width: 15%\" class=\"text-center\">Supplier</th>\r\n                  <th style=\"width: 10%\" class=\"text-center\">Order ID</th>\r\n                  <th style=\"width: 15%\" class=\"text-center\">Items Reception Date</th>\r\n                  <th style=\"width: 20%\">Root List</th>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"body\" let-invoice let-i=\"rowIndex\">\r\n                <tr [pSelectableRow]=\"invoice\">\r\n                  <td style=\"width: 5%\" class=\"text-center\">\r\n                    {{i + 1}}\r\n                  </td>\r\n                  <td style=\"width: 20%\" class=\"text-center\">\r\n                    {{(invoice.order?.qc_started_date ? invoice.order?.qc_wh_started_date :\r\n                    invoice.system_creation_date) | date:'dd/MM/yyyy HH:mm'}}\r\n                  </td>\r\n                  <td style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">\r\n                    {{invoice.order?.qc_closed_date | date:'dd/MM/yyyy HH:mm'}}\r\n                  </td>\r\n                  <td style=\"width: 10%\" class=\"text-center\">\r\n                    {{invoice.self_serial_number}} {{invoice.self_proforma_serial_number}}\r\n                  </td>\r\n                  <td style=\"width: 15%\" class=\"text-center\">\r\n                    {{invoice.supplier?.name}}\r\n                  </td>\r\n                  <td style=\"width: 10%\" class=\"text-center\">\r\n                    {{invoice.order?.id}}\r\n                  </td>\r\n                  <td style=\"width: 15%\" class=\"text-center\">\r\n                    {{invoice.items_reception_date | date: 'dd/MM/yyyy'}}\r\n                  </td>\r\n                  <td style=\"width: 20%\">\r\n                    <ng-container *ngIf=\"invoice.root_production_plans.length > 0\">\r\n                      {{invoice.root_production_plans[0].list_product.nomenclature.code}}\r\n                      ~{{invoice.root_production_plans[0].list_product.nomenclature.name}}\r\n                    </ng-container>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"emptymessage\">\r\n                <tr>\r\n                  <td class=\"text-center p-4\" [attr.colspan]=\"7\">\r\n                    <i *ngIf=\"isLoadingInvoices\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n                    <span *ngIf=\"!isLoadingInvoices\">No Records Found</span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"paginatorright\">\r\n                <p-button\r\n                  type=\"button\"\r\n                  (click)=\"pt.paginator=false\"\r\n                  styleClass=\"p-button-text\"\r\n                >All\r\n                </p-button>\r\n              </ng-template>\r\n            </p-table>\r\n          </div>\r\n          <div *ngIf=\"!pt.paginator && !isLoadingInvoices && purchasedInvoicesList.length > 0\" class=\"paginator-return-pagination\">\r\n            <p-button\r\n              type=\"button\"\r\n              (click)=\"pt.paginator=true\"\r\n              styleClass=\"p-button-text\"\r\n            >\r\n              Return pagination\r\n            </p-button>\r\n          </div>\r\n        </ng-container>\r\n        <ng-container *ngIf=\"invoicesPurchasedType === 'hierarchy'\">\r\n          <div class=\"page__table\">\r\n            <p-treeTable\r\n              #dt\r\n              selectionMode=\"single\"\r\n              [value]=\"invoicePurchasedTree\"\r\n              [(selection)]=\"selectedPurchasedInvoiceNode\"\r\n              scrollHeight=\"calc(100vh - 22rem)\"\r\n              [scrollable]=\"true\"\r\n            >\r\n              <ng-template pTemplate=\"header\">\r\n                <tr>\r\n                  <th style=\"width: 20%; padding-left: 19px\">QC Started Date</th>\r\n                  <th style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">\r\n                    QC Closed Date\r\n                  </th>\r\n                  <th style=\"width: 15%\" class=\"text-center\">Invoice Number</th>\r\n                  <th style=\"width: 10%\" class=\"text-center\">Order ID</th>\r\n                  <th style=\"width: 20%\" class=\"text-center\">Supplier</th>\r\n                  <th style=\"width: 15%;\" class=\"text-center\">Items Reception Date</th>\r\n                  <th style=\"width: 20%;\" class=\"text-center\">Root List</th>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"caption\">\r\n                <div class=\"d-flex\">\r\n                  <p\r\n                    class=\"subtitle\"\r\n                    *ngIf=\"!selectedPurchasedInvoiceNode\">\r\n                    Choose the General Procurement Invoice to view Items\r\n                  </p>\r\n                  <a\r\n                    [class.disabled]=\"!selectedPurchasedInvoiceNode\"\r\n                    [routerLink]=\"['../', 'invoice', selectedPurchasedInvoiceNode?.data.invoice ?\r\n        selectedPurchasedInvoiceNode?.data.invoice.id :\r\n        selectedPurchasedInvoiceNode?.data.id]\"\r\n                    class=\"ml-auto mr-2\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    icon=\"pi pi-bars\"\r\n                    label=\"Items\"\r\n                    target=\"_blank\"\r\n                  >\r\n                  </a>\r\n                  <button\r\n                    [disabled]=\"isLoadingInvoices\"\r\n                    class=\"mr-2\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Expand All\"\r\n                    icon=\"pi pi-angle-down\"\r\n                    (click)=\"expandCollapsePurchasedInvoices()\"\r\n                  ></button>\r\n                  <button\r\n                    [disabled]=\"isLoadingInvoices\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Collapse All\"\r\n                    class=\"mr-2\"\r\n                    icon=\"pi pi-angle-up\"\r\n                    (click)=\"expandCollapsePurchasedInvoices(false)\"\r\n                  ></button>\r\n                  <button\r\n                    pButton\r\n                    type=\"button\"\r\n                    class=\"mr-2\"\r\n                    label=\"List\"\r\n                    icon=\"pi pi-list\"\r\n                    (click)=\"onSelectPurchaseType('list')\"\r\n                  ></button>\r\n                  <button\r\n                    [disabled]=\"invoicesPurchasedType === 'hierarchy'\"\r\n                    pButton\r\n                    type=\"button\"\r\n                    label=\"Hierarchy\"\r\n                    icon=\"pi pi-table\"\r\n                    (click)=\"onSelectPurchaseType('hierarchy')\"\r\n                  ></button>\r\n                </div>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"body\" let-invoiceNode let-invoice=\"rowData\" let-i=\"rowIndex\">\r\n                <tr [ttRow]=\"invoiceNode\"\r\n                    [ttSelectableRowDisabled]=\"!invoice.order && !invoice.level || invoice.level < 4\"\r\n                    [ttSelectableRow]=\"invoiceNode\">\r\n                  <td  style=\"width: 20%\"\r\n                      [class.text-center]=\"invoice.order\">\r\n                    <div  class=\"table-toggle\">\r\n                      <p-treeTableToggler [rowNode]=\"invoiceNode\"></p-treeTableToggler>\r\n                      <ng-container *ngIf=\"!invoice.order\">\r\n                    <span [class.category-name]=\"!invoice.level && invoice.level !== 1\">{{invoice.name}}\r\n                      <span *ngIf=\"invoice.description\">({{invoice.description}})</span>\r\n                      <i *ngIf=\"invoice.level < 4 && invoice.level > 0\" style=\"font-style: normal\">({{invoice.categories}})</i>\r\n                    </span>\r\n                      </ng-container>\r\n                      <ng-container *ngIf=\"invoice.order\">\r\n                  <span>\r\n                    {{(invoice.order.qc_started_date ? invoice.order.qc_started_date : invoice.system_creation_date)|date:'dd/MM/yyyy HH:mm'}}\r\n                  </span>\r\n                      </ng-container>\r\n                    </div>\r\n                  </td>\r\n                  <td  style=\"width: 20%\" class=\"text-center\" *ngIf=\"showClosedInvoices\">\r\n                    <span *ngIf=\"invoice.order\">\r\n                      {{invoice.order.qc_closed_date |date:'dd/MM/yyyy HH:mm'}} \r\n                    </span>\r\n                  </td>\r\n                  <td  style=\"width: 15%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      {{invoice.self_serial_number}} {{invoice.self_proforma_serial_number}}\r\n                    </ng-container>\r\n                    <span *ngIf=\"invoice.level === 4\" [class.text-warning]=\"invoice.invoice.unique_root_production_plans.length > 1\">\r\n                  {{invoice.invoice.self_serial_number}} {{invoice.invoice.self_proforma_serial_number}}\r\n                </span>\r\n                  </td>\r\n                  <td style=\"width: 10%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      {{invoice.order.id}}\r\n                    </ng-container>\r\n                  </td>\r\n                  <td  style=\"width: 20%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      {{invoice.supplier?.name}}\r\n                    </ng-container>\r\n                    <span *ngIf=\"invoice.level === 4\">\r\n                  {{invoice.invoice.supplier?.name}}\r\n                </span>\r\n                  </td>\r\n                  <td  style=\"width: 15%\" class=\"text-center\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      {{invoice.items_reception_date | date: 'dd/MM/yyyy'}}\r\n                    </ng-container>\r\n                    <span *ngIf=\"invoice.level === 4\">\r\n                  {{invoice.invoice.items_reception_date | date: 'dd/MM/yyyy'}}\r\n                </span>\r\n                  </td>\r\n                  <td style=\"width: 20%\">\r\n                    <ng-container *ngIf=\"invoice.order\">\r\n                      <div *ngFor=\"let root_list of invoice.unique_root_production_plans\">\r\n                        {{root_list.list_product.nomenclature.name}}\r\n                      </div>\r\n                    </ng-container>\r\n                    <span *ngIf=\"invoice.level === 4 && invoice.plan\">\r\n                  {{invoice.plan.list_product.nomenclature.code}}~{{invoice.plan.list_product.nomenclature.name}}\r\n                      <span>({{invoice.plan.required_quantity}})</span>\r\n                </span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n              <ng-template pTemplate=\"emptymessage\">\r\n                <tr>\r\n                  <td class=\"text-center p-4\" [attr.colspan]=\"7\">\r\n                    <i *ngIf=\"isLoadingInvoices\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n                    <span *ngIf=\"!isLoadingInvoices\">No Records Found</span>\r\n                  </td>\r\n                </tr>\r\n              </ng-template>\r\n            </p-treeTable>\r\n          </div>\r\n        </ng-container>\r\n      </p-tabPanel>\r\n    </p-tabView>\r\n  </div>\r\n</div>\r\n","import {Component, OnInit} from '@angular/core';\r\nimport {environment} from '@env/environment';\r\nimport {Order} from '../../../procurement/models/order';\r\nimport {filter, map, tap} from 'rxjs/operators';\r\nimport {ActivatedRoute, Router} from '@angular/router';\r\nimport {OrderService} from '../../../procurement/services/order.service';\r\nimport {OrderProductService} from '../../../procurement/services/order-product.service';\r\nimport {OrderTechnicalEquipment} from '../../../warehouse/models/order-technical-equipment';\r\nimport {OrderProduct} from '../../../procurement/models/order-product';\r\nimport {ModalService} from '@shared/services/modal.service';\r\nimport {AlbumService} from '@shared/services/album.service';\r\nimport {QrCodeService} from '../../../qr-code/qr-code.service';\r\nimport {QcService} from '../../services/qc.service';\r\nimport {deepCopy} from 'deep-copy-ts';\r\nimport {EInvoiceProductQualityControl} from '../../../procurement/models/invoice-product';\r\nimport {forkJoin} from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'pek-qc-order',\r\n  templateUrl: './qc-order.component.html',\r\n  styleUrls: ['./qc-order.component.scss']\r\n})\r\nexport class QcOrderComponent implements OnInit {\r\n  link = environment.link_url + 'dash/';\r\n\r\n  order: Order;\r\n  orderId: number;\r\n  isLoadingTechnicalEquipment = true;\r\n  isLoading = true;\r\n  isLoadingProducts = true;\r\n\r\n  isGenerating = false;\r\n  isReworking = false;\r\n  isCompletingProducts = false;\r\n  isCompleting = false;\r\n  isReworkingProduct = false;\r\n\r\n  selectedOrderProducts: OrderProduct[] = [];\r\n  orderProducts: OrderProduct[] = [];\r\n\r\n  technicalEquipments: OrderTechnicalEquipment[] = [];\r\n  selectedTechnicalEquipment: OrderTechnicalEquipment;\r\n\r\n  orderCanBeCompleted = false;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private orderService: OrderService,\r\n    private readonly orderProductService: OrderProductService,\r\n    private readonly modalService: ModalService,\r\n    public readonly albumService: AlbumService,\r\n    private readonly qrCodeService: QrCodeService,\r\n    private readonly qcService: QcService,\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.route.paramMap.pipe(\r\n      map(params => params.get('id')),\r\n      tap(id => this.orderId = +id),\r\n      tap(() => this.getOrder()),\r\n      tap(() => this.getOrderProducts()),\r\n    ).subscribe();\r\n  }\r\n\r\n  getOrder() {\r\n    this.orderService.getById(this.orderId).pipe(\r\n      tap(order => this.order = order),\r\n      tap(() => this.getTechnicalEquipmentToQc()),\r\n      tap(() => this.isLoading = false)\r\n    ).subscribe();\r\n  }\r\n\r\n  getTechnicalEquipmentToQc() {\r\n    this.technicalEquipments = [];\r\n    this.isLoadingTechnicalEquipment = true;\r\n\r\n    this.orderProductService.getTechnicalEquipmentToQC(this.orderId).pipe(\r\n      tap(equipment => this.technicalEquipments = equipment),\r\n      tap(() => this.isLoadingTechnicalEquipment = false)\r\n    ).subscribe();\r\n  }\r\n\r\n  getOrderProducts() {\r\n    this.orderProducts = [];\r\n    this.selectedOrderProducts = [];\r\n    this.isLoadingProducts = true;\r\n\r\n    this.orderProductService.getQc(this.orderId).pipe(\r\n      tap(products => {\r\n        products.forEach(product => {\r\n          const technologyId = product.current_technology?.id;\r\n          const nomenclatureId = product.nomenclature.id;\r\n          const existing = this.orderProducts.find(el =>\r\n            el.nomenclature.id === nomenclatureId &&\r\n            el.current_technology?.id === technologyId);\r\n          if (existing) {\r\n            existing.totalQuantity = existing.totalQuantity += product.quantity;\r\n            existing.totalQuantityPassed = existing.totalQuantityPassed += product.passed_quantity;\r\n            existing.totalQuantityNotPassed = existing.totalQuantityNotPassed += product.not_passed_quantity;\r\n            existing.totalSerialNumbers.push(...product.serial_numbers);\r\n            existing.orderProducts.push(product);\r\n          } else {\r\n            product.orderProducts = [deepCopy(product)];\r\n            product.totalQuantity = product.quantity;\r\n            product.totalQuantityPassed = product.passed_quantity;\r\n            product.totalQuantityNotPassed = product.not_passed_quantity;\r\n            product.totalSerialNumbers = [...product.serial_numbers];\r\n            this.orderProducts.push(product);\r\n          }\r\n        });\r\n        this.orderProducts.forEach(product => {\r\n          if (product.totalQuantityPassed === product.totalQuantity) {\r\n            product.quality_control = EInvoiceProductQualityControl.PASSED;\r\n          } else if (product.totalQuantityNotPassed === product.totalQuantity) {\r\n            product.quality_control = EInvoiceProductQualityControl.NOT_PASSED;\r\n          } else if (product.totalQuantityNotPassed + product.totalQuantityPassed === product.totalQuantity) {\r\n            product.quality_control = EInvoiceProductQualityControl.PARTLY_PASSED;\r\n          }\r\n        });\r\n        this.orderProducts = [...this.orderProducts];\r\n      }),\r\n      tap(products => this.orderCanBeCompleted = Boolean(products.find(p => p.quality_control))),\r\n      tap(() => this.isLoadingProducts = false)\r\n    ).subscribe();\r\n  }\r\n\r\n  onPrintAlbum() {\r\n    this.albumService.getNomenclaturesImages((this.selectedOrderProducts.map(p => p?.nomenclature)));\r\n  }\r\n\r\n  goToOrder() {\r\n    let link: string;\r\n    const order = this.order;\r\n\r\n    switch (order.accounting_type) {\r\n      case 1:\r\n        link = '/procurement/chains/order/' + order.id;\r\n        break;\r\n      case 2:\r\n        link = '/outsourcing/chains/order/' + order.id;\r\n        break;\r\n      case 3:\r\n        link = `${this.link}production/orders/order/` + order.id;\r\n        break;\r\n    }\r\n\r\n    window.open(link, '_blank');\r\n  }\r\n\r\n\r\n  onCompleteItems() {\r\n    this.modalService.confirm('success').pipe(\r\n      filter(confirm => confirm)\r\n    ).subscribe(() => {\r\n      const send = [];\r\n      const sendProducts = [];\r\n      this.selectedOrderProducts.forEach(product => {\r\n        const products = product.orderProducts.filter(p => !p.nomenclature.qc_protocol && p.nomenclature.bulk_or_serial === '0');\r\n        sendProducts.push(...products);\r\n      });\r\n\r\n      sendProducts.forEach(product => {\r\n        send.push({\r\n          id: product.id,\r\n          not_passed_quantity: 0,\r\n          passed_quantity: product.quantity,\r\n          quality_control: 1\r\n        });\r\n      });\r\n\r\n      this.isCompletingProducts = true;\r\n      this.orderProductService.severalUpdatePartly(send).pipe(\r\n        tap(() => this.getOrderProducts()),\r\n        tap(() => this.isCompletingProducts = false)\r\n      ).subscribe();\r\n    });\r\n  }\r\n\r\n  onComplete() {\r\n    this.modalService.confirm('success').pipe(\r\n      filter(confirm => confirm)\r\n    ).subscribe(() => {\r\n      const send = {id: this.order.id, qc_completed: true};\r\n      this.isCompleting = true;\r\n      this.orderService.updatePartly(send).subscribe(() => {\r\n        this.isCompleting = false;\r\n        this.router.navigate(['../../'], {relativeTo: this.route});\r\n      });\r\n    });\r\n  }\r\n\r\n  onGenerateQrCodes() {\r\n    this.isGenerating = true;\r\n\r\n    const send = {\r\n      by_nomenclatures_list: [],\r\n    };\r\n\r\n    this.selectedOrderProducts.forEach(product => {\r\n      product.orderProducts.forEach(p => {\r\n        if (p.nomenclature.bulk_or_serial === '1') {\r\n          send.by_nomenclatures_list.push({\r\n            nomenclature_id: p.nomenclature.id,\r\n            serial_number_ids:\r\n              p.nomenclature.bulk_or_serial === '1' ?\r\n                p.serial_numbers.map(s => +s.id) : [],\r\n            order_product_ids: [p.id],\r\n            invoice_product_ids: [],\r\n          });\r\n        } else {\r\n          const exists = send.by_nomenclatures_list.findIndex(el => el.nomenclature_id === p.nomenclature.id) >= 0;\r\n          if (!exists) {\r\n            send.by_nomenclatures_list.push({\r\n              nomenclature_id: p.nomenclature.id,\r\n              serial_number_ids: [],\r\n              order_product_ids: [p.id],\r\n              invoice_product_ids: [],\r\n            });\r\n          }\r\n        }\r\n      });\r\n    });\r\n    this.qrCodeService.generateQrCodes(send, this.order.id).subscribe(() => this.isGenerating = false);\r\n  }\r\n\r\n  onShowImages() {\r\n    this.modalService.showImageGallery([], this.selectedOrderProducts[0].nomenclature.id, 1).subscribe();\r\n  }\r\n\r\n  onQualityControl() {\r\n    if (this.selectedOrderProducts[0].nomenclature.qc_protocol && this.selectedOrderProducts[0].nomenclature.bulk_or_serial === '1') {\r\n      let currentCount = 1;\r\n\r\n      if (this.selectedOrderProducts[0].passed_quantity) currentCount += this.selectedOrderProducts[0].totalQuantityPassed;\r\n      if (this.selectedOrderProducts[0].not_passed_quantity) currentCount += this.selectedOrderProducts[0].totalQuantityNotPassed;\r\n\r\n      this.qcService.withProtocolControlProduct(this.selectedOrderProducts[0], currentCount, this.selectedOrderProducts[0].totalQuantity, 'order').subscribe(res => {\r\n        if (res) {\r\n          this.selectedOrderProducts = [];\r\n          this.getOrderProducts();\r\n        }\r\n      });\r\n    } else if (!this.selectedOrderProducts[0].nomenclature.qc_protocol && this.selectedOrderProducts[0].nomenclature.bulk_or_serial === '1') {\r\n      let currentCount = 1;\r\n\r\n      if (this.selectedOrderProducts[0].passed_quantity) currentCount += this.selectedOrderProducts[0].totalQuantityPassed;\r\n      if (this.selectedOrderProducts[0].not_passed_quantity) currentCount += this.selectedOrderProducts[0].totalQuantityNotPassed;\r\n\r\n      this.qcService.serializedControlProduct(this.selectedOrderProducts[0], currentCount, this.selectedOrderProducts[0].totalQuantity, 'order').subscribe(res => {\r\n        if (res) {\r\n          this.selectedOrderProducts = [];\r\n          this.getOrderProducts();\r\n        }\r\n      });\r\n    } else {\r\n      this.qcService.controlProduct(this.selectedOrderProducts[0], true).subscribe((res) => {\r\n        if (res) {\r\n          this.getOrderProducts();\r\n          this.selectedOrderProducts = [];\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  onRework() {\r\n    this.modalService.confirm('danger', 'Confirm').pipe(\r\n      filter(confirm => confirm)\r\n    ).subscribe(() => {\r\n      this.isReworking = true;\r\n      const ids = []\r\n      this.orderProducts.forEach(p => {\r\n        ids.push(...p.orderProducts.map(order => order.id))\r\n      });\r\n\r\n      this.orderProductService.reworkOrder(ids).subscribe(() => {\r\n        this.isReworking = false;\r\n        this.router.navigate(['../../'], {relativeTo: this.route});\r\n      });\r\n    });\r\n  }\r\n\r\n  onReworkProduct() {\r\n    this.modalService.confirm('danger', 'Confirm').pipe(\r\n      filter(confirm => confirm)\r\n    ).subscribe(() => {\r\n      this.isReworkingProduct = true;\r\n      const ids = [];\r\n      const productsIds = [];\r\n      const calls = [];\r\n      this.orderProducts.forEach(p => {\r\n        productsIds.push(p.id)\r\n        ids.push(...p.orderProducts.map(order => order.id));\r\n      });\r\n\r\n      ids.forEach(id => {\r\n        calls.push(this.orderProductService.reworkOrderProduct(id))\r\n      });\r\n\r\n      forkJoin([...calls]).subscribe(() => {\r\n        productsIds.forEach(id => {\r\n          const index = this.orderProducts.findIndex(o => o.id === id);\r\n          this.orderProducts.splice(index, 1);\r\n        });\r\n        if (this.orderProducts.length === 0) {\r\n          this.router.navigate(['../../'], {relativeTo: this.route});\r\n          return;\r\n        }\r\n        this.selectedOrderProducts = [];\r\n        this.isReworkingProduct = false;\r\n      })\r\n\r\n      // this.orderProductService.reworkOrderProduct(this.selectedOrderProducts[0].id).subscribe(() => {\r\n      //   const index = this.orderProducts.findIndex(o => o.id === this.selectedOrderProducts[0].id);\r\n      //   this.orderProducts.splice(index, 1);\r\n      //   if (this.orderProducts.length === 0) {\r\n      //     this.router.navigate(['../../'], {relativeTo: this.route});\r\n      //     return;\r\n      //   }\r\n      //   this.selectedOrderProducts = [];\r\n      //   this.isReworkingProduct = false;\r\n      // });\r\n    });\r\n  }\r\n\r\n  onQualityControlTechnicalEquipment() {\r\n    this.qcService.controlTechnicalEquipment(this.selectedTechnicalEquipment, true).subscribe(res => {\r\n      if (res) {\r\n        this.getTechnicalEquipmentToQc();\r\n        this.selectedTechnicalEquipment = null;\r\n      }\r\n    });\r\n  }\r\n}\r\n","<div class=\"page\">\r\n  <div class=\"page__header\">\r\n    <div class=\"page__title\">\r\n      <pek-module-icon [module]=\"'warehouse'\" [isActive]=\"true\"></pek-module-icon>\r\n      <h1>\r\n        Order ID <ng-container *ngIf=\"isLoading; else orderLink\">...</ng-container>\r\n      </h1>\r\n    </div>\r\n    <div class=\"page__tools\">\r\n      <button\r\n        class=\"mr-2 p-button-icon\"\r\n        pButton\r\n        type=\"button\"\r\n        icon=\"pi pi-print\"\r\n        label=\"Print Album\"\r\n        [loading]=\"albumService.loading$ | async\"\r\n        (click)=\"onPrintAlbum()\"\r\n        [disabled]=\"selectedOrderProducts.length === 0\"\r\n      >\r\n      </button>\r\n      <button\r\n        class=\"mr-2 p-button-icon\"\r\n        pButton\r\n        type=\"button\"\r\n        icon=\"pi pi-qrcode\"\r\n        label=\"Generate QR Codes\"\r\n        [loading]=\"isGenerating\"\r\n        (click)=\"onGenerateQrCodes()\"\r\n        [disabled]=\"selectedOrderProducts.length === 0\"\r\n      >\r\n      </button>\r\n      <button\r\n        pButton\r\n        type=\"button\"\r\n        class=\"p-button-icon mr-2\"\r\n        icon=\"pi pi-check\"\r\n        label=\"Complete Products\"\r\n        [loading]=\"isCompletingProducts\"\r\n        [disabled]=\"selectedOrderProducts.length === 0\"\r\n        (click)=\"onCompleteItems()\"\r\n      >\r\n      </button>\r\n      <button\r\n        pButton\r\n        type=\"button\"\r\n        class=\"p-button-icon p-button-danger mr-2\"\r\n        icon=\"pi pi-refresh\"\r\n        [loading]=\"isReworking\"\r\n        label=\"Rework All\"\r\n        (click)=\"onRework()\"\r\n        [disabled]=\"isLoading\"\r\n      >\r\n      </button>\r\n      <button\r\n        pButton\r\n        type=\"button\"\r\n        class=\"p-button-icon p-button-success\"\r\n        icon=\"pi pi-check\"\r\n        label=\"Complete\"\r\n        [loading]=\"isCompleting\"\r\n        (click)=\"onComplete()\"\r\n        [disabled]=\"!orderCanBeCompleted\"\r\n      >\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div class=\"page__content\">\r\n  <div class=\"page__card\">\r\n    <div class=\"page__table\">\r\n      <p-table\r\n        #dt\r\n        scrollHeight=\"calc(100vh - 17rem)\"\r\n        [scrollable]=\"true\"\r\n        [paginator]=\"!isLoadingProducts\"\r\n        dataKey=\"id\"\r\n        [rows]=\"10\"\r\n        [value]=\"orderProducts\"\r\n        [(selection)]=\"selectedOrderProducts\"\r\n      >\r\n        <ng-template pTemplate=\"header\">\r\n          <tr>\r\n            <th style=\"width: 3%\">\r\n              <p-tableHeaderCheckbox></p-tableHeaderCheckbox>\r\n            </th>\r\n            <th class=\"index-header text-center\" style=\"width: 5%\">#</th>\r\n            <th style=\"width: 15%\">Code</th>\r\n            <th style=\"width: 17%\">Name</th>\r\n            <th style=\"width: 15%\" class=\"text-center\">Technology</th>\r\n            <th style=\"width: 5%\" class=\"text-center\">UOM</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Quantity</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Not Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Status</th>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"caption\">\r\n          <div class=\"d-flex\">\r\n            <p class=\"subtitle\" *ngIf=\"selectedOrderProducts.length === 0\">Choose the Product to edit</p>\r\n            <button\r\n              pButton\r\n              type=\"button\"\r\n              class=\"p-button-icon p-button-danger ml-auto mr-2\"\r\n              icon=\"pi pi-refresh\"\r\n              [loading]=\"isReworkingProduct\"\r\n              label=\"Rework Item\"\r\n              (click)=\"onReworkProduct()\"\r\n              [disabled]=\"isLoadingProducts || selectedOrderProducts.length === 0 || selectedOrderProducts.length > 1\"\r\n            >\r\n            </button>\r\n            <button\r\n              pButton\r\n              type=\"button\"\r\n              class=\"p-button-icon mr-2\"\r\n              icon=\"pi pi-images\"\r\n              label=\"Show Images\"\r\n              (click)=\"onShowImages()\"\r\n              [disabled]=\"isLoadingProducts || selectedOrderProducts.length === 0 || selectedOrderProducts.length > 1\"\r\n            >\r\n            </button>\r\n            <button\r\n              pButton\r\n              type=\"button\"\r\n              class=\"p-button-icon\"\r\n              icon=\"pi pi-angle-double-right\"\r\n              label=\"Quality Control\"\r\n              [disabled]=\"isLoadingProducts || selectedOrderProducts.length === 0 || selectedOrderProducts.length > 1\"\r\n              (click)=\"onQualityControl()\"\r\n            >\r\n            </button>\r\n          </div>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"body\" let-product let-i=\"rowIndex\">\r\n          <tr [pSelectableRow]=\"product\">\r\n            <td style=\"width: 3%\">\r\n              <p-tableCheckbox [value]=\"product\"></p-tableCheckbox>\r\n            </td>\r\n            <td style=\"width: 5%\" class=\"text-center\">{{i + 1}}</td>\r\n            <td style=\"width: 15%\">\r\n              {{product.nomenclature.code}}\r\n            </td>\r\n            <td style=\"width: 17%\">\r\n              {{product.nomenclature.name}}\r\n            </td>\r\n            <td style=\"width: 15%\" class=\"text-center\">\r\n              {{product.current_technology?.name}}\r\n            </td>\r\n            <td style=\"width: 5%\" class=\"text-center\">\r\n              {{product.nomenclature.category ? product.nomenclature.category.unit_of_measure.symbol : 'Pcs'}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.totalQuantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.totalQuantityPassed}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.totalQuantityNotPassed}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              <span *ngIf=\"product.quality_control == 1\" class=\"badge badge_success\">PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 2\" class=\"badge badge_warning\">PARTLY PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 0\" class=\"badge badge_danger\">NOT PASSED</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"emptymessage\">\r\n          <tr>\r\n            <td class=\"text-center p-4\" [attr.colspan]=\"11\">\r\n              <i *ngIf=\"isLoadingProducts\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n              <span *ngIf=\"!isLoadingProducts\">No Records Found</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"paginatorright\">\r\n          <p-button\r\n            type=\"button\"\r\n            (click)=\"dt.paginator=false\"\r\n            styleClass=\"p-button-text\"\r\n          >All\r\n          </p-button>\r\n        </ng-template>\r\n      </p-table>\r\n    </div>\r\n    <div *ngIf=\"!dt.paginator && !isLoading\" class=\"paginator-return-pagination\">\r\n      <p-button\r\n        type=\"button\"\r\n        (click)=\"dt.paginator=true\"\r\n        styleClass=\"p-button-text\"\r\n      >\r\n        Return pagination\r\n      </p-button>\r\n    </div>\r\n  </div>\r\n\r\n  <h2 class=\"mt-4 mb-4\">Technical Equipment</h2>\r\n\r\n  <div class=\"page__card\">\r\n    <div class=\"page__table\">\r\n      <p-table\r\n        #st\r\n        selectionMode=\"single\"\r\n        scrollHeight=\"calc(100vh - 17rem)\"\r\n        [scrollable]=\"true\"\r\n        [paginator]=\"!isLoadingTechnicalEquipment && technicalEquipments.length > 0\"\r\n        dataKey=\"id\"\r\n        [rows]=\"10\"\r\n        [value]=\"technicalEquipments\"\r\n        [(selection)]=\"selectedTechnicalEquipment\"\r\n      >\r\n        <ng-template pTemplate=\"header\">\r\n          <tr>\r\n            <th class=\"index-header text-center\" style=\"width: 8%\">#</th>\r\n            <th style=\"width: 15%\">Code</th>\r\n            <th style=\"width: 32%\">Name</th>\r\n            <th style=\"width: 5%\" class=\"text-center\">UOM</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Quantity</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Not Passed Qty</th>\r\n            <th style=\"width: 10%\" class=\"text-center\">Status</th>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"caption\">\r\n          <div class=\"d-flex\">\r\n            <p class=\"subtitle\" *ngIf=\"!selectedTechnicalEquipment\">Choose the Technical Equipment to Quality Control</p>\r\n            <button\r\n              pButton\r\n              type=\"button\"\r\n              class=\"ml-auto p-button-icon\"\r\n              icon=\"pi pi-angle-double-right\"\r\n              label=\"Quality Control\"\r\n              [disabled]=\"isLoadingTechnicalEquipment || !selectedTechnicalEquipment\"\r\n              (click)=\"onQualityControlTechnicalEquipment()\"\r\n            >\r\n            </button>\r\n          </div>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"body\" let-product let-i=\"rowIndex\">\r\n          <tr [pSelectableRow]=\"product\">\r\n            <td style=\"width: 8%\" class=\"text-center\">{{i + 1}}</td>\r\n            <td style=\"width: 15%\">\r\n              {{product.nomenclature.code}}\r\n            </td>\r\n            <td style=\"width: 32%\">\r\n              {{product.nomenclature.name}}\r\n            </td>\r\n            <td style=\"width: 5%\" class=\"text-center\">\r\n              {{product.nomenclature.category ? product.nomenclature.category.unit_of_measure.symbol : 'Pcs'}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.quantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.passed_quantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              {{product.not_passed_quantity}}\r\n            </td>\r\n            <td style=\"width: 10%\" class=\"text-center\">\r\n              <span *ngIf=\"product.quality_control == 1\" class=\"badge badge_success\">PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 2\" class=\"badge badge_warning\">PARTLY PASSED</span>\r\n              <span *ngIf=\"product.quality_control == 0\" class=\"badge badge_danger\">NOT PASSED</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"emptymessage\">\r\n          <tr>\r\n            <td class=\"text-center p-4\" [attr.colspan]=\"11\">\r\n              <i *ngIf=\"isLoadingTechnicalEquipment\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n              <span *ngIf=\"!isLoadingTechnicalEquipment\">No Records Found</span>\r\n            </td>\r\n          </tr>\r\n        </ng-template>\r\n        <ng-template pTemplate=\"paginatorright\">\r\n          <p-button\r\n            type=\"button\"\r\n            (click)=\"st.paginator=false\"\r\n            styleClass=\"p-button-text\"\r\n          >All\r\n          </p-button>\r\n        </ng-template>\r\n      </p-table>\r\n    </div>\r\n    <div *ngIf=\"!st.paginator && !isLoadingTechnicalEquipment && technicalEquipments.length > 0\" class=\"paginator-return-pagination\">\r\n      <p-button\r\n        type=\"button\"\r\n        (click)=\"st.paginator=true\"\r\n        styleClass=\"p-button-text\"\r\n      >\r\n        Return pagination\r\n      </p-button>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #orderLink>\r\n  <a class=\"order-link\" (click)=\"goToOrder()\">{{order.id}}</a>\r\n</ng-template>\r\n","import {Component, Inject, OnInit} from '@angular/core';\r\nimport {FormArray, FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {WarehouseService} from '../../../warehouse/services/warehouse.service';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {ModalActionType} from '@shared/models/modal-action';\r\nimport {Warehouse} from '../../../warehouse/models/warehouse';\r\nimport {QcProtocol} from '../../models/protocol';\r\nimport {ProtocolService} from '../../services/protocol.service';\r\nimport {filter, tap} from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'pek-create-edit-protocol',\r\n  templateUrl: './create-edit-protocol.component.html',\r\n  styleUrls: ['./create-edit-protocol.component.scss']\r\n})\r\nexport class CreateEditProtocolComponent implements OnInit {\r\n  isSaving = false;\r\n  isLoadingParagraphs = false;\r\n\r\n  defaultParagraphsIds = new Set<number>();\r\n  removeFilesSet: Set<number> = new Set<number>();\r\n\r\n  files = [];\r\n  defaultFiles = [];\r\n\r\n  form: FormGroup = this.fb.group({\r\n    id: [null],\r\n    name: [null, Validators.required],\r\n    comment: ['', Validators.required],\r\n    paragraphs: this.fb.array([]),\r\n    nomenclatures: [[]]\r\n  });\r\n\r\n  constructor(\r\n    private readonly fb: FormBuilder,\r\n    private readonly protocolService: ProtocolService,\r\n    private dialogRef: MatDialogRef<CreateEditProtocolComponent>,\r\n    @Inject(MAT_DIALOG_DATA) public data: { type: ModalActionType, protocol: QcProtocol, isShowMode: boolean }\r\n  ) { }\r\n\r\n  get paragraphs() {\r\n    return this.form.get('paragraphs') as FormArray;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    if (this.data.type === 'edit') {\r\n      this.form.patchValue(this.data.protocol);\r\n      this.getParagraphs();\r\n      this.getFiles();\r\n    } else {\r\n      this.addParagraph();\r\n    }\r\n  }\r\n\r\n  getParagraphs() {\r\n    this.isLoadingParagraphs = true;\r\n    this.protocolService.getParagraphs([{name: 'protocol_ids', value: this.form.get('id').value}]).subscribe(paragraphs => {\r\n      paragraphs.forEach(paragraph => {\r\n        this.defaultParagraphsIds.add(paragraph.id);\r\n\r\n        (this.form.get('paragraphs') as FormArray).push(this.fb.group({\r\n          id: [paragraph.id],\r\n          name: [paragraph.name, Validators.required],\r\n          comment: [paragraph.comment]\r\n        }));\r\n      });\r\n\r\n      this.isLoadingParagraphs = false;\r\n    });\r\n  }\r\n\r\n  addParagraph() {\r\n    (this.form.get('paragraphs') as FormArray).push(this.fb.group({\r\n      id: [null],\r\n      name: [null, Validators.required],\r\n      comment: ['']\r\n    }));\r\n  }\r\n\r\n  getFiles() {\r\n    if (this.data.type === 'edit') {\r\n      this.protocolService.getFiles([{name: 'qc_protocol_id', value: this.form.get('id').value}]).subscribe(files => {\r\n        this.files = files.map(file => {\r\n          return {\r\n            ...file,\r\n            name: this.getFileName(file.file),\r\n          };\r\n        });\r\n\r\n        this.defaultFiles = [...this.files]\r\n      });\r\n    }\r\n  }\r\n\r\n  getFileName(fileName: string) {\r\n    if (fileName) {\r\n      const name = fileName.split('/');\r\n      return name[name.length - 1];\r\n    }\r\n  }\r\n\r\n  removeNomenclature(id: number) {\r\n    const index = this.form.get('nomenclatures').value.findIndex(n => n.id === id);\r\n    this.form.get('nomenclatures').value.splice(index, 1);\r\n  }\r\n\r\n  getType(type) {\r\n    switch (type) {\r\n      case '0':\r\n        return 'Purchased';\r\n      case '1':\r\n        return 'Assembly';\r\n      case '2':\r\n        return 'Manufactured';\r\n    }\r\n  }\r\n\r\n  onSave() {\r\n    if (this.data.type === 'create') {\r\n      this.createProtocol();\r\n    } else {\r\n      this.editProtocol()\r\n    }\r\n  }\r\n\r\n  addNomenclature() {\r\n    this.protocolService.addNomenclatureDialog().pipe(\r\n      filter(value => Boolean(value))\r\n    ).subscribe(nomenclature => {\r\n      this.form.get('nomenclatures').value.push({\r\n        id: nomenclature.id,\r\n        name: nomenclature.name,\r\n        code: nomenclature.code,\r\n        type: nomenclature.type\r\n      });\r\n    })\r\n  }\r\n\r\n  createProtocol() {\r\n    if (this.form.valid) {\r\n      this.isSaving = true;\r\n      const sendData = JSON.parse(JSON.stringify(this.form.value));\r\n      delete sendData.nomenclatures;\r\n      delete sendData.id;\r\n      this.protocolService.create(sendData).subscribe(protocol => {\r\n\r\n        const send = this.paragraphs.controls.map(control => {\r\n          delete control.value.id;\r\n          control.value.protocol_id = protocol.id;\r\n          return control.value;\r\n        });\r\n\r\n        this.protocolService.addParagraphs(send).subscribe();\r\n        this.saveFiles(protocol.id.toString());\r\n\r\n        if (this.form.get('nomenclatures').value.length > 0) {\r\n          const nomenclatures = {\r\n            nomenclature_ids: this.form.get('nomenclatures').value.map(el => el.id)\r\n          };\r\n          this.protocolService.addNomenclature(nomenclatures, protocol.id).pipe(\r\n            tap(() => this.isSaving = false)\r\n          ).subscribe(() => this.dialogRef.close(true));\r\n        } else {\r\n          this.isSaving = false;\r\n          this.dialogRef.close(true);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  saveFiles(protocolId: string) {\r\n    this.files.forEach((file, idx) => {\r\n      if (!file?.id) {\r\n        const formData = new FormData();\r\n        formData.append('file', file, file.name);\r\n        formData.append('qc_protocol', protocolId);\r\n\r\n        this.protocolService.saveFile(formData).subscribe();\r\n      }\r\n    });\r\n  }\r\n\r\n  onSelectFiles(files: File[]) {\r\n    this.files = files;\r\n  }\r\n\r\n  private editProtocol() {\r\n    if (this.form.value) {\r\n      this.isSaving = true;\r\n\r\n        const sendData = JSON.parse(JSON.stringify(this.form.value));\r\n        delete sendData.nomenclatures;\r\n\r\n        this.protocolService.update(sendData).subscribe();\r\n\r\n        const addedParagraphs = this.paragraphs.controls.filter(c => c.value.id === null).map(control => {\r\n          control.value.protocol_id = this.form.get('id').value;\r\n          return control.value;\r\n        });\r\n\r\n        this.protocolService.addParagraphs(addedParagraphs).subscribe();\r\n\r\n        const updatedParagraphsIds = this.paragraphs.controls.filter(c => this.defaultParagraphsIds.has(c.value.id)).map(c => c.value);\r\n\r\n        this.protocolService.updateParagraphs(updatedParagraphsIds).subscribe();\r\n\r\n        this.paragraphs.controls\r\n          .forEach(c => {\r\n            if (this.defaultParagraphsIds.has(c.value.id)) {\r\n              this.defaultParagraphsIds.delete(c.value.id);\r\n            }\r\n          });\r\n\r\n        this.saveFiles(this.form.get('id').value);\r\n        this.deleteFiles();\r\n\r\n        const removedParagraphsIds = Array.from(this.defaultParagraphsIds);\r\n        this.protocolService.deleteParagraphs(removedParagraphsIds).subscribe();\r\n\r\n        if (this.form.get('nomenclatures').value.length >= 0) {\r\n          const send = {\r\n            nomenclature_ids: this.form.get('nomenclatures').value.length ? this.form.get('nomenclatures').value.map(el => el.id) : ''\r\n          };\r\n          this.protocolService.addNomenclature(send, this.form.get('id').value).subscribe(() => {\r\n            this.isSaving = false;\r\n            this.dialogRef.close(true);\r\n          });\r\n        } else {\r\n          this.isSaving = false;\r\n          this.dialogRef.close(true);\r\n        }\r\n    }\r\n  }\r\n\r\n  deleteFiles() {\r\n    this.defaultFiles.filter(file => file?.id && !this.files.find(f => f.id === file.id)).map(f => f.id).forEach(id => {\r\n      this.protocolService.deleteFile(id).subscribe();\r\n    });\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h2 class=\"modal-header__title\">\r\n    <span *ngIf=\"!data.isShowMode\">{{data.type === 'edit' ? 'Edit' : 'Create'}} Protocol</span>\r\n    <span *ngIf=\"data.isShowMode\">Protocol &laquo;{{data.protocol.name}}&raquo;</span>\r\n  </h2>\r\n</div>\r\n\r\n<mat-dialog-content>\r\n  <form [formGroup]=\"form\">\r\n    <div>\r\n      <div class=\"row\">\r\n        <div class=\"col-6\">\r\n          <div class=\"form-group\">\r\n            <label for=\"name\"> Name* </label>\r\n            <input pInputText formControlName=\"name\" class=\"form-control\" type=\"text\" id=\"name\">\r\n          </div>\r\n        </div>\r\n        <div class=\"col-6\">\r\n          <div class=\"form-group\">\r\n            <label for=\"comment\"> Comment* </label>\r\n            <input pInputText formControlName=\"comment\" class=\"form-control\" type=\"text\" id=\"comment\">\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"paragraphs__header mt-3 mb-1\">\r\n        <h4>Protocol Paragraph</h4>\r\n      </div>\r\n\r\n      <div [ngSwitch]=\"isLoadingParagraphs\">\r\n        <ng-container *ngSwitchCase=\"true\">\r\n          <div class=\"d-flex justify-content-center\">\r\n            <i class=\"pi pi-spin pi-spinner\" style=\"font-size: 2rem\"></i>\r\n          </div>\r\n        </ng-container>\r\n        <ng-container *ngSwitchCase=\"false\">\r\n          <div formArrayName=\"paragraphs\" *ngIf=\"paragraphs.length > 0; else empty\">\r\n            <div class=\"row\"\r\n                 *ngFor=\"let paragraph of paragraphs.controls; let idx = index\"\r\n                 [formGroupName]=\"idx\"\r\n            >\r\n              <div class=\"col-6\">\r\n                <div class=\"form-group\">\r\n                  <label [for]=\"'p-name-' + idx\"> Name* </label>\r\n                  <input formControlName=\"name\" class=\"form-control\" type=\"text\" [id]=\"'p-name-' + idx\" pInputText>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-6\">\r\n                <div class=\"form-group\">\r\n                  <label [for]=\"'p-comment-' + idx\"> Comment </label>\r\n                  <input formControlName=\"comment\" class=\"form-control\" type=\"text\" [id]=\"'p-comment-' + idx\" pInputText>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <ng-template #empty>\r\n            <div class=\"empty-text\">\r\n              There are no paragraphs of the protocol\r\n            </div>\r\n          </ng-template>\r\n        </ng-container>\r\n      </div>\r\n\r\n      <div class=\"paragraphs__header mt-4 mb-3\">\r\n        <h4>Nomenclatures</h4>\r\n        <a class=\"btn-add\" (click)=\"addNomenclature()\" *ngIf=\"!data.isShowMode\">\r\n          <i class=\"pi pi-plus\"></i>\r\n          Add Nomenclature\r\n        </a>\r\n      </div>\r\n\r\n      <div *ngIf=\"form.get('nomenclatures').value.length > 0\">\r\n        <p-table #dt [value]=\"form.get('nomenclatures').value\" [paginator]=\"true\" [rows]=\"10\" selectionMode=\"single\">\r\n          <ng-template pTemplate=\"header\">\r\n            <tr>\r\n              <th style=\"width: 7%\" class=\"text-center\">#</th>\r\n              <th style=\"width: 33%\">Name</th>\r\n              <th style=\"width: 30%\">Code</th>\r\n              <th style=\"width: 20%\" class=\"text-center\">Type</th>\r\n              <th style=\"width: 10%\" class=\"text-right\"></th>\r\n            </tr>\r\n          </ng-template>\r\n          <ng-template pTemplate=\"body\" let-nomenclature let-i=\"rowIndex\">\r\n            <tr>\r\n              <td style=\"width: 7%\" class=\"text-center\">{{i + 1}}</td>\r\n              <td style=\"width: 33%\">{{nomenclature.name}}</td>\r\n              <td style=\"width: 30%\">{{nomenclature.code}}</td>\r\n              <td style=\"width: 20%\" class=\"text-center\">{{getType(nomenclature.type)}}</td>\r\n              <td style=\"width: 10%\" class=\"text-right\">\r\n                <button class=\"btn-remove\" (click)=\"removeNomenclature(nomenclature.id)\">\r\n                  <i class=\"pi pi-times\"></i>\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </ng-template>\r\n        </p-table>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"paragraphs__header mt-4 mb-3\">\r\n      <h4>Protocol Files</h4>\r\n    </div>\r\n\r\n    <div class=\"protocols-files\">\r\n      <pek-upload-file\r\n        [uploadFiles]=\"files\"\r\n        [multiple]=\"true\"\r\n        (selectFile)=\"onSelectFiles($event)\"\r\n      ></pek-upload-file>\r\n    </div>\r\n  </form>\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions class=\"justify-content-between\">\r\n  <button pButton type=\"button\" label=\"Cancel\" [mat-dialog-close]=\"false\" class=\"p-button-danger\"></button>\r\n  <button\r\n    pButton\r\n    type=\"button\"\r\n    class=\"p-button-success\"\r\n    [label]=\"data.type\"\r\n    [loading]=\"isSaving\"\r\n    [disabled]=\"form.invalid\"\r\n    (click)=\"onSave()\"\r\n  ></button>\r\n</mat-dialog-actions>\r\n","import {Component, Inject, OnInit} from '@angular/core';\r\nimport {FormArray, FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {forkJoin} from 'rxjs';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {ProtocolService} from '../../services/protocol.service';\r\nimport {DomSanitizer} from '@angular/platform-browser';\r\nimport {QrCodeService} from '../../../qr-code/qr-code.service';\r\nimport {AdapterService} from '@shared/services/adapter.service';\r\nimport {ModalService} from '@shared/services/modal.service';\r\nimport {InvoiceProduct} from '../../../procurement/models/invoice-product';\r\nimport {environment} from '@env/environment';\r\nimport {SerialNumber} from '../../../procurement/models/invoice';\r\nimport {QcProtocol, QrProtocolParagraph} from '../../models/protocol';\r\nimport {OrderProduct} from '../../../procurement/models/order-product';\r\n\r\n@Component({\r\n  selector: 'pek-move-qc-with-protocol',\r\n  templateUrl: './move-qc-with-protocol.component.html',\r\n  styleUrls: ['./move-qc-with-protocol.component.scss']\r\n})\r\nexport class MoveQcWithProtocolComponent implements OnInit {\r\n  isLoading = true;\r\n  protocol: QcProtocol;\r\n  isGeneratedNumber = false;\r\n  paragraphs: QrProtocolParagraph[] = [];\r\n  currentCount: number;\r\n  hasComplete = false;\r\n\r\n  isLoadingFiles = true;\r\n\r\n  files = [];\r\n\r\n  serialNumbers: SerialNumber[] = [];\r\n  defaultSerialNumbers: SerialNumber[] = [];\r\n\r\n  qrCode: any;\r\n\r\n  form: FormGroup = this.fb.group({\r\n    serial_number: [null, Validators.required],\r\n    invoice_product: [null],\r\n    order_product: [null],\r\n    protocol: [null],\r\n    paragraphs: this.fb.array([]),\r\n    serial: [null],\r\n  });\r\n  link = environment.image_path;\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private dialogRef: MatDialogRef<MoveQcWithProtocolComponent>,\r\n    private readonly qcProtocolService: ProtocolService,\r\n    private domSanitizer: DomSanitizer,\r\n    private qrCodeService: QrCodeService,\r\n    private readonly adapterService: AdapterService,\r\n    private readonly modalService: ModalService,\r\n    @Inject(MAT_DIALOG_DATA) public data: {\r\n      product: InvoiceProduct | OrderProduct,\r\n      currentCount: number,\r\n      count: number,\r\n      type: 'invoice' | 'order'\r\n    }\r\n  ) {\r\n  }\r\n\r\n  get answerParagraphs() {\r\n    return this.form.get('paragraphs') as FormArray;\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    if (this.data.currentCount > this.data.count) {\r\n      this.data.currentCount = this.data.count;\r\n    }\r\n\r\n    this.serialNumbers = this.data.product.totalSerialNumbers;\r\n    this.serialNumbers.forEach(serial => {\r\n      serial.traversed = serial.is_passed !== null;\r\n    });\r\n\r\n    this.defaultSerialNumbers = JSON.parse(JSON.stringify(this.serialNumbers));\r\n    this.serialNumbers.sort((a, b) => a.id - b.id);\r\n    this.currentCount = JSON.parse(JSON.stringify(this.data.currentCount));\r\n\r\n    const serialObject = this.serialNumbers[this.data.currentCount - 1];\r\n\r\n    if (serialObject && serialObject?.type_with_number) {\r\n      this.form.get('serial').patchValue(serialObject?.type_with_number);\r\n    } else {\r\n      this.form.get('serial').patchValue(serialObject?.id);\r\n    }\r\n\r\n    if (serialObject) {\r\n      this.form.get('serial_number').patchValue(serialObject.id);\r\n    }\r\n\r\n    this.getFiles();\r\n    this.getProtocol();\r\n  }\r\n\r\n  showButtonSave() {\r\n    return Boolean(this.serialNumbers[this.data.currentCount - 1].warehouseproductqcprotocol_set.length === 0);\r\n  }\r\n\r\n  generateSerialNumber() {\r\n    this.form.get('serial_number').patchValue('Serial Number');\r\n    this.isGeneratedNumber = true;\r\n  }\r\n\r\n  nextSerial() {\r\n    if (this.data.currentCount < this.data.count) {\r\n      this.data.currentCount += 1;\r\n      this.saveSerialInfo();\r\n    }\r\n  }\r\n\r\n  prevSerial() {\r\n    if (this.data.currentCount >= 1) {\r\n      this.data.currentCount -= 1;\r\n      this.saveSerialInfo();\r\n    }\r\n  }\r\n\r\n  saveSerialInfo() {\r\n    const serialObject = this.serialNumbers[this.data.currentCount - 1];\r\n\r\n    if (serialObject && serialObject?.type_with_number) {\r\n      this.form.get('serial').patchValue(serialObject?.type_with_number);\r\n    } else {\r\n      this.form.get('serial').patchValue(serialObject?.id);\r\n    }\r\n\r\n    if (serialObject) {\r\n      this.form.get('paragraphs').value[0].is_passed = serialObject.is_passed;\r\n      this.form.get('serial_number').patchValue(serialObject.id);\r\n    }\r\n\r\n    (this.form.get('paragraphs') as FormArray).controls[0].get('comment').patchValue(serialObject.warehouseproductqcprotocol_set.length > 0 ? serialObject.warehouseproductqcprotocol_set[0].paragraphs[0].comment : '');\r\n    (this.form.get('paragraphs') as FormArray).controls[0].get('is_passed').patchValue(serialObject.is_passed);\r\n\r\n    if ((this.form.get('paragraphs') as FormArray).controls[0].get('is_passed').value !== null) {\r\n      this.hasComplete = true;\r\n    }\r\n  }\r\n\r\n  getProtocol() {\r\n    forkJoin({\r\n      protocol: this.qcProtocolService.getOne(this.data.product.nomenclature.qc_protocol),\r\n      paragraphs: this.qcProtocolService.getParagraphs([{name: 'protocol_ids', value: this.data.product.nomenclature.qc_protocol}])\r\n    }).subscribe(({protocol, paragraphs}) => {\r\n      this.protocol = protocol;\r\n      this.paragraphs = paragraphs;\r\n      if (this.data.type === 'invoice') {\r\n        this.form.get('invoice_product').patchValue(this.data.product.id);\r\n      }\r\n\r\n      if (this.data.type === 'order') {\r\n        this.form.get('order_product').patchValue(this.data.product.id);\r\n      }\r\n\r\n      this.form.get('protocol').patchValue(this.data.product.nomenclature.qc_protocol);\r\n\r\n      this.updateParagraphs();\r\n\r\n      if ((this.form.get('paragraphs') as FormArray).controls[0].get('is_passed').value !== null) {\r\n        this.hasComplete = true;\r\n      }\r\n\r\n      this.isLoading = false;\r\n    });\r\n  }\r\n\r\n  updateParagraphs() {\r\n    const serialObject = this.serialNumbers[this.data.currentCount - 1];\r\n    this.paragraphs.forEach(paragraph => {\r\n      (this.form.get('paragraphs') as FormArray).push(this.fb.group({\r\n        qc_protocol_paragraph: [paragraph.id],\r\n        comment: [serialObject.warehouseproductqcprotocol_set.length > 0 ? serialObject.warehouseproductqcprotocol_set[0].paragraphs[0].comment : ''],\r\n        is_passed: [serialObject.is_passed]\r\n      }));\r\n    });\r\n  }\r\n\r\n  getParagraphName(id: number) {\r\n    let str = `${this.paragraphs.find(p => p.id === id).name}`;\r\n    if (this.paragraphs.find(p => p.id === id).comment) {\r\n      str += ` (${this.paragraphs.find(p => p.id === id).comment})`;\r\n    }\r\n    return str;\r\n  }\r\n\r\n  changePassedTrue(paragraph) {\r\n    const index = this.form.get('paragraphs').value.findIndex(p => p.qc_protocol_paragraph === paragraph.value.qc_protocol_paragraph);\r\n    if ((this.form.get('paragraphs') as FormArray).controls[index].get('is_passed').value) {\r\n      (this.form.get('paragraphs') as FormArray).controls[index].get('is_passed').patchValue(null);\r\n      this.hasComplete = false;\r\n    } else {\r\n      (this.form.get('paragraphs') as FormArray).controls[index].get('is_passed').patchValue(true);\r\n      this.hasComplete = true;\r\n    }\r\n  }\r\n\r\n  changePassedFalse(paragraph) {\r\n    const index = this.form.get('paragraphs').value.findIndex(p => p.qc_protocol_paragraph === paragraph.value.qc_protocol_paragraph);\r\n    if ((this.form.get('paragraphs') as FormArray).controls[index].get('is_passed').value === false) {\r\n      (this.form.get('paragraphs') as FormArray).controls[index].get('is_passed').patchValue(null);\r\n      this.hasComplete = false;\r\n    } else {\r\n      (this.form.get('paragraphs') as FormArray).controls[index].get('is_passed').patchValue(false);\r\n      this.hasComplete = true;\r\n    }\r\n  }\r\n\r\n  generateQrCode() {\r\n    const send = {\r\n      by_nomenclatures_list: [{\r\n        // nomenclature_id: this.data.product.nomenclature.id,\r\n        // serial_number_ids: [parseInt(this.form.get('serial_number').value, 10)],\r\n        nomenclature_id: 13237,\r\n        serial_number_ids: [46],\r\n        order_product_ids: [],\r\n        invoice_product_ids: [],\r\n      }],\r\n    };\r\n\r\n    this.qrCodeService.generateQrCodes(send).subscribe(codes => {\r\n      this.qrCode = codes.with_serial[0].code[0];\r\n      // this.qrCode.serial_number = this.form.get('serial_number').value;\r\n      this.qrCode.qr_src = this.domSanitizer.bypassSecurityTrustUrl('data:image/svg+xml;base64,' + this.qrCode.qr_src);\r\n      // this.modalService.qrCodeModal(this.qrCode).subscribe();\r\n    });\r\n  }\r\n\r\n  complete() {\r\n    if (this.form.value) {\r\n      const send = {...this.form.value};\r\n\r\n      if (this.data.type === 'invoice') {\r\n        const invoice_product = (this.data.product as InvoiceProduct).invoiceProducts.find(prod => {\r\n          return prod.serial_numbers.findIndex(serial => serial.id === send.serial_number) >= 0;\r\n        });\r\n        send.invoice_product = invoice_product.id;\r\n        delete send.order_product;\r\n      }\r\n\r\n      if (this.data.type === 'order') {\r\n        const invoice_product = (this.data.product as OrderProduct).orderProducts.find(prod => {\r\n          return prod.serial_numbers.findIndex(serial => serial.id === send.serial_number) >= 0;\r\n        });\r\n        send.order_product = invoice_product.id;\r\n        delete send.invoice_product;\r\n      }\r\n\r\n      delete send.serial;\r\n      send.serial_number = this.form.get('serial_number').value;\r\n\r\n      // send.serial_number = 21;\r\n      this.qcProtocolService.productsToQc(send).subscribe(() => {\r\n        if (this.data.currentCount === this.data.count) {\r\n          this.dialogRef.close(true);\r\n        } else {\r\n          this.hasComplete = false;\r\n          this.data.currentCount++;\r\n          // const serialObject = this.serialNumbers[this.data.currentCount - 1];\r\n          //\r\n          // if (serialObject.type_with_number) {\r\n          //   this.form.get('serial_number').patchValue(serialObject.type_with_number);\r\n          // } else {\r\n          //   this.form.get('serial_number').patchValue(serialObject.id);\r\n          // }\r\n          //\r\n          // this.form.get('serial').patchValue(serialObject?.id);\r\n          //\r\n          // (this.form.get('paragraphs') as FormArray).controls.forEach(p => {\r\n          //   p.get('comment').patchValue('');\r\n          //   p.get('is_passed').patchValue(null);\r\n          // });\r\n\r\n          this.saveSerialInfo();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  save() {\r\n    const send = {...this.form.value};\r\n    const id = this.serialNumbers[this.data.currentCount - 1].warehouseproductqcprotocol_set[0].id;\r\n\r\n    if (this.data.type === 'invoice') {\r\n      const invoice_product = (this.data.product as InvoiceProduct).invoiceProducts.find(prod => {\r\n        return prod.serial_numbers.findIndex(serial => serial.id === send.serial_number) >= 0;\r\n      });\r\n      send.invoice_product = invoice_product.id;\r\n      delete send.order_product;\r\n    }\r\n\r\n    if (this.data.type === 'order') {\r\n      const invoice_product = (this.data.product as OrderProduct).orderProducts.find(prod => {\r\n        return prod.serial_numbers.findIndex(serial => serial.id === send.serial_number) >= 0;\r\n      });\r\n      send.order_product = invoice_product.id;\r\n      delete send.invoice_product;\r\n    }\r\n\r\n    delete send.serial;\r\n\r\n    send.serial_number = +this.form.get('serial_number').value;\r\n    send.paragraphs[0].id = this.serialNumbers[this.data.currentCount - 1].warehouseproductqcprotocol_set[0].paragraphs[0].id\r\n\r\n    this.qcProtocolService.updateProductProtocol(send, id).subscribe(() => {\r\n      if (this.data.currentCount === this.data.count) {\r\n        this.dialogRef.close(true);\r\n      } else {\r\n        this.hasComplete = false;\r\n        this.data.currentCount++;\r\n        this.saveSerialInfo();\r\n      }\r\n    });\r\n  }\r\n\r\n  downloadFile(file: any) {\r\n    this.qcProtocolService.downloadFile(file.id).subscribe(response => {\r\n      const filename = this.getFileName(file.file);\r\n      this.adapterService.downloadFile(filename, response);\r\n    });\r\n  }\r\n\r\n  close() {\r\n    if (this.currentCount === this.data.currentCount) {\r\n      this.dialogRef.close(false);\r\n    } else {\r\n      this.dialogRef.close(true);\r\n    }\r\n  }\r\n\r\n  getFileName(fileName: string) {\r\n    const name = fileName.split('/');\r\n    return name[name.length - 1];\r\n  }\r\n\r\n  getFiles() {\r\n    this.qcProtocolService.getFiles([{name: 'qc_protocol_id', value: this.data.product.nomenclature.qc_protocol}]).subscribe(files => {\r\n      this.files = files;\r\n      this.isLoadingFiles = false;\r\n    });\r\n  }\r\n}\r\n","<div class=\"modal-header-container align-items-start d-flex justify-content-between\">\r\n  <h2 class=\"modal-heading\" mat-dialog-title>\r\n    Quality Control with Protocol &laquo;{{isLoading ? '...' : protocol.name}}&raquo;\r\n    (Name: {{data.product.nomenclature.name}}) ({{data.currentCount}}/{{data.count}})\r\n  </h2>\r\n  <div class=\"tools\">\r\n    <button pButton (click)=\"generateQrCode()\">Generate QR-code</button>\r\n    <button  pButton type=\"button\" class=\"p-button-icon ml-3\" size=\"s\" icon=\"pi pi-arrow-left\" (click)=\"prevSerial()\"\r\n             [disabled]=\"data.currentCount <= 1\">\r\n    </button>\r\n    <button  pButton type=\"button\" class=\"p-button-icon ml-3\" icon=\"pi pi-arrow-right\" (click)=\"nextSerial()\"\r\n             [disabled]=\"data.currentCount >= this.data.count\">\r\n    </button>\r\n  </div>\r\n</div>\r\n<mat-dialog-content>\r\n  <div *ngIf=\"!isLoading else loading\">\r\n    <form [formGroup]=\"form\">\r\n      <div class=\"form-group\">\r\n        <label for=\"serial\"> Serial Number </label>\r\n        <div class=\"serial\">\r\n          <input pInputText formControlName=\"serial\" class=\"form-control disabled\" type=\"text\" id=\"serial\">\r\n        </div>\r\n      </div>\r\n\r\n      <div formArrayName=\"paragraphs\" *ngIf=\"answerParagraphs.length > 0; else empty\">\r\n        <label>Protocol Paragraph</label>\r\n        <div class=\"paragraphs__row\" *ngFor=\"let paragraph of answerParagraphs.controls; let idx = index\"\r\n             [formGroupName]=\"idx\">\r\n          <div class=\"paragraph-row\">\r\n            <label style=\"font-weight: 500; font-size: 16px\">\r\n              {{getParagraphName(paragraph.get('qc_protocol_paragraph').value)}}\r\n            </label>\r\n            <div class=\"row\">\r\n              <div class=\"col-9\">\r\n                <div class=\"form-group form-group_text\">\r\n                  <label [for]=\"'p-name-' + idx\">Comment</label>\r\n                  <input pInputText formControlName=\"comment\" class=\"form-control\" type=\"text\" [id]=\"'p-name-' + idx\">\r\n                </div>\r\n              </div>\r\n              <div class=\"col-1\">\r\n                <div class=\"form-group passing\">\r\n                  <label for=\"serial\">Passed</label>\r\n                  <div class=\"column-filter-box\">\r\n                    <button type=\"button\" [class.active]=\"paragraph.value.is_passed === true\"\r\n                            (click)=\"changePassedTrue(paragraph)\">\r\n                      <i class=\"pi pi-check\"></i>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-1\">\r\n                <div class=\"passing form-group\">\r\n                  <label for=\"serial\">To Isolator</label>\r\n                  <div class=\"column-filter-box\">\r\n                    <button type=\"button\" [class.active]=\"paragraph.value.is_passed === false\"\r\n                            (click)=\"changePassedFalse(paragraph)\">\r\n                      <i class=\"pi pi-times\"></i>\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <ng-template #empty>\r\n        <div class=\"empty-text\">\r\n          There are no paragraphs of the protocol\r\n        </div>\r\n      </ng-template>\r\n    </form>\r\n\r\n    <div class=\"upload-header\">\r\n      <h4>Protocol Files:</h4>\r\n    </div>\r\n    <div class=\"files-list\" *ngIf=\"files.length > 0; else emptyFiles\">\r\n      <a class=\"file\" *ngFor=\"let file of files; let idx = index\" [href]=\"link + file.file\">\r\n        {{idx + 1}}. {{getFileName(file?.file)}}\r\n      </a>\r\n    </div>\r\n\r\n    <ng-template #emptyFiles>\r\n      <div class=\"empty-text\">\r\n        There are no files of the protocol\r\n      </div>\r\n    </ng-template>\r\n  </div>\r\n</mat-dialog-content>\r\n<mat-dialog-actions class=\" d-flex justify-content-between\">\r\n  <button pButton label=\"Cancel\" type=\"button\" class=\"p-button-danger\" (click)=\"close()\"></button>\r\n  <button pButton type=\"button\" label=\"Complete\" class=\"p-button-secondary\" (click)=\"complete()\" [disabled]=\"!hasComplete\" *ngIf=\"showButtonSave()\"></button>\r\n  <button pButton type=\"button\" label=\"Save\" class=\"p-button-secondary\" (click)=\"save()\" [disabled]=\"!hasComplete\" *ngIf=\"!showButtonSave()\"></button>\r\n</mat-dialog-actions>\r\n\r\n<ng-template #createBtn>\r\n  <!--  <button type=\"button\" class=\"btn btn-primary\" (click)=\"create()\" [disabled]=\"form.invalid\"> Create</button>-->\r\n</ng-template>\r\n\r\n<ng-template #loading>\r\n  <div class=\"d-flex justify-content-center\">\r\n    <i class=\"fas fa-circle-notch fa-spin fa-3x \"></i>\r\n  </div>\r\n</ng-template>\r\n","import {Component, Inject, OnInit} from '@angular/core';\r\nimport {SerialNumber} from '../../../procurement/models/invoice';\r\nimport {FormBuilder, FormGroup, Validators} from '@angular/forms';\r\nimport {InvoiceProduct} from '../../../procurement/models/invoice-product';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {QrCodeService} from '../../../qr-code/qr-code.service';\r\nimport {ProtocolService} from '../../services/protocol.service';\r\nimport {OrderProduct} from '../../../procurement/models/order-product';\r\n\r\n@Component({\r\n  selector: 'pek-move-qc-with-serial',\r\n  templateUrl: './move-qc-with-serial.component.html',\r\n  styleUrls: ['./move-qc-with-serial.component.scss']\r\n})\r\nexport class MoveQcWithSerialComponent implements OnInit {\r\n  isPending: any;\r\n\r\n  currentCount: number;\r\n  qrCode: any;\r\n  serialNumbers: SerialNumber[] = [];\r\n  defaultSerialNumbers: SerialNumber[] = [];\r\n\r\n  form: FormGroup = this.fb.group({\r\n    serial_number_id: [null, Validators.required],\r\n    serial: [null, ],\r\n    invoice_product_id: [null],\r\n    order_product_id: [null],\r\n    is_passed: [null],\r\n    traversed: [null],\r\n  });\r\n\r\n  constructor(\r\n    private fb: FormBuilder,\r\n    private qrCodeService: QrCodeService,\r\n    private dialogRef: MatDialogRef<MoveQcWithSerialComponent>,\r\n    private readonly qcProtocolService: ProtocolService,\r\n    @Inject(MAT_DIALOG_DATA) public data: {\r\n      product: InvoiceProduct | OrderProduct,\r\n      currentCount: number,\r\n      count: number,\r\n      type: 'invoice' | 'order'\r\n    }\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    if (this.data.currentCount > this.data.count) {\r\n      this.data.currentCount = this.data.count;\r\n    }\r\n\r\n    this.serialNumbers = this.data.product.totalSerialNumbers;\r\n    this.serialNumbers.forEach(serial => {\r\n      serial.traversed = serial.is_passed !== null;\r\n    });\r\n\r\n    this.defaultSerialNumbers = JSON.parse(JSON.stringify(this.serialNumbers));\r\n    this.serialNumbers.sort((a, b) => a.id - b.id);\r\n    this.currentCount = JSON.parse(JSON.stringify(this.data.currentCount));\r\n\r\n    const serialObject = this.serialNumbers[this.data.currentCount - 1];\r\n\r\n    if (serialObject && serialObject?.type_with_number) {\r\n      this.form.get('serial').patchValue(serialObject?.type_with_number);\r\n    } else {\r\n      this.form.get('serial').patchValue(serialObject?.id);\r\n    }\r\n\r\n    if (serialObject) {\r\n      this.form.get('is_passed').patchValue(serialObject.is_passed);\r\n      this.form.get('traversed').patchValue(serialObject.traversed);\r\n      this.form.get('serial_number_id').patchValue(serialObject.id);\r\n    }\r\n\r\n    if (this.data.type === 'order') {\r\n      this.form.get('order_product_id').patchValue(this.data.product.id);\r\n    }\r\n\r\n    if (this.data.type === 'invoice') {\r\n      this.form.get('invoice_product_id').patchValue(this.data.product.id);\r\n    }\r\n  }\r\n\r\n  saveSerialInfo() {\r\n    const serialObject = this.serialNumbers[this.data.currentCount - 1];\r\n\r\n    if (serialObject && serialObject?.type_with_number) {\r\n      this.form.get('serial').patchValue(serialObject?.type_with_number);\r\n    } else {\r\n      this.form.get('serial').patchValue(serialObject?.id);\r\n    }\r\n\r\n    if (serialObject) {\r\n      this.form.get('traversed').patchValue(serialObject.traversed);\r\n      this.form.get('serial_number_id').patchValue(serialObject.id);\r\n      this.form.get('is_passed').patchValue(serialObject.is_passed);\r\n    }\r\n  }\r\n\r\n  nextSerial() {\r\n    if (this.data.currentCount < this.data.count) {\r\n      this.data.currentCount += 1;\r\n      this.saveSerialInfo();\r\n    }\r\n  }\r\n\r\n  prevSerial() {\r\n    if (this.data.currentCount >= 1) {\r\n      this.data.currentCount -= 1;\r\n      this.saveSerialInfo();\r\n    }\r\n  }\r\n\r\n  generateQrCode() {\r\n    const send = {\r\n      by_nomenclatures_list: [{\r\n        // nomenclature_id: 13237,\r\n        nomenclature_id: this.data.product.nomenclature.id,\r\n        serial_number_ids: [parseInt(this.form.get('serial_number_id').value, 10)],\r\n        // serial_number_ids: [184],\r\n        order_product_ids: [],\r\n        invoice_product_ids: [],\r\n      }],\r\n    };\r\n\r\n    this.qrCodeService.generateQrCodes(send).subscribe(codes => {\r\n      this.qrCode = codes.with_serial[0].code[0];\r\n      // this.qrCode.serial_number = this.form.get('serial_number_id').value;\r\n      // this.qrCode.qr_src = this.domSanitizer.bypassSecurityTrustUrl('data:image/svg+xml;base64,' + this.qrCode.qr_src);\r\n      // this.modalService.qrCodeModal(this.qrCode).subscribe();\r\n    });\r\n  }\r\n\r\n  close() {\r\n    if (JSON.stringify(this.defaultSerialNumbers) === JSON.stringify(this.serialNumbers)) {\r\n      this.dialogRef.close(false);\r\n    } else {\r\n      this.dialogRef.close(true);\r\n    }\r\n  }\r\n\r\n  changePassedTrue() {\r\n    if (this.form.get('is_passed').value === true) {\r\n      this.form.get('is_passed').patchValue(null);\r\n    } else {\r\n      this.form.get('is_passed').patchValue(true);\r\n    }\r\n  }\r\n\r\n  changePassedFalse() {\r\n    if (this.form.get('is_passed').value === false) {\r\n      this.form.get('is_passed').patchValue(null);\r\n    } else {\r\n      this.form.get('is_passed').patchValue(false);\r\n    }\r\n  }\r\n\r\n  beforeForSave() {\r\n    const index = this.serialNumbers.findIndex(s => s.id === this.form.get('serial_number_id').value);\r\n    this.serialNumbers[index].traversed = true;\r\n    this.serialNumbers[index].is_passed = this.form.get('is_passed').value;\r\n    this.nextSerial();\r\n  }\r\n\r\n  complete() {\r\n    const send = {...this.form.value};\r\n\r\n    delete send.serial;\r\n    delete send.traversed;\r\n\r\n    if (send.invoice_product_id) {\r\n      const invoice_product = (this.data.product as InvoiceProduct).invoiceProducts.find(prod => {\r\n        return prod.serial_numbers.findIndex(serial => serial.id === send.serial_number_id) >= 0;\r\n      });\r\n      send.invoice_product_id = invoice_product.id;\r\n      delete send.order_product_id;\r\n    }\r\n\r\n    if (send.order_product_id) {\r\n      const invoice_product = (this.data.product as OrderProduct).orderProducts.find(prod => {\r\n        return prod.serial_numbers.findIndex(serial => serial.id === send.serial_number_id) >= 0;\r\n      });\r\n      send.order_product_id = invoice_product.id;\r\n      delete send.invoice_product_id;\r\n    }\r\n    if (this.form.get('traversed').value === false) {\r\n      this.qcProtocolService.qcSerial(send).subscribe(() => {\r\n        if (this.data.currentCount === this.data.count) {\r\n          this.dialogRef.close(true);\r\n        } else {\r\n          this.beforeForSave();\r\n        }\r\n      });\r\n    } else {\r\n      this.qcProtocolService.qcSerialUpdate(send).subscribe(() => {\r\n        if (this.data.currentCount === this.data.count) {\r\n          this.dialogRef.close(true);\r\n        } else {\r\n          this.beforeForSave();\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h2 class=\"modal-header__title\">\r\n    Quality Control (Name: {{data.product.nomenclature.name}}) ({{data.currentCount}}/{{data.count}})\r\n  </h2>\r\n  <div class=\"tools\">\r\n    <button pButton type=\"button\" class=\"p-button-success\" (click)=\"generateQrCode()\">Generate QR-code</button>\r\n    <button pButton type=\"button\" class=\"p-button-icon step-btn ml-3\" size=\"s\" icon=\"pi pi-arrow-left\" (click)=\"prevSerial()\" [disabled]=\"data.currentCount <= 1\">\r\n    </button>\r\n    <button pButton type=\"button\" class=\"p-button-icon step-btn ml-3\" icon=\"pi pi-arrow-right\" (click)=\"nextSerial()\" [disabled]=\"data.currentCount >= this.data.count\">\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n<mat-dialog-content>\r\n  <form [formGroup]=\"form\">\r\n    <div class=\"row\">\r\n      <div class=\"col-9\">\r\n      <div class=\"form-group\">\r\n        <label for=\"serial\"> Serial Number </label>\r\n        <div class=\"serial\">\r\n          <input pInputText formControlName=\"serial\" class=\"form-control disabled\" type=\"text\" id=\"serial\">\r\n        </div>\r\n      </div>\r\n      </div>\r\n\r\n      <div class=\"col-1\">\r\n        <div class=\"form-group passing\">\r\n          <label for=\"serial\">Passed</label>\r\n          <div class=\"column-filter-box\">\r\n            <button type=\"button\" [class.active]=\"form.get('is_passed').value === true\"\r\n                    (click)=\"changePassedTrue()\">\r\n              <i class=\"pi pi-check\"></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-1\">\r\n        <div class=\"form-group passing\">\r\n          <label for=\"serial\">To Isolator</label>\r\n          <div class=\"column-filter-box\">\r\n            <button type=\"button\" [class.active]=\"form.get('is_passed').value === false\"\r\n                    (click)=\"changePassedFalse()\">\r\n              <i class=\"pi pi-times\"></i>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n\r\n<!--      <div class=\"d-flex align-items-center mb-3\">-->\r\n<!--        <div class=\"passing mr-3\">-->\r\n<!--          <label for=\"serial\">Passed</label>-->\r\n<!--          <div class=\"column-filter-box\">-->\r\n<!--            <button type=\"button\" [class.active]=\"form.get('is_passed').value === true\"-->\r\n<!--                    (click)=\"changePassedTrue()\">-->\r\n<!--              <i class=\"pi pi-check\"></i>-->\r\n<!--            </button>-->\r\n<!--          </div>-->\r\n<!--        </div>-->\r\n<!--        <div class=\"passing\">-->\r\n<!--          <label for=\"serial\">To Isolator</label>-->\r\n<!--          <div class=\"column-filter-box\">-->\r\n<!--            <button type=\"button\" [class.active]=\"form.get('is_passed').value === false\"-->\r\n<!--                    (click)=\"changePassedFalse()\">-->\r\n<!--              <i class=\"pi pi-times\"></i>-->\r\n<!--            </button>-->\r\n<!--          </div>-->\r\n<!--        </div>-->\r\n<!--      </div>-->\r\n    </div>\r\n  </form>\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions class=\"justify-content-between\">\r\n  <button pButton type=\"button\" label=\"Cancel\" [mat-dialog-close]=\"false\" class=\"p-button-danger\"></button>\r\n  <button pButton type=\"button\" label=\"Complete\" class=\"p-button-success\" (click)=\"complete()\" [disabled]=\"form.get('is_passed').value === null\" [loading]=\"isPending\"></button>\r\n</mat-dialog-actions>\r\n","import {Component, Inject, OnInit, ViewChild} from '@angular/core';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {FormBuilder, FormGroup} from '@angular/forms';\r\nimport {NomenclatureService} from '@shared/services/nomenclature.service';\r\nimport {BehaviorSubject, Observable, Subject, switchMap} from 'rxjs';\r\nimport {Nomenclature} from '@shared/models/nomenclature';\r\nimport {QuerySearch} from '@shared/models/other';\r\nimport {AdapterService} from '@shared/services/adapter.service';\r\nimport {debounceTime, distinctUntilChanged, map, tap} from 'rxjs/operators';\r\nimport {UntilDestroy, untilDestroyed} from '@ngneat/until-destroy';\r\nimport {Paginator} from 'primeng/paginator';\r\n\r\n@UntilDestroy()\r\n@Component({\r\n  selector: 'pek-nomenclature-protocol-picker',\r\n  templateUrl: './nomenclature-protocol-picker.component.html',\r\n  styleUrls: ['./nomenclature-protocol-picker.component.scss']\r\n})\r\nexport class NomenclatureProtocolPickerComponent implements OnInit {\r\n  @ViewChild('paginator') paginator: Paginator;\r\n\r\n  nomenclatureFilterTypes = [\r\n    {name: 'Manufactured', value: '2'},\r\n    {name: 'Assembly', value: '1'},\r\n    {name: 'Purchased', value: '0'}\r\n  ];\r\n\r\n  searchForm: FormGroup = this.fb.group({\r\n    name: [''],\r\n    code: [''],\r\n    categories: [''],\r\n    root_categories: [''],\r\n    type: [null],\r\n  });\r\n\r\n  isLoading = true;\r\n\r\n  currentPage = 1;\r\n  isStartFirstPage = false;\r\n\r\n  queryKey: string = this.adapterService.generateQueryKey(this.searchForm);\r\n\r\n  query: QuerySearch[] = [];\r\n\r\n  selectedProduct: Nomenclature;\r\n\r\n  productsCount = 0;\r\n\r\n  name$: Subject<void> = new Subject<void>();\r\n  code$: Subject<void> = new Subject<void>();\r\n  search$: BehaviorSubject<void> = new BehaviorSubject<void>(null);\r\n\r\n  products$: Observable<Nomenclature[]> = this.search$.pipe(\r\n    tap(() => this.prepareForSearch()),\r\n    switchMap(() => this.nomenclatureService.getForPagination(this.query)),\r\n    tap(response => this.productsCount = response.count),\r\n    map(response => response.results),\r\n    tap(() => this.paginateToFistPage()),\r\n    tap(() => this.isLoading = false),\r\n    untilDestroyed(this)\r\n  );\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<NomenclatureProtocolPickerComponent>,\r\n    private readonly fb: FormBuilder,\r\n    private readonly nomenclatureService: NomenclatureService,\r\n    private readonly adapterService: AdapterService,\r\n    @Inject(MAT_DIALOG_DATA) public data: {}\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.name$.pipe(\r\n      debounceTime(150),\r\n      tap(() => this.search$.next()),\r\n      distinctUntilChanged(),\r\n      untilDestroyed(this)\r\n    ).subscribe();\r\n\r\n    this.code$.pipe(\r\n      debounceTime(150),\r\n      tap(() => this.search$.next()),\r\n      distinctUntilChanged(),\r\n      untilDestroyed(this)\r\n    ).subscribe();\r\n  }\r\n\r\n  prepareForSearch() {\r\n    this.isLoading = true;\r\n    this.selectedProduct = null;\r\n\r\n    const newQueryKey = this.adapterService.generateQueryKey(this.searchForm);\r\n\r\n    if (newQueryKey !== this.queryKey) {\r\n      this.currentPage = 1;\r\n      this.queryKey = newQueryKey;\r\n      this.isStartFirstPage = true;\r\n    }\r\n\r\n    this.query = [\r\n      {name: 'paginated', value: true},\r\n      {name: 'page', value: this.currentPage},\r\n    ];\r\n\r\n    for (const key in this.searchForm.controls) {\r\n      if (this.searchForm.controls[key].value) {\r\n        this.query.push({\r\n          name: key,\r\n          value: this.searchForm.controls[key].value\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  paginateToFistPage() {\r\n    if (this.isStartFirstPage) {\r\n      this.paginator?.changePage(0);\r\n    }\r\n\r\n    this.isStartFirstPage = false;\r\n  }\r\n\r\n  onSelectProduct() {\r\n    this.dialogRef.close(this.selectedProduct)\r\n  }\r\n\r\n  paginate(event: any) {\r\n    if (!this.isStartFirstPage) {\r\n      this.currentPage = event.page + 1;\r\n      this.search$.next();\r\n    }\r\n  }\r\n\r\n  onSelectCategories(ids: string) {\r\n    this.searchForm.get('categories').patchValue(ids)\r\n    this.search$.next()\r\n  }\r\n\r\n  onSelectRootCategories(ids: string) {\r\n    this.searchForm.get('root_categories').patchValue(ids)\r\n    this.search$.next()\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n    <h2 class=\"modal-header__title\">Choice Nomenclature</h2>\r\n</div>\r\n\r\n<form [formGroup]=\"searchForm\">\r\n  <div class=\"row\">\r\n    <div class=\"col-4\">\r\n      <div class=\"form-group\">\r\n        <label for=\"name\">Name</label>\r\n        <input\r\n          pInputText\r\n          formControlName=\"name\"\r\n          class=\"form-control\"\r\n          type=\"text\"\r\n          id=\"name\"\r\n          (ngModelChange)=\"name$.next()\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <div class=\"col-4\">\r\n      <div class=\"form-group\">\r\n        <label for=\"code\">Code</label>\r\n        <input\r\n          pInputText\r\n          formControlName=\"code\"\r\n          class=\"form-control\"\r\n          type=\"text\"\r\n          id=\"code\"\r\n          (ngModelChange)=\"code$.next()\"\r\n        />\r\n      </div>\r\n    </div>\r\n    <div class=\"col-4\">\r\n      <div class=\"form-group\">\r\n        <label>Type</label>\r\n        <p-dropdown\r\n          formControlName=\"type\"\r\n          [options]=\"nomenclatureFilterTypes\"\r\n          placeholder=\"Type\"\r\n          optionLabel=\"name\"\r\n          optionValue=\"value\"\r\n          [showClear]=\"true\"\r\n          (ngModelChange)=\"search$.next()\"\r\n        >\r\n        </p-dropdown>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-4\">\r\n      <div class=\"form-group\">\r\n        <label>Categories</label>\r\n        <pek-multi-categories-picker (choiceCategories)=\"onSelectCategories($event)\"></pek-multi-categories-picker>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-4\">\r\n      <div class=\"form-group\">\r\n        <label>Root Categories</label>\r\n        <pek-multi-product-structure-categories-picker (choiceCategories)=\"onSelectRootCategories($event)\"></pek-multi-product-structure-categories-picker>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</form>\r\n\r\n<div class=\"table-pagination-preloader\">\r\n  <mat-dialog-content>\r\n    <p-table\r\n      [scrollable]=\"true\"\r\n      #dt\r\n      selectionMode=\"single\"\r\n      dataKey=\"id\"\r\n      rowExpandMode=\"single\"\r\n      [rows]=\"10\"\r\n      [value]=\"products$ | async\"\r\n      [(selection)]=\"selectedProduct\"\r\n    >\r\n      <ng-template pTemplate=\"header\">\r\n        <tr>\r\n          <th style=\"width: 5%\" class=\"text-center\">#</th>\r\n          <th style=\"width: 20%\">Name</th>\r\n          <th style=\"width: 30%\">Code</th>\r\n          <th style=\"width: 10%\"  class=\"text-center\">Uom</th>\r\n          <th style=\"width: 20%\"  class=\"text-center\">Technology</th>\r\n          <th style=\"width: 15%\" class=\"text-center\">Category</th>\r\n        </tr>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"body\" let-product let-i=\"rowIndex\">\r\n        <tr\r\n          [pSelectableRow]=\"product\"\r\n        >\r\n          <td style=\"width: 5%\" class=\"text-center\">{{(this.currentPage - 1) * 10 + i + 1}}</td>\r\n          <td style=\"width: 20%\" class=\"word-break\">\r\n            {{ product.code }}\r\n          </td>\r\n          <td style=\"width: 30%\">\r\n                  <span\r\n                    *ngIf=\"product.approved === '0' && product.type === '0'\"\r\n                    class=\"badge badge_warning\"\r\n                    style=\"margin-right: 0.25rem\"\r\n                  >\r\n                    NEW\r\n                  </span>\r\n            {{ product.name }}\r\n          </td>\r\n          <td class=\"word-break text-center\" style=\"width: 10%\" >{{product.category?.unit_of_measure?.symbol ? product.category?.unit_of_measure?.symbol : 'Pcs' }}</td>\r\n          <td class=\"text-center\" style=\"width: 20%\">\r\n            <div *ngFor=\"let technology of product.technologies\">\r\n              {{technology.name}}\r\n            </div>\r\n          </td>\r\n        <td class=\"text-center\" style=\"width: 15%\">\r\n          {{product.category?.name}}\r\n        </td>\r\n      </ng-template>\r\n      <ng-template pTemplate=\"emptymessage\">\r\n        <tr>\r\n          <td class=\"text-center p-4\" [attr.colspan]=\"12\">\r\n            <i *ngIf=\"isLoading\" class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n            <span *ngIf=\"!isLoading\">No Records Found</span>\r\n          </td>\r\n        </tr>\r\n      </ng-template>\r\n    </p-table>\r\n\r\n    <div class=\"pagination-preloader pagination-preloader_bord\" *ngIf=\"isLoading\">\r\n      <i class=\"pi pi-spin pi-spinner\" style=\"font-size: 2.25rem\"></i>\r\n    </div>\r\n  </mat-dialog-content>\r\n</div>\r\n\r\n<mat-dialog-actions class=\"justify-content-between\">\r\n  <button pButton type=\"button\" label=\"Cancel\" [mat-dialog-close]=\"false\" class=\"p-button-danger\"></button>\r\n  <div\r\n    class=\"paginator-wrapper\"\r\n    [class.paginator-wrapper_hide]=\"productsCount === 0\"\r\n  >\r\n    <p-paginator\r\n      #paginator\r\n      [rows]=\"10\"\r\n      [totalRecords]=\"productsCount\"\r\n      (onPageChange)=\"paginate($event)\"\r\n    >\r\n    </p-paginator>\r\n  </div>\r\n  <button\r\n    pButton\r\n    type=\"button\"\r\n    class=\"p-button-success\"\r\n    label=\"Choice\"\r\n    [disabled]=\"!selectedProduct\"\r\n    (click)=\"onSelectProduct()\"\r\n  ></button>\r\n</mat-dialog-actions>\r\n","import {Component, Inject, OnInit} from '@angular/core';\r\nimport {FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {InvoiceProductService} from '../../../procurement/services/invoice-product.service';\r\nimport {OrderProductService} from '../../../procurement/services/order-product.service';\r\nimport {EInvoiceProductQualityControl} from '../../../procurement/models/invoice-product';\r\nimport {OrderProduct} from '../../../procurement/models/order-product';\r\nimport {forkJoin, Observable} from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'pek-quality-control-modal',\r\n  templateUrl: './quality-control-modal.component.html',\r\n  styleUrls: ['./quality-control-modal.component.scss']\r\n})\r\nexport class QualityControlModalComponent implements OnInit {\r\n  form: FormGroup;\r\n  quantity: number;\r\n  isPending = false;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<QualityControlModalComponent>,\r\n    private fb: FormBuilder,\r\n    private invoiceProductService: InvoiceProductService,\r\n    private orderProductService: OrderProductService,\r\n    @Inject(MAT_DIALOG_DATA) public data: { type: any, entity: any, isOwnProduction: boolean }\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.form = this.fb.group({\r\n      id: [this.data.entity.id],\r\n      passed_quantity: [this.data.entity.totalQuantityPassed, [Validators.max(this.data.entity.totalQuantity), Validators.min(0), Validators.required]],\r\n      not_passed_quantity: [this.data.entity.totalQuantityNotPassed, [Validators.max(this.data.entity.totalQuantity), Validators.min(0), Validators.required]],\r\n    });\r\n    this.quantity = this.data.entity.totalQuantity;\r\n  }\r\n\r\n  onComplete() {\r\n    if (this.form.valid) {\r\n      let totalPassedQuantity = this.form.get('passed_quantity').value;\r\n      let totalNotPassedQuantity = this.form.get('not_passed_quantity').value;\r\n      const totalQuantity = this.quantity;\r\n      let products;\r\n      if (this.data.isOwnProduction) {\r\n        products = this.data.entity.orderProducts;\r\n      } else {\r\n        products = this.data.entity.invoiceProducts;\r\n      }\r\n      const dataToSendCalls: Observable<any>[] = [];\r\n      products.sort((a, b) => {\r\n        return a.id - b.id;\r\n      })\r\n        .forEach(prod => {\r\n          let passedQuantity = 0;\r\n          let notPassedQuantity = 0;\r\n          let canFillQuantity = prod.quantity;\r\n\r\n          // Update accepted quantities\r\n          if (totalPassedQuantity <= canFillQuantity) {\r\n            canFillQuantity -= totalPassedQuantity;\r\n            passedQuantity += totalPassedQuantity;\r\n            totalPassedQuantity = 0;\r\n          } else {\r\n            totalPassedQuantity -= canFillQuantity;\r\n            passedQuantity += canFillQuantity;\r\n            canFillQuantity = 0;\r\n          }\r\n\r\n          // Update NOT accepted quantities\r\n          if (totalNotPassedQuantity <= canFillQuantity) {\r\n            canFillQuantity -= totalNotPassedQuantity;\r\n            notPassedQuantity += totalNotPassedQuantity;\r\n            totalNotPassedQuantity = 0;\r\n          } else {\r\n            totalNotPassedQuantity -= canFillQuantity;\r\n            notPassedQuantity += canFillQuantity;\r\n            canFillQuantity = 0;\r\n          }\r\n\r\n          const updateProduct = {\r\n            id: prod.id,\r\n            passed_quantity: passedQuantity,\r\n            not_passed_quantity: notPassedQuantity\r\n          };\r\n          if (this.data.isOwnProduction) {\r\n            dataToSendCalls.push(this.orderProductService.updatePartly(updateProduct as OrderProduct));\r\n          } else {\r\n            dataToSendCalls.push(this.invoiceProductService.updatePartly(updateProduct));\r\n          }\r\n          // dataToSend.push(updateProduct);\r\n        });\r\n\r\n      if (this.form.value.passed_quantity + this.form.value.not_passed_quantity === this.data.entity.totalQuantity) {\r\n        if (this.form.value.passed_quantity === this.data.entity.totalQuantity) {\r\n          this.form.addControl('quality_control', new FormControl(EInvoiceProductQualityControl.PASSED));\r\n        } else if (this.form.value.not_passed_quantity === this.data.entity.totalQuantity) {\r\n          this.form.addControl('quality_control', new FormControl(EInvoiceProductQualityControl.NOT_PASSED));\r\n        } else if (this.form.value.not_passed_quantity + this.form.value.passed_quantity === this.data.entity.totalQuantity) {\r\n          this.form.addControl('quality_control', new FormControl(EInvoiceProductQualityControl.PARTLY_PASSED));\r\n        }\r\n      }\r\n\r\n      this.isPending = true;\r\n      forkJoin([...dataToSendCalls]).subscribe(res => {\r\n        this.isPending = false;\r\n        this.dialogRef.close(true);\r\n      });\r\n      // if (this.form.value.passed_quantity + this.form.value.not_passed_quantity === this.data.entity.totalQuantity) {\r\n      //   console.log('this.form.value', this.form.value);\r\n      //\r\n      //   if (this.data.isOwnProduction) {\r\n      //     this.orderProductService.updatePartly(this.form.value).subscribe(() => {\r\n      //       this.isPending = false;\r\n      //       this.dialogRef.close(true);\r\n      //     });\r\n      //   } else {\r\n      //     this.invoiceProductService.updatePartly(this.form.value).subscribe(() => {\r\n      //       this.isPending = false;\r\n      //       this.dialogRef.close(true);\r\n      //     });\r\n      //   }\r\n      // }\r\n    }\r\n  }\r\n\r\n  isDisableCompleteButton() {\r\n    return +this.form.get('passed_quantity').value + +this.form.get('not_passed_quantity').value !== +this.quantity;\r\n  }\r\n}\r\n","<div class=\"modal-header\">\r\n  <h2 class=\"modal-header__title\">\r\n    Quality Control (Name: {{data.entity.nomenclature.name}}, Quantity: {{data.entity.totalQuantity}})\r\n  </h2>\r\n</div>\r\n\r\n<mat-dialog-content>\r\n  <form [formGroup]=\"form\">\r\n    <div class=\"form-group\">\r\n      <label for=\"passed\"> Passed* </label>\r\n      <input\r\n        pInputText\r\n        formControlName=\"passed_quantity\"\r\n        class=\"form-control\"\r\n        min=\"0\"\r\n        max=\"{{data.entity.totalQuantity}}\"\r\n        type=\"number\"\r\n        id=\"passed\"\r\n      >\r\n    </div>\r\n    <div class=\"form-group\">\r\n      <label for=\"np\"> Not Passed* </label>\r\n      <input\r\n        pInputText\r\n        formControlName=\"not_passed_quantity\"\r\n        class=\"form-control\"\r\n        min=\"0\"\r\n        max=\"{{data.entity.totalQuantity}}\"\r\n        type=\"number\"\r\n        id=\"np\"\r\n      >\r\n    </div>\r\n  </form>\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions class=\"justify-content-between\">\r\n  <button pButton type=\"button\" label=\"Cancel\" [mat-dialog-close]=\"false\" class=\"p-button-danger\"></button>\r\n  <button pButton type=\"button\" label=\"Complete\" class=\"p-button-success\" [disabled]=\"form.invalid || isDisableCompleteButton()\" (click)=\"onComplete()\" [loading]=\"isPending\"></button>\r\n</mat-dialog-actions>\r\n","import {Component, Inject, OnInit} from '@angular/core';\r\nimport {FormBuilder, FormControl, FormGroup, Validators} from '@angular/forms';\r\nimport {MAT_DIALOG_DATA, MatDialogRef} from '@angular/material/dialog';\r\nimport {InvoiceProductService} from '../../../procurement/services/invoice-product.service';\r\nimport {OrderProductService} from '../../../procurement/services/order-product.service';\r\nimport {EInvoiceProductQualityControl} from '../../../procurement/models/invoice-product';\r\nimport {OrderTechnicalEquipmentsService} from '../../../warehouse/services/order-technical-equipments.service';\r\n\r\n@Component({\r\n  selector: 'pek-quality-control-technical-equipment',\r\n  templateUrl: './quality-control-technical-equipment.component.html',\r\n  styleUrls: ['./quality-control-technical-equipment.component.scss']\r\n})\r\nexport class QualityControlTechnicalEquipmentComponent implements OnInit {\r\n  form: FormGroup;\r\n  quantity: number;\r\n  isPending = false;\r\n\r\n  constructor(\r\n    private dialogRef: MatDialogRef<QualityControlTechnicalEquipmentComponent>,\r\n    private fb: FormBuilder,\r\n    private invoiceProductService: InvoiceProductService,\r\n    private orderTechnicalEquipmentsService: OrderTechnicalEquipmentsService,\r\n    private orderProductService: OrderProductService,\r\n    @Inject(MAT_DIALOG_DATA) public data: { type: any, entity: any, isOwnProduction: boolean }\r\n  ) {\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.form = this.fb.group({\r\n      id: [this.data.entity.id],\r\n      passed_quantity: [this.data.entity.passed_quantity, [Validators.max(this.data.entity.quantity), Validators.min(0), Validators.required]],\r\n      not_passed_quantity: [this.data.entity.not_passed_quantity, [Validators.max(this.data.entity.quantity), Validators.min(0), Validators.required]],\r\n    });\r\n    this.quantity = this.data.entity.quantity;\r\n  }\r\n\r\n  isDisableCompleteButton() {\r\n    return +this.form.get('passed_quantity').value + +this.form.get('not_passed_quantity').value !== +this.quantity;\r\n  }\r\n\r\n  onComplete() {\r\n    if (this.form.valid) {\r\n      this.isPending = true;\r\n      if (this.form.value.passed_quantity + this.form.value.not_passed_quantity === this.data.entity.quantity) {\r\n        if (this.form.value.passed_quantity === this.data.entity.quantity) {\r\n          this.form.addControl('quality_control', new FormControl(EInvoiceProductQualityControl.PASSED));\r\n        } else if (this.form.value.not_passed_quantity === this.data.entity.quantity) {\r\n          this.form.addControl('quality_control', new FormControl(EInvoiceProductQualityControl.NOT_PASSED));\r\n        } else if (this.form.value.not_passed_quantity + this.form.value.passed_quantity === this.data.entity.quantity) {\r\n          this.form.addControl('quality_control', new FormControl(EInvoiceProductQualityControl.PARTLY_PASSED));\r\n        }\r\n      }\r\n      if (this.form.value.not_passed_quantity + this.form.value.passed_quantity === this.data.entity.quantity) {\r\n        if (this.data.isOwnProduction) {\r\n          this.orderTechnicalEquipmentsService.updatePartly(this.form.value).subscribe(() => {\r\n            this.isPending = false;\r\n            this.dialogRef.close(true);\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","<div class=\"modal-header\">\r\n  <h2 class=\"modal-header__title\">\r\n    Quality Control (Name: {{data.entity.nomenclature.name}}, Quantity: {{data.entity.quantity}})\r\n  </h2>\r\n</div>\r\n\r\n<mat-dialog-content>\r\n  <form [formGroup]=\"form\">\r\n    <div class=\"form-group\">\r\n      <label for=\"passed\"> Passed* </label>\r\n      <input\r\n        pInputText\r\n        formControlName=\"passed_quantity\"\r\n        class=\"form-control\"\r\n        min=\"0\"\r\n        max=\"{{data.entity.quantity}}\"\r\n        type=\"number\"\r\n        id=\"passed\"\r\n      >\r\n    </div>\r\n    <div class=\"form-group\">\r\n      <label for=\"np\"> Not Passed* </label>\r\n      <input\r\n        pInputText\r\n        formControlName=\"not_passed_quantity\"\r\n        class=\"form-control\"\r\n        min=\"0\"\r\n        max=\"{{data.entity.quantity}}\"\r\n        type=\"number\"\r\n        id=\"np\"\r\n      >\r\n    </div>\r\n  </form>\r\n</mat-dialog-content>\r\n\r\n<mat-dialog-actions class=\"justify-content-between\">\r\n  <button pButton type=\"button\" label=\"Cancel\" [mat-dialog-close]=\"false\" class=\"p-button-danger\"></button>\r\n  <button pButton type=\"button\" label=\"Complete\" class=\"p-button-success\" [disabled]=\"form.invalid || isDisableCompleteButton()\" (click)=\"onComplete()\" [loading]=\"isPending\"></button>\r\n</mat-dialog-actions>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { QcRouting } from './qc.routing';\r\nimport { QcListComponent } from './components/qc-list/qc-list.component';\r\nimport { QcLayoutComponent } from './components/qc-layout/qc-layout.component';\r\nimport {SharedModule} from '@shared/shared.module';\r\nimport {LayoutModule} from '../layout/layout.module';\r\nimport { QcInvoiceComponent } from './components/qc-invoice/qc-invoice.component';\r\nimport { QcOrderComponent } from './components/qc-order/qc-order.component';\r\nimport { QualityControlModalComponent } from './modals/quality-control-modal/quality-control-modal.component';\r\nimport { ProtocolsComponent } from './components/protocols/protocols.component';\r\nimport { CreateEditProtocolComponent } from './modals/create-edit-protocol/create-edit-protocol.component';\r\nimport { NomenclatureProtocolPickerComponent } from './modals/nomenclature-protocol-picker/nomenclature-protocol-picker.component';\r\nimport { QualityControlTechnicalEquipmentComponent } from './modals/quality-control-technical-equipment/quality-control-technical-equipment.component';\r\nimport { MoveQcWithSerialComponent } from './modals/move-qc-with-serial/move-qc-with-serial.component';\r\nimport { MoveQcWithProtocolComponent } from './modals/move-qc-with-protocol/move-qc-with-protocol.component';\r\n\r\n\r\n@NgModule({\r\n  declarations: [\r\n    QcListComponent,\r\n    QcLayoutComponent,\r\n    QcInvoiceComponent,\r\n    QcOrderComponent,\r\n    QualityControlModalComponent,\r\n    ProtocolsComponent,\r\n    CreateEditProtocolComponent,\r\n    NomenclatureProtocolPickerComponent,\r\n    QualityControlTechnicalEquipmentComponent,\r\n    MoveQcWithSerialComponent,\r\n    MoveQcWithProtocolComponent\r\n  ],\r\n  imports: [\r\n    CommonModule,\r\n    QcRouting,\r\n    SharedModule,\r\n    LayoutModule\r\n  ]\r\n})\r\nexport class QcModule { }\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport {QcLayoutComponent} from './components/qc-layout/qc-layout.component';\r\nimport {QcListComponent} from './components/qc-list/qc-list.component';\r\nimport {QcOrderComponent} from './components/qc-order/qc-order.component';\r\nimport {QcInvoiceComponent} from './components/qc-invoice/qc-invoice.component';\r\nimport {ProtocolsComponent} from './components/protocols/protocols.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: QcLayoutComponent,\r\n    children: [\r\n      {path: '', redirectTo: 'list', pathMatch: 'full'},\r\n      {path: 'list', title: 'Quality Control', component: QcListComponent},\r\n      {path: 'invoice/:id', title: 'Invoice Quality Control', component: QcInvoiceComponent},\r\n      {path: 'order/:id', title: 'Order Quality Control', component: QcOrderComponent},\r\n      {path: 'protocols', title: 'Protocols', component: ProtocolsComponent},\r\n    ]\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class QcRouting { }\r\n","import {Injectable} from '@angular/core';\r\nimport {HttpClient} from '@angular/common/http';\r\nimport {forkJoin, Observable} from 'rxjs';\r\nimport {map} from 'rxjs/operators';\r\nimport {environment} from '@env/environment';\r\nimport {QuerySearch} from '@shared/models/other';\r\nimport {ProductQcProtocol, QcProtocol, QcProtocols, QrProtocolParagraph} from '../models/protocol';\r\nimport {ModalActionType} from '@shared/models/modal-action';\r\nimport {Warehouse} from '../../warehouse/models/warehouse';\r\nimport {\r\n  CreateEditWarehouseComponent\r\n} from '../../warehouse/modals/create-edit-warehouse/create-edit-warehouse.component';\r\nimport {CreateEditProtocolComponent} from '../modals/create-edit-protocol/create-edit-protocol.component';\r\nimport {MatDialog} from '@angular/material/dialog';\r\nimport {Nomenclature} from '@shared/models/nomenclature';\r\nimport {\r\n  NomenclatureProtocolPickerComponent\r\n} from '../modals/nomenclature-protocol-picker/nomenclature-protocol-picker.component';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ProtocolService {\r\n\r\n  API_URL = environment.base_url + environment.procurement_url;\r\n\r\n  constructor(\r\n    private httpClient: HttpClient,\r\n    private readonly dialog: MatDialog,\r\n  ) {\r\n  }\r\n\r\n  getForPagination(query?: QuerySearch[]): Observable<QcProtocols> {\r\n    let qString = '';\r\n    if (query) {\r\n      query.forEach((element, index) => {\r\n        if (index > 0) {\r\n          qString += '&' + element.name + '=' + element.value;\r\n        } else {\r\n          qString += '?' + element.name + '=' + element.value;\r\n        }\r\n      });\r\n    }\r\n\r\n    return this.httpClient.get<{ data: QcProtocols }>(this.API_URL + 'qc_protocols/' + qString).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  get(query?: QuerySearch[]): Observable<QcProtocol[]> {\r\n    let qString = '';\r\n    if (query) {\r\n      query.forEach((element, index) => {\r\n        if (index > 0) {\r\n          qString += '&' + element.name + '=' + element.value;\r\n        } else {\r\n          qString += '?' + element.name + '=' + element.value;\r\n        }\r\n      });\r\n    }\r\n\r\n    return this.httpClient.get<{ data: QcProtocol[] }>(this.API_URL + 'qc_protocols/' + qString).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  getOne(id): Observable<QcProtocol> {\r\n    return this.httpClient.get<{ data: QcProtocol }>(this.API_URL + `qc_protocols/${id}/`).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  create(send): Observable<QcProtocol> {\r\n    return this.httpClient.post<{ data: QcProtocol }>(this.API_URL + 'qc_protocols/', send).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  update(send): Observable<QcProtocol> {\r\n    return this.httpClient.patch<{ data: QcProtocol }>(this.API_URL + `qc_protocols/${send.id}/`, send).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  addParagraphs(paragraphs): Observable<QrProtocolParagraph[]> {\r\n    return forkJoin(...paragraphs.map(paragraph => this.httpClient.post<{ data: QrProtocolParagraph }>(this.API_URL + 'qc_protocol_paragraphs/', paragraph)));\r\n  }\r\n\r\n  updateParagraphs(paragraphs): Observable<QrProtocolParagraph[]> {\r\n    return forkJoin(...paragraphs.map(paragraph => this.httpClient.patch<{ data: QrProtocolParagraph }>(this.API_URL + `qc_protocol_paragraphs/${paragraph.id}/`, paragraph)));\r\n  }\r\n\r\n  deleteParagraphs(ids): Observable<QrProtocolParagraph[]> {\r\n    return forkJoin(...ids.map(id => this.httpClient.delete<{ data: QrProtocolParagraph }>(this.API_URL + `qc_protocol_paragraphs/${id}/`)));\r\n  }\r\n\r\n  getParagraphs(query?: QuerySearch[]): Observable<QrProtocolParagraph[]> {\r\n    let qString = '';\r\n    if (query) {\r\n      query.forEach((element, index) => {\r\n        if (index > 0) {\r\n          qString += '&' + element.name + '=' + element.value;\r\n        } else {\r\n          qString += '?' + element.name + '=' + element.value;\r\n        }\r\n      });\r\n    }\r\n\r\n    return this.httpClient.get<{ data: QrProtocolParagraph[] }>(this.API_URL + 'qc_protocol_paragraphs/' + qString).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  getWarehouseProducts(id: number): Observable<any> {\r\n    return this.httpClient.get<{ data: any }>(this.API_URL + `warehouse_products_qc_protocols/${id}/`).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  addNomenclature(send, id): Observable<any>  {\r\n    return this.httpClient.post<{ data: QcProtocol }>(this.API_URL + `qc_protocols/${id}/add_protocol_to_nomenclature/`, send).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  productsToQc(send): Observable<any>  {\r\n    return this.httpClient.post<{ data: any }>(environment.base_url + 'procurement/warehouse_products_qc_protocols/', send).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  deleteProtocol(id): Observable<any>  {\r\n    return this.httpClient.delete(this.API_URL + 'qc_protocols/' + `${id}/`);\r\n  }\r\n\r\n  saveFile(file): Observable<any>  {\r\n    return this.httpClient.post<{ data: any }>(this.API_URL + 'qc_protocols_files/', file).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  deleteFile(id): Observable<any> {\r\n    return this.httpClient.delete(this.API_URL + `qc_protocols_files/${id}/`);\r\n  }\r\n\r\n  getFiles(query?: QuerySearch[]) {\r\n    let qString = '';\r\n    if (query) {\r\n      query.forEach((element, index) => {\r\n        if (index > 0) {\r\n          qString += '&' + element.name + '=' + element.value;\r\n        } else {\r\n          qString += '?' + element.name + '=' + element.value;\r\n        }\r\n      });\r\n    }\r\n\r\n    return this.httpClient.get<{ data: any }>(this.API_URL + `qc_protocols_files/` + qString).pipe(map(response => {\r\n      return response.data;\r\n    }));\r\n  }\r\n\r\n  downloadFile(id): Observable<any> {\r\n    return this.httpClient.get(this.API_URL + 'qc_protocols_files/' + id + '/download/', {responseType: 'blob'});\r\n  }\r\n\r\n  qcSerial(send): Observable<any> {\r\n    return this.httpClient.post(this.API_URL + 'create_update_product_by_serial/', send);\r\n  }\r\n\r\n  qcSerialUpdate(send): Observable<any> {\r\n    return this.httpClient.patch(this.API_URL + 'create_update_product_by_serial/', send);\r\n  }\r\n\r\n  getProductsQcProtocols(query?: QuerySearch[]): Observable<ProductQcProtocol[]> {\r\n    let qString = '';\r\n    if (query) {\r\n      query.forEach((element, index) => {\r\n        if (index > 0) {\r\n          qString += '&' + element.name + '=' + element.value;\r\n        } else {\r\n          qString += '?' + element.name + '=' + element.value;\r\n        }\r\n      });\r\n    }\r\n\r\n    return this.httpClient.get<{ data: ProductQcProtocol[] }>(this.API_URL + 'warehouse_products_qc_protocols/' + qString).pipe(\r\n      map(response =>\r\n        response.data)\r\n    );\r\n  }\r\n\r\n  updateProductProtocol(send: any, id: number) {\r\n    return this.httpClient.patch<{ data: any[] }>(this.API_URL + `warehouse_products_qc_protocols/${id}/`, send).pipe(\r\n      map(response => response.data)\r\n    );\r\n  }\r\n\r\n  createEditProtocolModal(type: ModalActionType, protocol?: QcProtocol): Observable<QcProtocol> {\r\n    return this.dialog\r\n      .open<CreateEditProtocolComponent>(CreateEditProtocolComponent, {\r\n        width: '60rem',\r\n        height: 'auto',\r\n        data: {type, protocol},\r\n        autoFocus: false,\r\n        enterAnimationDuration: '250ms'\r\n      })\r\n      .afterClosed();\r\n  }\r\n\r\n  addNomenclatureDialog(): Observable<Nomenclature> {\r\n    return this.dialog\r\n      .open<NomenclatureProtocolPickerComponent>(NomenclatureProtocolPickerComponent, {\r\n        width: '70rem',\r\n        height: 'auto',\r\n        data: {},\r\n        autoFocus: false,\r\n        enterAnimationDuration: '250ms'\r\n      })\r\n      .afterClosed();\r\n  }\r\n}\r\n","import {Injectable} from '@angular/core';\r\nimport {MatDialog} from '@angular/material/dialog';\r\nimport {QualityControlModalComponent} from '../modals/quality-control-modal/quality-control-modal.component';\r\nimport {\r\n  QualityControlTechnicalEquipmentComponent\r\n} from '../modals/quality-control-technical-equipment/quality-control-technical-equipment.component';\r\nimport {MoveQcWithSerialComponent} from '../modals/move-qc-with-serial/move-qc-with-serial.component';\r\nimport {InvoiceProduct} from '../../procurement/models/invoice-product';\r\nimport {MoveQcWithProtocolComponent} from '../modals/move-qc-with-protocol/move-qc-with-protocol.component';\r\nimport {OrderProduct} from '../../procurement/models/order-product';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class QcService {\r\n\r\n  constructor(\r\n    private readonly dialog: MatDialog,\r\n  ) {\r\n  }\r\n\r\n  controlProduct(entity: any, isOwnProduction = false) {\r\n    return this.dialog\r\n      .open<QualityControlModalComponent>(QualityControlModalComponent, {\r\n        width: '50rem',\r\n        data: {type: 'edit', entity, isOwnProduction},\r\n        disableClose: true,\r\n        autoFocus: false\r\n      })\r\n      .afterClosed()\r\n      .pipe();\r\n  }\r\n\r\n  serializedControlProduct(product: InvoiceProduct | OrderProduct, currentCount: number, count: number, type: 'invoice' | 'order') {\r\n    return this.dialog\r\n      .open<MoveQcWithSerialComponent>(MoveQcWithSerialComponent, {\r\n        width: '60rem',\r\n        data: {product, currentCount, count, type},\r\n        disableClose: true,\r\n        autoFocus: false\r\n      })\r\n      .afterClosed()\r\n      .pipe();\r\n  }\r\n\r\n  withProtocolControlProduct(product: InvoiceProduct | OrderProduct, currentCount: number, count: number, type: 'invoice' | 'order') {\r\n    return this.dialog\r\n      .open<MoveQcWithProtocolComponent>(MoveQcWithProtocolComponent, {\r\n        width: '60rem',\r\n        data: {product, currentCount, count, type},\r\n        disableClose: true,\r\n        autoFocus: false\r\n      })\r\n      .afterClosed()\r\n      .pipe();\r\n  }\r\n\r\n  controlTechnicalEquipment(entity: any, isOwnProduction = false) {\r\n    return this.dialog\r\n      .open<QualityControlTechnicalEquipmentComponent>(QualityControlTechnicalEquipmentComponent, {\r\n        width: '50rem',\r\n        data: {type: 'edit', entity, isOwnProduction},\r\n        disableClose: true,\r\n        autoFocus: false\r\n      })\r\n      .afterClosed()\r\n      .pipe();\r\n  }\r\n}\r\n"],"names":["BehaviorSubject","iif","switchMap","filter","map","tap","UntilDestroy","untilDestroyed","i0","ctx_r6","ProtocolsComponent","constructor","protocolService","modalService","label","items","icon","command","editProtocol","removeProtocol","name","value","currentPage","search$","pipe","isLoading","prepareForSearch","isShowAll","getForPagination","query","response","protocolsCount","count","results","get","products","length","protocols","ngOnInit","paginate","event","isStartFirstPage","page","next","onShowAll","selectedProtocol","push","confirm","subscribe","res","deleteProtocol","id","onCreateProtocol","createEditProtocolModal","Boolean","selectors","viewQuery","ctx","EInvoiceProductQualityControl","environment","deepCopy","QcInvoiceComponent","invoiceService","orderProductService","invoiceProductService","qrCodeService","qcService","route","albumService","router","link_url","paramMap","params","invoiceId","getInvoice","getInvoiceProducts","getById","invoice","getTechnicalEquipmentToQc","invoiceProducts","selectedInvoiceProducts","isLoadingProducts","forEach","product","technologyId","current_technology","nomenclatureId","nomenclature","existing","find","el","totalQuantity","quantity","totalQuantityPassed","passed_quantity","totalQuantityNotPassed","not_passed_quantity","totalSerialNumbers","serial_numbers","quality_control","PASSED","toString","NOT_PASSED","PARTLY_PASSED","invoiceCanBeCompleted","p","isLoadingTechnicalEquipment","technicalEquipments","order","getTechnicalEquipmentToQC","equipment","onGenerateQrCodes","isGenerating","send","by_nomenclatures_list","invoiceProduct","bulk_or_serial","nomenclature_id","serial_number_ids","s","order_product_ids","invoice_product_ids","exists","findIndex","generateQrCodes","self_serial_number","onCancellation","isCancellation","cancellation","navigate","relativeTo","onComplete","qc_completed","isCompleting","updatePartly","onCompleteItems","sendProducts","qc_protocol","isCompletingProducts","severalUpdatePartly","onShowImages","showImageGallery","onQualityControl","currentCount","withProtocolControlProduct","serializedControlProduct","controlProduct","onPrintAlbum","getNomenclaturesImages","goToOrder","link","accounting_type","window","open","onQualityControlTechnicalEquipment","controlTechnicalEquipment","selectedTechnicalEquipment","decls","vars","consts","template","_r15","forkJoin","ctx_r3","QcOrderComponent","orderService","orderId","getOrder","getOrderProducts","orderProducts","selectedOrderProducts","getQc","orderCanBeCompleted","onRework","isReworking","ids","reworkOrder","onReworkProduct","isReworkingProduct","productsIds","calls","reworkOrderProduct","index","o","splice","MAT_DIALOG_DATA","Subject","debounceTime","distinctUntilChanged","NomenclatureProtocolPickerComponent","dialogRef","fb","nomenclatureService","adapterService","data","group","code","categories","root_categories","type","generateQueryKey","searchForm","productsCount","paginateToFistPage","name$","code$","selectedProduct","newQueryKey","queryKey","key","controls","paginator","changePage","onSelectProduct","close","onSelectCategories","patchValue","onSelectRootCategories"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}