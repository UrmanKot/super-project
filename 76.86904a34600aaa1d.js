"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[76],{7076:(Is,ie,_)=>{_.r(ie),_.d(ie,{QcModule:()=>Ps});var g=_(6895),C=_(4269),e=_(4650),ve=_(9293);let xe=(()=>{class n{constructor(){this.routes=[{label:"Invoices",commands:["list"]},{label:"Delivery",commands:["delivery"]}],this.settingRoutes=[{label:"Protocols",commands:["protocols"]}]}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-layout"]],decls:2,vars:3,consts:[[3,"module","routes","settingsRoutes"]],template:function(t,i){1&t&&e._UZ(0,"pek-header",0)(1,"router-outlet"),2&t&&e.Q6J("module","Quality Control")("routes",i.routes)("settingsRoutes",i.settingRoutes)},dependencies:[C.lC,ve.G]}),n})();var Ze=_(2595),b=_(7579),A=_(2722),P=_(733),oe=_(5757),R=_(8789),re=_(8234),j=_(6767),l=_(4006),Z=_(5593),$=_(6237),I=_(805),v=_(5390),N=_(3237),G=_(8783),ce=_(585);function qe(n,r){1&n&&(e.TgZ(0,"p",30),e._uU(1," Choose the Production Lists Procurement or Outsourcing Invoice to view Items "),e.qZA())}const B=function(n){return["../","invoice",n]};function ye(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.YNc(1,qe,2,0,"p",26),e._UZ(2,"a",27),e.TgZ(3,"button",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectInvoiceType("list"))}),e.qZA(),e.TgZ(4,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectInvoiceType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedInvoiceItem),e.xp6(1),e.ekj("disabled",!t.selectedInvoiceItem),e.Q6J("routerLink",e.VKq(5,B,null==t.selectedInvoiceItem?null:t.selectedInvoiceItem.id)),e.xp6(1),e.Q6J("disabled","list"===t.invoicesViewType)}}function Te(n,r){1&n&&(e.TgZ(0,"th",32),e._uU(1,"QC Closed Date"),e.qZA())}function Ce(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",31),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",32),e._uU(4,"QC Started Date"),e.qZA(),e.YNc(5,Te,2,0,"th",33),e.TgZ(6,"th",34),e._uU(7,"Invoice Number"),e.qZA(),e.TgZ(8,"th",35),e._uU(9,"Supplier"),e.qZA(),e.TgZ(10,"th",34),e._uU(11,"Order ID"),e.qZA(),e.TgZ(12,"th",35),e._uU(13,"Items Reception Date"),e.qZA(),e.TgZ(14,"th",36),e._uU(15,"Root List"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("ngIf",t.showClosedInvoices)}}function be(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function Qe(n,r){if(1&n&&(e.TgZ(0,"td",32),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,null==t.order?null:t.order.qc_closed_date,"dd/MM/yyyy HH:mm")," ")}}function Ae(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function Pe(n,r){if(1&n&&(e.TgZ(0,"div",39),e._uU(1),e.YNc(2,Ae,2,0,"span",14),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",null==t||null==t.toolRequest||null==t.toolRequest.tool_order||null==t.toolRequest.tool_order.area_locator?null:t.toolRequest.tool_order.area_locator.name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function Ie(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.root_production_plans[0].list_product.nomenclature.code," ~",t.root_production_plans[0].list_product.nomenclature.name," ")}}function we(n,r){if(1&n&&(e.TgZ(0,"tr",37)(1,"td",31),e._uU(2),e.qZA(),e.TgZ(3,"td",32),e._uU(4),e.ALo(5,"date"),e.YNc(6,be,2,0,"b",14),e.qZA(),e.YNc(7,Qe,3,4,"td",33),e.TgZ(8,"td",34),e._uU(9),e.qZA(),e.TgZ(10,"td",35),e._uU(11),e.qZA(),e.TgZ(12,"td",34),e._uU(13),e.qZA(),e.TgZ(14,"td",35),e._uU(15),e.ALo(16,"date"),e.qZA(),e.TgZ(17,"td",36),e.YNc(18,Pe,3,2,"div",38),e.YNc(19,Ie,2,2,"ng-container",14),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(2),e.hij(" ",i+1," "),e.xp6(2),e.hij(" ",e.xi3(5,12,null!=t.order&&t.order.qc_started_date?null==t.order?null:t.order.qc_started_date:t.system_creation_date,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.rma_products_count),e.xp6(1),e.Q6J("ngIf",o.showClosedInvoices),e.xp6(2),e.AsE(" ",t.self_serial_number," ",t.self_proforma_serial_number," "),e.xp6(2),e.hij(" ",null==t.supplier?null:t.supplier.name," "),e.xp6(2),e.hij(" ",null==t.order?null:t.order.id," "),e.xp6(2),e.hij(" ",e.xi3(16,15,t.items_reception_date,"dd/MM/yyyy")," "),e.xp6(3),e.Q6J("ngForOf",null==t||null==t.order?null:t.order.uniqueToolRequests),e.xp6(1),e.Q6J("ngIf",t.root_production_plans.length>0)}}function Ne(n,r){1&n&&e._UZ(0,"i",42)}function Ue(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Se(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e.YNc(2,Ne,1,0,"i",41),e.YNc(3,Ue,2,0,"span",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoadingInvoices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingInvoices)}}function Oe(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",43),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ke(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",44)(1,"p-button",43),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function Je(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16)(2,"p-table",17,18),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedInvoiceItem=o)}),e.YNc(4,ye,5,7,"ng-template",19),e.YNc(5,Ce,16,1,"ng-template",20),e.YNc(6,we,20,18,"ng-template",21),e.YNc(7,Se,4,3,"ng-template",22),e.YNc(8,Oe,2,0,"ng-template",23),e.qZA()(),e.YNc(9,ke,3,0,"div",24),e.BQk()}if(2&n){const t=e.MAs(3),i=e.oxw();e.xp6(2),e.Q6J("scrollable",!0)("paginator",i.invoicesList.length>0)("rows",10)("selection",i.selectedInvoiceItem)("value",i.invoicesList),e.xp6(7),e.Q6J("ngIf",!t.paginator&&!i.isLoadingInvoices&&i.invoicesList.length>0)}}function Me(n,r){1&n&&(e.TgZ(0,"th",32),e._uU(1," QC Closed Date "),e.qZA())}function Le(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",46),e._uU(2," QC Started Date "),e.qZA(),e.YNc(3,Me,2,0,"th",33),e.TgZ(4,"th",35),e._uU(5,"Invoice Number"),e.qZA(),e.TgZ(6,"th",34),e._uU(7,"Order ID"),e.qZA(),e.TgZ(8,"th",32),e._uU(9,"Supplier"),e.qZA(),e.TgZ(10,"th",35),e._uU(11,"Items Reception Date"),e.qZA(),e.TgZ(12,"th",32),e._uU(13,"Root List"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.showClosedInvoices)}}function De(n,r){1&n&&(e.TgZ(0,"p",30),e._uU(1," Choose the Production Lists Procurement or Outsourcing Invoice to view Items "),e.qZA())}function Ye(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.YNc(1,De,2,0,"p",26),e._UZ(2,"a",47),e.TgZ(3,"button",48),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.expandCollapseAllInvoices())}),e.qZA(),e.TgZ(4,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.expandCollapseAllInvoices(!1))}),e.qZA(),e.TgZ(5,"button",50),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectInvoiceType("list"))}),e.qZA(),e.TgZ(6,"button",51),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectInvoiceType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedInvoiceNode),e.xp6(1),e.ekj("disabled",!t.selectedInvoiceNode),e.Q6J("routerLink",e.VKq(7,B,null!=t.selectedInvoiceNode&&t.selectedInvoiceNode.data.order?null==t.selectedInvoiceNode?null:t.selectedInvoiceNode.data.order.id:null==t.selectedInvoiceNode?null:t.selectedInvoiceNode.data.id)),e.xp6(1),e.Q6J("disabled",t.isLoadingInvoices),e.xp6(1),e.Q6J("disabled",t.isLoadingInvoices),e.xp6(2),e.Q6J("disabled","hierarchy"===t.invoicesViewType)}}function Ee(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(3).rowData;e.xp6(1),e.hij("(",t.description,")")}}function Fe(n,r){if(1&n&&(e.TgZ(0,"i",58),e._uU(1),e.qZA()),2&n){const t=e.oxw(3).rowData;e.xp6(1),e.hij("(",t.categories,")")}}function Re(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.YNc(3,Ee,2,1,"span",14),e.YNc(4,Fe,2,1,"i",57),e.qZA(),e.BQk()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.ekj("category-name",0===t.level&&!1!==t.hideFromTable),e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",t.description),e.xp6(1),e.Q6J("ngIf",t.level<4&&t.level>0)}}function je(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function $e(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.YNc(3,je,2,0,"b",14),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.xi3(2,2,null!=t.order&&null!=t.order.order&&t.order.order.qc_started_date?null==t.order||null==t.order.order?null:t.order.order.qc_started_date:t.order.system_creation_date,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.order.rma_products_count)}}function Ge(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(3).rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,null==t.order||null==t.order.order?null:t.order.order.qc_closed_date,"dd/MM/yyyy HH:mm")," ")}}function Be(n,r){if(1&n&&(e.TgZ(0,"td",32),e.YNc(1,Ge,3,4,"span",14),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("ngIf",4===t.level)}}function He(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.AsE(" ",t.self_serial_number," ",t.self_proforma_serial_number," ")}}function Ke(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.ekj("text-warning",t.order.unique_root_production_plans.length>1),e.xp6(1),e.AsE(" ",t.order.self_serial_number," ",t.order.self_proforma_serial_number," ")}}function ze(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t.order||null==t.order.order?null:t.order.order.id," ")}}function We(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t.supplier?null:t.supplier.name," ")}}function Ve(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",null==t.order.supplier?null:t.order.supplier.name," ")}}function Xe(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.items_reception_date,"dd/MM/yyyy")," ")}}function et(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.order.items_reception_date,"dd/MM/yyyy")," ")}}function tt(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function nt(n,r){if(1&n&&(e.TgZ(0,"div",39),e._uU(1),e.YNc(2,tt,2,0,"span",14),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",null==t||null==t.toolRequest||null==t.toolRequest.tool_order||null==t.toolRequest.tool_order.area_locator?null:t.toolRequest.tool_order.area_locator.name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function it(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.list_product.nomenclature.name," ")}}function ot(n,r){if(1&n&&(e.ynx(0),e.YNc(1,nt,3,2,"div",38),e.YNc(2,it,2,1,"div",59),e.BQk()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("ngForOf",null==t||null==t.order||null==t.order.order?null:t.order.order.uniqueToolRequests),e.xp6(1),e.Q6J("ngForOf",t.unique_root_production_plans)}}function rt(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.AsE(" ",t.plan.list_product.nomenclature.code,"~",t.plan.list_product.nomenclature.name," "),e.xp6(2),e.hij("(",t.plan.required_quantity,")")}}function ct(n,r){if(1&n&&(e.TgZ(0,"tr",53)(1,"td",36)(2,"div",54),e._UZ(3,"p-treeTableToggler",55),e.YNc(4,Re,5,5,"ng-container",14),e.YNc(5,$e,4,5,"span",14),e.qZA()(),e.YNc(6,Be,2,1,"td",33),e.TgZ(7,"td",35),e.YNc(8,He,2,2,"ng-container",14),e.YNc(9,Ke,2,4,"span",56),e.qZA(),e.TgZ(10,"td",34),e.YNc(11,ze,2,1,"span",14),e.qZA(),e.TgZ(12,"td",32),e.YNc(13,We,2,1,"ng-container",14),e.YNc(14,Ve,2,1,"span",14),e.qZA(),e.TgZ(15,"td",35),e.YNc(16,Xe,3,4,"ng-container",14),e.YNc(17,et,3,4,"span",14),e.qZA(),e.TgZ(18,"td",32),e.YNc(19,ot,3,2,"ng-container",14),e.YNc(20,rt,4,3,"span",14),e.qZA()()),2&n){const t=e.oxw(),i=t.$implicit,o=t.rowData,c=e.oxw(2);e.Q6J("ttRow",i)("ttSelectableRowDisabled",!o.order&&!o.level||o.level<4)("ttSelectableRow",i),e.xp6(1),e.ekj("text-center",o.order),e.xp6(2),e.Q6J("rowNode",i),e.xp6(1),e.Q6J("ngIf",!o.order),e.xp6(1),e.Q6J("ngIf",4===o.level),e.xp6(1),e.Q6J("ngIf",c.showClosedInvoices),e.xp6(2),e.Q6J("ngIf",o.order),e.xp6(1),e.Q6J("ngIf",4===o.level),e.xp6(2),e.Q6J("ngIf",4===o.level),e.xp6(2),e.Q6J("ngIf",o.order),e.xp6(1),e.Q6J("ngIf",4===o.level),e.xp6(2),e.Q6J("ngIf",o.order),e.xp6(1),e.Q6J("ngIf",4===o.level),e.xp6(2),e.Q6J("ngIf",o.order),e.xp6(1),e.Q6J("ngIf",4===o.level&&o.plan)}}function at(n,r){1&n&&e.YNc(0,ct,21,18,"tr",52),2&n&&e.Q6J("ngIf",!r.rowData.hideFromTable)}function st(n,r){1&n&&e._UZ(0,"i",42)}function lt(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function _t(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e.YNc(2,st,1,0,"i",41),e.YNc(3,lt,2,0,"span",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoadingInvoices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingInvoices)}}function ut(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16)(2,"p-treeTable",45,18),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedInvoiceNode=o)}),e.YNc(4,Le,14,1,"ng-template",20),e.YNc(5,Ye,7,9,"ng-template",19),e.YNc(6,at,1,1,"ng-template",21),e.YNc(7,_t,4,3,"ng-template",22),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("value",t.invoiceManufacturedTree)("selection",t.selectedInvoiceNode)("scrollable",!0)}}function dt(n,r){1&n&&(e.TgZ(0,"p",30),e._uU(1," \u0421hoose the Own Production Invoice to view Items "),e.qZA())}const ae=function(n){return["../","order",n]};function pt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.YNc(1,dt,2,0,"p",26),e._UZ(2,"a",27),e.TgZ(3,"button",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("list"))}),e.qZA(),e.TgZ(4,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedOrderItem),e.xp6(1),e.ekj("disabled",!t.selectedOrderItem),e.Q6J("routerLink",e.VKq(5,ae,null==t.selectedOrderItem?null:t.selectedOrderItem.id)),e.xp6(1),e.Q6J("disabled","list"===t.invoicesOrderType)}}function gt(n,r){1&n&&(e.TgZ(0,"th",61),e._uU(1," QC Closed Date "),e.qZA())}function mt(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",31),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",61),e._uU(4," QC Started Date "),e.qZA(),e.YNc(5,gt,2,0,"th",62),e.TgZ(6,"th",34),e._uU(7,"Order ID"),e.qZA(),e.TgZ(8,"th",35),e._uU(9,"Items Reception Date"),e.qZA(),e.TgZ(10,"th",36),e._uU(11,"Root List"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("ngIf",t.showClosedOrders)}}function ht(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function ft(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.AsE(" ",t.list_product.nomenclature.code,"~",t.list_product.nomenclature.name," ")}}function vt(n,r){if(1&n&&(e.TgZ(0,"tr",37)(1,"td",63),e._uU(2),e.qZA(),e.TgZ(3,"td",61),e._uU(4),e.ALo(5,"date"),e.YNc(6,ht,2,0,"b",14),e.qZA(),e.TgZ(7,"td",34),e._uU(8),e.qZA(),e.TgZ(9,"td",35),e._uU(10),e.ALo(11,"date"),e.qZA(),e.TgZ(12,"td",36),e.YNc(13,ft,2,2,"div",59),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",e.xi3(5,7,null!=t&&t.qc_started_date?null==t?null:t.qc_started_date:null==t?null:t.created,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.contains_rma_invoices),e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.hij(" ",e.xi3(11,10,t.items_reception_date,"dd/MM/yyyy")," "),e.xp6(3),e.Q6J("ngForOf",t.unique_root_production_plans)}}function xt(n,r){1&n&&e._UZ(0,"i",42)}function Zt(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function qt(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e.YNc(2,xt,1,0,"i",41),e.YNc(3,Zt,2,0,"span",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoadingOrders),e.xp6(1),e.Q6J("ngIf",!t.isLoadingOrders)}}function yt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",43),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Tt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",44)(1,"p-button",43),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function Ct(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16)(2,"p-table",17,60),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedOrderItem=o)}),e.YNc(4,pt,5,7,"ng-template",19),e.YNc(5,mt,12,1,"ng-template",20),e.YNc(6,vt,14,13,"ng-template",21),e.YNc(7,qt,4,3,"ng-template",22),e.YNc(8,yt,2,0,"ng-template",23),e.qZA()(),e.YNc(9,Tt,3,0,"div",24),e.BQk()}if(2&n){const t=e.MAs(3),i=e.oxw();e.xp6(2),e.Q6J("scrollable",!0)("paginator",i.ordersList.length>0)("rows",10)("selection",i.selectedOrderItem)("value",i.ordersList),e.xp6(7),e.Q6J("ngIf",!t.paginator&&!i.isLoadingOrders&&i.ordersList.length>0)}}function bt(n,r){1&n&&(e.TgZ(0,"th",32),e._uU(1,"QC Closed Date"),e.qZA())}function Qt(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",46),e._uU(2,"QC Started Date"),e.qZA(),e.YNc(3,bt,2,0,"th",64),e.TgZ(4,"th",35),e._uU(5,"Order ID"),e.qZA(),e.TgZ(6,"th",65),e._uU(7,"Items Reception Date"),e.qZA(),e.TgZ(8,"th",32),e._uU(9,"Root List"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.showClosedOrders)}}function At(n,r){1&n&&(e.TgZ(0,"p",30),e._uU(1," Choose Own Production Item to view Items "),e.qZA())}function Pt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.YNc(1,At,2,0,"p",26),e._UZ(2,"a",27),e.TgZ(3,"button",48),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.expandCollapseAllOrders())}),e.qZA(),e.TgZ(4,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.expandCollapseAllOrders(!1))}),e.qZA(),e.TgZ(5,"button",50),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("list"))}),e.qZA(),e.TgZ(6,"button",51),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedOrderNode),e.xp6(1),e.ekj("disabled",!t.selectedOrderNode),e.Q6J("routerLink",e.VKq(7,ae,null==t.selectedOrderNode?null:t.selectedOrderNode.data.order.id)),e.xp6(1),e.Q6J("disabled",t.isLoadingOrders),e.xp6(1),e.Q6J("disabled",t.isLoadingOrders),e.xp6(2),e.Q6J("disabled","hierarchy"===t.invoicesOrderType)}}function It(n,r){if(1&n&&(e.TgZ(0,"i",58),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij("(",t.categories,")")}}function wt(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function Nt(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.YNc(3,wt,2,0,"b",14),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.xi3(2,2,t.order.qc_started_date?t.order.qc_started_date:t.order.created,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.order.contains_rma_invoices)}}function Ut(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(3).rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.order.qc_closed_date,"dd/MM/yyyy HH:mm")," ")}}function St(n,r){if(1&n&&(e.TgZ(0,"td",32),e.YNc(1,Ut,3,4,"span",14),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.Q6J("ngIf",t.order)}}function Ot(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.ekj("text-warning",t.order.unique_root_production_plans.length>1),e.xp6(1),e.hij(" ",t.order.id," ")}}function kt(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.order.items_reception_date,"dd/MM/yyyy")," ")}}function Jt(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.AsE(" ",t.plan.list_product.nomenclature.code,"~",t.plan.list_product.nomenclature.name," ")}}function Mt(n,r){if(1&n&&(e.TgZ(0,"tr",67)(1,"td",36)(2,"div",54),e._UZ(3,"p-treeTableToggler",55),e.TgZ(4,"span"),e._uU(5),e.YNc(6,It,2,1,"i",57),e.qZA(),e.YNc(7,Nt,4,5,"span",14),e.qZA()(),e.YNc(8,St,2,1,"td",64),e.TgZ(9,"td",35),e.YNc(10,Ot,2,3,"span",56),e.qZA(),e.TgZ(11,"td",65),e.YNc(12,kt,3,4,"span",14),e.qZA(),e.TgZ(13,"td",32),e.YNc(14,Jt,2,2,"span",14),e.qZA()()),2&n){const t=e.oxw(),i=t.$implicit,o=t.rowData,c=e.oxw(2);e.Q6J("ttRow",i)("ttSelectableRow",i)("ttSelectableRowDisabled",o.level<4),e.xp6(3),e.Q6J("rowNode",i),e.xp6(1),e.ekj("category-name",0===o.level),e.xp6(1),e.hij(" ",o.name," "),e.xp6(1),e.Q6J("ngIf",o.level<4),e.xp6(1),e.Q6J("ngIf",o.order),e.xp6(1),e.Q6J("ngIf",c.showClosedOrders),e.xp6(2),e.Q6J("ngIf",o.order),e.xp6(2),e.Q6J("ngIf",o.order),e.xp6(2),e.Q6J("ngIf",o.order&&o.plan)}}function Lt(n,r){1&n&&e.YNc(0,Mt,15,13,"tr",66),2&n&&e.Q6J("ngIf",!r.rowData.hideFromTable)}function Dt(n,r){1&n&&e._UZ(0,"i",42)}function Yt(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Et(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e.YNc(2,Dt,1,0,"i",41),e.YNc(3,Yt,2,0,"span",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoadingOrders),e.xp6(1),e.Q6J("ngIf",!t.isLoadingOrders)}}function Ft(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16)(2,"p-treeTable",45,18),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedOrderNode=o)}),e.YNc(4,Qt,10,1,"ng-template",20),e.YNc(5,Pt,7,9,"ng-template",19),e.YNc(6,Lt,1,1,"ng-template",21),e.YNc(7,Et,4,3,"ng-template",22),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("value",t.ownProductionCategorizedList)("selection",t.selectedOrderNode)("scrollable",!0)}}function Rt(n,r){1&n&&(e.TgZ(0,"p",30),e._uU(1," Choose the General Procurement Invoice to view Items "),e.qZA())}function jt(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.YNc(1,Rt,2,0,"p",26),e._UZ(2,"a",27),e.TgZ(3,"button",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectPurchaseType("list"))}),e.qZA(),e.TgZ(4,"button",29),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectPurchaseType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedInvoicePurchaseItem),e.xp6(1),e.ekj("disabled",!t.selectedInvoicePurchaseItem),e.Q6J("routerLink",e.VKq(5,B,null==t.selectedInvoicePurchaseItem?null:t.selectedInvoicePurchaseItem.id)),e.xp6(1),e.Q6J("disabled","list"===t.invoicesPurchasedType)}}function $t(n,r){1&n&&(e.TgZ(0,"th",32),e._uU(1,"QC Closed Date"),e.qZA())}function Gt(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",31),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",32),e._uU(4,"QC Started Date"),e.qZA(),e.YNc(5,$t,2,0,"th",33),e.TgZ(6,"th",34),e._uU(7,"Invoice Number"),e.qZA(),e.TgZ(8,"th",35),e._uU(9,"Supplier"),e.qZA(),e.TgZ(10,"th",34),e._uU(11,"Order ID"),e.qZA(),e.TgZ(12,"th",35),e._uU(13,"Items Reception Date"),e.qZA(),e.TgZ(14,"th",36),e._uU(15,"Root List"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("ngIf",t.showClosedInvoices)}}function Bt(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function Ht(n,r){if(1&n&&(e.TgZ(0,"td",32),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,null==t.order?null:t.order.qc_closed_date,"dd/MM/yyyy HH:mm")," ")}}function Kt(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.root_production_plans[0].list_product.nomenclature.code," ~",t.root_production_plans[0].list_product.nomenclature.name," ")}}function zt(n,r){if(1&n&&(e.TgZ(0,"tr",37)(1,"td",31),e._uU(2),e.qZA(),e.TgZ(3,"td",32),e._uU(4),e.ALo(5,"date"),e.YNc(6,Bt,2,0,"b",14),e.qZA(),e.YNc(7,Ht,3,4,"td",33),e.TgZ(8,"td",34),e._uU(9),e.qZA(),e.TgZ(10,"td",35),e._uU(11),e.qZA(),e.TgZ(12,"td",34),e._uU(13),e.qZA(),e.TgZ(14,"td",35),e._uU(15),e.ALo(16,"date"),e.qZA(),e.TgZ(17,"td",36),e.YNc(18,Kt,2,2,"ng-container",14),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(2),e.hij(" ",i+1," "),e.xp6(2),e.hij(" ",e.xi3(5,11,null!=t.order&&t.order.qc_started_date?null==t.order?null:t.order.qc_wh_started_date:t.system_creation_date,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.rma_products_count),e.xp6(1),e.Q6J("ngIf",o.showClosedInvoices),e.xp6(2),e.AsE(" ",t.self_serial_number," ",t.self_proforma_serial_number," "),e.xp6(2),e.hij(" ",null==t.supplier?null:t.supplier.name," "),e.xp6(2),e.hij(" ",null==t.order?null:t.order.id," "),e.xp6(2),e.hij(" ",e.xi3(16,14,t.items_reception_date,"dd/MM/yyyy")," "),e.xp6(3),e.Q6J("ngIf",t.root_production_plans.length>0)}}function Wt(n,r){1&n&&e._UZ(0,"i",42)}function Vt(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Xt(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e.YNc(2,Wt,1,0,"i",41),e.YNc(3,Vt,2,0,"span",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoadingInvoices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingInvoices)}}function en(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",43),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function tn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",44)(1,"p-button",43),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function nn(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16)(2,"p-table",17,68),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedInvoicePurchaseItem=o)}),e.YNc(4,jt,5,7,"ng-template",19),e.YNc(5,Gt,16,1,"ng-template",20),e.YNc(6,zt,19,17,"ng-template",21),e.YNc(7,Xt,4,3,"ng-template",22),e.YNc(8,en,2,0,"ng-template",23),e.qZA()(),e.YNc(9,tn,3,0,"div",24),e.BQk()}if(2&n){const t=e.MAs(3),i=e.oxw();e.xp6(2),e.Q6J("scrollable",!0)("paginator",i.purchasedInvoicesList.length>0)("rows",10)("selection",i.selectedInvoicePurchaseItem)("value",i.purchasedInvoicesList),e.xp6(7),e.Q6J("ngIf",!t.paginator&&!i.isLoadingInvoices&&i.purchasedInvoicesList.length>0)}}function on(n,r){1&n&&(e.TgZ(0,"th",32),e._uU(1," QC Closed Date "),e.qZA())}function rn(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",46),e._uU(2,"QC Started Date"),e.qZA(),e.YNc(3,on,2,0,"th",33),e.TgZ(4,"th",35),e._uU(5,"Invoice Number"),e.qZA(),e.TgZ(6,"th",34),e._uU(7,"Order ID"),e.qZA(),e.TgZ(8,"th",32),e._uU(9,"Supplier"),e.qZA(),e.TgZ(10,"th",35),e._uU(11,"Items Reception Date"),e.qZA(),e.TgZ(12,"th",32),e._uU(13,"Root List"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngIf",t.showClosedInvoices)}}function cn(n,r){1&n&&(e.TgZ(0,"p",30),e._uU(1," Choose the General Procurement Invoice to view Items "),e.qZA())}function an(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.YNc(1,cn,2,0,"p",26),e._UZ(2,"a",27),e.TgZ(3,"button",48),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.expandCollapsePurchasedInvoices())}),e.qZA(),e.TgZ(4,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.expandCollapsePurchasedInvoices(!1))}),e.qZA(),e.TgZ(5,"button",50),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectPurchaseType("list"))}),e.qZA(),e.TgZ(6,"button",51),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectPurchaseType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedPurchasedInvoiceNode),e.xp6(1),e.ekj("disabled",!t.selectedPurchasedInvoiceNode),e.Q6J("routerLink",e.VKq(7,B,null!=t.selectedPurchasedInvoiceNode&&t.selectedPurchasedInvoiceNode.data.invoice?null==t.selectedPurchasedInvoiceNode?null:t.selectedPurchasedInvoiceNode.data.invoice.id:null==t.selectedPurchasedInvoiceNode?null:t.selectedPurchasedInvoiceNode.data.id)),e.xp6(1),e.Q6J("disabled",t.isLoadingInvoices),e.xp6(1),e.Q6J("disabled",t.isLoadingInvoices),e.xp6(2),e.Q6J("disabled","hierarchy"===t.invoicesPurchasedType)}}function sn(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij("(",t.description,")")}}function ln(n,r){if(1&n&&(e.TgZ(0,"i",58),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij("(",t.categories,")")}}function _n(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.YNc(3,sn,2,1,"span",14),e.YNc(4,ln,2,1,"i",57),e.qZA(),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.ekj("category-name",!t.level&&1!==t.level),e.xp6(1),e.hij("",t.name," "),e.xp6(1),e.Q6J("ngIf",t.description),e.xp6(1),e.Q6J("ngIf",t.level<4&&t.level>0)}}function un(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function dn(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"date"),e.YNc(4,un,2,0,"b",14),e.qZA(),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(2),e.hij(" ",e.xi3(3,2,t.order.qc_started_date?t.order.qc_started_date:t.system_creation_date,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",t.order.rma_products_count)}}function pn(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.order.qc_closed_date,"dd/MM/yyyy HH:mm")," ")}}function gn(n,r){if(1&n&&(e.TgZ(0,"td",32),e.YNc(1,pn,3,4,"span",14),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngIf",t.order)}}function mn(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.AsE(" ",t.self_serial_number," ",t.self_proforma_serial_number," ")}}function hn(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("text-warning",t.invoice.unique_root_production_plans.length>1),e.xp6(1),e.AsE(" ",t.invoice.self_serial_number," ",t.invoice.self_proforma_serial_number," ")}}function fn(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",t.order.id," ")}}function vn(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",null==t.supplier?null:t.supplier.name," ")}}function xn(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",null==t.invoice.supplier?null:t.invoice.supplier.name," ")}}function Zn(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.items_reception_date,"dd/MM/yyyy")," ")}}function qn(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.invoice.items_reception_date,"dd/MM/yyyy")," ")}}function yn(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.list_product.nomenclature.name," ")}}function Tn(n,r){if(1&n&&(e.ynx(0),e.YNc(1,yn,2,1,"div",59),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.unique_root_production_plans)}}function Cn(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.TgZ(2,"span"),e._uU(3),e.qZA()()),2&n){const t=e.oxw().rowData;e.xp6(1),e.AsE(" ",t.plan.list_product.nomenclature.code,"~",t.plan.list_product.nomenclature.name," "),e.xp6(2),e.hij("(",t.plan.required_quantity,")")}}function bn(n,r){if(1&n&&(e.TgZ(0,"tr",53)(1,"td",36)(2,"div",54),e._UZ(3,"p-treeTableToggler",55),e.YNc(4,_n,5,5,"ng-container",14),e.YNc(5,dn,5,5,"ng-container",14),e.qZA()(),e.YNc(6,gn,2,1,"td",33),e.TgZ(7,"td",35),e.YNc(8,mn,2,2,"ng-container",14),e.YNc(9,hn,2,4,"span",56),e.qZA(),e.TgZ(10,"td",34),e.YNc(11,fn,2,1,"ng-container",14),e.qZA(),e.TgZ(12,"td",32),e.YNc(13,vn,2,1,"ng-container",14),e.YNc(14,xn,2,1,"span",14),e.qZA(),e.TgZ(15,"td",35),e.YNc(16,Zn,3,4,"ng-container",14),e.YNc(17,qn,3,4,"span",14),e.qZA(),e.TgZ(18,"td",36),e.YNc(19,Tn,2,1,"ng-container",14),e.YNc(20,Cn,4,3,"span",14),e.qZA()()),2&n){const t=r.$implicit,i=r.rowData,o=e.oxw(2);e.Q6J("ttRow",t)("ttSelectableRowDisabled",!i.order&&!i.level||i.level<4)("ttSelectableRow",t),e.xp6(1),e.ekj("text-center",i.order),e.xp6(2),e.Q6J("rowNode",t),e.xp6(1),e.Q6J("ngIf",!i.order),e.xp6(1),e.Q6J("ngIf",i.order),e.xp6(1),e.Q6J("ngIf",o.showClosedInvoices),e.xp6(2),e.Q6J("ngIf",i.order),e.xp6(1),e.Q6J("ngIf",4===i.level),e.xp6(2),e.Q6J("ngIf",i.order),e.xp6(2),e.Q6J("ngIf",i.order),e.xp6(1),e.Q6J("ngIf",4===i.level),e.xp6(2),e.Q6J("ngIf",i.order),e.xp6(1),e.Q6J("ngIf",4===i.level),e.xp6(2),e.Q6J("ngIf",i.order),e.xp6(1),e.Q6J("ngIf",4===i.level&&i.plan)}}function Qn(n,r){1&n&&e._UZ(0,"i",42)}function An(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Pn(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e.YNc(2,Qn,1,0,"i",41),e.YNc(3,An,2,0,"span",14),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoadingInvoices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingInvoices)}}function In(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",16)(2,"p-treeTable",45,18),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedPurchasedInvoiceNode=o)}),e.YNc(4,rn,14,1,"ng-template",20),e.YNc(5,an,7,9,"ng-template",19),e.YNc(6,bn,21,18,"ng-template",21),e.YNc(7,Pn,4,3,"ng-template",22),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("value",t.invoicePurchasedTree)("selection",t.selectedPurchasedInvoiceNode)("scrollable",!0)}}let wn=(()=>{class n{constructor(t,i,o,c,a){this.invoiceService=t,this.orderService=i,this.productStructureCategoryService=o,this.adapterService=c,this.fb=a,this.invoicesViewType="hierarchy",this.invoicesOrderType="hierarchy",this.invoicesPurchasedType="hierarchy",this.isLoadingInvoices=!0,this.isLoadingOrders=!0,this.showClosedInvoices=!1,this.showClosedOrders=!1,this.invoicesList=[],this.ordersList=[],this.purchasedInvoicesList=[],this.expanseMap={},this.destroyInvoices$=new b.x,this.destroyOrders$=new b.x,this.invoicesQuery=[{name:"needs_qc",value:!0},{name:"by_qc_module_permission",value:!0}],this.ordersQuery=[{name:"needs_qc",value:!0},{name:"by_qc_module_permission",value:!0}],this.searchForm=this.fb.group({supplier:[null],qc_closed_date_after:[null],qc_closed_date_before:[null],accounting_type:[null],material_or_service:[null],purchase_categories:[null],status:[null]})}ngOnInit(){this.getCategories(),this.getInvoices(),this.getServices()}searchItems(){this.searchInvoices(),this.searchServices()}searchInvoices(){this.isLoadingInvoices=!0,this.destroyInvoices$.next(!0),this.invoiceManufacturedTree=[],this.invoicePurchasedTree=[],this.invoicesList=[],this.purchasedInvoicesList=[],this.invoices=[],this.selectedInvoice=null,this.invoicesQuery=[{name:"by_qc_module_permission",value:!0}],this.searchForm.get("qc_closed_date_after").value||this.searchForm.get("qc_closed_date_before").value?this.showClosedInvoices=!0:(this.invoicesQuery.push({name:"needs_qc",value:!0}),this.showClosedInvoices=!1),this.searchForm.get("qc_closed_date_after").value&&this.invoicesQuery.push({name:"qc_closed_date_after",value:this.adapterService.dateAdapter(this.searchForm.get("qc_closed_date_after").value)}),this.searchForm.get("qc_closed_date_before").value&&this.invoicesQuery.push({name:"qc_closed_date_before",value:this.adapterService.dateAdapter(this.searchForm.get("qc_closed_date_before").value)}),this.getInvoices()}searchServices(){this.isLoadingOrders=!0,this.destroyOrders$.next(!0),this.orders=[],this.ordersList=[],this.ownProductionCategorizedList=[],this.selectedOrderItem=null,this.ordersQuery=[{name:"by_qc_module_permission",value:!0}],this.searchForm.get("qc_closed_date_after").value||this.searchForm.get("qc_closed_date_before").value?this.showClosedOrders=!0:(this.ordersQuery.push({name:"needs_qc",value:!0}),this.showClosedOrders=!1),this.searchForm.get("qc_closed_date_after").value&&this.ordersQuery.push({name:"qc_closed_date_after",value:this.adapterService.dateAdapter(this.searchForm.get("qc_closed_date_after").value)}),this.searchForm.get("qc_closed_date_before").value&&this.ordersQuery.push({name:"qc_closed_date_before",value:this.adapterService.dateAdapter(this.searchForm.get("qc_closed_date_before").value)}),this.getServices()}mapExpansion(){this.categories.forEach(t=>{this.createExpanseMap(t)})}createExpanseMap(t){this.expanseMap[t.data.id]=!!t.expanded&&t.expanded,t.children&&t.children.forEach(i=>{this.createExpanseMap(i)})}getCategories(){this.productStructureCategoryService.get().pipe((0,A.R)(this.destroyInvoices$)).subscribe(t=>{this.categories&&this.mapExpansion(),this.createTree(t)})}getInvoices(){this.invoiceService.get(this.invoicesQuery).pipe((0,A.R)(this.destroyInvoices$)).subscribe(t=>{t.forEach(i=>{i.order=new Ze.K(i.order),i.order.generateUniqueToolRequests()}),this.invoices=t,this.makeUniqueProductionPlansInvoice(),this.resetProductPaymentTree(),this.resetInvoicesList(),this.isLoadingInvoices=!1})}getServices(){this.orderService.get(this.ordersQuery).pipe((0,A.R)(this.destroyOrders$)).subscribe(t=>{this.orders=t,this.makeUniqueProductionPlans(),this.fillOwnProductionWithData(),this.resetOrdersList(),this.isLoadingOrders=!1})}resetInvoicesList(){this.purchasedInvoicesList=this.invoices.filter(t=>t.purchase_category),this.invoicesList=this.invoices.filter(t=>!t.purchase_category),this.invoicesList.sort((t,i)=>i.rma_products_count-t.rma_products_count||new Date(i.qc_started_date).getTime()-new Date(t.qc_started_date).getTime()),this.purchasedInvoicesList.sort((t,i)=>i.rma_products_count-t.rma_products_count||new Date(i.qc_started_date).getTime()-new Date(t.qc_started_date).getTime())}resetOrdersList(){this.ordersList=this.orders}resetProductPaymentTree(){const t=[];this.invoices.forEach(i=>{const o=i.purchase_category;o?t.findIndex(a=>a.id===o.id)<0&&t.push({name:o.name,id:o.id,description:o.description}):(1===i.order?.accounting_type&&t.findIndex(a=>-2===a.id)<0&&t.push({name:"Production Lists Procurement",id:-2,description:"",level:0}),2===i.order?.accounting_type&&t.findIndex(a=>-1===a.id)<0&&t.push({name:"Outsourcing",id:-1,description:"",level:0}))}),t.sort((i,o)=>i.id-o.id),this.invoiceTree=[],t.forEach(i=>{this.invoiceTree.push({data:i,expanded:!1,parent:null})}),this.createPaymentTree()}createPaymentTree(){this.invoiceTree=this.invoiceTree.map(t=>({...t,children:[]})),this.invoiceTree.forEach(t=>{if(this.invoices.filter(i=>i.purchase_category).forEach(i=>{const o=i.purchase_category;o&&o.id===t.data.id&&t.children.push({data:i,expanded:!1,children:[]})}),-2===t.data.id){const i=this.invoices.filter(o=>!o.purchase_category&&1===o.order?.accounting_type);t.children=P(this.categories),this.prepareInnerTreeCategories(i,t)}if(-1===t.data.id){const i=this.invoices.filter(o=>!o.purchase_category&&2===o.order?.accounting_type);t.children=P(this.categories),this.prepareInnerTreeCategories(i,t)}}),this.separatePurchasedAndManufactured()}prepareInnerTreeCategories(t,i){const o=[];t.forEach(a=>{if(a.unique_root_production_plans.forEach(s=>{if(s.root_nomenclature&&s.root_nomenclature.root_category){const u=s.root_nomenclature.root_category.id,h=s.root_nomenclature.root_category.name,f=1,d=s.root_nomenclature.id,Y=s.root_nomenclature.name,w=2;o.findIndex(F=>F.id===u&&f===F.level)<0&&o.push({id:u,level:f,name:h,parentId:null}),o.findIndex(F=>F.id===d&&w===F.level)<0&&o.push({id:d,level:w,name:Y,parentId:u})}else o.findIndex(h=>-2===h.id)<0&&o.push({id:-2,level:1,name:"No root nomenclature",parentId:null})}),a.unique_root_production_plans.length<1){const s=i.children.findIndex(u=>-1===u.data.id);s<0?i.children.push({data:{id:-1,level:0,name:"No Root List",parentId:null},expanded:!1,children:[{data:{order:a,plan:null,level:4},expanded:!1,children:[]}]}):i.children[s].children.push({data:{order:a,plan:null,level:4},expanded:!1,children:[]})}});const c=P(i.children);c.forEach(a=>{this.appendCategories(a,o)}),c.forEach(a=>{this.fillWithTheData(a,t)}),c.forEach(a=>{this.removeUpdateEmptyCategories(a)}),i.children=c}separatePurchasedAndManufactured(){this.invoicePurchasedTree=this.invoiceTree.filter(t=>t.data.id>=0),this.invoiceManufacturedTree=this.invoiceTree.filter(t=>t.data.id<0),console.log(this.invoiceManufacturedTree)}makeUniqueProductionPlans(){this.orders.forEach(t=>{t.unique_root_production_plans=[],t.root_production_plans.forEach(i=>{if(i.root_nomenclature){const o=i.root_nomenclature.id;t.unique_root_production_plans.findIndex(a=>a.root_nomenclature.id===o)<0&&t.unique_root_production_plans.push(i)}})})}makeUniqueProductionPlansInvoice(){this.invoices.forEach(t=>{t.unique_root_production_plans=[],t.root_production_plans.forEach(i=>{if(i.root_nomenclature){const o=i.root_nomenclature.id;t.unique_root_production_plans.findIndex(a=>a.root_nomenclature.id===o)<0&&t.unique_root_production_plans.push(i)}})})}createTree(t){const i=[];t.forEach(a=>{const s={data:a,expanded:!1};this.expanseMap&&(s.expanded=this.expanseMap[a.id]),i.push(s)});const o=[],c=i.reduce((a,s,u)=>(a[s.data.id]=u,a),{});i.forEach(a=>{if(null===a.data.parent)return void o.push(a);const s=i[c[a.data.parent]];s.children=[...s.children||[],a],0===s.children.length&&delete s.children}),this.categories=o,this.ownProductionCategorizedList=P(this.categories)}fillOwnProductionWithData(){this.fillCategorizedTree()}fillCategorizedTree(){this.ownProductionCategorizedList=P(this.categories);const t=[];if(this.orders.forEach(i=>{if(i.unique_root_production_plans.forEach(o=>{if(o.root_nomenclature&&o.root_nomenclature.root_category){const c=o.root_nomenclature.root_category.id,a=o.root_nomenclature.root_category.name,s=1,u=o.root_nomenclature.id,h=o.root_nomenclature.name,f=2;t.findIndex(w=>w.id===c&&s===w.level)<0&&t.push({id:c,level:s,name:a,parentId:null}),t.findIndex(w=>w.id===u&&f===w.level)<0&&t.push({id:u,level:f,name:h,parentId:c})}}),i.unique_root_production_plans.length<1){const o=this.ownProductionCategorizedList.findIndex(c=>-1===c.data.id);o<0?this.ownProductionCategorizedList.push({data:{id:-1,level:0,name:"No Root List",parentId:null},expanded:!1,children:[{data:{order:i,plan:null,level:4},expanded:!1,children:[]}]}):this.ownProductionCategorizedList[o].children.push({data:{order:i,plan:null,level:4},expanded:!1,children:[]})}}),this.ownProductionCategorizedList){const i=P(this.ownProductionCategorizedList);i.forEach(o=>{this.appendCategories(o,t)}),i.forEach(o=>{this.fillWithTheData(o,this.orders)}),i.forEach(o=>{this.removeUpdateEmptyCategories(o)}),this.ownProductionCategorizedList=i,this.isLoadingOrders=!1}}appendCategories(t,i){t.children||(t.children=[]),i.forEach(o=>{o.parentId===t.data.id&&t.children.push({data:{id:o.id,name:o.name,level:o.level,parentId:o.parentId,isCategory:!0,categories:0},expanded:!1,children:[]})}),t.children&&t.children.forEach(o=>{this.appendCategories(o,i)})}fillWithTheData(t,i){t.children||(t.children=[]),t.data.isCategory&&i.forEach(o=>{o.unique_root_production_plans.forEach(c=>{if(c.root_nomenclature&&t.data.id===c.root_nomenclature.id){const s=t.children.findIndex(u=>u.data.id===c.list_product.nomenclature.id);s<0?t.children.push({data:{id:c.list_product.nomenclature.id,name:c.list_product.nomenclature.name,level:3,categories:0},expanded:!1,children:[{data:{order:o,plan:c,level:4},expanded:!1,children:[]}]}):t.children[s].children.push({data:{order:o,plan:c,level:4},expanded:!1,children:[]})}})}),t.children&&t.children.forEach(o=>{this.fillWithTheData(o,i)})}removeUpdateEmptyCategories(t){if(!t.data.isCategory&&!t.data.order){let c=function(a){i&&a.children.filter(u=>u.data.order).length>0&&(i=!1),a.children.forEach(s=>{c(s)})},i=!0;t.children.filter(a=>a.data.order).length>0&&(i=!1),t.children.forEach(a=>{c(a)}),t.data.hideFromTable=i}t.data.categories=t.children.length,t.children&&t.children.forEach((i,o)=>{this.removeUpdateEmptyCategories(i)})}expandCollapseAllInvoices(t=!0){const i=P(this.invoiceManufacturedTree);i.forEach(o=>{this.expandCollapseRecursive(o,t)}),this.invoiceManufacturedTree=i}expandCollapseRecursive(t,i){t.expanded=i,t.children&&t.children.forEach(o=>{this.expandCollapseRecursive(o,i)})}expandCollapsePurchasedInvoices(t=!0){const i=P(this.invoicePurchasedTree);i.forEach(o=>{this.expandCollapseRecursive(o,t)}),this.invoicePurchasedTree=i}expandCollapseAllOrders(t=!0){const i=P(this.ownProductionCategorizedList);i.forEach(o=>{this.expandCollapseRecursive(o,t)}),this.ownProductionCategorizedList=i}onSelectInvoiceType(t){this.invoicesViewType=t}onSelectOrderType(t){this.invoicesOrderType=t}onSelectPurchaseType(t){this.invoicesPurchasedType=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(oe.q),e.Y36(R.p),e.Y36(re.z),e.Y36(j.v),e.Y36(l.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-list"]],decls:30,vars:17,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"page__tabs"],[1,"form","mb-3",3,"formGroup"],[1,"row"],[1,"col-3"],[1,"form-group"],["formControlName","qc_closed_date_after","dateFormat","dd/mm/yy","dataType","date",3,"readonlyInput","showButtonBar","ngModelChange"],["formControlName","qc_closed_date_before","dateFormat","dd/mm/yy","dataType","date",3,"readonlyInput","showButtonBar","ngModelChange"],[1,"custom-tabs"],[3,"header","selected"],[4,"ngIf"],[3,"header"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)","dataKey","id",3,"scrollable","paginator","rows","selection","value","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"d-flex"],["class","subtitle",4,"ngIf"],["pButton","","type","button","icon","pi pi-bars","label","Items","target","_blank",1,"ml-auto","mr-2",3,"routerLink"],["pButton","","type","button","label","List","icon","pi pi-list",1,"mr-2",3,"disabled","click"],["pButton","","type","button","label","Hierarchy","icon","pi pi-table",3,"click"],[1,"subtitle"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","20%"],["style","width: 20%","class","text-center",4,"ngIf"],[1,"text-center",2,"width","10%"],[1,"text-center",2,"width","15%"],[2,"width","20%"],[3,"pSelectableRow"],["class","word-break",4,"ngFor","ngForOf"],[1,"word-break"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],["selectionMode","single","scrollHeight","calc(100vh - 22rem)",3,"value","selection","scrollable","selectionChange"],[2,"width","20%","padding-left","19px"],["target","_blank","pButton","","type","button","icon","pi pi-bars","label","Items",1,"ml-auto","mr-2",3,"routerLink"],["pButton","","type","button","label","Expand All","icon","pi pi-angle-down",1,"mr-2",3,"disabled","click"],["pButton","","type","button","label","Collapse All","icon","pi pi-angle-up",1,"mr-2",3,"disabled","click"],["pButton","","type","button","label","List","icon","pi pi-list",1,"mr-2",3,"click"],["pButton","","type","button","label","Hierarchy","icon","pi pi-table",3,"disabled","click"],[3,"ttRow","ttSelectableRowDisabled","ttSelectableRow",4,"ngIf"],[3,"ttRow","ttSelectableRowDisabled","ttSelectableRow"],[1,"table-toggle"],[3,"rowNode"],[3,"text-warning",4,"ngIf"],["style","font-style: normal",4,"ngIf"],[2,"font-style","normal"],[4,"ngFor","ngForOf"],["ot",""],[1,"text-center",2,"width","25%"],["style","width: 25%","class","text-center",4,"ngIf"],[1,"text-center"],["style","width: 20%;","class","text-center",4,"ngIf"],[1,"text-center",2,"width","45%"],[3,"ttRow","ttSelectableRow","ttSelectableRowDisabled",4,"ngIf"],[3,"ttRow","ttSelectableRow","ttSelectableRowDisabled"],["pt",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Invoices"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"form",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"label"),e._uU(13,"QC Closed Date From"),e.qZA(),e.TgZ(14,"p-calendar",10),e.NdJ("ngModelChange",function(){return i.searchItems()}),e.qZA()()(),e.TgZ(15,"div",8)(16,"div",9)(17,"label"),e._uU(18,"QC Closed Date To"),e.qZA(),e.TgZ(19,"p-calendar",11),e.NdJ("ngModelChange",function(){return i.searchItems()}),e.qZA()()()()(),e.TgZ(20,"p-tabView",12)(21,"p-tabPanel",13),e.YNc(22,Je,10,6,"ng-container",14),e.YNc(23,ut,8,3,"ng-container",14),e.qZA(),e.TgZ(24,"p-tabPanel",15),e.YNc(25,Ct,10,6,"ng-container",14),e.YNc(26,Ft,8,3,"ng-container",14),e.qZA(),e.TgZ(27,"p-tabPanel",15),e.YNc(28,nn,10,6,"ng-container",14),e.YNc(29,In,8,3,"ng-container",14),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("module","quality-control")("isActive",!0),e.xp6(5),e.Q6J("formGroup",i.searchForm),e.xp6(6),e.Q6J("readonlyInput",!0)("showButtonBar",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showButtonBar",!0),e.xp6(2),e.Q6J("header","Production Lists Procurement and Outsourcing Invoices")("selected",!0),e.xp6(1),e.Q6J("ngIf","list"===i.invoicesViewType),e.xp6(1),e.Q6J("ngIf","hierarchy"===i.invoicesViewType),e.xp6(1),e.Q6J("header","Own Production"),e.xp6(1),e.Q6J("ngIf","list"===i.invoicesOrderType),e.xp6(1),e.Q6J("ngIf","hierarchy"===i.invoicesOrderType),e.xp6(1),e.Q6J("header","General Procurement Invoices"),e.xp6(1),e.Q6J("ngIf","list"===i.invoicesPurchasedType),e.xp6(1),e.Q6J("ngIf","hierarchy"===i.invoicesPurchasedType))},dependencies:[g.sg,g.O5,C.yS,Z.Hq,Z.zx,$.iw,I.jx,$.gc,$.V4,$.e2,l._Y,l.JJ,l.JL,l.sg,l.u,v.iA,v.Ei,N.D,G.xf,G.x4,ce.f,g.uU],styles:[".category-name[_ngcontent-%COMP%]{font-weight:500;overflow-wrap:anywhere}"]}),n})();var X=_(1135),Q=_(2340),Nn=_(4345),x=_(4004),Un=_(195),se=_(529),m=_(6319);let le=(()=>{class n{constructor(t,i){this.httpClient=t,this.dialog=i,this.API_URL=Q.N.base_url+Q.N.production_url,this.url="qc_delivery_statuses/"}get(){return this.httpClient.get(this.API_URL+this.url).pipe((0,x.U)(t=>t.data))}create(t){return this.httpClient.post(this.API_URL+this.url,t).pipe((0,x.U)(i=>i.data))}update(t){return this.httpClient.put(this.API_URL+this.url+`${t.id}/`,t).pipe((0,x.U)(i=>i.data))}updatePartly(t){return this.httpClient.patch(this.API_URL+this.url+`${t.id}/`,t).pipe((0,x.U)(i=>i.data))}delete(t){return this.httpClient.delete(this.API_URL+this.url+t+"/")}createEditStatusModal(t,i,o,c){return this.dialog.open(Un.v,{width:"45rem",height:"auto",data:{type:t,statusType:i,isAutoStatus:o,status:c},autoFocus:!1,panelClass:"modal-overflow-visible",enterAnimationDuration:"250ms"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(se.eN),e.LFG(m.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Sn=_(5722);function On(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-multiSelect",3),e.NdJ("ngModelChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedStatuses=o)})("ngModelChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.onChoiceQcDeliveryStatuses(o))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("ngModel",t.selectedStatuses)("options",t.qcDeliveryStatuses)("showClear",!0)}}function kn(n,r){1&n&&(e.TgZ(0,"div",4),e._UZ(1,"i",5),e.qZA())}let Jn=(()=>{class n{constructor(t){this.qcDeliveryStatusService=t,this.selectStatuses=new e.vpe,this.isFinalStatusSelected=new e.vpe,this.isLoading=!0,this.qcDeliveryStatuses=[],this.selectedStatuses=[],this.destroy$=new b.x}ngOnInit(){this.qcDeliveryStatusService.get().pipe((0,A.R)(this.destroy$)).subscribe(t=>{this.qcDeliveryStatuses=t,this.isLoading=!1})}onChoiceQcDeliveryStatuses(t){this.selectStatuses.emit(t?t.map(i=>i.id):null)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(le))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-delivery-statuses-picker"]],inputs:{accountingType:"accountingType"},outputs:{selectStatuses:"selectStatuses",isFinalStatusSelected:"isFinalStatusSelected"},decls:4,vars:2,consts:[[1,"qc-delivery-status-picker"],["optionLabel","name","placeholder","Qc Delivery Statuses",3,"ngModel","options","showClear","ngModelChange",4,"ngIf","ngIfElse"],["spinner",""],["optionLabel","name","placeholder","Qc Delivery Statuses",3,"ngModel","options","showClear","ngModelChange"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,On,1,3,"p-multiSelect",1),e.YNc(2,kn,2,0,"ng-template",null,2,e.W1O),e.qZA()),2&t){const o=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!i.isLoading)("ngIfElse",o)}},dependencies:[Sn.NU,g.O5,l.JJ,l.On]}),n})();function Mn(n,r){1&n&&(e.TgZ(0,"p",34),e._uU(1," \u0421hoose the Outsoursing Materials Delivery to view Items "),e.qZA())}const Ln=function(n){return["chain",n]};function Dn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e.YNc(1,Mn,2,0,"p",30),e._UZ(2,"a",31),e.TgZ(3,"button",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("list"))}),e.qZA(),e.TgZ(4,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedOrderItem),e.xp6(1),e.ekj("disabled",!t.selectedDeliveryChain),e.Q6J("routerLink",e.VKq(5,Ln,null==t.selectedDeliveryChain?null:t.selectedDeliveryChain.id)),e.xp6(1),e.Q6J("disabled","list"===t.invoicesOrderType)}}function Yn(n,r){1&n&&(e.TgZ(0,"th",36),e._uU(1," QC Closed Date "),e.qZA())}function En(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",35),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",36),e._uU(4," QC Started Date "),e.qZA(),e.YNc(5,Yn,2,0,"th",37),e.TgZ(6,"th",38),e._uU(7,"Delivery Chain ID"),e.qZA(),e.TgZ(8,"th",38),e._uU(9,"Sales Chain ID"),e.qZA(),e.TgZ(10,"th",36),e._uU(11,"Customer"),e.qZA(),e.TgZ(12,"th",38),e._uU(13,"Status"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("ngIf",t.showClosedChains)}}function Fn(n,r){if(1&n&&(e.TgZ(0,"td",44)(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,null==t?null:t.qc_delivery_closed_date,"dd/MM/yyyy HH:mm")," ")}}function Rn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr",39)(1,"td",40),e._uU(2),e.qZA(),e.TgZ(3,"td",36),e._uU(4),e.ALo(5,"date"),e.qZA(),e.YNc(6,Fn,4,4,"td",41),e.TgZ(7,"td",38)(8,"a",42),e.NdJ("click",function(){const c=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.onGoToDeliveryChainLink(c.id))}),e._uU(9),e.qZA()(),e.TgZ(10,"td",38)(11,"a",42),e.NdJ("click",function(){const c=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.onGoToSalesChainLink(c.sales_chain_id))}),e._uU(12),e.qZA()(),e.TgZ(13,"td",36),e._uU(14),e.qZA(),e.TgZ(15,"td",43),e._uU(16),e.qZA()()}if(2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",e.xi3(5,8,t.qc_delivery_started_date,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",o.showClosedChains),e.xp6(3),e.hij(" ",t.id," "),e.xp6(3),e.hij(" ",t.sales_chain_id," "),e.xp6(2),e.hij(" ",null==t.customer?null:t.customer.name," "),e.xp6(2),e.hij(" ",null==t.qc_delivery_status?null:t.qc_delivery_status.name," ")}}function jn(n,r){1&n&&e._UZ(0,"i",47)}function $n(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Gn(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",45),e.YNc(2,jn,1,0,"i",46),e.YNc(3,$n,2,0,"span",17),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoadingChains),e.xp6(1),e.Q6J("ngIf",!t.isLoadingChains)}}function Bn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",48),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Hn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"p-button",48),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function Kn(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"p-table",21,22),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedDeliveryChain=o)}),e.YNc(4,Dn,5,7,"ng-template",23),e.YNc(5,En,14,1,"ng-template",24),e.YNc(6,Rn,17,11,"ng-template",25),e.YNc(7,Gn,4,3,"ng-template",26),e.YNc(8,Bn,2,0,"ng-template",27),e.qZA()(),e.YNc(9,Hn,3,0,"div",28),e.BQk()}if(2&n){const t=e.MAs(3),i=e.oxw();e.xp6(2),e.Q6J("scrollable",!0)("paginator",i.deliveryChainsList.length>0)("rows",10)("selection",i.selectedDeliveryChain)("value",i.deliveryChainsList),e.xp6(7),e.Q6J("ngIf",!t.paginator&&!i.isLoadingChains&&i.ordersList.length>0)}}function zn(n,r){1&n&&(e.ynx(0),e._uU(1," In development "),e.BQk())}function Wn(n,r){1&n&&(e.TgZ(0,"p",34),e._uU(1," \u0421hoose the Outsoursing Materials Delivery to view Items "),e.qZA())}const Vn=function(n){return["../","delivery",n]};function Xn(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e.YNc(1,Wn,2,0,"p",30),e._UZ(2,"a",31),e.TgZ(3,"button",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("list"))}),e.qZA(),e.TgZ(4,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onSelectOrderType("hierarchy"))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!t.selectedOrderItem),e.xp6(1),e.ekj("disabled",!t.selectedOrderItem),e.Q6J("routerLink",e.VKq(5,Vn,null==t.selectedOrderItem?null:t.selectedOrderItem.id)),e.xp6(1),e.Q6J("disabled","list"===t.invoicesOrderType)}}function ei(n,r){1&n&&(e.TgZ(0,"th",36),e._uU(1," QC Closed Date "),e.qZA())}function ti(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",35),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",36),e._uU(4," QC Started Date "),e.qZA(),e.YNc(5,ei,2,0,"th",37),e.TgZ(6,"th",38),e._uU(7,"Order ID"),e.qZA(),e.TgZ(8,"th",50),e._uU(9,"Root List"),e.qZA(),e.TgZ(10,"th",44),e._uU(11,"Technologies"),e.qZA(),e.TgZ(12,"th",38),e._uU(13,"Status"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("ngIf",t.showClosedOrders)}}function ni(n,r){if(1&n&&(e.TgZ(0,"td",44)(1,"span"),e._uU(2),e.ALo(3,"date"),e.qZA()()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",e.xi3(3,1,null==t?null:t.qc_material_closed_date,"dd/MM/yyyy HH:mm")," ")}}function ii(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.AsE(" ",t.list_product.nomenclature.code,"~",t.list_product.nomenclature.name," ")}}function oi(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function ri(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,oi,2,0,"span",17),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",t,""),e.xp6(1),e.Q6J("ngIf",!i)}}function ci(n,r){if(1&n&&(e.TgZ(0,"tr",39)(1,"td",40),e._uU(2),e.qZA(),e.TgZ(3,"td",36),e._uU(4),e.ALo(5,"date"),e.qZA(),e.YNc(6,ni,4,4,"td",41),e.TgZ(7,"td",38),e._uU(8),e.qZA(),e.TgZ(9,"td",50),e.YNc(10,ii,2,2,"div",51),e.qZA(),e.TgZ(11,"td",50),e.YNc(12,ri,3,2,"span",51),e.qZA(),e.TgZ(13,"td",43),e._uU(14),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",e.xi3(5,8,t.qc_material_started_date,"dd/MM/yyyy HH:mm")," "),e.xp6(2),e.Q6J("ngIf",o.showClosedOrders),e.xp6(2),e.hij(" ",t.id," "),e.xp6(2),e.Q6J("ngForOf",t.unique_root_production_plans),e.xp6(2),e.Q6J("ngForOf",t.ordered_products_unique_technologies),e.xp6(2),e.hij(" ",null==t.qc_delivery_status?null:t.qc_delivery_status.name," ")}}function ai(n,r){1&n&&e._UZ(0,"i",47)}function si(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function li(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",45),e.YNc(2,ai,1,0,"i",46),e.YNc(3,si,2,0,"span",17),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoadingOrders),e.xp6(1),e.Q6J("ngIf",!t.isLoadingOrders)}}function _i(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",48),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ui(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",49)(1,"p-button",48),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(3);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function di(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",20)(2,"p-table",21,22),e.NdJ("selectionChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.selectedOrderItem=o)}),e.YNc(4,Xn,5,7,"ng-template",23),e.YNc(5,ti,14,1,"ng-template",24),e.YNc(6,ci,15,11,"ng-template",25),e.YNc(7,li,4,3,"ng-template",26),e.YNc(8,_i,2,0,"ng-template",27),e.qZA()(),e.YNc(9,ui,3,0,"div",28),e.BQk()}if(2&n){const t=e.MAs(3),i=e.oxw();e.xp6(2),e.Q6J("scrollable",!0)("paginator",i.ordersList.length>0)("rows",10)("selection",i.selectedOrderItem)("value",i.ordersList),e.xp6(7),e.Q6J("ngIf",!t.paginator&&!i.isLoadingOrders&&i.ordersList.length>0)}}function pi(n,r){1&n&&(e.ynx(0),e._uU(1," In development "),e.BQk())}function gi(n,r){1&n&&(e.TgZ(0,"div",52),e._UZ(1,"i",53),e.qZA())}let mi=(()=>{class n{constructor(t,i,o,c,a,s){this.deliveryService=t,this.orderService=i,this.productStructureCategoryService=o,this.adapterService=c,this.qcDeliveryStatusService=a,this.fb=s,this.selectedQcDeliveryStatuses=new e.vpe,this.deliveryChains=[],this.link=Q.N.link_url+"dash/",this.invoicesOrderType="list",this.isLoadingOrders=!0,this.isLoadingChains=!0,this.isLoadingStatuses=!0,this.showClosedOrders=!1,this.showClosedChains=!1,this.ordersList=[],this.deliveryChainsList=[],this.expanseMap={},this.search$=new X.X(null),this.destroyOrders$=new b.x,this.destroyChains$=new b.x,this.destroyQcDeliveryStatuses$=new b.x,this.ordersQuery=[{name:"needs_delivery_qc",value:!0},{name:"by_qc_module_permission",value:!0}],this.chainsQuery=[{name:"needs_delivery_qc",value:!0},{name:"by_qc_module_permission",value:!0}],this.searchForm=this.fb.group({supplier:[null],qc_closed_date_after:[null],qc_closed_date_before:[null],qc_delivery_started_date_after:[null],qc_delivery_started_date_before:[null],qc_delivery_closed_date_after:[null],qc_delivery_closed_date_before:[null],accounting_type:[null],material_or_service:[null],purchase_categories:[null],qc_delivery_status:[null],qc_delivery_status__in:[null]})}ngOnInit(){this.getQcDeliveryStatuses(),this.getDeliveryChains(),this.getServices()}searchItems(){this.searchChains(),this.searchServices()}searchChains(){this.isLoadingOrders=!0,this.destroyOrders$.next(!0),this.orders=[],this.selectedOrderItem=null,this.chainsQuery=[{name:"by_qc_module_permission",value:!0}],this.searchForm.get("qc_delivery_closed_date_after").value||this.searchForm.get("qc_delivery_closed_date_before").value?this.showClosedChains=!0:(this.chainsQuery.push({name:"needs_delivery_qc",value:!0}),this.showClosedChains=!1),this.searchForm.get("qc_delivery_started_date_after").value&&this.chainsQuery.push({name:"qc_delivery_started_date_after",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_started_date_after").value)}),this.searchForm.get("qc_delivery_started_date_before").value&&this.chainsQuery.push({name:"qc_delivery_started_date_before",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_started_date_before").value)}),this.searchForm.get("qc_delivery_closed_date_after").value&&this.chainsQuery.push({name:"qc_delivery_closed_date_after",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_closed_date_after").value)}),this.searchForm.get("qc_delivery_closed_date_before").value&&this.chainsQuery.push({name:"qc_delivery_closed_date_before",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_closed_date_before").value)}),this.searchForm.get("qc_delivery_status__in").value&&this.chainsQuery.push({name:"qc_delivery_status__in",value:this.searchForm.get("qc_delivery_status__in").value}),this.getDeliveryChains()}searchServices(){this.isLoadingOrders=!0,this.destroyOrders$.next(!0),this.orders=[],this.selectedOrderItem=null,this.ordersQuery=[{name:"by_qc_module_permission",value:!0}],this.searchForm.get("qc_delivery_closed_date_after").value||this.searchForm.get("qc_delivery_closed_date_before").value?this.showClosedOrders=!0:(this.ordersQuery.push({name:"needs_delivery_qc",value:!0}),this.showClosedOrders=!1),this.searchForm.get("qc_delivery_started_date_after").value&&this.ordersQuery.push({name:"qc_delivery_started_date_after",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_started_date_after").value)}),this.searchForm.get("qc_delivery_started_date_before").value&&this.ordersQuery.push({name:"qc_delivery_started_date_before",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_started_date_before").value)}),this.searchForm.get("qc_delivery_closed_date_after").value&&this.ordersQuery.push({name:"qc_delivery_closed_date_after",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_closed_date_after").value)}),this.searchForm.get("qc_delivery_closed_date_before").value&&this.ordersQuery.push({name:"qc_delivery_closed_date_before",value:this.adapterService.dateAdapter(this.searchForm.get("qc_delivery_closed_date_before").value)}),this.searchForm.get("qc_delivery_status__in").value&&this.ordersQuery.push({name:"qc_delivery_status__in",value:this.searchForm.get("qc_delivery_status__in").value}),this.getServices()}onChoiceQcDeliveryStatuses(t){this.searchForm.get("qc_delivery_status__in").patchValue(t?.join(",")||null),this.searchItems()}getQcDeliveryStatuses(){this.qcDeliveryStatusService.get().pipe((0,A.R)(this.destroyQcDeliveryStatuses$)).subscribe(t=>{this.qcDeliveryStatus=t,this.isLoadingStatuses=!1})}getDeliveryChains(){this.deliveryService.get(this.chainsQuery).pipe((0,A.R)(this.destroyChains$)).subscribe(t=>{this.deliveryChains=t,this.resetChainsList(),this.isLoadingChains=!1})}getServices(){this.orderService.get(this.ordersQuery).pipe((0,A.R)(this.destroyOrders$)).subscribe(t=>{this.orders=t,this.makeUniqueProductionPlans(),this.resetOrdersList(),this.isLoadingOrders=!1,this.orders.forEach(i=>{i.ordered_products_unique_technologies=[],i.order_products.forEach(o=>{o.current_technology&&i.ordered_products_unique_technologies.findIndex(a=>a===o.current_technology.name)<0&&i.ordered_products_unique_technologies.push(o.current_technology.name)})})})}resetOrdersList(){this.ordersList=this.orders}resetChainsList(){this.deliveryChainsList=this.deliveryChains}makeUniqueProductionPlans(){this.orders.forEach(t=>{t.unique_root_production_plans=[],t.root_production_plans.forEach(i=>{if(i.root_nomenclature){const o=i.root_nomenclature.id;t.unique_root_production_plans.findIndex(a=>a.root_nomenclature.id===o)<0&&t.unique_root_production_plans.push(i)}})})}onSelectOrderType(t){this.invoicesOrderType=t}onGoToDeliveryChainLink(t){window.open(`/delivery-chains/chains/${t}`)}onGoToSalesChainLink(t){window.open(`/sales/sales-procurement-chains/chain-page/${t}`)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Nn.a),e.Y36(R.p),e.Y36(re.z),e.Y36(j.v),e.Y36(le),e.Y36(l.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-delivery-list"]],outputs:{selectedQcDeliveryStatuses:"selectedQcDeliveryStatuses"},decls:45,vars:17,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"page__tabs"],[1,"form","mb-3",3,"formGroup"],[1,"row"],[1,"col-3"],[1,"form-group"],["formControlName","qc_delivery_started_date_after","dateFormat","dd/mm/yy","dataType","date",3,"readonlyInput","showButtonBar","ngModelChange"],["formControlName","qc_delivery_started_date_before","dateFormat","dd/mm/yy","dataType","date",3,"readonlyInput","showButtonBar","ngModelChange"],[3,"selectStatuses"],["formControlName","qc_delivery_closed_date_after","dateFormat","dd/mm/yy","dataType","date",3,"readonlyInput","showButtonBar","ngModelChange"],["formControlName","qc_delivery_closed_date_before","dateFormat","dd/mm/yy","dataType","date",3,"readonlyInput","showButtonBar","ngModelChange"],[1,"custom-tabs"],["header","Delivery to customers"],[4,"ngIf"],[3,"header","selected"],["spinner",""],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)","dataKey","id",3,"scrollable","paginator","rows","selection","value","selectionChange"],["ot",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"d-flex"],["class","subtitle",4,"ngIf"],["pButton","","type","button","icon","pi pi-bars","label","Items","target","_blank",1,"ml-auto","mr-2",3,"routerLink"],["pButton","","type","button","label","List","icon","pi pi-list",1,"mr-2",3,"disabled","click"],["pButton","","type","button","label","Hierarchy","icon","pi pi-table",3,"click"],[1,"subtitle"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","25%"],["style","width: 25%","class","text-center",4,"ngIf"],[1,"text-center",2,"width","10%"],[3,"pSelectableRow"],[1,"text-center"],["style","width: 20%;","class","text-center",4,"ngIf"],["target","_blank",3,"click"],[2,"width","10%"],[1,"text-center",2,"width","20%"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[2,"width","20%"],[4,"ngFor","ngForOf"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Delivery"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"form",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"label"),e._uU(13,"QC Started Date From"),e.qZA(),e.TgZ(14,"p-calendar",10),e.NdJ("ngModelChange",function(){return i.searchItems()}),e.qZA()()(),e.TgZ(15,"div",8)(16,"div",9)(17,"label"),e._uU(18,"QC Started Date To"),e.qZA(),e.TgZ(19,"p-calendar",11),e.NdJ("ngModelChange",function(){return i.searchItems()}),e.qZA()()(),e.TgZ(20,"div",8)(21,"div",9)(22,"label"),e._uU(23,"Status"),e.qZA(),e.TgZ(24,"pek-qc-delivery-statuses-picker",12),e.NdJ("selectStatuses",function(c){return i.onChoiceQcDeliveryStatuses(c)}),e.qZA()()()(),e.TgZ(25,"div",7)(26,"div",8)(27,"div",9)(28,"label"),e._uU(29,"QC Closed Date From"),e.qZA(),e.TgZ(30,"p-calendar",13),e.NdJ("ngModelChange",function(){return i.searchItems()}),e.qZA()()(),e.TgZ(31,"div",8)(32,"div",9)(33,"label"),e._uU(34,"QC Closed Date To"),e.qZA(),e.TgZ(35,"p-calendar",14),e.NdJ("ngModelChange",function(){return i.searchItems()}),e.qZA()()()()(),e.TgZ(36,"p-tabView",15)(37,"p-tabPanel",16),e.YNc(38,Kn,10,6,"ng-container",17),e.YNc(39,zn,2,0,"ng-container",17),e.qZA(),e.TgZ(40,"p-tabPanel",18),e.YNc(41,di,10,6,"ng-container",17),e.YNc(42,pi,2,0,"ng-container",17),e.qZA()()()(),e.YNc(43,gi,2,0,"ng-template",null,19,e.W1O)),2&t&&(e.xp6(3),e.Q6J("module","quality-control")("isActive",!0),e.xp6(5),e.Q6J("formGroup",i.searchForm),e.xp6(6),e.Q6J("readonlyInput",!0)("showButtonBar",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showButtonBar",!0),e.xp6(11),e.Q6J("readonlyInput",!0)("showButtonBar",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showButtonBar",!0),e.xp6(3),e.Q6J("ngIf","list"===i.invoicesOrderType),e.xp6(1),e.Q6J("ngIf","hierarchy"===i.invoicesOrderType),e.xp6(1),e.Q6J("header","Outsoursing Materials Delivery")("selected",!0),e.xp6(1),e.Q6J("ngIf","list"===i.invoicesOrderType),e.xp6(1),e.Q6J("ngIf","hierarchy"===i.invoicesOrderType))},dependencies:[g.sg,g.O5,C.yS,Jn,Z.Hq,Z.zx,I.jx,l._Y,l.JJ,l.JL,l.sg,l.u,v.iA,v.Ei,N.D,G.xf,G.x4,ce.f,g.uU],styles:[".category-name[_ngcontent-%COMP%]{font-weight:500;overflow-wrap:anywhere}"]}),n})();var p=_(8505),y=_(9300),U=_(5303),T=_(6195),M=_(4128),H=_(3691),L=_(7427),ee=_(372),K=_(307),te=_(9384),D=_(1740);let hi=(()=>{class n{constructor(t,i,o,c,a){this.dialogRef=t,this.fb=i,this.invoiceProductService=o,this.orderProductService=c,this.data=a,this.isPending=!1}ngOnInit(){this.form=this.fb.group({id:[this.data.entity.id],passed_quantity:[this.data.entity.totalQuantityPassed,[l.kI.max(this.data.entity.totalQuantity),l.kI.min(0),l.kI.required]],not_passed_quantity:[this.data.entity.totalQuantityNotPassed,[l.kI.max(this.data.entity.totalQuantity),l.kI.min(0),l.kI.required]]}),this.quantity=this.data.entity.totalQuantity}onComplete(){if(this.form.valid)if(this.data.isOwnProduction){let c,t=this.form.get("passed_quantity").value,i=this.form.get("not_passed_quantity").value;c=this.data.isOwnProduction?this.data.entity.orderProducts:this.data.entity.invoiceProducts;const a=[];c.sort((s,u)=>s.id-u.id).forEach(s=>{let u=0,h=0,f=s.quantity;t<=f?(f-=t,u+=t,t=0):(t-=f,u+=f,f=0),i<=f?(f-=i,h+=i,i=0):(i-=f,h+=f,f=0);let d={id:s.id,passed_quantity:u,not_passed_quantity:h};console.log("updateProduct.passed_quantity",d.passed_quantity),console.log("updateProduct.passed_quantity",s.quantity),0===d.passed_quantity&&0===d.not_passed_quantity?d.quality_control=null:d.passed_quantity===s.quantity?d.quality_control=T.bN.PASSED:d.not_passed_quantity===s.quantity?d.quality_control=T.bN.NOT_PASSED:d.not_passed_quantity+d.passed_quantity===s.quantity&&(d.quality_control=T.bN.PARTLY_PASSED),a.push(this.orderProductService.updatePartly(d))}),this.isPending=!0,(0,M.D)([...a]).subscribe(s=>{this.isPending=!1,this.dialogRef.close(!0)})}else this.updateQualityControl()}updateQualityControl(){if(console.log(this.form.value),this.form.valid){const t=this.form.get("passed_quantity").value+this.form.get("not_passed_quantity").value,i=this.data.entity.invoiceProducts.reduce((s,u)=>s+u.quantity,0),o=this.data.entity.invoiceProducts.reduce((s,u)=>s+u.accepted_quantity,0)+this.form.get("passed_quantity").value;let c=this.form.get("passed_quantity").value;t<i&&(c=o);const a={invoice_products_ids:this.data.entity.invoiceProducts.map(s=>s.id),passed_quantity:c,not_passed_quantity:this.form.get("not_passed_quantity").value};this.isPending=!0,this.invoiceProductService.bulkUpdateQualityControl(a).subscribe(s=>{this.isPending=!1,this.dialogRef.close(!0)})}}isDisableCompleteButton(){const t=+this.form.get("passed_quantity").value+ +this.form.get("not_passed_quantity").value!=+this.quantity,i=0==+this.form.get("passed_quantity").value&&0==+this.form.get("not_passed_quantity").value;return t&&!i}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.so),e.Y36(l.qu),e.Y36(te.J),e.Y36(H.c),e.Y36(m.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-quality-control-modal"]],decls:16,vars:8,consts:[[1,"modal-header"],[1,"modal-header__title"],[3,"formGroup"],[1,"form-group"],["for","passed"],["pInputText","","formControlName","passed_quantity","min","0","type","number","id","passed",1,"form-control",3,"max"],["for","np"],["pInputText","","formControlName","not_passed_quantity","min","0","type","number","id","np",1,"form-control",3,"max"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button","label","Complete",1,"p-button-success",3,"disabled","loading","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"form",2)(5,"div",3)(6,"label",4),e._uU(7," Passed* "),e.qZA(),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"div",3)(10,"label",6),e._uU(11," Not Passed* "),e.qZA(),e._UZ(12,"input",7),e.qZA()()(),e.TgZ(13,"mat-dialog-actions",8),e._UZ(14,"button",9),e.TgZ(15,"button",10),e.NdJ("click",function(){return i.onComplete()}),e.qZA()()),2&t&&(e.xp6(2),e.AsE(" Quality Control (Name: ",i.data.entity.nomenclature.name,", Quantity: ",i.data.entity.totalQuantity,") "),e.xp6(2),e.Q6J("formGroup",i.form),e.xp6(4),e.s9C("max",i.data.entity.totalQuantity),e.xp6(4),e.s9C("max",i.data.entity.totalQuantity),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("disabled",i.form.invalid||i.isDisableCompleteButton())("loading",i.isPending))},dependencies:[Z.Hq,D.o,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.qQ,l.Fd,l.sg,l.u,m.ZT,m.xY,m.H8]}),n})();var _e=_(439);let fi=(()=>{class n{constructor(t,i,o,c,a,s){this.dialogRef=t,this.fb=i,this.invoiceProductService=o,this.orderTechnicalEquipmentsService=c,this.orderProductService=a,this.data=s,this.isPending=!1}ngOnInit(){this.form=this.fb.group({id:[this.data.entity.id],passed_quantity:[this.data.entity.passed_quantity,[l.kI.max(this.data.entity.quantity),l.kI.min(0),l.kI.required]],not_passed_quantity:[this.data.entity.not_passed_quantity,[l.kI.max(this.data.entity.quantity),l.kI.min(0),l.kI.required]]}),this.quantity=this.data.entity.quantity}isDisableCompleteButton(){return+this.form.get("passed_quantity").value+ +this.form.get("not_passed_quantity").value!=+this.quantity}onComplete(){this.form.valid&&(this.isPending=!0,this.form.value.passed_quantity+this.form.value.not_passed_quantity===this.data.entity.quantity&&(this.form.value.passed_quantity===this.data.entity.quantity?this.form.addControl("quality_control",new l.NI(T.bN.PASSED)):this.form.value.not_passed_quantity===this.data.entity.quantity?this.form.addControl("quality_control",new l.NI(T.bN.NOT_PASSED)):this.form.value.not_passed_quantity+this.form.value.passed_quantity===this.data.entity.quantity&&this.form.addControl("quality_control",new l.NI(T.bN.PARTLY_PASSED))),this.form.value.not_passed_quantity+this.form.value.passed_quantity===this.data.entity.quantity&&this.data.isOwnProduction&&this.orderTechnicalEquipmentsService.updatePartly(this.form.value).subscribe(()=>{this.isPending=!1,this.dialogRef.close(!0)}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.so),e.Y36(l.qu),e.Y36(te.J),e.Y36(_e.v),e.Y36(H.c),e.Y36(m.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-quality-control-technical-equipment"]],decls:16,vars:8,consts:[[1,"modal-header"],[1,"modal-header__title"],[3,"formGroup"],[1,"form-group"],["for","passed"],["pInputText","","formControlName","passed_quantity","min","0","type","number","id","passed",1,"form-control",3,"max"],["for","np"],["pInputText","","formControlName","not_passed_quantity","min","0","type","number","id","np",1,"form-control",3,"max"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button","label","Complete",1,"p-button-success",3,"disabled","loading","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"form",2)(5,"div",3)(6,"label",4),e._uU(7," Passed* "),e.qZA(),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"div",3)(10,"label",6),e._uU(11," Not Passed* "),e.qZA(),e._UZ(12,"input",7),e.qZA()()(),e.TgZ(13,"mat-dialog-actions",8),e._UZ(14,"button",9),e.TgZ(15,"button",10),e.NdJ("click",function(){return i.onComplete()}),e.qZA()()),2&t&&(e.xp6(2),e.AsE(" Quality Control (Name: ",i.data.entity.nomenclature.name,", Quantity: ",i.data.entity.quantity,") "),e.xp6(2),e.Q6J("formGroup",i.form),e.xp6(4),e.s9C("max",i.data.entity.quantity),e.xp6(4),e.s9C("max",i.data.entity.quantity),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("disabled",i.form.invalid||i.isDisableCompleteButton())("loading",i.isPending))},dependencies:[Z.Hq,D.o,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.qQ,l.Fd,l.sg,l.u,m.ZT,m.xY,m.H8]}),n})();var vi=_(5288);function xi(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij("","edit"===t.data.type?"Edit":"Create"," Protocol")}}function Zi(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij("Protocol \xab",t.data.protocol.name,"\xbb")}}function qi(n,r){1&n&&(e.ynx(0),e.TgZ(1,"div",21),e._UZ(2,"i",22),e.qZA(),e.BQk())}function yi(n,r){if(1&n&&(e.TgZ(0,"div",27)(1,"div",5)(2,"div",6)(3,"label",28),e._uU(4," Name* "),e.qZA(),e._UZ(5,"input",29),e.qZA()(),e.TgZ(6,"div",5)(7,"div",6)(8,"label",28),e._uU(9," Comment "),e.qZA(),e._UZ(10,"input",30),e.qZA()()()),2&n){const t=r.index;e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("for","p-name-"+t),e.xp6(2),e.Q6J("id","p-name-"+t),e.xp6(3),e.Q6J("for","p-comment-"+t),e.xp6(2),e.Q6J("id","p-comment-"+t)}}function Ti(n,r){if(1&n&&(e.TgZ(0,"div",25),e.YNc(1,yi,11,5,"div",26),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.paragraphs.controls)}}function Ci(n,r){1&n&&(e.TgZ(0,"div",31),e._uU(1," There are no paragraphs of the protocol "),e.qZA())}function bi(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Ti,2,1,"div",23),e.YNc(2,Ci,2,0,"ng-template",null,24,e.W1O),e.BQk()),2&n){const t=e.MAs(3),i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.paragraphs.length>0)("ngIfElse",t)}}function Qi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"a",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.addNomenclature())}),e._UZ(1,"i",33),e._uU(2," Add Nomenclature "),e.qZA()}}function Ai(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",38),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",39),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",40),e._uU(6,"Code"),e.qZA(),e.TgZ(7,"th",41),e._uU(8,"Type"),e.qZA(),e._UZ(9,"th",42),e.qZA())}function Pi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",38),e._uU(2),e.qZA(),e.TgZ(3,"td",39),e._uU(4),e.qZA(),e.TgZ(5,"td",40),e._uU(6),e.qZA(),e.TgZ(7,"td",41),e._uU(8),e.qZA(),e.TgZ(9,"td",42)(10,"button",43),e.NdJ("click",function(){const c=e.CHM(t).$implicit,a=e.oxw(2);return e.KtG(a.removeNomenclature(c.id))}),e._UZ(11,"i",44),e.qZA()()()}if(2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw(2);e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(o.getType(t.type))}}function Ii(n,r){if(1&n&&(e.TgZ(0,"div")(1,"p-table",34,35),e.YNc(3,Ai,10,0,"ng-template",36),e.YNc(4,Pi,12,4,"ng-template",37),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("value",t.form.get("nomenclatures").value)("paginator",!0)("rows",10)}}let wi=(()=>{class n{constructor(t,i,o,c){this.fb=t,this.protocolService=i,this.dialogRef=o,this.data=c,this.isSaving=!1,this.isLoadingParagraphs=!1,this.defaultParagraphsIds=new Set,this.removeFilesSet=new Set,this.files=[],this.defaultFiles=[],this.form=this.fb.group({id:[null],name:[null,l.kI.required],comment:["",l.kI.required],paragraphs:this.fb.array([]),nomenclatures:[[]]})}get paragraphs(){return this.form.get("paragraphs")}ngOnInit(){"edit"===this.data.type?(this.form.patchValue(this.data.protocol),this.getParagraphs(),this.getFiles()):this.addParagraph()}getParagraphs(){this.isLoadingParagraphs=!0,this.protocolService.getParagraphs([{name:"protocol_ids",value:this.form.get("id").value}]).subscribe(t=>{t.forEach(i=>{this.defaultParagraphsIds.add(i.id),this.form.get("paragraphs").push(this.fb.group({id:[i.id],name:[i.name,l.kI.required],comment:[i.comment]}))}),this.isLoadingParagraphs=!1})}addParagraph(){this.form.get("paragraphs").push(this.fb.group({id:[null],name:[null,l.kI.required],comment:[""]}))}getFiles(){"edit"===this.data.type&&this.protocolService.getFiles([{name:"qc_protocol_id",value:this.form.get("id").value}]).subscribe(t=>{this.files=t.map(i=>({...i,name:this.getFileName(i.file)})),this.defaultFiles=[...this.files]})}getFileName(t){if(t){const i=t.split("/");return i[i.length-1]}}removeNomenclature(t){const i=this.form.get("nomenclatures").value.findIndex(o=>o.id===t);this.form.get("nomenclatures").value.splice(i,1)}getType(t){switch(t){case"0":return"Purchased";case"1":return"Assembly";case"2":return"Manufactured"}}onSave(){"create"===this.data.type?this.createProtocol():this.editProtocol()}addNomenclature(){this.protocolService.addNomenclatureDialog().pipe((0,y.h)(t=>Boolean(t))).subscribe(t=>{this.form.get("nomenclatures").value.push({id:t.id,name:t.name,code:t.code,type:t.type})})}createProtocol(){if(this.form.valid){this.isSaving=!0;const t=JSON.parse(JSON.stringify(this.form.value));delete t.nomenclatures,delete t.id,this.protocolService.create(t).subscribe(i=>{const o=this.paragraphs.controls.map(c=>(delete c.value.id,c.value.protocol_id=i.id,c.value));if(this.protocolService.addParagraphs(o).subscribe(),this.saveFiles(i.id.toString()),this.form.get("nomenclatures").value.length>0){const c={nomenclature_ids:this.form.get("nomenclatures").value.map(a=>a.id)};this.protocolService.addNomenclature(c,i.id).pipe((0,p.b)(()=>this.isSaving=!1)).subscribe(()=>this.dialogRef.close(!0))}else this.isSaving=!1,this.dialogRef.close(!0)})}}saveFiles(t){this.files.forEach((i,o)=>{if(!i?.id){const c=new FormData;c.append("file",i,i.name),c.append("qc_protocol",t),this.protocolService.saveFile(c).subscribe()}})}onSelectFiles(t){this.files=t}editProtocol(){if(this.form.value){this.isSaving=!0;const t=JSON.parse(JSON.stringify(this.form.value));delete t.nomenclatures,this.protocolService.update(t).subscribe();const i=this.paragraphs.controls.filter(a=>null===a.value.id).map(a=>(a.value.protocol_id=this.form.get("id").value,a.value));this.protocolService.addParagraphs(i).subscribe();const o=this.paragraphs.controls.filter(a=>this.defaultParagraphsIds.has(a.value.id)).map(a=>a.value);this.protocolService.updateParagraphs(o).subscribe(),this.paragraphs.controls.forEach(a=>{this.defaultParagraphsIds.has(a.value.id)&&this.defaultParagraphsIds.delete(a.value.id)}),this.saveFiles(this.form.get("id").value),this.deleteFiles();const c=Array.from(this.defaultParagraphsIds);if(this.protocolService.deleteParagraphs(c).subscribe(),this.form.get("nomenclatures").value.length>=0){const a={nomenclature_ids:this.form.get("nomenclatures").value.length?this.form.get("nomenclatures").value.map(s=>s.id):""};this.protocolService.addNomenclature(a,this.form.get("id").value).subscribe(()=>{this.isSaving=!1,this.dialogRef.close(!0)})}else this.isSaving=!1,this.dialogRef.close(!0)}}deleteFiles(){this.defaultFiles.filter(t=>t?.id&&!this.files.find(i=>i.id===t.id)).map(t=>t.id).forEach(t=>{this.protocolService.deleteFile(t).subscribe()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.qu),e.Y36(W),e.Y36(m.so),e.Y36(m.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-create-edit-protocol"]],decls:37,vars:14,consts:[[1,"modal-header"],[1,"modal-header__title"],[4,"ngIf"],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"form-group"],["for","name"],["pInputText","","formControlName","name","type","text","id","name",1,"form-control"],["for","comment"],["pInputText","","formControlName","comment","type","text","id","comment",1,"form-control"],[1,"paragraphs__header","mt-3","mb-1"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"paragraphs__header","mt-4","mb-3"],["class","btn-add",3,"click",4,"ngIf"],[1,"protocols-files"],[3,"uploadFiles","multiple","selectFile"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button",1,"p-button-success",3,"label","loading","disabled","click"],[1,"d-flex","justify-content-center"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2rem"],["formArrayName","paragraphs",4,"ngIf","ngIfElse"],["empty",""],["formArrayName","paragraphs"],["class","row",3,"formGroupName",4,"ngFor","ngForOf"],[1,"row",3,"formGroupName"],[3,"for"],["formControlName","name","type","text","pInputText","",1,"form-control",3,"id"],["formControlName","comment","type","text","pInputText","",1,"form-control",3,"id"],[1,"empty-text"],[1,"btn-add",3,"click"],[1,"pi","pi-plus"],["selectionMode","single",3,"value","paginator","rows"],["dt",""],["pTemplate","header"],["pTemplate","body"],[1,"text-center",2,"width","7%"],[2,"width","33%"],[2,"width","30%"],[1,"text-center",2,"width","20%"],[1,"text-right",2,"width","10%"],[1,"btn-remove",3,"click"],[1,"pi","pi-times"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e.YNc(2,xi,2,1,"span",2),e.YNc(3,Zi,2,1,"span",2),e.qZA()(),e.TgZ(4,"mat-dialog-content")(5,"form",3)(6,"div")(7,"div",4)(8,"div",5)(9,"div",6)(10,"label",7),e._uU(11," Name* "),e.qZA(),e._UZ(12,"input",8),e.qZA()(),e.TgZ(13,"div",5)(14,"div",6)(15,"label",9),e._uU(16," Comment* "),e.qZA(),e._UZ(17,"input",10),e.qZA()()(),e.TgZ(18,"div",11)(19,"h4"),e._uU(20,"Protocol Paragraph"),e.qZA()(),e.TgZ(21,"div",12),e.YNc(22,qi,3,0,"ng-container",13),e.YNc(23,bi,4,2,"ng-container",13),e.qZA(),e.TgZ(24,"div",14)(25,"h4"),e._uU(26,"Nomenclatures"),e.qZA(),e.YNc(27,Qi,3,0,"a",15),e.qZA(),e.YNc(28,Ii,5,3,"div",2),e.qZA(),e.TgZ(29,"div",14)(30,"h4"),e._uU(31,"Protocol Files"),e.qZA()(),e.TgZ(32,"div",16)(33,"pek-upload-file",17),e.NdJ("selectFile",function(c){return i.onSelectFiles(c)}),e.qZA()()()(),e.TgZ(34,"mat-dialog-actions",18),e._UZ(35,"button",19),e.TgZ(36,"button",20),e.NdJ("click",function(){return i.onSave()}),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("ngIf",!i.data.isShowMode),e.xp6(1),e.Q6J("ngIf",i.data.isShowMode),e.xp6(2),e.Q6J("formGroup",i.form),e.xp6(16),e.Q6J("ngSwitch",i.isLoadingParagraphs),e.xp6(1),e.Q6J("ngSwitchCase",!0),e.xp6(1),e.Q6J("ngSwitchCase",!1),e.xp6(4),e.Q6J("ngIf",!i.data.isShowMode),e.xp6(1),e.Q6J("ngIf",i.form.get("nomenclatures").value.length>0),e.xp6(5),e.Q6J("uploadFiles",i.files)("multiple",!0),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("label",i.data.type)("loading",i.isSaving)("disabled",i.form.invalid))},dependencies:[g.sg,g.O5,g.RF,g.n9,Z.Hq,D.o,I.jx,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,m.ZT,m.xY,m.H8,v.iA,vi.R],styles:[".paragraphs__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.paragraphs__header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600}.btn-add[_ngcontent-%COMP%]{font-weight:600;cursor:pointer}.btn-add[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-weight:600}.btn-add[_ngcontent-%COMP%]:hover{text-decoration:underline}.btn-remove[_ngcontent-%COMP%]{background:transparent;color:var(--theme-color-danger);font-weight:600;cursor:pointer;position:relative;top:2px}"]}),n})();var z=_(655),ue=_(3900),de=_(8372),pe=_(1884),q=_(9933),Ni=_(3178),Ui=_(666),ge=_(1997),Si=_(7925),Oi=_(6913);const ki=["paginator"];function Ji(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",25),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",26),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",27),e._uU(6,"Code"),e.qZA(),e.TgZ(7,"th",28),e._uU(8,"Uom"),e.qZA(),e.TgZ(9,"th",29),e._uU(10,"Technology"),e.qZA(),e.TgZ(11,"th",30),e._uU(12,"Category"),e.qZA()())}function Mi(n,r){1&n&&(e.TgZ(0,"span",36),e._uU(1," NEW "),e.qZA())}function Li(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Di(n,r){if(1&n&&(e.TgZ(0,"tr",31)(1,"td",25),e._uU(2),e.qZA(),e.TgZ(3,"td",32),e._uU(4),e.qZA(),e.TgZ(5,"td",27),e.YNc(6,Mi,2,0,"span",33),e._uU(7),e.qZA(),e.TgZ(8,"td",34),e._uU(9),e.qZA(),e.TgZ(10,"td",29),e.YNc(11,Li,2,1,"div",35),e.qZA(),e.TgZ(12,"td",30),e._uU(13),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw();e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(10*(o.currentPage-1)+i+1),e.xp6(2),e.hij(" ",t.code," "),e.xp6(2),e.Q6J("ngIf","0"===t.approved&&"0"===t.type),e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.Oqu(null!=t.category&&null!=t.category.unit_of_measure&&t.category.unit_of_measure.symbol?null==t.category||null==t.category.unit_of_measure?null:t.category.unit_of_measure.symbol:"Pcs"),e.xp6(2),e.Q6J("ngForOf",t.technologies),e.xp6(2),e.hij(" ",null==t.category?null:t.category.name," ")}}function Yi(n,r){1&n&&e._UZ(0,"i",40)}function Ei(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Fi(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",37),e.YNc(2,Yi,1,0,"i",38),e.YNc(3,Ei,2,0,"span",39),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",12),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function Ri(n,r){1&n&&(e.TgZ(0,"div",41),e._UZ(1,"i",40),e.qZA())}let S=class{constructor(r,t,i,o,c){this.dialogRef=r,this.fb=t,this.nomenclatureService=i,this.adapterService=o,this.data=c,this.nomenclatureFilterTypes=[{name:"Manufactured",value:"2"},{name:"Assembly",value:"1"},{name:"Purchased",value:"0"}],this.searchForm=this.fb.group({name:[""],code:[""],categories:[""],root_categories:[""],type:[null]}),this.isLoading=!0,this.currentPage=1,this.isStartFirstPage=!1,this.queryKey=this.adapterService.generateQueryKey(this.searchForm),this.query=[],this.productsCount=0,this.name$=new b.x,this.code$=new b.x,this.search$=new X.X(null),this.products$=this.search$.pipe((0,p.b)(()=>this.prepareForSearch()),(0,ue.w)(()=>this.nomenclatureService.getForPagination(this.query)),(0,p.b)(a=>this.productsCount=a.count),(0,x.U)(a=>a.results),(0,p.b)(()=>this.paginateToFistPage()),(0,p.b)(()=>this.isLoading=!1),(0,q.t)(this))}ngOnInit(){this.name$.pipe((0,de.b)(150),(0,p.b)(()=>this.search$.next()),(0,pe.x)(),(0,q.t)(this)).subscribe(),this.code$.pipe((0,de.b)(150),(0,p.b)(()=>this.search$.next()),(0,pe.x)(),(0,q.t)(this)).subscribe()}prepareForSearch(){this.isLoading=!0,this.selectedProduct=null;const r=this.adapterService.generateQueryKey(this.searchForm);r!==this.queryKey&&(this.currentPage=1,this.queryKey=r,this.isStartFirstPage=!0),this.query=[{name:"paginated",value:!0},{name:"page",value:this.currentPage}];for(const t in this.searchForm.controls)this.searchForm.controls[t].value&&this.query.push({name:t,value:this.searchForm.controls[t].value})}paginateToFistPage(){this.isStartFirstPage&&this.paginator?.changePage(0),this.isStartFirstPage=!1}onSelectProduct(){this.dialogRef.close(this.selectedProduct)}paginate(r){this.isStartFirstPage||(this.currentPage=r.page+1,this.search$.next())}onSelectCategories(r){this.searchForm.get("categories").patchValue(r),this.search$.next()}onSelectRootCategories(r){this.searchForm.get("root_categories").patchValue(r),this.search$.next()}};S.\u0275fac=function(r){return new(r||S)(e.Y36(m.so),e.Y36(l.qu),e.Y36(Ni.g),e.Y36(j.v),e.Y36(m.WI))},S.\u0275cmp=e.Xpm({type:S,selectors:[["pek-nomenclature-protocol-picker"]],viewQuery:function(r,t){if(1&r&&e.Gf(ki,5),2&r){let i;e.iGM(i=e.CRH())&&(t.paginator=i.first)}},decls:45,vars:16,consts:[[1,"modal-header"],[1,"modal-header__title"],[3,"formGroup"],[1,"row"],[1,"col-4"],[1,"form-group"],["for","name"],["pInputText","","formControlName","name","type","text","id","name",1,"form-control",3,"ngModelChange"],["for","code"],["pInputText","","formControlName","code","type","text","id","code",1,"form-control",3,"ngModelChange"],["formControlName","type","placeholder","Type","optionLabel","name","optionValue","value",3,"options","showClear","ngModelChange"],[3,"choiceCategories"],[1,"table-pagination-preloader"],["selectionMode","single","dataKey","id","rowExpandMode","single",3,"scrollable","rows","value","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","pagination-preloader pagination-preloader_bord",4,"ngIf"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],[1,"paginator-wrapper"],[3,"rows","totalRecords","onPageChange"],["paginator",""],["pButton","","type","button","label","Choice",1,"p-button-success",3,"disabled","click"],[1,"text-center",2,"width","5%"],[2,"width","20%"],[2,"width","30%"],[1,"text-center",2,"width","10%"],[1,"text-center",2,"width","20%"],[1,"text-center",2,"width","15%"],[3,"pSelectableRow"],[1,"word-break",2,"width","20%"],["class","badge badge_warning","style","margin-right: 0.25rem",4,"ngIf"],[1,"word-break","text-center",2,"width","10%"],[4,"ngFor","ngForOf"],[1,"badge","badge_warning",2,"margin-right","0.25rem"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],[1,"pagination-preloader","pagination-preloader_bord"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2,"Choice Nomenclature"),e.qZA()(),e.TgZ(3,"form",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"label",6),e._uU(8,"Name"),e.qZA(),e.TgZ(9,"input",7),e.NdJ("ngModelChange",function(){return t.name$.next()}),e.qZA()()(),e.TgZ(10,"div",4)(11,"div",5)(12,"label",8),e._uU(13,"Code"),e.qZA(),e.TgZ(14,"input",9),e.NdJ("ngModelChange",function(){return t.code$.next()}),e.qZA()()(),e.TgZ(15,"div",4)(16,"div",5)(17,"label"),e._uU(18,"Type"),e.qZA(),e.TgZ(19,"p-dropdown",10),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(20,"div",4)(21,"div",5)(22,"label"),e._uU(23,"Categories"),e.qZA(),e.TgZ(24,"pek-multi-categories-picker",11),e.NdJ("choiceCategories",function(o){return t.onSelectCategories(o)}),e.qZA()()(),e.TgZ(25,"div",4)(26,"div",5)(27,"label"),e._uU(28,"Root Categories"),e.qZA(),e.TgZ(29,"pek-multi-product-structure-categories-picker",11),e.NdJ("choiceCategories",function(o){return t.onSelectRootCategories(o)}),e.qZA()()()()(),e.TgZ(30,"div",12)(31,"mat-dialog-content")(32,"p-table",13,14),e.NdJ("selectionChange",function(o){return t.selectedProduct=o}),e.ALo(34,"async"),e.YNc(35,Ji,13,0,"ng-template",15),e.YNc(36,Di,14,8,"ng-template",16),e.YNc(37,Fi,4,3,"ng-template",17),e.qZA(),e.YNc(38,Ri,2,0,"div",18),e.qZA()(),e.TgZ(39,"mat-dialog-actions",19),e._UZ(40,"button",20),e.TgZ(41,"div",21)(42,"p-paginator",22,23),e.NdJ("onPageChange",function(o){return t.paginate(o)}),e.qZA()(),e.TgZ(44,"button",24),e.NdJ("click",function(){return t.onSelectProduct()}),e.qZA()()),2&r&&(e.xp6(3),e.Q6J("formGroup",t.searchForm),e.xp6(16),e.Q6J("options",t.nomenclatureFilterTypes)("showClear",!0),e.xp6(13),e.Q6J("scrollable",!0)("rows",10)("value",e.lcZ(34,14,t.products$))("selection",t.selectedProduct),e.xp6(6),e.Q6J("ngIf",t.isLoading),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.ekj("paginator-wrapper_hide",0===t.productsCount),e.xp6(1),e.Q6J("rows",10)("totalRecords",t.productsCount),e.xp6(2),e.Q6J("disabled",!t.selectedProduct))},dependencies:[g.sg,g.O5,Z.Hq,D.o,I.jx,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,m.ZT,m.xY,m.H8,Ui.Lt,v.iA,v.Ei,ge.D,Si.M,Oi.j,g.Ov],styles:[".modal-header[_ngcontent-%COMP%], form[_ngcontent-%COMP%]{margin-bottom:.5rem}.paginator-wrapper[_ngcontent-%COMP%]{border-bottom:none}"]}),S=(0,z.gn)([(0,q.c)()],S);let W=(()=>{class n{constructor(t,i){this.httpClient=t,this.dialog=i,this.API_URL=Q.N.base_url+Q.N.procurement_url}getForPagination(t){let i="";return t&&t.forEach((o,c)=>{i+=c>0?"&"+o.name+"="+o.value:"?"+o.name+"="+o.value}),this.httpClient.get(this.API_URL+"qc_protocols/"+i).pipe((0,x.U)(o=>o.data))}get(t){let i="";return t&&t.forEach((o,c)=>{i+=c>0?"&"+o.name+"="+o.value:"?"+o.name+"="+o.value}),this.httpClient.get(this.API_URL+"qc_protocols/"+i).pipe((0,x.U)(o=>o.data))}getOne(t){return this.httpClient.get(this.API_URL+`qc_protocols/${t}/`).pipe((0,x.U)(i=>i.data))}create(t){return this.httpClient.post(this.API_URL+"qc_protocols/",t).pipe((0,x.U)(i=>i.data))}update(t){return this.httpClient.patch(this.API_URL+`qc_protocols/${t.id}/`,t).pipe((0,x.U)(i=>i.data))}addParagraphs(t){return(0,M.D)(...t.map(i=>this.httpClient.post(this.API_URL+"qc_protocol_paragraphs/",i)))}updateParagraphs(t){return(0,M.D)(...t.map(i=>this.httpClient.patch(this.API_URL+`qc_protocol_paragraphs/${i.id}/`,i)))}deleteParagraphs(t){return(0,M.D)(...t.map(i=>this.httpClient.delete(this.API_URL+`qc_protocol_paragraphs/${i}/`)))}getParagraphs(t){let i="";return t&&t.forEach((o,c)=>{i+=c>0?"&"+o.name+"="+o.value:"?"+o.name+"="+o.value}),this.httpClient.get(this.API_URL+"qc_protocol_paragraphs/"+i).pipe((0,x.U)(o=>o.data))}getWarehouseProducts(t){return this.httpClient.get(this.API_URL+`warehouse_products_qc_protocols/${t}/`).pipe((0,x.U)(i=>i.data))}addNomenclature(t,i){return this.httpClient.post(this.API_URL+`qc_protocols/${i}/add_protocol_to_nomenclature/`,t).pipe((0,x.U)(o=>o.data))}productsToQc(t){return this.httpClient.post(Q.N.base_url+"procurement/warehouse_products_qc_protocols/",t).pipe((0,x.U)(i=>i.data))}deleteProtocol(t){return this.httpClient.delete(this.API_URL+`qc_protocols/${t}/`)}saveFile(t){return this.httpClient.post(this.API_URL+"qc_protocols_files/",t).pipe((0,x.U)(i=>i.data))}deleteFile(t){return this.httpClient.delete(this.API_URL+`qc_protocols_files/${t}/`)}getFiles(t){let i="";return t&&t.forEach((o,c)=>{i+=c>0?"&"+o.name+"="+o.value:"?"+o.name+"="+o.value}),this.httpClient.get(this.API_URL+"qc_protocols_files/"+i).pipe((0,x.U)(o=>o.data))}downloadFile(t){return this.httpClient.get(this.API_URL+"qc_protocols_files/"+t+"/download/",{responseType:"blob"})}qcSerial(t){return this.httpClient.post(this.API_URL+"create_update_product_by_serial/",t)}qcSerialUpdate(t){return this.httpClient.patch(this.API_URL+"create_update_product_by_serial/",t)}getProductsQcProtocols(t){let i="";return t&&t.forEach((o,c)=>{i+=c>0?"&"+o.name+"="+o.value:"?"+o.name+"="+o.value}),this.httpClient.get(this.API_URL+"warehouse_products_qc_protocols/"+i).pipe((0,x.U)(o=>o.data))}updateProductProtocol(t,i){return this.httpClient.patch(this.API_URL+`warehouse_products_qc_protocols/${i}/`,t).pipe((0,x.U)(o=>o.data))}createEditProtocolModal(t,i){return this.dialog.open(wi,{width:"60rem",height:"auto",data:{type:t,protocol:i},autoFocus:!1,enterAnimationDuration:"250ms"}).afterClosed()}addNomenclatureDialog(){return this.dialog.open(S,{width:"70rem",height:"auto",data:{},autoFocus:!1,enterAnimationDuration:"250ms"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(se.eN),e.LFG(m.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ji=(()=>{class n{constructor(t,i,o,c,a){this.fb=t,this.qrCodeService=i,this.dialogRef=o,this.qcProtocolService=c,this.data=a,this.serialNumbers=[],this.defaultSerialNumbers=[],this.form=this.fb.group({serial_number_id:[null,l.kI.required],serial:[null],invoice_product_id:[null],order_product_id:[null],is_passed:[null],traversed:[null]})}ngOnInit(){if(this.data.currentCount>this.data.count&&(this.data.currentCount=this.data.count),this.serialNumbers=this.data.product.totalSerialNumbers,this.serialNumbers.forEach(i=>{i.traversed=null!==i.is_passed}),this.defaultSerialNumbers=JSON.parse(JSON.stringify(this.serialNumbers)),this.serialNumbers.sort((i,o)=>i.id-o.id),this.currentCount=JSON.parse(JSON.stringify(this.data.currentCount)),this.data.foundSerialId){const i=this.serialNumbers.findIndex(o=>+o.id===this.data.foundSerialId);[this.serialNumbers[0],this.serialNumbers[i]]=[this.serialNumbers[i],this.serialNumbers[0]]}const t=this.serialNumbers[this.data.currentCount-1];t&&t?.type_with_number?this.form.get("serial").patchValue(t?.type_with_number):this.form.get("serial").patchValue(t?.id),t&&(this.form.get("is_passed").patchValue(t.is_passed),this.form.get("traversed").patchValue(t.traversed),this.form.get("serial_number_id").patchValue(t.id)),"order"===this.data.type&&this.form.get("order_product_id").patchValue(this.data.product.id),"invoice"===this.data.type&&this.form.get("invoice_product_id").patchValue(this.data.product.id),t.invoice_product_id&&this.form.get("invoice_product_id").patchValue(t.invoice_product_id)}saveSerialInfo(){const t=this.serialNumbers[this.data.currentCount-1];t.invoice_product_id&&this.form.get("invoice_product_id").patchValue(t.invoice_product_id),t&&t?.type_with_number?this.form.get("serial").patchValue(t?.type_with_number):this.form.get("serial").patchValue(t?.id),t&&(this.form.get("traversed").patchValue(t.traversed),this.form.get("serial_number_id").patchValue(t.id),this.form.get("is_passed").patchValue(t.is_passed))}nextSerial(){this.data.currentCount<this.data.count&&(this.data.currentCount+=1,this.saveSerialInfo())}prevSerial(){this.data.currentCount>=1&&(this.data.currentCount-=1,this.saveSerialInfo())}generateQrCode(){const t={by_nomenclatures_list:[{nomenclature_id:this.data.product.nomenclature.id,serial_number_ids:[parseInt(this.form.get("serial_number_id").value,10)],order_product_ids:[],invoice_product_ids:[]}]};this.qrCodeService.generateQrCodes(t).subscribe(i=>{this.qrCode=i.with_serial[0].code[0]})}close(){JSON.stringify(this.defaultSerialNumbers)===JSON.stringify(this.serialNumbers)?this.dialogRef.close(!1):this.dialogRef.close(!0)}changePassedTrue(){!0===this.form.get("is_passed").value?this.form.get("is_passed").patchValue(null):this.form.get("is_passed").patchValue(!0)}changePassedFalse(){!1===this.form.get("is_passed").value?this.form.get("is_passed").patchValue(null):this.form.get("is_passed").patchValue(!1)}beforeForSave(){const t=this.serialNumbers.findIndex(i=>i.id===this.form.get("serial_number_id").value);this.serialNumbers[t].traversed=!0,this.serialNumbers[t].is_passed=this.form.get("is_passed").value,this.nextSerial()}complete(){const t={...this.form.value};if(delete t.serial,delete t.traversed,t.invoice_product_id){const i=this.data.product.invoiceProducts.find(o=>o.serial_numbers.findIndex(c=>c.id===t.serial_number_id)>=0);t.invoice_product_id=i.id,delete t.order_product_id}if(t.order_product_id){const i=this.data.product.orderProducts.find(o=>o.serial_numbers.findIndex(c=>c.id===t.serial_number_id)>=0);t.order_product_id=i.id,delete t.invoice_product_id}!1===this.form.get("traversed").value?this.qcProtocolService.qcSerial(t).subscribe(()=>{this.data.currentCount===this.data.count?this.dialogRef.close(!0):this.beforeForSave()}):this.qcProtocolService.qcSerialUpdate(t).subscribe(()=>{this.data.currentCount===this.data.count?this.dialogRef.close(!0):this.beforeForSave()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.qu),e.Y36(K.D),e.Y36(m.so),e.Y36(W),e.Y36(m.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-move-qc-with-serial"]],decls:34,vars:13,consts:[[1,"modal-header"],[1,"modal-header__title"],[1,"tools"],["pButton","","type","button",1,"p-button-success",3,"click"],["pButton","","type","button","size","s","icon","pi pi-arrow-left",1,"p-button-icon","step-btn","ml-3",3,"disabled","click"],["pButton","","type","button","icon","pi pi-arrow-right",1,"p-button-icon","step-btn","ml-3",3,"disabled","click"],[3,"formGroup"],[1,"row"],[1,"col-9"],[1,"form-group"],["for","serial"],[1,"serial"],["pInputText","","formControlName","serial","type","text","id","serial",1,"form-control","disabled"],[1,"col-1"],[1,"form-group","passing"],[1,"column-filter-box"],["type","button",3,"click"],[1,"pi","pi-check"],[1,"pi","pi-times"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button","label","Complete",1,"p-button-success",3,"disabled","loading","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return i.generateQrCode()}),e._uU(5,"Generate QR-code"),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return i.prevSerial()}),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return i.nextSerial()}),e.qZA()()(),e.TgZ(8,"mat-dialog-content")(9,"form",6)(10,"div",7)(11,"div",8)(12,"div",9)(13,"label",10),e._uU(14," Serial Number "),e.qZA(),e.TgZ(15,"div",11),e._UZ(16,"input",12),e.qZA()()(),e.TgZ(17,"div",13)(18,"div",14)(19,"label",10),e._uU(20,"Passed"),e.qZA(),e.TgZ(21,"div",15)(22,"button",16),e.NdJ("click",function(){return i.changePassedTrue()}),e._UZ(23,"i",17),e.qZA()()()(),e.TgZ(24,"div",13)(25,"div",14)(26,"label",10),e._uU(27,"To Isolator"),e.qZA(),e.TgZ(28,"div",15)(29,"button",16),e.NdJ("click",function(){return i.changePassedFalse()}),e._UZ(30,"i",18),e.qZA()()()()()()(),e.TgZ(31,"mat-dialog-actions",19),e._UZ(32,"button",20),e.TgZ(33,"button",21),e.NdJ("click",function(){return i.complete()}),e.qZA()()),2&t&&(e.xp6(2),e.lnq(" Quality Control (Name: ",i.data.product.nomenclature.name,") (",i.data.currentCount,"/",i.data.count,") "),e.xp6(4),e.Q6J("disabled",i.data.currentCount<=1),e.xp6(1),e.Q6J("disabled",i.data.currentCount>=i.data.count),e.xp6(2),e.Q6J("formGroup",i.form),e.xp6(13),e.ekj("active",!0===i.form.get("is_passed").value),e.xp6(7),e.ekj("active",!1===i.form.get("is_passed").value),e.xp6(3),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("disabled",null===i.form.get("is_passed").value)("loading",i.isPending))},dependencies:[Z.Hq,D.o,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,m.ZT,m.xY,m.H8],styles:[".disabled[_ngcontent-%COMP%]{cursor:default;pointer-events:none;opacity:.6}.step-btn[_ngcontent-%COMP%]{height:2.1875rem}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:2.375rem;height:2.375rem;border:.0625rem solid #ced4da;background:#fff;display:flex;align-items:center;justify-content:center;border-radius:.1875rem;cursor:pointer;color:#fff}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border-color:#2196f3}.column-filter-box[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#2196F3}.column-filter-box[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #a6d5fa}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:default;border:.0625rem solid #ced4da!important}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled.active{opacity:.8}"]}),n})();var $i=_(1481);function Gi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"div",26)(2,"label",27),e._uU(3),e.qZA(),e.TgZ(4,"div",28)(5,"div",29)(6,"div",30)(7,"label",31),e._uU(8,"Comment"),e.qZA(),e._UZ(9,"input",32),e.qZA()(),e.TgZ(10,"div",33)(11,"div",34)(12,"label",15),e._uU(13,"Passed"),e.qZA(),e.TgZ(14,"div",35)(15,"button",36),e.NdJ("click",function(){const c=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.changePassedTrue(c))}),e._UZ(16,"i",37),e.qZA()()()(),e.TgZ(17,"div",33)(18,"div",38)(19,"label",15),e._uU(20,"To Isolator"),e.qZA(),e.TgZ(21,"div",35)(22,"button",36),e.NdJ("click",function(){const c=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.changePassedFalse(c))}),e._UZ(23,"i",39),e.qZA()()()()()()()}if(2&n){const t=r.$implicit,i=r.index,o=e.oxw(3);e.Q6J("formGroupName",i),e.xp6(3),e.hij(" ",o.getParagraphName(t.get("qc_protocol_paragraph").value)," "),e.xp6(4),e.Q6J("for","p-name-"+i),e.xp6(2),e.Q6J("id","p-name-"+i),e.xp6(6),e.ekj("active",!0===t.value.is_passed),e.xp6(7),e.ekj("active",!1===t.value.is_passed)}}function Bi(n,r){if(1&n&&(e.TgZ(0,"div",23)(1,"label"),e._uU(2,"Protocol Paragraph"),e.qZA(),e.YNc(3,Gi,24,8,"div",24),e.qZA()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.answerParagraphs.controls)}}function Hi(n,r){1&n&&(e.TgZ(0,"div",40),e._uU(1," There are no paragraphs of the protocol "),e.qZA())}function Ki(n,r){if(1&n&&(e.TgZ(0,"a",43),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=r.index,o=e.oxw(3);e.Q6J("href",o.link+t.file,e.LSH),e.xp6(1),e.AsE(" ",i+1,". ",o.getFileName(null==t?null:t.file)," ")}}function zi(n,r){if(1&n&&(e.TgZ(0,"div",41),e.YNc(1,Ki,2,3,"a",42),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.files)}}function Wi(n,r){1&n&&(e.TgZ(0,"div",40),e._uU(1," There are no files of the protocol "),e.qZA())}function Vi(n,r){if(1&n&&(e.TgZ(0,"div")(1,"form",13)(2,"div",14)(3,"label",15),e._uU(4," Serial Number "),e.qZA(),e.TgZ(5,"div",16),e._UZ(6,"input",17),e.qZA()(),e.YNc(7,Bi,4,1,"div",18),e.YNc(8,Hi,2,0,"ng-template",null,19,e.W1O),e.qZA(),e.TgZ(10,"div",20)(11,"h4"),e._uU(12,"Protocol Files:"),e.qZA()(),e.YNc(13,zi,2,1,"div",21),e.YNc(14,Wi,2,0,"ng-template",null,22,e.W1O),e.qZA()),2&n){const t=e.MAs(9),i=e.MAs(15),o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.form),e.xp6(6),e.Q6J("ngIf",o.answerParagraphs.length>0)("ngIfElse",t),e.xp6(6),e.Q6J("ngIf",o.files.length>0)("ngIfElse",i)}}function Xi(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.complete())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.hasComplete)}}function eo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"button",45),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.save())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",!t.hasComplete)}}function to(n,r){}function no(n,r){1&n&&(e.TgZ(0,"div",46),e._UZ(1,"i",47),e.qZA())}let io=(()=>{class n{constructor(t,i,o,c,a,s,u,h){this.fb=t,this.dialogRef=i,this.qcProtocolService=o,this.domSanitizer=c,this.qrCodeService=a,this.adapterService=s,this.modalService=u,this.data=h,this.isLoading=!0,this.isGeneratedNumber=!1,this.paragraphs=[],this.hasComplete=!1,this.isLoadingFiles=!0,this.files=[],this.serialNumbers=[],this.defaultSerialNumbers=[],this.form=this.fb.group({serial_number:[null,l.kI.required],invoice_product:[null],invoice_product_id:[null],order_product:[null],protocol:[null],paragraphs:this.fb.array([]),serial:[null]}),this.link=Q.N.image_path}get answerParagraphs(){return this.form.get("paragraphs")}ngOnInit(){if(this.data.currentCount>this.data.count&&(this.data.currentCount=this.data.count),this.serialNumbers=this.data.product.totalSerialNumbers,this.serialNumbers.forEach(i=>{i.traversed=null!==i.is_passed}),this.defaultSerialNumbers=JSON.parse(JSON.stringify(this.serialNumbers)),this.serialNumbers.sort((i,o)=>i.id-o.id),this.currentCount=JSON.parse(JSON.stringify(this.data.currentCount)),this.data.foundSerialId){const i=this.serialNumbers.findIndex(o=>+o.id===this.data.foundSerialId);[this.serialNumbers[0],this.serialNumbers[i]]=[this.serialNumbers[i],this.serialNumbers[0]]}const t=this.serialNumbers[this.data.currentCount-1];console.log("serialObject",t),t&&t?.type_with_number?this.form.get("serial").patchValue(t?.type_with_number):this.form.get("serial").patchValue(t?.id),t&&this.form.get("serial_number").patchValue(t.id),t.invoice_product_id&&this.form.get("invoice_product_id").patchValue(t.invoice_product_id),this.getFiles(),this.getProtocol()}showButtonSave(){return Boolean(0===this.serialNumbers[this.data.currentCount-1].warehouseproductqcprotocol_set.length)}generateSerialNumber(){this.form.get("serial_number").patchValue("Serial Number"),this.isGeneratedNumber=!0}nextSerial(){this.data.currentCount<this.data.count&&(this.data.currentCount+=1,this.saveSerialInfo())}prevSerial(){this.data.currentCount>=1&&(this.data.currentCount-=1,this.saveSerialInfo())}saveSerialInfo(){const t=this.serialNumbers[this.data.currentCount-1];t.invoice_product_id&&this.form.get("invoice_product_id").patchValue(t.invoice_product_id),t&&t?.type_with_number?this.form.get("serial").patchValue(t?.type_with_number):this.form.get("serial").patchValue(t?.id),t&&(this.form.get("paragraphs").value[0].is_passed=t.is_passed,this.form.get("serial_number").patchValue(t.id)),this.form.get("paragraphs").controls[0].get("comment").patchValue(t.warehouseproductqcprotocol_set.length>0?t.warehouseproductqcprotocol_set[0].paragraphs[0].comment:""),this.form.get("paragraphs").controls[0].get("is_passed").patchValue(t.is_passed),null!==this.form.get("paragraphs").controls[0].get("is_passed").value&&(this.hasComplete=!0)}getProtocol(){(0,M.D)({protocol:this.qcProtocolService.getOne(this.data.product.nomenclature.qc_protocol),paragraphs:this.qcProtocolService.getParagraphs([{name:"protocol_ids",value:this.data.product.nomenclature.qc_protocol}])}).subscribe(({protocol:t,paragraphs:i})=>{this.protocol=t,this.paragraphs=i,"invoice"===this.data.type&&this.form.get("invoice_product").patchValue(this.data.product.id),"order"===this.data.type&&this.form.get("order_product").patchValue(this.data.product.id),this.form.get("protocol").patchValue(this.data.product.nomenclature.qc_protocol),this.updateParagraphs(),null!==this.form.get("paragraphs").controls[0].get("is_passed").value&&(this.hasComplete=!0),this.isLoading=!1})}updateParagraphs(){const t=this.serialNumbers[this.data.currentCount-1];this.paragraphs.forEach(i=>{this.form.get("paragraphs").push(this.fb.group({qc_protocol_paragraph:[i.id],comment:[t.warehouseproductqcprotocol_set.length>0?t.warehouseproductqcprotocol_set[0].paragraphs[0].comment:""],is_passed:[t.is_passed]}))})}getParagraphName(t){let i=`${this.paragraphs.find(o=>o.id===t).name}`;return this.paragraphs.find(o=>o.id===t).comment&&(i+=` (${this.paragraphs.find(o=>o.id===t).comment})`),i}changePassedTrue(t){const i=this.form.get("paragraphs").value.findIndex(o=>o.qc_protocol_paragraph===t.value.qc_protocol_paragraph);this.form.get("paragraphs").controls[i].get("is_passed").value?(this.form.get("paragraphs").controls[i].get("is_passed").patchValue(null),this.hasComplete=!1):(this.form.get("paragraphs").controls[i].get("is_passed").patchValue(!0),this.hasComplete=!0)}changePassedFalse(t){const i=this.form.get("paragraphs").value.findIndex(o=>o.qc_protocol_paragraph===t.value.qc_protocol_paragraph);!1===this.form.get("paragraphs").controls[i].get("is_passed").value?(this.form.get("paragraphs").controls[i].get("is_passed").patchValue(null),this.hasComplete=!1):(this.form.get("paragraphs").controls[i].get("is_passed").patchValue(!1),this.hasComplete=!0)}generateQrCode(){this.qrCodeService.generateQrCodes({by_nomenclatures_list:[{nomenclature_id:13237,serial_number_ids:[46],order_product_ids:[],invoice_product_ids:[]}]}).subscribe(i=>{this.qrCode=i.with_serial[0].code[0],this.qrCode.qr_src=this.domSanitizer.bypassSecurityTrustUrl("data:image/svg+xml;base64,"+this.qrCode.qr_src)})}complete(){if(this.form.value){const t={...this.form.value};if("invoice"===this.data.type){const i=this.data.product.invoiceProducts.find(o=>o.serial_numbers.findIndex(c=>c.id===t.serial_number)>=0);t.invoice_product=i.id,delete t.order_product}if("order"===this.data.type){const i=this.data.product.orderProducts.find(o=>o.serial_numbers.findIndex(c=>c.id===t.serial_number)>=0);t.order_product=i.id,delete t.invoice_product}delete t.serial,t.serial_number=this.form.get("serial_number").value,this.qcProtocolService.productsToQc(t).subscribe(()=>{this.data.currentCount===this.data.count?this.dialogRef.close(!0):(this.hasComplete=!1,this.data.currentCount++,this.saveSerialInfo())})}}save(){const t={...this.form.value},i=this.serialNumbers[this.data.currentCount-1].warehouseproductqcprotocol_set[0].id;if("invoice"===this.data.type){const o=this.data.product.invoiceProducts.find(c=>c.serial_numbers.findIndex(a=>a.id===t.serial_number)>=0);t.invoice_product=o.id,delete t.order_product}if("order"===this.data.type){const o=this.data.product.orderProducts.find(c=>c.serial_numbers.findIndex(a=>a.id===t.serial_number)>=0);t.order_product=o.id,delete t.invoice_product}delete t.serial,t.serial_number=+this.form.get("serial_number").value,t.paragraphs[0].id=this.serialNumbers[this.data.currentCount-1].warehouseproductqcprotocol_set[0].paragraphs[0].id,this.qcProtocolService.updateProductProtocol(t,i).subscribe(()=>{this.data.currentCount===this.data.count?this.dialogRef.close(!0):(this.hasComplete=!1,this.data.currentCount++,this.saveSerialInfo())})}downloadFile(t){this.qcProtocolService.downloadFile(t.id).subscribe(i=>{const o=this.getFileName(t.file);this.adapterService.downloadFile(o,i)})}close(){this.dialogRef.close(this.currentCount!==this.data.currentCount)}getFileName(t){const i=t.split("/");return i[i.length-1]}getFiles(){this.qcProtocolService.getFiles([{name:"qc_protocol_id",value:this.data.product.nomenclature.qc_protocol}]).subscribe(t=>{this.files=t,this.isLoadingFiles=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.qu),e.Y36(m.so),e.Y36(W),e.Y36($i.H7),e.Y36(K.D),e.Y36(j.v),e.Y36(L.Z),e.Y36(m.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-move-qc-with-protocol"]],decls:18,vars:10,consts:[[1,"modal-header-container","align-items-start","d-flex","justify-content-between"],["mat-dialog-title","",1,"modal-heading"],[1,"tools"],["pButton","",3,"click"],["pButton","","type","button","size","s","icon","pi pi-arrow-left",1,"p-button-icon","ml-3",3,"disabled","click"],["pButton","","type","button","icon","pi pi-arrow-right",1,"p-button-icon","ml-3",3,"disabled","click"],[4,"ngIf","ngIfElse"],[1,"d-flex","justify-content-between"],["pButton","","label","Cancel","type","button",1,"p-button-danger",3,"click"],["pButton","","type","button","label","Complete","class","p-button-secondary",3,"disabled","click",4,"ngIf"],["pButton","","type","button","label","Save","class","p-button-secondary",3,"disabled","click",4,"ngIf"],["createBtn",""],["loading",""],[3,"formGroup"],[1,"form-group"],["for","serial"],[1,"serial"],["pInputText","","formControlName","serial","type","text","id","serial",1,"form-control","disabled"],["formArrayName","paragraphs",4,"ngIf","ngIfElse"],["empty",""],[1,"upload-header"],["class","files-list",4,"ngIf","ngIfElse"],["emptyFiles",""],["formArrayName","paragraphs"],["class","paragraphs__row",3,"formGroupName",4,"ngFor","ngForOf"],[1,"paragraphs__row",3,"formGroupName"],[1,"paragraph-row"],[2,"font-weight","500","font-size","16px"],[1,"row"],[1,"col-9"],[1,"form-group","form-group_text"],[3,"for"],["pInputText","","formControlName","comment","type","text",1,"form-control",3,"id"],[1,"col-1"],[1,"form-group","passing"],[1,"column-filter-box"],["type","button",3,"click"],[1,"pi","pi-check"],[1,"passing","form-group"],[1,"pi","pi-times"],[1,"empty-text"],[1,"files-list"],["class","file",3,"href",4,"ngFor","ngForOf"],[1,"file",3,"href"],["pButton","","type","button","label","Complete",1,"p-button-secondary",3,"disabled","click"],["pButton","","type","button","label","Save",1,"p-button-secondary",3,"disabled","click"],[1,"d-flex","justify-content-center"],[1,"fas","fa-circle-notch","fa-spin","fa-3x"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return i.generateQrCode()}),e._uU(5,"Generate QR-code"),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return i.prevSerial()}),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(){return i.nextSerial()}),e.qZA()()(),e.TgZ(8,"mat-dialog-content"),e.YNc(9,Vi,16,5,"div",6),e.qZA(),e.TgZ(10,"mat-dialog-actions",7)(11,"button",8),e.NdJ("click",function(){return i.close()}),e.qZA(),e.YNc(12,Xi,1,1,"button",9),e.YNc(13,eo,1,1,"button",10),e.qZA(),e.YNc(14,to,0,0,"ng-template",null,11,e.W1O),e.YNc(16,no,2,0,"ng-template",null,12,e.W1O)),2&t){const o=e.MAs(17);e.xp6(2),e.HOy(" Quality Control with Protocol \xab",i.isLoading?"...":i.protocol.name,"\xbb (Name: ",i.data.product.nomenclature.name,") (",i.data.currentCount,"/",i.data.count,") "),e.xp6(4),e.Q6J("disabled",i.data.currentCount<=1),e.xp6(1),e.Q6J("disabled",i.data.currentCount>=i.data.count),e.xp6(2),e.Q6J("ngIf",!i.isLoading)("ngIfElse",o),e.xp6(3),e.Q6J("ngIf",i.showButtonSave()),e.xp6(1),e.Q6J("ngIf",!i.showButtonSave())}},dependencies:[g.sg,g.O5,Z.Hq,D.o,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,l.x0,l.CE,m.uh,m.xY,m.H8],styles:[".disabled[_ngcontent-%COMP%]{cursor:default;pointer-events:none;opacity:.6}.tools[_ngcontent-%COMP%]{white-space:nowrap}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:2.375rem;height:2.375rem;border:.0625rem solid #ced4da;background:#fff;display:flex;align-items:center;justify-content:center;border-radius:.1875rem;cursor:pointer;color:#fff}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{border-color:#2196f3}.column-filter-box[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#2196F3}.column-filter-box[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #a6d5fa}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{cursor:default;border:.0625rem solid #ced4da!important}.column-filter-box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled.active{opacity:.8}"]}),n})(),oo=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i}ngOnInit(){}onAccept(){this.dialogRef.close(!0)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m.so),e.Y36(m.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-found-product-in-qc"]],decls:10,vars:3,consts:[[1,"modal-header"],[1,"modal-header__title"],[1,"capitalize"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button","label","Quality Control",1,"p-button-success",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"h2",1)(2,"span",2),e._uU(3,"product found"),e.qZA()()(),e.TgZ(4,"mat-dialog-content")(5,"span"),e._uU(6),e.qZA()(),e.TgZ(7,"mat-dialog-actions",3),e._UZ(8,"button",4),e.TgZ(9,"button",5),e.NdJ("click",function(){return i.onAccept()}),e.qZA()()),2&t&&(e.xp6(6),e.AsE(" ",i.data.nomenclature.code," ",i.data.nomenclature.name," "),e.xp6(2),e.Q6J("mat-dialog-close",!1))},dependencies:[Z.Hq,m.ZT,m.xY,m.H8]}),n})(),me=(()=>{class n{constructor(t){this.dialog=t}controlProduct(t,i=!1){return this.dialog.open(hi,{width:"50rem",data:{type:"edit",entity:t,isOwnProduction:i},disableClose:!0,autoFocus:!1}).afterClosed().pipe()}serializedControlProduct(t,i,o,c,a=null){return this.dialog.open(ji,{width:"60rem",data:{product:t,currentCount:i,count:o,type:c,foundSerialId:a},disableClose:!0,autoFocus:!1}).afterClosed().pipe()}withProtocolControlProduct(t,i,o,c,a=null){return this.dialog.open(io,{width:"60rem",data:{product:t,currentCount:i,count:o,type:c,foundSerialId:a},disableClose:!0,autoFocus:!1}).afterClosed().pipe()}controlTechnicalEquipment(t,i=!1){return this.dialog.open(fi,{width:"50rem",data:{type:"edit",entity:t,isOwnProduction:i},disableClose:!0,autoFocus:!1}).afterClosed().pipe()}foundProductInList(t){return this.dialog.open(oo,{width:"50rem",data:{nomenclature:t},disableClose:!1,autoFocus:!1}).afterClosed().pipe()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(m.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ne=_(7850);function ro(n,r){1&n&&(e.ynx(0),e._uU(1,"..."),e.BQk())}function co(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",28),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th",29),e._uU(4,"#"),e.qZA(),e.TgZ(5,"th",30),e._uU(6,"Code"),e.qZA(),e.TgZ(7,"th",31),e._uU(8,"Name"),e.qZA(),e.TgZ(9,"th",32),e._uU(10,"Technology"),e.qZA(),e.TgZ(11,"th",33),e._uU(12,"UOM"),e.qZA(),e.TgZ(13,"th",34),e._uU(14,"Quantity"),e.qZA(),e.TgZ(15,"th",34),e._uU(16,"Passed Qty"),e.qZA(),e.TgZ(17,"th",34),e._uU(18,"Not Passed Qty"),e.qZA(),e.TgZ(19,"th",34),e._uU(20,"Status"),e.qZA()())}function ao(n,r){1&n&&(e.TgZ(0,"p",40),e._uU(1,"Choose the Product to edit"),e.qZA())}function so(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",35),e.YNc(1,ao,2,0,"p",36),e.TgZ(2,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onReworkProduct())}),e.qZA(),e.TgZ(3,"button",38),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onShowImages())}),e.qZA(),e.TgZ(4,"button",39),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onQualityControl())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0===t.selectedOrderProducts.length),e.xp6(1),e.Q6J("loading",t.isReworkingProduct)("disabled",t.isLoadingProducts||0===t.selectedOrderProducts.length||t.selectedOrderProducts.length>1),e.xp6(1),e.Q6J("disabled",t.isLoadingProducts||0===t.selectedOrderProducts.length||t.selectedOrderProducts.length>1),e.xp6(1),e.Q6J("disabled",t.isLoadingProducts||0===t.selectedOrderProducts.length||t.selectedOrderProducts.length>1)}}function lo(n,r){1&n&&(e.TgZ(0,"span",46),e._uU(1,"PASSED"),e.qZA())}function _o(n,r){1&n&&(e.TgZ(0,"span",47),e._uU(1,"PARTLY PASSED"),e.qZA())}function uo(n,r){1&n&&(e.TgZ(0,"span",48),e._uU(1,"NOT PASSED"),e.qZA())}function po(n,r){if(1&n&&(e.TgZ(0,"tr",41)(1,"td",28),e._UZ(2,"p-tableCheckbox",42),e.qZA(),e.TgZ(3,"td",33),e._uU(4),e.qZA(),e.TgZ(5,"td",30),e._uU(6),e.qZA(),e.TgZ(7,"td",31),e._uU(8),e.qZA(),e.TgZ(9,"td",32),e._uU(10),e.qZA(),e.TgZ(11,"td",33),e._uU(12),e.qZA(),e.TgZ(13,"td",34),e._uU(14),e.qZA(),e.TgZ(15,"td",34),e._uU(16),e.qZA(),e.TgZ(17,"td",34),e._uU(18),e.qZA(),e.TgZ(19,"td",34),e.YNc(20,lo,2,0,"span",43),e.YNc(21,_o,2,0,"span",44),e.YNc(22,uo,2,0,"span",45),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Q6J("value",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",t.nomenclature.code," "),e.xp6(2),e.hij(" ",t.nomenclature.name," "),e.xp6(2),e.hij(" ",null==t.current_technology?null:t.current_technology.name," "),e.xp6(2),e.hij(" ",t.nomenclature.category?t.nomenclature.category.unit_of_measure.symbol:"Pcs"," "),e.xp6(2),e.hij(" ",t.totalQuantity," "),e.xp6(2),e.hij(" ",t.totalQuantityPassed," "),e.xp6(2),e.hij(" ",t.totalQuantityNotPassed," "),e.xp6(2),e.Q6J("ngIf",1==t.quality_control),e.xp6(1),e.Q6J("ngIf",2==t.quality_control),e.xp6(1),e.Q6J("ngIf",0==t.quality_control)}}function go(n,r){1&n&&e._UZ(0,"i",52)}function mo(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function ho(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",49),e.YNc(2,go,1,0,"i",50),e.YNc(3,mo,2,0,"span",51),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",11),e.xp6(1),e.Q6J("ngIf",t.isLoadingProducts),e.xp6(1),e.Q6J("ngIf",!t.isLoadingProducts)}}function fo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",53),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(19);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function vo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",54)(1,"p-button",53),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(19);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function xo(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",55),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",30),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",56),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",33),e._uU(8,"UOM"),e.qZA(),e.TgZ(9,"th",34),e._uU(10,"Quantity"),e.qZA(),e.TgZ(11,"th",34),e._uU(12,"Passed Qty"),e.qZA(),e.TgZ(13,"th",34),e._uU(14,"Not Passed Qty"),e.qZA(),e.TgZ(15,"th",34),e._uU(16,"Status"),e.qZA()())}function Zo(n,r){1&n&&(e.TgZ(0,"p",40),e._uU(1,"Choose the Technical Equipment to Quality Control"),e.qZA())}function qo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",35),e.YNc(1,Zo,2,0,"p",36),e.TgZ(2,"button",57),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onQualityControlTechnicalEquipment())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedTechnicalEquipment),e.xp6(1),e.Q6J("disabled",t.isLoadingTechnicalEquipment||!t.selectedTechnicalEquipment)}}function yo(n,r){1&n&&(e.TgZ(0,"span",46),e._uU(1,"PASSED"),e.qZA())}function To(n,r){1&n&&(e.TgZ(0,"span",47),e._uU(1,"PARTLY PASSED"),e.qZA())}function Co(n,r){1&n&&(e.TgZ(0,"span",48),e._uU(1,"NOT PASSED"),e.qZA())}function bo(n,r){if(1&n&&(e.TgZ(0,"tr",41)(1,"td",58),e._uU(2),e.qZA(),e.TgZ(3,"td",30),e._uU(4),e.qZA(),e.TgZ(5,"td",56),e._uU(6),e.qZA(),e.TgZ(7,"td",33),e._uU(8),e.qZA(),e.TgZ(9,"td",34),e._uU(10),e.qZA(),e.TgZ(11,"td",34),e._uU(12),e.qZA(),e.TgZ(13,"td",34),e._uU(14),e.qZA(),e.TgZ(15,"td",34),e.YNc(16,yo,2,0,"span",43),e.YNc(17,To,2,0,"span",44),e.YNc(18,Co,2,0,"span",45),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",t.nomenclature.code," "),e.xp6(2),e.hij(" ",t.nomenclature.name," "),e.xp6(2),e.hij(" ",t.nomenclature.category?t.nomenclature.category.unit_of_measure.symbol:"Pcs"," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",t.passed_quantity," "),e.xp6(2),e.hij(" ",t.not_passed_quantity," "),e.xp6(2),e.Q6J("ngIf",1==t.quality_control),e.xp6(1),e.Q6J("ngIf",2==t.quality_control),e.xp6(1),e.Q6J("ngIf",0==t.quality_control)}}function Qo(n,r){1&n&&e._UZ(0,"i",52)}function Ao(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Po(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",49),e.YNc(2,Qo,1,0,"i",50),e.YNc(3,Ao,2,0,"span",51),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",11),e.xp6(1),e.Q6J("ngIf",t.isLoadingTechnicalEquipment),e.xp6(1),e.Q6J("ngIf",!t.isLoadingTechnicalEquipment)}}function Io(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",53),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(31);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function wo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",54)(1,"p-button",53),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(31);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function No(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"a",59),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.goToOrder())}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.order.id)}}function Uo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"pek-qr-code-scanner",60),e.NdJ("scanned",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.onScanned(o))})("cancel",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onCancelScanned())}),e.qZA()}}let So=(()=>{class n{constructor(t,i,o,c,a,s,u,h){this.route=t,this.router=i,this.orderService=o,this.orderProductService=c,this.modalService=a,this.albumService=s,this.qrCodeService=u,this.qcService=h,this.link=Q.N.link_url+"dash/",this.isLoadingTechnicalEquipment=!0,this.isLoading=!0,this.isLoadingProducts=!0,this.isGenerating=!1,this.isReworking=!1,this.isCompletingProducts=!1,this.isCompleting=!1,this.isReworkingProduct=!1,this.selectedOrderProducts=[],this.orderProducts=[],this.technicalEquipments=[],this.orderCanBeCompleted=!1,this.isScanning=!1}ngOnInit(){this.route.paramMap.pipe((0,x.U)(t=>t.get("id")),(0,p.b)(t=>this.orderId=+t),(0,p.b)(()=>this.getOrder()),(0,p.b)(()=>this.getOrderProducts())).subscribe()}getOrder(){this.orderService.getById(this.orderId).pipe((0,p.b)(t=>this.order=t),(0,p.b)(()=>this.getTechnicalEquipmentToQc()),(0,p.b)(()=>this.isLoading=!1)).subscribe()}getTechnicalEquipmentToQc(){this.technicalEquipments=[],this.isLoadingTechnicalEquipment=!0,this.orderProductService.getTechnicalEquipmentToQC(this.orderId).pipe((0,p.b)(t=>this.technicalEquipments=t),(0,p.b)(()=>this.isLoadingTechnicalEquipment=!1)).subscribe()}getOrderProducts(){this.orderProducts=[],this.selectedOrderProducts=[],this.isLoadingProducts=!0,this.orderProductService.getQc(this.orderId).pipe((0,p.b)(t=>{t.forEach(i=>{const o=i.current_technology?.id,c=i.nomenclature.id,a=this.orderProducts.find(s=>s.nomenclature.id===c&&s.current_technology?.id===o);a?(a.totalQuantity=a.totalQuantity+=i.quantity,a.totalQuantityPassed=a.totalQuantityPassed+=i.passed_quantity,a.totalQuantityNotPassed=a.totalQuantityNotPassed+=i.not_passed_quantity,a.totalSerialNumbers.push(...i.serial_numbers),a.orderProducts.push(i)):(i.orderProducts=[(0,U.p$)(i)],i.totalQuantity=i.quantity,i.totalQuantityPassed=i.passed_quantity,i.totalQuantityNotPassed=i.not_passed_quantity,i.totalSerialNumbers=[...i.serial_numbers],this.orderProducts.push(i))}),this.orderProducts.forEach(i=>{i.totalQuantityPassed===i.totalQuantity?i.quality_control=T.bN.PASSED:i.totalQuantityNotPassed===i.totalQuantity?i.quality_control=T.bN.NOT_PASSED:i.totalQuantityNotPassed+i.totalQuantityPassed===i.totalQuantity&&(i.quality_control=T.bN.PARTLY_PASSED)}),this.orderProducts=[...this.orderProducts]}),(0,p.b)(t=>this.orderCanBeCompleted=Boolean(t.find(i=>i.quality_control))),(0,p.b)(()=>this.isLoadingProducts=!1)).subscribe()}onPrintAlbum(){const t=[];this.selectedOrderProducts.length>0&&t.push(...this.selectedOrderProducts.map(i=>i?.nomenclature)),this.selectedTechnicalEquipment&&t.push(this.selectedTechnicalEquipment.nomenclature),this.albumService.getNomenclaturesImages(t)}goToOrder(){let t;const i=this.order;switch(i.accounting_type){case 1:t="/procurement/chains/order/"+i.id;break;case 2:t="/outsourcing/chains/order/"+i.id;break;case 3:t="/manufacturing/orders/order/"+i.id}window.open(t,"_blank")}onCompleteItems(){this.modalService.confirm("success").pipe((0,y.h)(t=>t)).subscribe(()=>{const t=[],i=[];this.selectedOrderProducts.forEach(o=>{const c=o.orderProducts.filter(a=>!a.nomenclature.qc_protocol&&"0"===a.nomenclature.bulk_or_serial);i.push(...c)}),i.forEach(o=>{t.push({id:o.id,not_passed_quantity:0,passed_quantity:o.quantity,quality_control:1})}),this.isCompletingProducts=!0,this.orderProductService.severalUpdatePartly(t).pipe((0,p.b)(()=>this.getOrderProducts()),(0,p.b)(()=>this.isCompletingProducts=!1)).subscribe()})}onComplete(){this.modalService.confirm("success").pipe((0,y.h)(t=>t)).subscribe(()=>{const t={id:this.order.id,qc_completed:!0};this.isCompleting=!0,this.orderService.updatePartly(t).subscribe(()=>{this.isCompleting=!1,this.router.navigate(["../../"],{relativeTo:this.route})})})}onGenerateQrCodes(){this.isGenerating=!0;const t={by_nomenclatures_list:[]};this.selectedOrderProducts.forEach(i=>{i.orderProducts.forEach(o=>{"1"===o.nomenclature.bulk_or_serial?t.by_nomenclatures_list.push({nomenclature_id:o.nomenclature.id,serial_number_ids:"1"===o.nomenclature.bulk_or_serial?o.serial_numbers.map(c=>+c.id):[],order_product_ids:[o.id],invoice_product_ids:[]}):t.by_nomenclatures_list.findIndex(a=>a.nomenclature_id===o.nomenclature.id)>=0||t.by_nomenclatures_list.push({nomenclature_id:o.nomenclature.id,serial_number_ids:[],order_product_ids:[o.id],invoice_product_ids:[]})})}),this.selectedTechnicalEquipment&&(t.by_nomenclatures_list.findIndex(o=>o.nomenclature_id===this.selectedTechnicalEquipment.nomenclature.id)>=0||t.by_nomenclatures_list.push({nomenclature_id:this.selectedTechnicalEquipment.nomenclature.id,serial_number_ids:[],order_product_ids:[],invoice_product_ids:[]})),this.qrCodeService.generateQrCodes(t,this.order.id).subscribe(()=>this.isGenerating=!1)}onShowImages(){this.modalService.showImageGallery([],this.selectedOrderProducts[0].nomenclature.id,1).subscribe()}onQualityControl(){if(this.selectedOrderProducts[0].nomenclature.qc_protocol&&"1"===this.selectedOrderProducts[0].nomenclature.bulk_or_serial){let t=1;this.selectedOrderProducts[0].passed_quantity&&(t+=this.selectedOrderProducts[0].totalQuantityPassed),this.selectedOrderProducts[0].not_passed_quantity&&(t+=this.selectedOrderProducts[0].totalQuantityNotPassed),this.qcService.withProtocolControlProduct(this.selectedOrderProducts[0],t,this.selectedOrderProducts[0].totalQuantity,"order",this.foundSerialId).subscribe(i=>{i&&(this.selectedOrderProducts=[],this.getOrderProducts())})}else if(this.selectedOrderProducts[0].nomenclature.qc_protocol||"1"!==this.selectedOrderProducts[0].nomenclature.bulk_or_serial)this.qcService.controlProduct(this.selectedOrderProducts[0],!0).subscribe(t=>{t&&(this.getOrderProducts(),this.selectedOrderProducts=[])});else{let t=1;this.selectedOrderProducts[0].passed_quantity&&(t+=this.selectedOrderProducts[0].totalQuantityPassed),this.selectedOrderProducts[0].not_passed_quantity&&(t+=this.selectedOrderProducts[0].totalQuantityNotPassed),this.qcService.serializedControlProduct(this.selectedOrderProducts[0],t,this.selectedOrderProducts[0].totalQuantity,"order",this.foundSerialId).subscribe(i=>{i&&(this.selectedOrderProducts=[],this.getOrderProducts())})}}onRework(){this.modalService.confirm("danger","Confirm").pipe((0,y.h)(t=>t)).subscribe(()=>{this.isReworking=!0;const t=[];this.orderProducts.forEach(i=>{t.push(...i.orderProducts.map(o=>o.id))}),this.orderProductService.reworkOrder(t).subscribe(()=>{this.isReworking=!1,this.router.navigate(["../../"],{relativeTo:this.route})})})}onReworkProduct(){this.modalService.confirm("danger","Confirm").pipe((0,y.h)(t=>t)).subscribe(()=>{this.isReworkingProduct=!0;const t=[],i=[],o=[];this.selectedOrderProducts.forEach(c=>{i.push(c.id),t.push(...c.orderProducts.map(a=>a.id))}),t.forEach(c=>{o.push(this.orderProductService.reworkOrderProduct(c))}),(0,M.D)([...o]).subscribe(()=>{i.forEach(c=>{const a=this.orderProducts.findIndex(s=>s.id===c);this.orderProducts.splice(a,1)}),0!==this.orderProducts.length?(this.selectedOrderProducts=[],this.isReworkingProduct=!1):this.router.navigate(["../../"],{relativeTo:this.route})})})}onQualityControlTechnicalEquipment(){this.qcService.controlTechnicalEquipment(this.selectedTechnicalEquipment,!0).subscribe(t=>{t&&(this.getTechnicalEquipmentToQc(),this.selectedTechnicalEquipment=null)})}onStartScanning(){this.isScanning=!0,this.scanningEnd=!1}onScanned(t){this.scanningEnd=!0,this.isScanning=!1,this.scanForListProduct(t)}scanForListProduct(t=null){this.orderService.scanOrderProductInQc(t,this.orderId).subscribe(i=>{const o=this.orderProducts.find(c=>c.orderProducts.findIndex(a=>a.id===i.found_id)>-1);o&&this.qcService.foundProductInList(o.nomenclature).subscribe(c=>{c&&(t.serial_number&&(this.foundSerialId=t.serial_number),this.selectedOrderProducts=[o],this.onQualityControl())})})}onCancelScanned(){this.scanningEnd=!0,this.isScanning=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.gz),e.Y36(C.F0),e.Y36(R.p),e.Y36(H.c),e.Y36(L.Z),e.Y36(ee.$),e.Y36(K.D),e.Y36(me))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-order"]],decls:41,vars:29,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf","ngIfElse"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-print","label","Print Album",1,"mr-2","p-button-icon",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-camera","label","Scan QR Codes",1,"mr-2","p-button-icon",3,"click"],["pButton","","type","button","icon","pi pi-qrcode","label","Generate QR Codes",1,"mr-2","p-button-icon",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Complete Products",1,"p-button-icon","mr-2",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-refresh","label","Rework All",1,"p-button-icon","p-button-danger","mr-2",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Complete",1,"p-button-icon","p-button-success",3,"loading","disabled","click"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["scrollHeight","calc(100vh - 17rem)","dataKey","id",3,"scrollable","paginator","rows","value","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"mt-4","mb-4"],["selectionMode","single","scrollHeight","calc(100vh - 17rem)","dataKey","id",3,"scrollable","paginator","rows","value","selection","selectionChange"],["st",""],["orderLink",""],[3,"scanned","cancel",4,"ngIf"],[2,"width","3%"],[1,"index-header","text-center",2,"width","5%"],[2,"width","15%"],[2,"width","17%"],[1,"text-center",2,"width","15%"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","10%"],[1,"d-flex"],["class","subtitle",4,"ngIf"],["pButton","","type","button","icon","pi pi-refresh","label","Rework Item",1,"p-button-icon","p-button-danger","ml-auto","mr-2",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-images","label","Show Images",1,"p-button-icon","mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Quality Control",1,"p-button-icon",3,"disabled","click"],[1,"subtitle"],[3,"pSelectableRow"],[3,"value"],["class","badge badge_success",4,"ngIf"],["class","badge badge_warning",4,"ngIf"],["class","badge badge_danger",4,"ngIf"],[1,"badge","badge_success"],[1,"badge","badge_warning"],[1,"badge","badge_danger"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[1,"index-header","text-center",2,"width","8%"],[2,"width","32%"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Quality Control",1,"ml-auto","p-button-icon",3,"disabled","click"],[1,"text-center",2,"width","8%"],[1,"order-link",3,"click"],[3,"scanned","cancel"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5," Order ID "),e.YNc(6,ro,2,0,"ng-container",4),e.qZA()(),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return i.onPrintAlbum()}),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){return i.onStartScanning()}),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.onGenerateQrCodes()}),e.qZA(),e.TgZ(12,"button",9),e.NdJ("click",function(){return i.onCompleteItems()}),e.qZA(),e.TgZ(13,"button",10),e.NdJ("click",function(){return i.onRework()}),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){return i.onComplete()}),e.qZA()()()(),e.TgZ(15,"div",12)(16,"div",13)(17,"div",14)(18,"p-table",15,16),e.NdJ("selectionChange",function(c){return i.selectedOrderProducts=c}),e.YNc(20,co,21,0,"ng-template",17),e.YNc(21,so,5,5,"ng-template",18),e.YNc(22,po,23,13,"ng-template",19),e.YNc(23,ho,4,3,"ng-template",20),e.YNc(24,fo,2,0,"ng-template",21),e.qZA()(),e.YNc(25,vo,3,0,"div",22),e.qZA(),e.TgZ(26,"h2",23),e._uU(27,"Technical Equipment"),e.qZA(),e.TgZ(28,"div",13)(29,"div",14)(30,"p-table",24,25),e.NdJ("selectionChange",function(c){return i.selectedTechnicalEquipment=c}),e.YNc(32,xo,17,0,"ng-template",17),e.YNc(33,qo,3,2,"ng-template",18),e.YNc(34,bo,19,11,"ng-template",19),e.YNc(35,Po,4,3,"ng-template",20),e.YNc(36,Io,2,0,"ng-template",21),e.qZA()(),e.YNc(37,wo,3,0,"div",22),e.qZA()(),e.YNc(38,No,2,1,"ng-template",null,26,e.W1O),e.YNc(40,Uo,1,0,"pek-qr-code-scanner",27)),2&t){const o=e.MAs(19),c=e.MAs(31),a=e.MAs(39);e.xp6(3),e.Q6J("module","warehouse")("isActive",!0),e.xp6(3),e.Q6J("ngIf",i.isLoading)("ngIfElse",a),e.xp6(2),e.Q6J("loading",e.lcZ(9,27,i.albumService.loading$))("disabled",0===i.selectedOrderProducts.length&&!i.selectedTechnicalEquipment),e.xp6(3),e.Q6J("loading",i.isGenerating)("disabled",0===i.selectedOrderProducts.length&&!i.selectedTechnicalEquipment),e.xp6(1),e.Q6J("loading",i.isCompletingProducts)("disabled",0===i.selectedOrderProducts.length),e.xp6(1),e.Q6J("loading",i.isReworking)("disabled",i.isLoading),e.xp6(1),e.Q6J("loading",i.isCompleting)("disabled",!i.orderCanBeCompleted),e.xp6(4),e.Q6J("scrollable",!0)("paginator",!i.isLoadingProducts)("rows",10)("value",i.orderProducts)("selection",i.selectedOrderProducts),e.xp6(7),e.Q6J("ngIf",!o.paginator&&!i.isLoading),e.xp6(5),e.Q6J("scrollable",!0)("paginator",!i.isLoadingTechnicalEquipment&&i.technicalEquipments.length>0)("rows",10)("value",i.technicalEquipments)("selection",i.selectedTechnicalEquipment),e.xp6(7),e.Q6J("ngIf",!c.paginator&&!i.isLoadingTechnicalEquipment&&i.technicalEquipments.length>0),e.xp6(3),e.Q6J("ngIf",i.isScanning)}},dependencies:[g.O5,Z.Hq,Z.zx,I.jx,v.iA,v.Ei,v.UA,v.Mo,N.D,ne.i,g.Ov],styles:[".order-link[_ngcontent-%COMP%]{cursor:pointer}.order-link[_ngcontent-%COMP%]:hover{text-decoration:underline}h2[_ngcontent-%COMP%]{font-size:1.1875rem;font-weight:600}"]}),n})();var Oo=_(3608);function ko(n,r){1&n&&(e.ynx(0),e._uU(1,"..."),e.BQk())}function Jo(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",28),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th",29),e._uU(4,"#"),e.qZA(),e.TgZ(5,"th",30),e._uU(6,"Code"),e.qZA(),e.TgZ(7,"th",31),e._uU(8,"Name"),e.qZA(),e.TgZ(9,"th",32),e._uU(10,"Technology"),e.qZA(),e.TgZ(11,"th",33),e._uU(12,"UOM"),e.qZA(),e.TgZ(13,"th",34),e._uU(14,"Quantity"),e.qZA(),e.TgZ(15,"th",34),e._uU(16,"Passed Qty"),e.qZA(),e.TgZ(17,"th",34),e._uU(18,"Not Passed Qty"),e.qZA(),e.TgZ(19,"th",34),e._uU(20,"Status"),e.qZA()())}function Mo(n,r){1&n&&(e.TgZ(0,"p",39),e._uU(1,"Choose the Product to edit"),e.qZA())}function Lo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",35),e.YNc(1,Mo,2,0,"p",36),e.TgZ(2,"button",37),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onShowImages())}),e.qZA(),e.TgZ(3,"button",38),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onQualityControl())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",0===t.selectedInvoiceProducts.length),e.xp6(1),e.Q6J("disabled",t.isLoadingProducts||0===t.selectedInvoiceProducts.length||t.selectedInvoiceProducts.length>1),e.xp6(1),e.Q6J("disabled",t.isLoadingProducts||0===t.selectedInvoiceProducts.length||t.selectedInvoiceProducts.length>1||t.selectedInvoiceProducts[0].isNonRma)}}function Do(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function Yo(n,r){if(1&n&&(e.TgZ(0,"b",47),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" A (",t.totalQuantityAllocated,") ")}}function Eo(n,r){1&n&&(e.TgZ(0,"span",48),e._uU(1,"PASSED"),e.qZA())}function Fo(n,r){1&n&&(e.TgZ(0,"span",49),e._uU(1,"PARTLY PASSED"),e.qZA())}function Ro(n,r){1&n&&(e.TgZ(0,"span",50),e._uU(1,"NOT PASSED"),e.qZA())}function jo(n,r){if(1&n&&(e.TgZ(0,"tr",40)(1,"td",28),e._UZ(2,"p-tableCheckbox",41),e.qZA(),e.TgZ(3,"td",33),e._uU(4),e.qZA(),e.TgZ(5,"td",30),e._uU(6),e.YNc(7,Do,2,0,"b",42),e.qZA(),e.TgZ(8,"td",31),e._uU(9),e.qZA(),e.TgZ(10,"td",32),e._uU(11),e.qZA(),e.TgZ(12,"td",33),e._uU(13),e.qZA(),e.TgZ(14,"td",34),e._uU(15),e.YNc(16,Yo,2,1,"b",43),e.qZA(),e.TgZ(17,"td",34),e._uU(18),e.qZA(),e.TgZ(19,"td",34),e._uU(20),e.qZA(),e.TgZ(21,"td",34),e.YNc(22,Eo,2,0,"span",44),e.YNc(23,Fo,2,0,"span",45),e.YNc(24,Ro,2,0,"span",46),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex;e.Q6J("pSelectableRow",t)("pSelectableRowDisabled",t.isNonRma),e.xp6(2),e.Q6J("value",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",t.nomenclature.code," "),e.xp6(1),e.Q6J("ngIf",t.rma_status),e.xp6(2),e.hij(" ",t.nomenclature.name," "),e.xp6(2),e.hij(" ",null==t.current_technology?null:t.current_technology.name," "),e.xp6(2),e.hij(" ",t.nomenclature.category?null==t.nomenclature.category||null==t.nomenclature.category.unit_of_measure?null:t.nomenclature.category.unit_of_measure.symbol:"Pcs"," "),e.xp6(2),e.hij(" ",t.totalQuantity," "),e.xp6(1),e.Q6J("ngIf",(t.isNonRma||!t.rma_comment)&&t.totalQuantityAllocated>0),e.xp6(2),e.hij(" ",t.totalQuantityPassed," "),e.xp6(2),e.hij(" ",t.totalQuantityNotPassed," "),e.xp6(2),e.Q6J("ngIf",1==t.quality_control),e.xp6(1),e.Q6J("ngIf",2==t.quality_control),e.xp6(1),e.Q6J("ngIf",0==t.quality_control)}}function $o(n,r){1&n&&e._UZ(0,"i",53)}function Go(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Bo(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",51),e.YNc(2,$o,1,0,"i",52),e.YNc(3,Go,2,0,"span",42),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",11),e.xp6(1),e.Q6J("ngIf",t.isLoadingProducts),e.xp6(1),e.Q6J("ngIf",!t.isLoadingProducts)}}function Ho(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",54),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(19);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Ko(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",55)(1,"p-button",54),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(19);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function zo(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",56),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",30),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",57),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",33),e._uU(8,"UOM"),e.qZA(),e.TgZ(9,"th",34),e._uU(10,"Quantity"),e.qZA(),e.TgZ(11,"th",34),e._uU(12,"Passed Qty"),e.qZA(),e.TgZ(13,"th",34),e._uU(14,"Not Passed Qty"),e.qZA(),e.TgZ(15,"th",34),e._uU(16,"Status"),e.qZA()())}function Wo(n,r){1&n&&(e.TgZ(0,"p",39),e._uU(1,"Choose the Technical Equipment to Quality Control"),e.qZA())}function Vo(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",35),e.YNc(1,Wo,2,0,"p",36),e.TgZ(2,"button",58),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onQualityControlTechnicalEquipment())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedTechnicalEquipment),e.xp6(1),e.Q6J("disabled",t.isLoadingTechnicalEquipment||!t.selectedTechnicalEquipment)}}function Xo(n,r){1&n&&(e.TgZ(0,"span",48),e._uU(1,"PASSED"),e.qZA())}function er(n,r){1&n&&(e.TgZ(0,"span",49),e._uU(1,"PARTLY PASSED"),e.qZA())}function tr(n,r){1&n&&(e.TgZ(0,"span",50),e._uU(1,"NOT PASSED"),e.qZA())}function nr(n,r){if(1&n&&(e.TgZ(0,"tr",59)(1,"td",60),e._uU(2),e.qZA(),e.TgZ(3,"td",30),e._uU(4),e.qZA(),e.TgZ(5,"td",57),e._uU(6),e.qZA(),e.TgZ(7,"td",33),e._uU(8),e.qZA(),e.TgZ(9,"td",34),e._uU(10),e.qZA(),e.TgZ(11,"td",34),e._uU(12),e.qZA(),e.TgZ(13,"td",34),e._uU(14),e.qZA(),e.TgZ(15,"td",34),e.YNc(16,Xo,2,0,"span",44),e.YNc(17,er,2,0,"span",45),e.YNc(18,tr,2,0,"span",46),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.hij(" ",t.nomenclature.code," "),e.xp6(2),e.hij(" ",t.nomenclature.name," "),e.xp6(2),e.hij(" ",t.nomenclature.category?t.nomenclature.category.unit_of_measure.symbol:"Pcs"," "),e.xp6(2),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",t.passed_quantity," "),e.xp6(2),e.hij(" ",t.not_passed_quantity," "),e.xp6(2),e.Q6J("ngIf",1==t.quality_control),e.xp6(1),e.Q6J("ngIf",2==t.quality_control),e.xp6(1),e.Q6J("ngIf",0==t.quality_control)}}function ir(n,r){1&n&&e._UZ(0,"i",53)}function or(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function rr(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",51),e.YNc(2,ir,1,0,"i",52),e.YNc(3,or,2,0,"span",42),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",11),e.xp6(1),e.Q6J("ngIf",t.isLoadingTechnicalEquipment),e.xp6(1),e.Q6J("ngIf",!t.isLoadingTechnicalEquipment)}}function cr(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",54),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(31);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ar(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",55)(1,"p-button",54),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(31);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function sr(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"a",61),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.goToOrder())}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Oqu(null==t.invoice||null==t.invoice.order?null:t.invoice.order.id)}}function lr(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"pek-qr-code-scanner",62),e.NdJ("scanned",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.onScanned(o))})("cancel",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onCancelScanned())}),e.qZA()}}let _r=(()=>{class n{constructor(t,i,o,c,a,s,u,h,f){this.invoiceService=t,this.orderProductService=i,this.invoiceProductService=o,this.qrCodeService=c,this.qcService=a,this.route=s,this.modalService=u,this.albumService=h,this.router=f,this.link=Q.N.link_url+"dash/",this.isLoading=!0,this.isLoadingProducts=!1,this.isLoadingTechnicalEquipment=!0,this.isGenerating=!1,this.isCancellation=!1,this.isCompletingProducts=!1,this.isCompleting=!1,this.invoiceProducts=[],this.selectedInvoiceProducts=[],this.technicalEquipments=[],this.invoiceCanBeCompleted=!1,this.isScanning=!1}ngOnInit(){this.route.paramMap.pipe((0,x.U)(t=>t.get("id")),(0,p.b)(t=>this.invoiceId=+t),(0,p.b)(()=>this.getInvoice()),(0,p.b)(()=>this.getInvoiceProducts())).subscribe()}getInvoice(){this.invoiceService.getById(this.invoiceId).pipe((0,p.b)(t=>this.invoice=t),(0,p.b)(()=>this.getTechnicalEquipmentToQc()),(0,p.b)(()=>this.isLoading=!1)).subscribe()}getInvoiceProducts(){this.invoiceProducts=[],this.selectedInvoiceProducts=[],this.isLoadingProducts=!0,this.invoiceProductService.getInvoiceProducts(this.invoiceId).pipe((0,p.b)(t=>{const i=t.filter(a=>a.allocated_quantity>0),o=this.prepareRMAInvoiceProducts(t,i),c=this.prepareNonRMAInvoiceProducts(t,i);this.invoiceProducts=[...o,...c],this.invoiceProducts.filter(a=>!a.rma_status).forEach(a=>{const s=a.current_technology?.id,u=a.nomenclature.id;this.invoiceProducts.filter(f=>f.nomenclature.id===u&&f.rma_status&&f.current_technology?.id===s).forEach(f=>{f.invoiceProducts.forEach(d=>{a.totalQuantity+=d.accepted_quantity,a.totalQuantityPassed+=d.accepted_quantity})})}),this.invoiceProducts.forEach((a,s)=>{a.idx=`${a.id}${s}`,a.quality_control=null,(a.totalQuantityNotPassed>0||a.totalQuantityPassed>0)&&(a.totalQuantityPassed===a.totalQuantity?a.quality_control=T.bN.PASSED.toString():a.totalQuantityNotPassed===a.totalQuantity?a.quality_control=T.bN.NOT_PASSED.toString():a.totalQuantityNotPassed+a.totalQuantityPassed===a.totalQuantity&&(a.quality_control=T.bN.PARTLY_PASSED.toString()))}),this.invoiceProducts=[...this.invoiceProducts.filter(a=>a.totalQuantity)],this.invoiceProducts.sort((a,s)=>s.rma_comment.localeCompare(a.rma_comment))}),(0,p.b)(t=>this.invoiceCanBeCompleted=Boolean(t.find(i=>i.quality_control))),(0,p.b)(()=>this.isLoadingProducts=!1)).subscribe()}prepareRMAInvoiceProducts(t,i){let o=[];return(0,U.p$)(t).filter(c=>c.rma_status===T.Ro.RECEIVED).forEach(c=>{let a=c;const s=a.current_technology?.id,u=a.nomenclature.id,h=o.find(d=>d.nomenclature.id===u&&d.current_technology?.id===s),f=i.filter(d=>d.nomenclature.id===u&&d.current_technology?.id===s);h?(h.invoiceProducts.push((0,U.p$)(a)),h.totalSerialNumbers.push(...a.serial_numbers.map(d=>({...d,invoice_product_id:a.id}))),h.totalQuantity+=a.quantity,h.totalQuantityPassed+=a.passed_quantity,h.totalQuantityNotPassed+=a.not_passed_quantity):(a.invoiceProducts=[(0,U.p$)(a)],a.totalSerialNumbers=[...a.serial_numbers.map(d=>({...d,invoice_product_id:a.id}))],a.totalQuantity=a.quantity,a.totalQuantityPassed=a.passed_quantity,a.totalQuantityNotPassed=a.not_passed_quantity,a.totalQuantityAllocated=f.reduce((d,Y)=>d+Y.allocated_quantity,0),o.push(a))}),o}prepareNonRMAInvoiceProducts(t,i){let o=[];return(0,U.p$)(t).filter(c=>""===c.rma_status&&""===c.rma_comment||c.rma_status===T.Ro.PASSED).forEach(c=>{let a=c;a.rma_status="";const s=a.current_technology?.id,u=a.nomenclature.id,h=o.find(d=>d.nomenclature.id===u&&d.current_technology?.id===s),f=i.filter(d=>d.nomenclature.id===u&&d.current_technology?.id===s);h?(h.invoiceProducts.push((0,U.p$)(a)),h.totalSerialNumbers.push(...a.serial_numbers.map(d=>({...d,invoice_product_id:a.id}))),h.totalQuantity+=a.quantity,h.totalQuantityPassed+=a.passed_quantity,h.totalQuantityNotPassed+=a.not_passed_quantity):(a.invoiceProducts=[(0,U.p$)(a)],a.totalSerialNumbers=[...a.serial_numbers.map(d=>({...d,invoice_product_id:a.id}))],a.totalQuantity=a.quantity,a.totalQuantityPassed=a.passed_quantity,a.totalQuantityNotPassed=a.not_passed_quantity,a.totalQuantityAllocated=f.reduce((d,Y)=>d+Y.allocated_quantity,0),o.push(a))}),o}getTechnicalEquipmentToQc(){this.isLoadingTechnicalEquipment=!0,this.technicalEquipments=[],this.invoice.order&&this.orderProductService.getTechnicalEquipmentToQC(this.invoice.order.id).pipe((0,p.b)(t=>this.technicalEquipments=t),(0,p.b)(()=>this.isLoadingTechnicalEquipment=!1)).subscribe()}onGenerateQrCodes(){this.isGenerating=!0;const t={by_nomenclatures_list:[]};this.selectedInvoiceProducts.forEach(i=>{i.invoiceProducts.forEach(o=>{"1"===o.nomenclature.bulk_or_serial?t.by_nomenclatures_list.push({nomenclature_id:o.nomenclature.id,serial_number_ids:"1"===o.nomenclature.bulk_or_serial?o.serial_numbers.map(c=>+c.id):[],order_product_ids:[o.id],invoice_product_ids:[]}):t.by_nomenclatures_list.findIndex(a=>a.nomenclature_id===o.nomenclature.id)>=0||t.by_nomenclatures_list.push({nomenclature_id:o.nomenclature.id,serial_number_ids:[],order_product_ids:[o.id],invoice_product_ids:[]})})}),this.qrCodeService.generateQrCodes(t,this.invoice.order.id,this.invoice.self_serial_number).subscribe(()=>this.isGenerating=!1)}onCancellation(){this.modalService.confirm("danger","Confirm").pipe((0,y.h)(t=>t)).subscribe(()=>{this.isCancellation=!0,this.invoiceService.cancellation(this.invoiceId).subscribe(()=>{this.isCancellation=!1,this.router.navigate(["../../"],{relativeTo:this.route})})})}onComplete(){this.modalService.confirm("success").pipe((0,y.h)(t=>t)).subscribe(()=>{const t={id:this.invoice.id,qc_completed:!0};this.isCompleting=!0,this.invoiceService.updatePartly(t).subscribe(()=>{this.isCompleting=!1,this.router.navigate(["../../"],{relativeTo:this.route})})})}onCompleteItems(){this.modalService.confirm("success").pipe((0,y.h)(t=>t)).subscribe(()=>{const t=[],i=[];this.selectedInvoiceProducts.forEach(o=>{const c=o.invoiceProducts.filter(a=>!a.nomenclature.qc_protocol&&"0"===a.nomenclature.bulk_or_serial);i.push(...c)}),i.forEach(o=>{t.push({id:o.id,not_passed_quantity:0,passed_quantity:o.quantity,quality_control:1})}),this.isCompletingProducts=!0,this.invoiceProductService.severalUpdatePartly(t).pipe((0,p.b)(()=>this.getInvoiceProducts()),(0,p.b)(()=>this.isCompletingProducts=!1)).subscribe()})}onShowImages(){this.modalService.showImageGallery([],this.selectedInvoiceProducts[0].nomenclature.id,1).subscribe()}onQualityControl(){if(this.selectedInvoiceProducts[0].nomenclature.qc_protocol&&"1"===this.selectedInvoiceProducts[0].nomenclature.bulk_or_serial){let t=1;this.selectedInvoiceProducts[0].passed_quantity&&(t+=this.selectedInvoiceProducts[0].totalQuantityPassed),this.selectedInvoiceProducts[0].not_passed_quantity&&(t+=this.selectedInvoiceProducts[0].totalQuantityNotPassed),this.qcService.withProtocolControlProduct(this.selectedInvoiceProducts[0],t,this.selectedInvoiceProducts[0].totalQuantity,"invoice",this.foundSerialId).subscribe(i=>{i&&(this.selectedInvoiceProducts=[],this.getInvoiceProducts())})}else if(this.selectedInvoiceProducts[0].nomenclature.qc_protocol||"1"!==this.selectedInvoiceProducts[0].nomenclature.bulk_or_serial)this.qcService.controlProduct(this.selectedInvoiceProducts[0]).subscribe(t=>{t&&(this.selectedInvoiceProducts=null,this.getInvoiceProducts())});else{let t=1;this.selectedInvoiceProducts[0].passed_quantity&&(t+=this.selectedInvoiceProducts[0].totalQuantityPassed),this.selectedInvoiceProducts[0].not_passed_quantity&&(t+=this.selectedInvoiceProducts[0].totalQuantityNotPassed),this.qcService.serializedControlProduct(this.selectedInvoiceProducts[0],t,this.selectedInvoiceProducts[0].totalQuantity,"invoice",this.foundSerialId).subscribe(i=>{i&&(this.selectedInvoiceProducts=[],this.getInvoiceProducts())})}}onPrintAlbum(){this.albumService.getNomenclaturesImages(this.selectedInvoiceProducts.map(t=>t?.nomenclature))}goToOrder(){let t;const i=this.invoice.order;switch(i.accounting_type){case 1:t="/procurement/chains/order/"+i.id;break;case 2:t="/outsourcing/chains/order/"+i.id;break;case 3:t="/manufacturing/orders/order/"+i.id}window.open(t,"_blank")}onQualityControlTechnicalEquipment(){this.qcService.controlTechnicalEquipment(this.selectedTechnicalEquipment,!0).subscribe(t=>{t&&(this.getTechnicalEquipmentToQc(),this.selectedTechnicalEquipment=null)})}onStartScanning(){this.isScanning=!0,this.scanningEnd=!1}onScanned(t){this.scanningEnd=!0,this.isScanning=!1,this.scanForListProduct(t)}scanForListProduct(t=null){this.invoiceService.scanInvoiceProductInQc(t,this.invoiceId).subscribe(i=>{const o=this.invoiceProducts.find(c=>c.invoiceProducts.findIndex(a=>a.id===i.found_id)>-1);o&&this.qcService.foundProductInList(o.nomenclature).subscribe(c=>{c&&(t.serial_number&&(this.foundSerialId=t.serial_number),this.selectedInvoiceProducts=[o],this.onQualityControl())})})}onCancelScanned(){this.scanningEnd=!0,this.isScanning=!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(oe.q),e.Y36(H.c),e.Y36(te.J),e.Y36(K.D),e.Y36(me),e.Y36(C.gz),e.Y36(L.Z),e.Y36(ee.$),e.Y36(C.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-invoice"]],decls:41,vars:29,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf","ngIfElse"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-print","label","Print Album",1,"mr-2","p-button-icon",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-camera","label","Scan QR Codes",1,"mr-2","p-button-icon",3,"click"],["pButton","","type","button","icon","pi pi-qrcode","label","Generate QR Codes",1,"mr-2","p-button-icon",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Complete Products",1,"p-button-icon","mr-2",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-times","label","Cancellation",1,"p-button-icon","p-button-danger","mr-2",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Complete",1,"p-button-icon","p-button-success",3,"loading","disabled","click"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["scrollHeight","calc(100vh - 19rem)","dataKey","idx",3,"scrollable","paginator","rows","value","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","caption"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"mt-4","mb-4"],["selectionMode","single","scrollHeight","calc(100vh - 19rem)","dataKey","id",3,"scrollable","paginator","rows","value","selection","selectionChange"],["st",""],["orderLink",""],[3,"scanned","cancel",4,"ngIf"],[2,"width","3%"],[1,"index-header","text-center",2,"width","5%"],[2,"width","15%"],[2,"width","17%"],[1,"text-center",2,"width","15%"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","10%"],[1,"d-flex"],["class","subtitle",4,"ngIf"],["pButton","","type","button","icon","pi pi-images","label","Show Images",1,"p-button-icon","ml-auto","mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Quality Control",1,"p-button-icon",3,"disabled","click"],[1,"subtitle"],[3,"pSelectableRow","pSelectableRowDisabled"],[3,"value"],[4,"ngIf"],["pTooltip","Allocated products count",4,"ngIf"],["class","badge badge_success",4,"ngIf"],["class","badge badge_warning",4,"ngIf"],["class","badge badge_danger",4,"ngIf"],["pTooltip","Allocated products count"],[1,"badge","badge_success"],[1,"badge","badge_warning"],[1,"badge","badge_danger"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[1,"index-header","text-center",2,"width","8%"],[2,"width","32%"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Quality Control",1,"ml-auto","p-button-icon",3,"disabled","click"],[3,"pSelectableRow"],[1,"text-center",2,"width","8%"],[1,"order-link",3,"click"],[3,"scanned","cancel"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5," Order ID "),e.YNc(6,ko,2,0,"ng-container",4),e.qZA()(),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return i.onPrintAlbum()}),e.ALo(9,"async"),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){return i.onStartScanning()}),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return i.onGenerateQrCodes()}),e.qZA(),e.TgZ(12,"button",9),e.NdJ("click",function(){return i.onCompleteItems()}),e.qZA(),e.TgZ(13,"button",10),e.NdJ("click",function(){return i.onCancellation()}),e.qZA(),e.TgZ(14,"button",11),e.NdJ("click",function(){return i.onComplete()}),e.qZA()()()(),e.TgZ(15,"div",12)(16,"div",13)(17,"div",14)(18,"p-table",15,16),e.NdJ("selectionChange",function(c){return i.selectedInvoiceProducts=c}),e.YNc(20,Jo,21,0,"ng-template",17),e.YNc(21,Lo,4,3,"ng-template",18),e.YNc(22,jo,25,16,"ng-template",19),e.YNc(23,Bo,4,3,"ng-template",20),e.YNc(24,Ho,2,0,"ng-template",21),e.qZA()(),e.YNc(25,Ko,3,0,"div",22),e.qZA(),e.TgZ(26,"h2",23),e._uU(27,"Technical Equipment"),e.qZA(),e.TgZ(28,"div",13)(29,"div",14)(30,"p-table",24,25),e.NdJ("selectionChange",function(c){return i.selectedTechnicalEquipment=c}),e.YNc(32,zo,17,0,"ng-template",17),e.YNc(33,Vo,3,2,"ng-template",18),e.YNc(34,nr,19,11,"ng-template",19),e.YNc(35,rr,4,3,"ng-template",20),e.YNc(36,cr,2,0,"ng-template",21),e.qZA()(),e.YNc(37,ar,3,0,"div",22),e.qZA()(),e.YNc(38,sr,2,1,"ng-template",null,26,e.W1O),e.YNc(40,lr,1,0,"pek-qr-code-scanner",27)),2&t){const o=e.MAs(19),c=e.MAs(31),a=e.MAs(39);e.xp6(3),e.Q6J("module","warehouse")("isActive",!0),e.xp6(3),e.Q6J("ngIf",i.isLoading)("ngIfElse",a),e.xp6(2),e.Q6J("loading",e.lcZ(9,27,i.albumService.loading$))("disabled",0===i.selectedInvoiceProducts.length),e.xp6(3),e.Q6J("loading",i.isGenerating)("disabled",0===i.selectedInvoiceProducts.length),e.xp6(1),e.Q6J("loading",i.isCompletingProducts)("disabled",0===i.selectedInvoiceProducts.length),e.xp6(1),e.Q6J("loading",i.isCancellation)("disabled",i.isLoading),e.xp6(1),e.Q6J("loading",i.isCompleting)("disabled",!i.invoiceCanBeCompleted),e.xp6(4),e.Q6J("scrollable",!0)("paginator",!i.isLoadingProducts)("rows",10)("value",i.invoiceProducts)("selection",i.selectedInvoiceProducts),e.xp6(7),e.Q6J("ngIf",!o.paginator&&!i.isLoading),e.xp6(5),e.Q6J("scrollable",!0)("paginator",!i.isLoadingTechnicalEquipment&&i.technicalEquipments.length>0)("rows",10)("value",i.technicalEquipments)("selection",i.selectedTechnicalEquipment),e.xp6(7),e.Q6J("ngIf",!c.paginator&&!i.isLoadingTechnicalEquipment&&i.technicalEquipments.length>0),e.xp6(3),e.Q6J("ngIf",i.isScanning)}},dependencies:[g.O5,Z.Hq,Z.zx,I.jx,Oo.u,v.iA,v.Ei,v.UA,v.Mo,N.D,ne.i,g.Ov],styles:[".order-link[_ngcontent-%COMP%]{cursor:pointer}.order-link[_ngcontent-%COMP%]:hover{text-decoration:underline}h2[_ngcontent-%COMP%]{font-size:1.1875rem;font-weight:600}"]}),n})();var ur=_(5698),dr=_(428),V=_(384),pr=_(7679),he=_(615),fe=_(8666),E=_(3068);function gr(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,t.currentReqDate,"dd.MM.y")," ")}}function mr(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.AsE(" ",t," ",i?"":","," ")}}function hr(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function fr(n,r){if(1&n&&(e.ynx(0),e.YNc(1,hr,2,0,"span",3),e.BQk()),2&n){const t=r.index,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t!==i.outsourcer.categories.length-1)}}function vr(n,r){if(1&n&&(e.TgZ(0,"div")(1,"div",6)(2,"div")(3,"h2",13),e._uU(4,"Outsourcer"),e.qZA(),e.TgZ(5,"h4")(6,"span"),e._uU(7,"Name:"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"h4")(10,"span"),e._uU(11,"Category:"),e.qZA(),e.YNc(12,fr,2,1,"ng-container",5),e.qZA(),e.TgZ(13,"h4")(14,"span"),e._uU(15,"Address:"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"h4")(18,"span"),e._uU(19,"Tax Number:"),e.qZA(),e._uU(20),e.qZA(),e.TgZ(21,"h4")(22,"span"),e._uU(23,"Register Number:"),e.qZA(),e._uU(24),e.qZA(),e.TgZ(25,"h4")(26,"span"),e._uU(27,"Nomenclature:"),e.qZA(),e._uU(28),e.qZA(),e.TgZ(29,"h4")(30,"span"),e._uU(31,"Description:"),e.qZA()(),e.TgZ(32,"p"),e._uU(33),e.qZA()()()()),2&n){const t=e.oxw(2);e.xp6(8),e.hij(" ",t.outsourcer.name,""),e.xp6(4),e.Q6J("ngForOf",t.outsourcer.categories),e.xp6(4),e.hij(" ",t.outsourcer.address,""),e.xp6(4),e.hij(" ",t.outsourcer.tax_number,""),e.xp6(4),e.hij(" ",t.outsourcer.registration_number,""),e.xp6(4),e.hij(" ",t.outsourcer.supplier_nomenclature,""),e.xp6(5),e.Oqu(t.outsourcer.comment)}}function xr(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("L(",(null==t.ids?null:t.ids.length)+1,")")}}function Zr(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.material_nomenclature.code," ")}}function qr(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.order_product_nomenclature.code," ")}}function yr(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.list_product.nomenclature.code," ")}}function Tr(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function Cr(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Tr,2,0,"b",3),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.material_nomenclature.name," ")}}function br(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function Qr(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,br,2,0,"b",3),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.order_product_nomenclature.name," ")}}function Ar(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function Pr(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ar,2,0,"b",3),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.list_product.nomenclature.name," ")}}function Ir(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.technology)}}function wr(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.material_nomenclature&&null!=t.material_nomenclature.category&&null!=t.material_nomenclature.category.unit_of_measure&&t.material_nomenclature.category.unit_of_measure.symbol?null==t.material_nomenclature||null==t.material_nomenclature.category||null==t.material_nomenclature.category.unit_of_measure?null:t.material_nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function Nr(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.order_product_nomenclature&&null!=t.order_product_nomenclature.category&&null!=t.order_product_nomenclature.category.unit_of_measure&&t.order_product_nomenclature.category.unit_of_measure.symbol?null==t.order_product_nomenclature||null==t.order_product_nomenclature.category||null==t.order_product_nomenclature.category.unit_of_measure?null:t.order_product_nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function Ur(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.list_product.nomenclature&&null!=t.list_product.nomenclature.category&&null!=t.list_product.nomenclature.category.unit_of_measure&&t.list_product.nomenclature.category.unit_of_measure.symbol?null==t.list_product.nomenclature||null==t.list_product.nomenclature.category||null==t.list_product.nomenclature.category.unit_of_measure?null:t.list_product.nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function Sr(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function Or(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.YNc(2,Sr,2,0,"span",3),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",t.name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function kr(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Or,3,2,"div",5),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.unique_locators)}}function Jr(n,r){if(1&n&&(e.TgZ(0,"div",14)(1,"div",15)(2,"div",16)(3,"h3"),e._uU(4,"ID"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.YNc(7,xr,2,1,"span",3),e.qZA()(),e.TgZ(8,"div",16)(9,"h3"),e._uU(10,"Code"),e.qZA(),e.YNc(11,Zr,2,1,"div",3),e.YNc(12,qr,2,1,"div",3),e.YNc(13,yr,2,1,"div",3),e.qZA(),e.TgZ(14,"div",16)(15,"h3"),e._uU(16,"Name"),e.qZA(),e.YNc(17,Cr,3,2,"div",3),e.YNc(18,Qr,3,2,"div",3),e.YNc(19,Pr,3,2,"div",3),e.qZA(),e.TgZ(20,"div",17)(21,"h3"),e._uU(22,"Technology"),e.qZA(),e.YNc(23,Ir,2,1,"span",3),e.qZA(),e.TgZ(24,"div",17)(25,"h3"),e._uU(26,"UOM"),e.qZA(),e.YNc(27,wr,2,1,"div",3),e.YNc(28,Nr,2,1,"div",3),e.YNc(29,Ur,2,1,"div",3),e.qZA(),e.TgZ(30,"div",16)(31,"h3"),e._uU(32,"Required Quantity"),e.qZA(),e._uU(33),e.qZA(),e.TgZ(34,"div",16)(35,"h3"),e._uU(36,"Locator"),e.qZA(),e.YNc(37,kr,2,1,"div",3),e.qZA(),e.TgZ(38,"div",16)(39,"h3"),e._uU(40,"Type"),e.qZA(),e.TgZ(41,"p"),e._uU(42),e.qZA()(),e.TgZ(43,"div",16)(44,"h3"),e._uU(45,"Status"),e.qZA(),e.TgZ(46,"p"),e._uU(47),e.qZA()()(),e.TgZ(48,"div",16)(49,"h3"),e._uU(50,"Quantity"),e.qZA(),e.TgZ(51,"p"),e._uU(52,"_________"),e.qZA()(),e.TgZ(53,"div",16)(54,"h3"),e._uU(55,"Packing"),e.qZA(),e.TgZ(56,"p"),e._uU(57,"_________"),e.qZA()()()),2&n){const t=r.$implicit,i=e.oxw(2);e.xp6(6),e.hij("",t.id," "),e.xp6(1),e.Q6J("ngIf",(null==t.ids?null:t.ids.length)>0),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.Q6J("ngIf",t.technology),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.hij(" ",t.total_required_quantity," "),e.xp6(4),e.Q6J("ngIf",t.locators),e.xp6(5),e.Oqu(i.getType(null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.type)),e.xp6(5),e.Oqu(null==t.qc_delivery_status?null:t.qc_delivery_status.name)}}function Mr(n,r){1&n&&(e.TgZ(0,"div")(1,"div",2)(2,"div")(3,"h2",13),e._uU(4,"Technical Equipments"),e.qZA()()()())}function Lr(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function Dr(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.YNc(2,Lr,2,0,"span",3),e.qZA()),2&n){const t=r.$implicit,i=r.last,o=e.oxw(5);e.xp6(1),e.hij(" ",o.getLocator(t).name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function Yr(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Dr,3,2,"div",5),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.locators)}}function Er(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function Fr(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Er,2,0,"span",3),e.qZA()),2&n){const t=r.$implicit,i=r.last,o=e.oxw(5);e.xp6(1),e.hij(" ",o.getLocator(t).name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function Rr(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Fr,3,2,"span",5),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.available_locators)}}function jr(n,r){if(1&n&&(e.TgZ(0,"div",14)(1,"div",15)(2,"div",16)(3,"h3"),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"div"),e._uU(6),e.qZA()(),e.TgZ(7,"div",16)(8,"h3"),e._uU(9,"Name"),e.qZA(),e._uU(10),e.qZA(),e.TgZ(11,"div",16)(12,"h3"),e._uU(13,"Locators"),e.qZA(),e.YNc(14,Yr,2,1,"div",3),e.YNc(15,Rr,2,1,"div",3),e.qZA(),e.TgZ(16,"div",16)(17,"h3"),e._uU(18,"Required Quantity"),e.qZA(),e._uU(19),e.qZA()()()),2&n){const t=r.$implicit,i=e.oxw(3);e.xp6(6),e.hij(" ",i.getNomenclature(t.nomenclature).code,""),e.xp6(4),e.hij(" ",i.getNomenclature(t.nomenclature).name," "),e.xp6(4),e.Q6J("ngIf",t.locators.length>0),e.xp6(1),e.Q6J("ngIf",t.locators.length<1),e.xp6(4),e.hij(" ",t.max_initial_quantity," ")}}function $r(n,r){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,jr,20,5,"div",7),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.technicalEquipments)}}function Gr(n,r){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div")(3,"h2"),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div")(8,"h2"),e._uU(9,"Name"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA()(),e.TgZ(12,"div")(13,"h2"),e._uU(14,"Order ID"),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA()(),e.TgZ(17,"div"),e._UZ(18,"h2")(19,"p"),e.qZA(),e.TgZ(20,"div")(21,"h2"),e._uU(22,"Production List Creation Date"),e.qZA(),e.TgZ(23,"p"),e._uU(24),e.ALo(25,"date"),e.qZA()(),e.TgZ(26,"div")(27,"h2"),e._uU(28,"Request Creation Date"),e.qZA(),e.TgZ(29,"p"),e.YNc(30,gr,3,4,"ng-container",3),e.qZA()(),e.TgZ(31,"div",4)(32,"h2"),e._uU(33,"Technologies"),e.qZA(),e.TgZ(34,"p"),e.YNc(35,mr,2,2,"span",5),e.qZA()()(),e.YNc(36,vr,34,7,"div",3),e.TgZ(37,"div",6),e.YNc(38,Jr,58,16,"div",7),e.YNc(39,Mr,5,0,"div",3),e.YNc(40,$r,2,1,"div",8),e.TgZ(41,"div",9)(42,"div",10)(43,"div",11)(44,"div")(45,"h3"),e._uU(46,"Sent"),e.qZA(),e.TgZ(47,"p"),e._uU(48),e.qZA()(),e.TgZ(49,"div")(50,"h3"),e._uU(51,"Date"),e.qZA(),e.TgZ(52,"p"),e._uU(53),e.ALo(54,"date"),e.qZA()(),e.TgZ(55,"div")(56,"h3"),e._uU(57,"Signed"),e.qZA()()(),e.TgZ(58,"div",12)(59,"div")(60,"h3"),e._uU(61,"Retrieved"),e.qZA(),e._UZ(62,"p"),e.qZA(),e.TgZ(63,"div")(64,"h3"),e._uU(65,"Date"),e.qZA(),e._UZ(66,"p"),e.qZA(),e.TgZ(67,"div")(68,"h3"),e._uU(69,"Signed"),e.qZA()()()()()()()),2&n){const t=e.oxw();e.xp6(6),e.Oqu(null==t.rootList?null:t.rootList.nomenclature.code),e.xp6(5),e.Oqu(null==t.rootList||null==t.rootList.nomenclature?null:t.rootList.nomenclature.name),e.xp6(5),e.Oqu(t.orderId),e.xp6(8),e.Oqu(e.xi3(25,13,null==t.rootList||null==t.rootList.list?null:t.rootList.list.created,"dd.MM.y")),e.xp6(6),e.Q6J("ngIf",t.currentReqDate),e.xp6(5),e.Q6J("ngForOf",t.technologies),e.xp6(1),e.Q6J("ngIf",t.outsourcer),e.xp6(2),e.Q6J("ngForOf",t.requests),e.xp6(1),e.Q6J("ngIf",t.technicalEquipments.length>0),e.xp6(1),e.Q6J("ngIf",t.technicalEquipments.length>0),e.xp6(8),e.AsE("",t.auth.user.first_name," ",t.auth.user.last_name,""),e.xp6(5),e.Oqu(e.xi3(54,16,t.currentDate,"dd.MM.y"))}}function Br(n,r){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,t.currentReqDate,"dd.MM.y")," ")}}function Hr(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.AsE(" ",t," ",i?"":","," ")}}function Kr(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function zr(n,r){if(1&n&&(e.ynx(0),e.YNc(1,Kr,2,0,"span",3),e.BQk()),2&n){const t=r.index,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t!==i.outsourcer.categories.length-1)}}function Wr(n,r){if(1&n&&(e.TgZ(0,"div")(1,"div",6)(2,"div")(3,"h2",13),e._uU(4,"Outsourcer"),e.qZA(),e.TgZ(5,"h4")(6,"span"),e._uU(7,"Name:"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"h4")(10,"span"),e._uU(11,"Category:"),e.qZA(),e.YNc(12,zr,2,1,"ng-container",5),e.qZA(),e.TgZ(13,"h4")(14,"span"),e._uU(15,"Address:"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"h4")(18,"span"),e._uU(19,"Tax Number:"),e.qZA(),e._uU(20),e.qZA(),e.TgZ(21,"h4")(22,"span"),e._uU(23,"Register Number:"),e.qZA(),e._uU(24),e.qZA(),e.TgZ(25,"h4")(26,"span"),e._uU(27,"Nomenclature:"),e.qZA(),e._uU(28),e.qZA(),e.TgZ(29,"h4")(30,"span"),e._uU(31,"Description:"),e.qZA()(),e.TgZ(32,"p"),e._uU(33),e.qZA()()()()),2&n){const t=e.oxw(2);e.xp6(8),e.hij(" ",t.outsourcer.name,""),e.xp6(4),e.Q6J("ngForOf",t.outsourcer.categories),e.xp6(4),e.hij(" ",t.outsourcer.address,""),e.xp6(4),e.hij(" ",t.outsourcer.tax_number,""),e.xp6(4),e.hij(" ",t.outsourcer.registration_number,""),e.xp6(4),e.hij(" ",t.outsourcer.supplier_nomenclature,""),e.xp6(5),e.Oqu(t.outsourcer.comment)}}function Vr(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("L(",(null==t.ids?null:t.ids.length)+1,")")}}function Xr(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.material_nomenclature.code," ")}}function ec(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.order_product_nomenclature.code," ")}}function tc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.list_product.nomenclature.code," ")}}function nc(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function ic(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,nc,2,0,"b",3),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.material_nomenclature.name," ")}}function oc(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function rc(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,oc,2,0,"b",3),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.order_product_nomenclature.name," ")}}function cc(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function ac(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,cc,2,0,"b",3),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.list_product.nomenclature.name," ")}}function sc(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.technology)}}function lc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.material_nomenclature&&null!=t.material_nomenclature.category&&null!=t.material_nomenclature.category.unit_of_measure&&t.material_nomenclature.category.unit_of_measure.symbol?null==t.material_nomenclature||null==t.material_nomenclature.category||null==t.material_nomenclature.category.unit_of_measure?null:t.material_nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function _c(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.order_product_nomenclature&&null!=t.order_product_nomenclature.category&&null!=t.order_product_nomenclature.category.unit_of_measure&&t.order_product_nomenclature.category.unit_of_measure.symbol?null==t.order_product_nomenclature||null==t.order_product_nomenclature.category||null==t.order_product_nomenclature.category.unit_of_measure?null:t.order_product_nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function uc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.list_product.nomenclature&&null!=t.list_product.nomenclature.category&&null!=t.list_product.nomenclature.category.unit_of_measure&&t.list_product.nomenclature.category.unit_of_measure.symbol?null==t.list_product.nomenclature||null==t.list_product.nomenclature.category||null==t.list_product.nomenclature.category.unit_of_measure?null:t.list_product.nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function dc(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function pc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.YNc(2,dc,2,0,"span",3),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",t.name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function gc(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,pc,3,2,"div",5),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.unique_locators)}}function mc(n,r){if(1&n&&(e.TgZ(0,"div",14)(1,"div",15)(2,"div",16)(3,"h3"),e._uU(4,"ID"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.YNc(7,Vr,2,1,"span",3),e.qZA()(),e.TgZ(8,"div",16)(9,"h3"),e._uU(10,"Code"),e.qZA(),e.YNc(11,Xr,2,1,"div",3),e.YNc(12,ec,2,1,"div",3),e.YNc(13,tc,2,1,"div",3),e.qZA(),e.TgZ(14,"div",16)(15,"h3"),e._uU(16,"Name"),e.qZA(),e.YNc(17,ic,3,2,"div",3),e.YNc(18,rc,3,2,"div",3),e.YNc(19,ac,3,2,"div",3),e.qZA(),e.TgZ(20,"div",17)(21,"h3"),e._uU(22,"Technology"),e.qZA(),e.YNc(23,sc,2,1,"span",3),e.qZA(),e.TgZ(24,"div",17)(25,"h3"),e._uU(26,"UOM"),e.qZA(),e.YNc(27,lc,2,1,"div",3),e.YNc(28,_c,2,1,"div",3),e.YNc(29,uc,2,1,"div",3),e.qZA(),e.TgZ(30,"div",16)(31,"h3"),e._uU(32,"Required Quantity"),e.qZA(),e._uU(33),e.qZA(),e.TgZ(34,"div",16)(35,"h3"),e._uU(36,"Locator"),e.qZA(),e.YNc(37,gc,2,1,"div",3),e.qZA(),e.TgZ(38,"div",16)(39,"h3"),e._uU(40,"Type"),e.qZA(),e.TgZ(41,"p"),e._uU(42),e.qZA()(),e.TgZ(43,"div",16)(44,"h3"),e._uU(45,"Status"),e.qZA(),e.TgZ(46,"p"),e._uU(47),e.qZA()()(),e.TgZ(48,"div",16)(49,"h3"),e._uU(50,"Quantity"),e.qZA(),e.TgZ(51,"p"),e._uU(52,"_________"),e.qZA()(),e.TgZ(53,"div",16)(54,"h3"),e._uU(55,"Packing"),e.qZA(),e.TgZ(56,"p"),e._uU(57,"_________"),e.qZA()()()),2&n){const t=r.$implicit,i=e.oxw(3);e.xp6(6),e.hij("",t.id," "),e.xp6(1),e.Q6J("ngIf",(null==t.ids?null:t.ids.length)>0),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.Q6J("ngIf",t.technology),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.hij(" ",t.total_required_quantity," "),e.xp6(4),e.Q6J("ngIf",t.locators),e.xp6(5),e.Oqu(i.getType(null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.type)),e.xp6(5),e.Oqu(null==t.qc_delivery_status?null:t.qc_delivery_status.name)}}function hc(n,r){1&n&&(e.TgZ(0,"div")(1,"div",2)(2,"div")(3,"h2",13),e._uU(4,"Technical Equipments"),e.qZA()()()())}function fc(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function vc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.YNc(2,fc,2,0,"span",3),e.qZA()),2&n){const t=r.$implicit,i=r.last,o=e.oxw(6);e.xp6(1),e.hij(" ",o.getLocator(t).name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function xc(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,vc,3,2,"div",5),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.locators)}}function Zc(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function qc(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Zc,2,0,"span",3),e.qZA()),2&n){const t=r.$implicit,i=r.last,o=e.oxw(6);e.xp6(1),e.hij(" ",o.getLocator(t).name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function yc(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,qc,3,2,"span",5),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.available_locators)}}function Tc(n,r){if(1&n&&(e.TgZ(0,"div",14)(1,"div",15)(2,"div",16)(3,"h3"),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"div"),e._uU(6),e.qZA()(),e.TgZ(7,"div",16)(8,"h3"),e._uU(9,"Name"),e.qZA(),e._uU(10),e.qZA(),e.TgZ(11,"div",16)(12,"h3"),e._uU(13,"Locators"),e.qZA(),e.YNc(14,xc,2,1,"div",3),e.YNc(15,yc,2,1,"div",3),e.qZA(),e.TgZ(16,"div",16)(17,"h3"),e._uU(18,"Required Quantity"),e.qZA(),e._uU(19),e.qZA()()()),2&n){const t=r.$implicit,i=e.oxw(4);e.xp6(6),e.hij(" ",i.getNomenclature(t.nomenclature).code,""),e.xp6(4),e.hij(" ",i.getNomenclature(t.nomenclature).name," "),e.xp6(4),e.Q6J("ngIf",t.locators.length>0),e.xp6(1),e.Q6J("ngIf",t.locators.length<1),e.xp6(4),e.hij(" ",t.max_initial_quantity," ")}}function Cc(n,r){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,Tc,20,5,"div",7),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.technicalEquipments)}}function bc(n,r){if(1&n&&(e.TgZ(0,"div",19)(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"div",6),e.YNc(4,mc,58,16,"div",7),e.qZA(),e.YNc(5,hc,5,0,"div",3),e.YNc(6,Cc,2,1,"div",8),e.TgZ(7,"div",9)(8,"div",10)(9,"div",11)(10,"div")(11,"h3"),e._uU(12,"Sent"),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.qZA()(),e.TgZ(15,"div")(16,"h3"),e._uU(17,"Date"),e.qZA(),e.TgZ(18,"p"),e._uU(19),e.ALo(20,"date"),e.qZA()(),e.TgZ(21,"div")(22,"h3"),e._uU(23,"Signed"),e.qZA()()(),e.TgZ(24,"div",12)(25,"div")(26,"h3"),e._uU(27,"Retrieved"),e.qZA(),e._UZ(28,"p"),e.qZA(),e.TgZ(29,"div")(30,"h3"),e._uU(31,"Date"),e.qZA(),e._UZ(32,"p"),e.qZA(),e.TgZ(33,"div")(34,"h3"),e._uU(35,"Signed"),e.qZA()()()()()()),2&n){const t=r.$implicit,i=r.last,o=e.oxw(2);e.ekj("not-last-group",!i),e.xp6(2),e.HOy("",t.nomenclature.code," ",t.nomenclature.name," ",null==t.current_technology?null:t.current_technology.name," Quantity: ",t.quantity,""),e.xp6(2),e.Q6J("ngForOf",t.children),e.xp6(1),e.Q6J("ngIf",o.technicalEquipments.length>0),e.xp6(1),e.Q6J("ngIf",o.technicalEquipments.length>0),e.xp6(8),e.AsE("",o.auth.user.first_name," ",o.auth.user.last_name,""),e.xp6(5),e.Oqu(e.xi3(20,12,o.currentDate,"dd.MM.y"))}}function Qc(n,r){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div")(3,"h2"),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div")(8,"h2"),e._uU(9,"Name"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA()(),e.TgZ(12,"div")(13,"h2"),e._uU(14,"Order ID"),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA()(),e.TgZ(17,"div"),e._UZ(18,"h2")(19,"p"),e.qZA(),e.TgZ(20,"div")(21,"h2"),e._uU(22,"Production List Creation Date"),e.qZA(),e.TgZ(23,"p"),e._uU(24),e.ALo(25,"date"),e.qZA()(),e.TgZ(26,"div")(27,"h2"),e._uU(28,"Request Creation Date"),e.qZA(),e.TgZ(29,"p"),e.YNc(30,Br,3,4,"ng-container",3),e.qZA()(),e.TgZ(31,"div",4)(32,"h2"),e._uU(33,"Technologies"),e.qZA(),e.TgZ(34,"p"),e.YNc(35,Hr,2,2,"span",5),e.qZA()()(),e.YNc(36,Wr,34,7,"div",3),e.YNc(37,bc,36,15,"div",18),e.qZA()),2&n){const t=e.oxw();e.xp6(6),e.Oqu(null==t.rootList||null==t.rootList.nomenclature?null:t.rootList.nomenclature.code),e.xp6(5),e.Oqu(null==t.rootList||null==t.rootList.nomenclature?null:t.rootList.nomenclature.name),e.xp6(5),e.Oqu(t.orderId),e.xp6(8),e.Oqu(e.xi3(25,8,null==t.rootList||null==t.rootList.list?null:t.rootList.list.created,"dd.MM.y")),e.xp6(6),e.Q6J("ngIf",t.currentReqDate),e.xp6(5),e.Q6J("ngForOf",t.technologies),e.xp6(1),e.Q6J("ngIf",t.outsourcer),e.xp6(1),e.Q6J("ngForOf",t.orderedProducts)}}let Ac=(()=>{class n{constructor(t){this.auth=t,this.requests=[],this.currentReqDate=null,this.technicalEquipments=[],this.currentDate=new Date,this.Nomenclature=E.UG}ngOnInit(){console.log("technicalEquipments",this.technicalEquipments)}getType(t){switch(t){case E.BN.ASSEMBLY:return"Assembly";case E.BN.PURCHASED:return"Outsourcing";case E.BN.MANUFACTURED:return"Own Production"}}getNomenclature(t){return t}getLocator(t){return t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(V.e8))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-delivery-print-page"]],inputs:{requests:"requests",orderedProducts:"orderedProducts",rootList:"rootList",orderId:"orderId",technologies:"technologies",outsourcer:"outsourcer",currentReqDate:"currentReqDate",technicalEquipments:"technicalEquipments"},decls:2,vars:2,consts:[["class","qc-delivery-print-page",4,"ngIf"],[1,"qc-delivery-print-page"],[1,"qc-delivery-print-page__header"],[4,"ngIf"],[1,"col-2"],[4,"ngFor","ngForOf"],[1,"qc-delivery-print-page__table"],["class","qc-delivery-print-page__row",4,"ngFor","ngForOf"],["class","qc-delivery-print-page__table",4,"ngIf"],[1,"qc-delivery-print-page__bottom"],[1,"qc-delivery-print-page__column"],[1,"qc-delivery-print-page__left"],[1,"qc-delivery-print-page__right"],[2,"white-space","nowrap"],[1,"qc-delivery-print-page__row"],[1,"qc-delivery-print-page__box"],[1,"qc-delivery-print-page__col"],[1,"qc-delivery-print-page__col_half"],["class","order-product-page",3,"not-last-group",4,"ngFor","ngForOf"],[1,"order-product-page"]],template:function(t,i){1&t&&(e.YNc(0,Gr,70,19,"div",0),e.YNc(1,Qc,38,11,"div",0)),2&t&&(e.Q6J("ngIf",!i.orderedProducts),e.xp6(1),e.Q6J("ngIf",i.orderedProducts))},dependencies:[g.sg,g.O5,g.uU],styles:[".qc-delivery-print-page[_ngcontent-%COMP%]{display:block}.qc-delivery-print-page__header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:10px}.qc-delivery-print-page__header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding-right:25px;width:25%;margin-bottom:20px}.qc-delivery-print-page__header[_ngcontent-%COMP%]   div.col-2[_ngcontent-%COMP%]{width:50%}.qc-delivery-print-page__box[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.qc-delivery-print-page__row[_ngcontent-%COMP%]{border:2px solid #000;border-bottom:none;padding:10px;border-bottom:1px solid #000;border-top:1px solid #000}@media print{.qc-delivery-print-page__row[_ngcontent-%COMP%]{page-break-after:auto;page-break-before:auto;page-break-inside:avoid}}.qc-delivery-print-page__row[_ngcontent-%COMP%]:last-child{border-bottom:2px solid #000}.qc-delivery-print-page__col[_ngcontent-%COMP%]{width:25%;padding:5px}.qc-delivery-print-page__col_half[_ngcontent-%COMP%]{width:12.5%;padding:5px}.qc-delivery-print-page[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.qc-delivery-print-page[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:500;margin-bottom:3px}.qc-delivery-print-page__column[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between}.qc-delivery-print-page__column[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:17px;font-weight:500;margin-bottom:6px}.qc-delivery-print-page__column[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:25%}@media print{.qc-delivery-print-page__column[_ngcontent-%COMP%]{page-break-after:auto;page-break-before:auto}}.qc-delivery-print-page__left[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .qc-delivery-print-page__right[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:40px}@media print{.qc-delivery-print-page__bottom[_ngcontent-%COMP%]{page-break-after:auto;page-break-before:auto}}.qc-delivery-print-page__table[_ngcontent-%COMP%]{margin-bottom:60px;margin-top:10px}@media print{.qc-delivery-print-page__table[_ngcontent-%COMP%]{page-break-after:auto}}@media print{.order-product-page.not-last-group[_ngcontent-%COMP%]{page-break-after:always}}"]}),n})();const Pc=["dt"];function Ic(n,r){1&n&&(e.ynx(0),e._uU(1,"..."),e.BQk())}function wc(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function Nc(n,r){if(1&n&&(e.ynx(0),e.YNc(1,wc,2,0,"span",30),e.BQk()),2&n){const t=r.index,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t!==(null==i.order||null==i.order.supplier?null:i.order.supplier.categories.length)-1)}}function Uc(n,r){if(1&n&&(e.TgZ(0,"div",27)(1,"h2",28),e._uU(2,"Outsourcer"),e.qZA(),e.TgZ(3,"h4")(4,"span"),e._uU(5,"Name:"),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"h4")(8,"span"),e._uU(9,"Category:"),e.qZA(),e.YNc(10,Nc,2,1,"ng-container",29),e.qZA(),e.TgZ(11,"h4")(12,"span"),e._uU(13,"Address:"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"h4")(16,"span"),e._uU(17,"Tax Number:"),e.qZA(),e._uU(18),e.qZA(),e.TgZ(19,"h4")(20,"span"),e._uU(21,"Register Number:"),e.qZA(),e._uU(22),e.qZA(),e.TgZ(23,"h4")(24,"span"),e._uU(25,"Nomenclature:"),e.qZA(),e._uU(26),e.qZA(),e.TgZ(27,"h4")(28,"span"),e._uU(29,"Description:"),e.qZA()(),e.TgZ(30,"p"),e._uU(31),e.qZA()()),2&n){const t=e.oxw();e.xp6(6),e.hij(" ",null==t.order||null==t.order.supplier?null:t.order.supplier.name,""),e.xp6(4),e.Q6J("ngForOf",null==t.order||null==t.order.supplier?null:t.order.supplier.categories),e.xp6(4),e.hij(" ",null==t.order||null==t.order.supplier?null:t.order.supplier.address,""),e.xp6(4),e.hij(" ",null==t.order||null==t.order.supplier?null:t.order.supplier.tax_number,""),e.xp6(4),e.hij(" ",null==t.order||null==t.order.supplier?null:t.order.supplier.registration_number,""),e.xp6(4),e.hij(" ",null==t.order||null==t.order.supplier?null:t.order.supplier.supplier_nomenclature,""),e.xp6(5),e.Oqu(null==t.order||null==t.order.supplier?null:t.order.supplier.comment)}}function Sc(n,r){1&n&&(e.TgZ(0,"p",28),e._uU(1,"Choose the Request to edit"),e.qZA())}function Oc(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",31),e.YNc(1,Sc,2,0,"p",32),e.TgZ(2,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onCompleteMaterialQcList(o.QC_STAGES.qty_control))}),e.qZA(),e.TgZ(3,"button",34),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onCompleteMaterialQcList(o.QC_STAGES.packing_control))}),e.qZA(),e.TgZ(4,"button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onResetConfirmation())}),e.qZA(),e.TgZ(5,"button",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onStartScanning())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedRequest),e.xp6(1),e.Q6J("disabled",0===(null==t.selectedRequest?null:t.selectedRequest.length)||t.order.qc_delivery_status.qc_stage==t.QC_STAGES.done),e.xp6(1),e.Q6J("disabled",0===(null==t.selectedRequest?null:t.selectedRequest.length)||t.order.qc_delivery_status.qc_stage==t.QC_STAGES.done),e.xp6(1),e.Q6J("disabled",0===(null==t.selectedRequest?null:t.selectedRequest.length)||t.order.qc_delivery_status.qc_stage==t.QC_STAGES.done)}}function kc(n,r){1&n&&(e.TgZ(0,"colgroup"),e._UZ(1,"col",37),e.qZA())}function Jc(n,r){1&n&&(e.ynx(0),e.TgZ(1,"th",42),e._uU(2,"Status"),e.qZA(),e.TgZ(3,"th",45),e._uU(4,"Quantity Confirmation"),e.qZA(),e.TgZ(5,"th",45),e._uU(6,"Packing Confirmation"),e.qZA(),e.BQk())}function Mc(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"th",38),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th",39)(4,"div",40),e._uU(5," # "),e.qZA()(),e.TgZ(6,"th",39),e._uU(7,"ID"),e.qZA(),e.TgZ(8,"th",41),e._uU(9,"Code"),e.qZA(),e.TgZ(10,"th",41),e._uU(11,"Name"),e.qZA(),e.TgZ(12,"th",42),e._uU(13,"Serial Number"),e.qZA(),e.TgZ(14,"th",43),e._uU(15,"Technology"),e.qZA(),e.TgZ(16,"th",44),e._uU(17,"Required Quantity"),e.qZA(),e.TgZ(18,"th",42),e._uU(19,"Locator"),e.qZA(),e.TgZ(20,"th",45),e._uU(21,"UOM"),e.qZA(),e.YNc(22,Jc,7,0,"ng-container",30),e.qZA()),2&n){const t=e.oxw();e.xp6(22),e.Q6J("ngIf",2==(null==t.order?null:t.order.accounting_type))}}function Lc(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("L(",(null==t.ids?null:t.ids.length)+1,")")}}function Dc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function Yc(n,r){if(1&n&&(e.TgZ(0,"pek-hover-detailed-info-component",52)(1,"span",53)(2,"div"),e._uU(3),e.qZA(),e.YNc(4,Dc,2,1,"div",29),e.qZA()()),2&n){const t=e.oxw(),i=t.rowIndex,o=t.$implicit,c=e.oxw();e.Q6J("moveLeft",0),e.xp6(1),e.ekj("is-fixed",c.listRequests.length<=10)("is-absolute",c.listRequests.length>10)("is-last",c.listRequests.length-10<=i),e.xp6(2),e.hij(" ",o.id," "),e.xp6(1),e.Q6J("ngForOf",o.ids)}}function Ec(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.material_nomenclature.code," ")}}function Fc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.order_product_nomenclature.code," ")}}function Rc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.list_product.nomenclature.code," ")}}function jc(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function $c(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,jc,2,0,"b",30),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.material_nomenclature.name," ")}}function Gc(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function Bc(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Gc,2,0,"b",30),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.order_product_nomenclature.name," ")}}function Hc(n,r){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function Kc(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Hc,2,0,"b",30),e._uU(2),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","1"===(null==t||null==t.list_product||null==t.list_product.nomenclature?null:t.list_product.nomenclature.bulk_or_serial)),e.xp6(1),e.hij(" ",t.list_product.nomenclature.name," ")}}function zc(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.reserved_serial_products[0].serial_number.type_with_number," ")}}function Wc(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.technology)}}function Vc(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function Xc(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.YNc(2,Vc,2,0,"span",30),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",t.name," "),e.xp6(1),e.Q6J("ngIf",!i)}}function ea(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Xc,3,2,"div",29),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.unique_locators)}}function ta(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.material_nomenclature&&null!=t.material_nomenclature.category&&null!=t.material_nomenclature.category.unit_of_measure&&t.material_nomenclature.category.unit_of_measure.symbol?null==t.material_nomenclature||null==t.material_nomenclature.category||null==t.material_nomenclature.category.unit_of_measure?null:t.material_nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function na(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.order_product_nomenclature&&null!=t.order_product_nomenclature.category&&null!=t.order_product_nomenclature.category.unit_of_measure&&t.order_product_nomenclature.category.unit_of_measure.symbol?null==t.order_product_nomenclature||null==t.order_product_nomenclature.category||null==t.order_product_nomenclature.category.unit_of_measure?null:t.order_product_nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function ia(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",null!=t.list_product.nomenclature&&null!=t.list_product.nomenclature.category&&null!=t.list_product.nomenclature.category.unit_of_measure&&t.list_product.nomenclature.category.unit_of_measure.symbol?null==t.list_product.nomenclature||null==t.list_product.nomenclature.category||null==t.list_product.nomenclature.category.unit_of_measure?null:t.list_product.nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function oa(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",56),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,1,!0))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("disabled",1!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)}}function ra(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",57),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,1,!1))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("disabled",1!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)}}function ca(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",56),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,2,!0))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("disabled",(2!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)&&3!=t.qc_delivery_status.id)}}function aa(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",57),e.NdJ("click",function(){e.CHM(t);const o=e.oxw(2).$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,2,!1))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("disabled",(2!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)&&3!=t.qc_delivery_status.id)}}function sa(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"td",42)(2,"h3",48),e._uU(3,"Status"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td",54)(6,"div",55),e.YNc(7,oa,2,1,"ng-container",30),e.YNc(8,ra,2,1,"ng-container",30),e.qZA()(),e.TgZ(9,"td",54)(10,"div",55),e.YNc(11,ca,2,1,"ng-container",30),e.YNc(12,aa,2,1,"ng-container",30),e.qZA()(),e.BQk()),2&n){const t=e.oxw().$implicit,i=e.oxw();e.xp6(4),e.hij(" ",t.qc_delivery_status.name," "),e.xp6(1),e.ekj("disabled",1!=i.order.qc_delivery_status.qc_stage),e.xp6(2),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed||1!=t.qc_delivery_status.qc_stage||3===t.qc_delivery_status.id),e.xp6(1),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed&&1===t.qc_delivery_status.qc_stage||2===t.qc_delivery_status.id),e.xp6(1),e.ekj("disabled",2!=t.qc_delivery_status.qc_stage&&3!=t.qc_delivery_status.id),e.xp6(2),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed||2!=t.qc_delivery_status.qc_stage||6===t.qc_delivery_status.id),e.xp6(1),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed&&2===t.qc_delivery_status.qc_stage||1===t.qc_delivery_status.qc_stage||5===t.qc_delivery_status.id)}}function la(n,r){if(1&n&&(e.TgZ(0,"tr",46)(1,"td",38),e._UZ(2,"p-tableCheckbox",47),e.qZA(),e.TgZ(3,"td",39)(4,"div",40)(5,"h3",48),e._uU(6,"#"),e.qZA(),e._uU(7),e.qZA()(),e.TgZ(8,"td",49)(9,"h3",48),e._uU(10,"ID"),e.qZA(),e._uU(11),e.YNc(12,Lc,2,1,"span",30),e.YNc(13,Yc,5,9,"pek-hover-detailed-info-component",50),e.qZA(),e.TgZ(14,"td",41)(15,"h3",48),e._uU(16,"Code"),e.qZA(),e.YNc(17,Ec,2,1,"div",30),e.YNc(18,Fc,2,1,"div",30),e.YNc(19,Rc,2,1,"div",30),e.qZA(),e.TgZ(20,"td",51)(21,"h3",48),e._uU(22,"Name"),e.qZA(),e.YNc(23,$c,3,2,"div",30),e.YNc(24,Bc,3,2,"div",30),e.YNc(25,Kc,3,2,"div",30),e.qZA(),e.TgZ(26,"td",42)(27,"h3",48),e._uU(28,"Serial number"),e.qZA(),e.YNc(29,zc,2,1,"span",30),e.qZA(),e.TgZ(30,"td",43)(31,"h3",48),e._uU(32,"Technology"),e.qZA(),e.YNc(33,Wc,2,1,"span",30),e.qZA(),e.TgZ(34,"td",44)(35,"h3",48),e._uU(36,"Required Quantity"),e.qZA(),e._uU(37),e.qZA(),e.TgZ(38,"td",42)(39,"h3",48),e._uU(40,"Locator"),e.qZA(),e.YNc(41,ea,2,1,"div",30),e.qZA(),e.TgZ(42,"td",45)(43,"h3",48),e._uU(44,"UOM"),e.qZA(),e.YNc(45,ta,2,1,"div",30),e.YNc(46,na,2,1,"div",30),e.YNc(47,ia,2,1,"div",30),e.qZA(),e.YNc(48,sa,13,9,"ng-container",30),e.qZA()),2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw();e.ekj("last-scanned",t.id===o.lastScannedId)("partly-scanned",o.isPartlyScanned(t))("is-added-after-order-creation",t.material_nomenclature)("qr-code-scanned",o.isFullyScanned(t)),e.Q6J("pSelectableRow",t),e.xp6(2),e.Q6J("value",t),e.xp6(5),e.hij(" ",i+1," "),e.xp6(4),e.hij(" ",t.id," "),e.xp6(1),e.Q6J("ngIf",(null==t.ids?null:t.ids.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.ids?null:t.ids.length)>0),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(4),e.Q6J("ngIf",1===(null==t.reserved_serial_products?null:t.reserved_serial_products.length)),e.xp6(4),e.Q6J("ngIf",t.technology),e.xp6(4),e.hij(" ",t.total_required_quantity," "),e.xp6(4),e.Q6J("ngIf",t.locators),e.xp6(4),e.Q6J("ngIf",t.material_nomenclature),e.xp6(1),e.Q6J("ngIf",t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",!t.material_nomenclature&&!t.order_product_nomenclature),e.xp6(1),e.Q6J("ngIf",2==(null==o.order?null:o.order.accounting_type))}}function _a(n,r){1&n&&e._UZ(0,"i",61)}function ua(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function da(n,r){if(1&n&&(e.TgZ(0,"tr",58)(1,"td",59),e.YNc(2,_a,1,0,"i",60),e.YNc(3,ua,2,0,"span",30),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",9),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function pa(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",62),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(23);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ga(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",63)(1,"p-button",62),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(23);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function ma(n,r){1&n&&(e.TgZ(0,"div",27)(1,"h2",28),e._uU(2,"Technical Equipments"),e.qZA(),e._UZ(3,"div"),e.qZA())}function ha(n,r){if(1&n&&e.YNc(0,ma,4,0,"div",64),2&n){const t=e.oxw();e.Q6J("ngIf",t.technicalEquipments)}}function fa(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",65),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",66),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",67),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",67),e._uU(8,"Locator"),e.qZA(),e.TgZ(9,"th",68),e._uU(10,"Quantity"),e.qZA()())}function va(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function xa(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.YNc(2,va,2,0,"span",30),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",t.name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function Za(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,xa,3,2,"div",29),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.locators)}}function qa(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function ya(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,qa,2,0,"span",30),e.qZA()),2&n){const t=r.$implicit,i=r.last;e.xp6(1),e.hij(" ",t.name,""),e.xp6(1),e.Q6J("ngIf",!i)}}function Ta(n,r){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,ya,3,2,"span",29),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.available_locators)}}function Ca(n,r){if(1&n&&(e.TgZ(0,"tr",69)(1,"td",70),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e.YNc(8,Za,2,1,"div",30),e.YNc(9,Ta,2,1,"div",30),e.qZA(),e.TgZ(10,"td",70),e._uU(11),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.nomenclature.code),e.xp6(2),e.Oqu(t.nomenclature.name),e.xp6(2),e.Q6J("ngIf",t.locators.length>0),e.xp6(1),e.Q6J("ngIf",t.locators.length<1),e.xp6(2),e.Oqu(t.max_initial_quantity)}}function ba(n,r){1&n&&(e.TgZ(0,"tr")(1,"td",71),e._uU(2," Choice ordered item "),e.qZA()())}function Qa(n,r){1&n&&e._UZ(0,"i",74)}function Aa(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Pa(n,r){if(1&n&&(e.TgZ(0,"tr",58)(1,"td",72),e.YNc(2,Qa,1,0,"i",73),e.YNc(3,Aa,2,0,"span",30),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",7),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function Ia(n,r){if(1&n&&(e.TgZ(0,"div",75)(1,"div"),e._UZ(2,"pek-qc-delivery-print-page",76),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("rootList",t.rootList)("orderId",+t.orderId)("requests",t.listRequests)("currentReqDate",t.currentReqDate)("technologies",null==t.order?null:t.order.ordered_items_technologies)("outsourcer",null==t.order?null:t.order.supplier)("technicalEquipments",t.technicalEquipments)}}function wa(n,r){if(1&n&&(e.TgZ(0,"div",75)(1,"div"),e._UZ(2,"pek-qc-delivery-print-page",77),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("rootList",t.rootList)("orderedProducts",t.orderedProductsForPrint)("orderId",+t.orderId)("requests",t.listRequests)("currentReqDate",t.currentReqDate)("technologies",null==t.order?null:t.order.ordered_items_technologies)("outsourcer",null==t.order?null:t.order.supplier)("technicalEquipments",t.technicalEquipments)}}function Na(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"pek-qr-code-scanner",78),e.NdJ("scanned",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.onScanned(o))})("cancel",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onCancelScanned())}),e.qZA()}}function Ua(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"a",79),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.goToOrder())}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Oqu(null==t.order?null:t.order.id)}}const Sa=function(){return["name"]};let O=class{constructor(r,t,i,o,c,a,s,u,h,f){this.requestsService=r,this.auth=t,this.ordersService=i,this.route=o,this.router=c,this.modalService=a,this.tasksService=s,this.orderTechnicalEquipmentsService=u,this.albumService=h,this.document=f,this.formGroupedOrderedProducts=new b.x,this.isShowPrint=!1,this.isShowPrintGrouped=!1,this.destroy$=new b.x,this.isAlbumPrint=!1,this.QC_STAGES={qty_control:1,packing_control:2,done:3},this.printMenuItems=[{label:"Print Options",items:[{label:"Print (default)",icon:"pi pi-print",command:()=>this.printPage()},{label:"Print Grouped by Order Product",icon:"pi pi-print",command:()=>this.printPageGrouped()}]}],this.rootList=null,this.currentDate=new Date,this.selectedRequest=null,this.currentReqDate=null,this.isLoading=!0,this.requests=[],this.listRequests=[],this.hierarchyRequests=[],this.orderId=this.route.snapshot.paramMap.get("id"),this.isCompletingMaterials=!1,this.requestTree=[],this.detailedRequestTree=[],this.orderedProductsForPrint=[],this.technicalEquipments=[],this.isLoadingTree=!0,this.elementsRowsIds=[],this.isScanned=!1,this.foundRowsIds=[],this.firstPage=0}ngOnInit(){this.getOrderInfo(+this.orderId),this.getRequests(),this.getOrderTechnicalEquipments(),this.formGroupedOrderedProducts.pipe((0,q.t)(this)).subscribe(()=>{this.hierarchyRequests.length>0&&this.orderedProductsForPrint.length>0&&this.orderedProductsForPrint.forEach(r=>{r.children=this.hierarchyRequests.filter(t=>t.for_order_product.id===r.id||t.for_order_ids.findIndex(i=>i===r.id)>=0)})})}getOrderTechnicalEquipments(){this.orderTechnicalEquipmentsService.get([{name:"order",value:+this.orderId},{name:"in_use",value:!1}]).pipe((0,ur.q)(1),(0,q.t)(this)).subscribe(t=>{this.technicalEquipments=t})}onCancel(){this.modalService.confirm("danger","Confirm").subscribe(r=>{r&&this.requestsService.cancel(+this.orderId).pipe((0,q.t)(this)).subscribe()})}getOrderInfo(r){this.ordersService.getMinimalById(r).pipe((0,A.R)(this.destroy$)).pipe((0,q.t)(this)).subscribe(t=>{this.order=t,this.order.ordered_items_technologies=[],this.order.order_products.forEach(i=>{i.current_technology&&this.order.ordered_items_technologies.findIndex(a=>a===i.current_technology.name)<0&&this.order.ordered_items_technologies.push(i.current_technology.name);const o=this.orderedProductsForPrint.find(c=>c.nomenclature.id===i.nomenclature.id&&c.current_technology?.id===i.current_technology?.id);o?o.quantity+=i.quantity:this.orderedProductsForPrint.push(i)}),this.formGroupedOrderedProducts.next()})}getRequests(){this.isLoading=!0,this.requests=[],this.selectedRequest=[],this.requestsService.getDeliveryByOrder(+this.orderId).pipe((0,A.R)(this.destroy$)).subscribe(r=>{this.isLoading=!1,this.requests=r,this.listRequests=JSON.parse(JSON.stringify(this.requests)),this.hierarchyRequests=JSON.parse(JSON.stringify(this.requests)),this.listRequests.sort((o,c)=>this.getCodeAndNameId(o).id-this.getCodeAndNameId(c).id).forEach(o=>{o.requests=this.listRequests.filter(c=>!c.material_nomenclature).filter(c=>!c.reserved_serial_products||0===c.reserved_serial_products.length).filter(c=>this.getSameRequests(c,o)&&c.id!==o.id),o.ids=o.requests.map(c=>c.id),o.all_reserved_serial_products=[],o.unique_locators=[...o.locators],o.available_quantity_sum=o.is_reserved&&o.requests.every(c=>c.is_reserved)?o.requests.map(c=>c.required_quantity).reduce((c,a)=>c+a,o.required_quantity):0===o.ids.length?o.is_reserved?o.required_quantity:o.warehouse_quantity:o.is_reserved?o.requests.find(c=>!c.is_reserved).warehouse_quantity:o.warehouse_quantity,o.reserved_serial_products&&o.all_reserved_serial_products.push(...o.reserved_serial_products.map(c=>c.serial_number)),o.requests.forEach(c=>{c.reserved_serial_products?.length>0&&o.all_reserved_serial_products.push(...c.reserved_serial_products.map(a=>a.serial_number)),o.unique_locators.push(...c.locators)}),o.total_required_quantity=o.requests.reduce((c,a)=>c+a.required_quantity,o.required_quantity),o.unique_locators=o.unique_locators.filter((c,a,s)=>s.findIndex(u=>u.id===c.id)===a),o.ids.forEach(c=>{const a=this.listRequests.findIndex(s=>s.id===c);this.listRequests.splice(a,1)})}),this.hierarchyRequests.sort((o,c)=>this.getCodeAndNameId(o).id-this.getCodeAndNameId(c).id).forEach(o=>{o.requests=this.hierarchyRequests.filter(c=>!c.material_nomenclature).filter(c=>c.for_order_product?.nomenclature.id===o.for_order_product?.nomenclature.id).filter(c=>!c.reserved_serial_products||0===c.reserved_serial_products.length).filter(c=>this.getSameRequests(c,o)&&c.id!==o.id&&(c.for_order_product?.nomenclature.id===o.for_order_product?.nomenclature.id||c.list_product?.nomenclature.id===o.list_product?.nomenclature.id)),o.ids=o.requests.map(c=>c.id),o.for_order_ids=[],o.for_order_product.length>0&&o.for_order_ids.push(o.for_order_product.id),o.for_order_ids.push(...o.requests.filter(c=>c.for_order_product).map(c=>c.for_order_product?.id)),o.available_quantity_sum=o.is_reserved&&o.requests.every(c=>c.is_reserved)?o.requests.map(c=>c.required_quantity).reduce((c,a)=>c+a,o.required_quantity):0===o.ids.length?o.is_reserved?o.required_quantity:o.warehouse_quantity:o.is_reserved?o.requests.find(c=>!c.is_reserved).warehouse_quantity:o.warehouse_quantity,o.unique_locators=[...o.locators],o.requests.forEach(c=>{o.unique_locators.push(...c.locators)}),o.unique_locators=o.unique_locators.filter((c,a,s)=>s.findIndex(u=>u.id===c.id)===a),o.total_required_quantity=o.requests.reduce((c,a)=>c+a.required_quantity,o.required_quantity),o.ids.forEach(c=>{const a=this.hierarchyRequests.findIndex(s=>s.id===c);this.hierarchyRequests.splice(a,1)})}),this.formGroupedOrderedProducts.next();const t=this.listRequests.filter(o=>o.material_nomenclature).sort((o,c)=>c.id-o.id),i=this.listRequests.filter(o=>!o.material_nomenclature).sort((o,c)=>c.id-o.id);this.listRequests=[...t,...i]})}getSameRequests(r,t){let i=this.getCodeAndNameId(r),o=this.getCodeAndNameId(t);return!(i.code!==o.code||i.name!==o.name||r.reserved_serial_products&&0!==r.reserved_serial_products?.length&&r.material_nomenclature)}getCodeAndNameId(r){let o,t="",i="";return r.order_product_nomenclature?(t=r.order_product_nomenclature.code,i=r.order_product_nomenclature.name,o=r.order_product_nomenclature.id):!r.material_nomenclature&&!r.order_product_nomenclature&&(t=r.list_product.nomenclature.code,i=r.list_product.nomenclature.name,o=r.list_product.nomenclature.id),{code:t,name:i,id:o}}complete(){this.modalService.confirm("success").subscribe(r=>{r&&(this.isLoading=!1,this.requestsService.completeMaterialQc(+this.orderId).pipe((0,q.t)(this)).subscribe(()=>this.router.navigate(["../"],{relativeTo:this.route})))})}onUpdateItems(r,t,i){let o=[];this.modalService.confirm("success").pipe((0,y.h)(c=>c)).subscribe(()=>{o.push(r.id,...r.ids),this.requestsService.updateMaterial({production_request_ids:o,order_qc_delivery_status_id:this.order.qc_delivery_status.id,confirmation_flag:i,qc_stage:t}).pipe((0,q.t)(this)).subscribe(()=>{this.getOrderInfo(+this.orderId),this.getRequests()})})}onResetConfirmation(){let r=[];this.selectedRequest.forEach(i=>{r.push(i.id,...i.ids)}),this.requestsService.resetConfirmation({production_request_ids:r}).pipe((0,q.t)(this)).subscribe(()=>{this.getOrderInfo(+this.orderId),this.getRequests()})}onCompleteMaterialQcList(r){let t=[];this.modalService.confirm("success").pipe((0,y.h)(i=>i)).subscribe(()=>{this.selectedRequest.forEach(o=>{t.push(o.id,...o.ids)}),this.requestsService.updateMaterial({production_request_ids:t,qc_stage:r}).pipe((0,q.t)(this)).subscribe(()=>{this.getOrderInfo(+this.orderId),this.getRequests()})})}onGoProd(r){window.open("/manufactoring/plan/plan/"+r,"_blank")}goOrder(r,t){let i="";1==r&&(i="/procurement/chains/order/"+t),2==r&&(i="/outsourcing/chains/order/"+t),3==r&&(i="/manufacturing/orders/order/"+t),window.open(i,"_blank")}goToOrder(){let r="";1==this.order.accounting_type&&(r="/procurement/chains/order/"+this.order.id),2==this.order.accounting_type&&(r="/outsourcing/chains/order/"+this.order.id),3==this.order.accounting_type&&(r="/manufacturing/orders/order/"+this.order.id),window.open(r,"_blank")}printPage(){this.isShowPrint=!0,setTimeout(()=>{window.print()})}printPageGrouped(){this.isShowPrintGrouped=!0,setTimeout(()=>{window.print()})}onWindowAfterPrint(){this.isShowPrintGrouped=!1,this.isShowPrint=!1}printClosed(){this.isShowPrintGrouped=!1,this.isShowPrint=!1}printAlbum(){this.albumService.getNomenclaturesImages(this.selectedRequest.map(r=>r.material_nomenclature?r.material_nomenclature:r.order_product_nomenclature?r.order_product_nomenclature:r.material_nomenclature||r.order_product_nomenclature?void 0:r.list_product?.nomenclature))}togglePrintAlbumMode(){this.selectedRequest=[],this.isAlbumPrint=!this.isAlbumPrint}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}onStartScanning(){this.clearQrResults(),requestAnimationFrame(()=>{this.elementsRowsIds=[],document.querySelectorAll("[id^=row-]").forEach(t=>{this.elementsRowsIds.push(t.id)})}),this.isScanned=!0,this.scanningEnd=!1}clearQrResults(){this.currentDisplayRowId=null,this.foundRowsIds=[]}onScanned(r){this.scanningEnd=!0,this.isScanned=!1,this.scanForListProduct(r)}onCancelScanned(){this.scanningEnd=!0,this.isScanned=!1}scanForListProduct(r=null){this.lastScannedId=null,requestAnimationFrame(()=>{this.elementsRowsIds=[],document.querySelectorAll("[id^=row-]").forEach(i=>{this.elementsRowsIds.push(i.id)})}),this.requestsService.sendDataProductionRequests(this.orderId,r).pipe((0,q.t)(this)).subscribe(t=>{this.testFoundIdsOnScan(t)})}testFoundIdsOnScan(r){const t=r.map(o=>o.item_id_changed);let i;this.listRequests.forEach((o,c)=>{t.findIndex(s=>s===o.id)>-1&&(o.is_scanned=!0,i=c,this.lastScannedId=o.id),o.requests.forEach(s=>{t.findIndex(u=>u===s.id)>-1&&(s.is_scanned=!0,i=c,this.lastScannedId=o.id)})}),i&&(this.firstPage=10*Math.floor(i/10)),this.requestTree.forEach(o=>{o.children.forEach(c=>{const a=c.data.request;t.findIndex(u=>u===a.id)>-1&&(a.is_scanned=!0,this.lastScannedId=a.id),a.requests?.forEach(u=>{t.findIndex(h=>h===u.id)>-1&&(u.is_scanned=!0,this.lastScannedId=a.id)})})})}scrollToElement(r){document.getElementById(r).scrollIntoView({behavior:"smooth",block:"center"})}isFullyScanned(r){if(0===r.requests?.length)return r.is_scanned;const t=r.is_scanned,i=!(r.requests?.findIndex(o=>!o.is_scanned)>-1);return t&&i}isPartlyScanned(r){if(0===r?.requests?.length)return!1;const t=r.is_scanned,i=r.requests?.findIndex(o=>!o.is_scanned)>-1;return!this.isFullyScanned(r)&&(t||!i)}};O.\u0275fac=function(r){return new(r||O)(e.Y36(dr.s),e.Y36(V.e8),e.Y36(R.p),e.Y36(C.gz),e.Y36(C.F0),e.Y36(L.Z),e.Y36(pr.M),e.Y36(_e.v),e.Y36(ee.$),e.Y36(g.K0))},O.\u0275cmp=e.Xpm({type:O,selectors:[["pek-qc-delivery"]],viewQuery:function(r,t){if(1&r&&e.Gf(Pc,5),2&r){let i;e.iGM(i=e.CRH())&&(t.dateTable=i.first)}},hostBindings:function(r,t){1&r&&e.NdJ("afterprint",function(){return t.onWindowAfterPrint()},!1,e.Jf7)("afterprint",function(){return t.printClosed()})},decls:45,vars:25,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf","ngIfElse"],[1,"page__tools"],[1,"ml-auto","mr-2",3,"model"],["pButton","","type","button","label","Print Album",1,"p-button-success","mr-2",3,"loading","disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Complete",1,"p-button-icon","mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Go to Order",1,"ml-2",3,"click"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["selectionMode","single"],["pTemplate","caption"],["scrollHeight","calc(100vh - 18.8rem)","dataKey","id",1,"adaptive-table","print-table",3,"paginator","scrollable","rows","value","first","globalFilterFields","selection","firstChange","selectionChange"],["dt",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],["selectionMode","single",3,"value"],["class","print-page",4,"ngIf"],[3,"scanned","cancel",4,"ngIf"],["orderLink",""],[1,"table-tools"],[1,"subtitle"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"d-flex","table-caption"],["class","subtitle",4,"ngIf"],["pButton","","type","button","icon","pi pi-check","label","QTY Confirm",1,"ml-auto","mr-2","p-button-success",3,"disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Packing Confirm",1,"mr-2","p-button-success",3,"disabled","click"],["pButton","","type","button","icon","pi pi-spinner","label","Reset Confirmation",1,"mr-2","p-button-danger",3,"disabled","click"],["pButton","","type","button","icon","pi pi-camera","label","Scan QR Codes",1,"mr-2","p-button-icon",3,"click"],[1,"index-header"],[2,"width","3%"],[1,"text-center",2,"width","5%"],[1,"row-toggler"],[2,"width","15%"],[1,"text-center",2,"width","10%"],[1,"text-center",2,"width","12%"],[1,"text-center",2,"width","14%"],[1,"text-center",2,"width","4%"],[1,"pagebreak",3,"pSelectableRow"],[3,"value"],[1,"td-title"],[1,"text-center","ids-container","hovered-info",2,"width","5%"],[3,"moveLeft",4,"ngIf"],[1,"serial-numbers-container",2,"width","15%"],[3,"moveLeft"],[1,"ids"],[2,"width","4%"],[1,"table-buttons"],["pButton","","type","button","icon","pi pi-check",1,"p-button-success","ml-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-times",1,"p-button-danger","ml-2",3,"disabled","click"],[1,"tr-spinner"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],["class","table-tools",4,"ngIf"],[1,"index-header","text-center",2,"width","5%"],[2,"width","35%"],[2,"width","30%"],[1,"text-center",2,"width","30%"],[1,"table-row",3,"pSelectableRow"],[1,"text-center"],["colspan","5"],[1,"text-center","p-5"],["class","fas fa-circle-notch fa-spin fa-3x ",4,"ngIf"],[1,"fas","fa-circle-notch","fa-spin","fa-3x"],[1,"print-page"],[3,"rootList","orderId","requests","currentReqDate","technologies","outsourcer","technicalEquipments"],[3,"rootList","orderedProducts","orderId","requests","currentReqDate","technologies","outsourcer","technicalEquipments"],[3,"scanned","cancel"],[1,"order-link",3,"click"]],template:function(r,t){if(1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5," Order ID "),e.YNc(6,Ic,2,0,"ng-container",4),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"p-menubar",6),e.TgZ(9,"button",7),e.NdJ("click",function(){return t.printAlbum()}),e.ALo(10,"async"),e.qZA(),e.TgZ(11,"button",8),e.NdJ("click",function(){return t.complete()}),e.qZA(),e.TgZ(12,"a",9),e.NdJ("click",function(){return t.goToOrder()}),e.qZA()()()(),e.TgZ(13,"div",10)(14,"div",11)(15,"div",12)(16,"p-table",13),e.YNc(17,Uc,32,7,"ng-template",14),e.qZA()()()(),e.TgZ(18,"div",10)(19,"div",11),e.ynx(20),e.TgZ(21,"div",12)(22,"p-table",15,16),e.NdJ("firstChange",function(o){return t.firstPage=o})("selectionChange",function(o){return t.selectedRequest=o}),e.YNc(24,Oc,6,4,"ng-template",14),e.YNc(25,kc,2,0,"ng-template",17),e.YNc(26,Mc,23,1,"ng-template",18),e.YNc(27,la,49,28,"ng-template",19),e.YNc(28,da,4,3,"ng-template",20),e.YNc(29,pa,2,0,"ng-template",21),e.qZA()(),e.YNc(30,ga,3,0,"div",22),e.BQk(),e.qZA()(),e.TgZ(31,"div",10)(32,"div",11)(33,"div",12)(34,"p-table",23),e.YNc(35,ha,1,1,"ng-template",14),e.YNc(36,fa,11,0,"ng-template",18),e.YNc(37,Ca,12,7,"ng-template",19),e.YNc(38,ba,3,0,"ng-template",20),e.YNc(39,Pa,4,3,"ng-template",20),e.qZA()()()(),e.YNc(40,Ia,3,7,"div",24),e.YNc(41,wa,3,8,"div",24),e.YNc(42,Na,1,0,"pek-qr-code-scanner",25),e.YNc(43,Ua,2,1,"ng-template",null,26,e.W1O)),2&r){const i=e.MAs(23),o=e.MAs(44);e.xp6(3),e.Q6J("module","warehouse")("isActive",!0),e.xp6(3),e.Q6J("ngIf",t.isLoading)("ngIfElse",o),e.xp6(2),e.Q6J("model",t.printMenuItems),e.xp6(1),e.Q6J("loading",e.lcZ(10,22,t.albumService.loading$))("disabled",0===(null==t.selectedRequest?null:t.selectedRequest.length)),e.xp6(2),e.Q6J("disabled",!(null!=t.order&&null!=t.order.qc_delivery_status&&t.order.qc_delivery_status.is_qc_completed)),e.xp6(1),e.ekj("disabled",!t.order),e.xp6(10),e.Q6J("paginator",t.listRequests.length>0)("scrollable",!i.paginator)("rows",10)("value",t.listRequests)("first",t.firstPage)("globalFilterFields",e.DdM(24,Sa))("selection",t.selectedRequest),e.xp6(8),e.Q6J("ngIf",!i.paginator&&!t.isLoading&&t.listRequests.length>0),e.xp6(4),e.Q6J("value",t.technicalEquipments),e.xp6(6),e.Q6J("ngIf",t.isShowPrint),e.xp6(1),e.Q6J("ngIf",t.isShowPrintGrouped),e.xp6(1),e.Q6J("ngIf",t.isScanned)}},dependencies:[g.sg,g.O5,Z.Hq,Z.zx,I.jx,he.nm,v.iA,v.Ei,v.UA,v.Mo,N.D,fe.h,ne.i,Ac,g.Ov],styles:["@page{size:portrait!important}.table-buttons[_ngcontent-%COMP%]{display:flex}.disabled[_ngcontent-%COMP%]{background:#d6d6d6!important}@media print{.page[_ngcontent-%COMP%], .page__content[_ngcontent-%COMP%]{display:none}}.row-toggler[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.row-toggler[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{margin-right:1.5rem}a[_ngcontent-%COMP%]{cursor:pointer}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.request-info[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:20px}.request-title[_ngcontent-%COMP%]{font-weight:500;font-size:24px;line-height:1.2;margin-bottom:25px}.request-row[_ngcontent-%COMP%]{margin-bottom:25px;box-sizing:border-box;padding-right:30px}.request-row[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:500;font-size:19px;margin:0 0 10px;line-height:1.2}.request-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;margin:0}.request-row[_ngcontent-%COMP%]:nth-child(1), .request-row[_ngcontent-%COMP%]:nth-child(2), .request-row[_ngcontent-%COMP%]:nth-child(5), .request-row[_ngcontent-%COMP%]:nth-child(6){width:30%}.request-row[_ngcontent-%COMP%]:nth-child(3), .request-row[_ngcontent-%COMP%]:nth-child(4){width:20%}.user-info[_ngcontent-%COMP%]{font-size:19px;display:flex}.user-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:19px;font-weight:500;margin-bottom:5px}.user-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:25%}.user-info[_ngcontent-%COMP%]{display:none;justify-content:space-between;margin-top:50px}.user-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{height:20px}.user-info[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .user-info[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:25px}.print-info[_ngcontent-%COMP%]{display:none}.root-plans[_ngcontent-%COMP%]{cursor:pointer}.root-plans[_ngcontent-%COMP%]:hover{text-decoration:underline}.toggle-row[_ngcontent-%COMP%]{display:flex;align-items:center;white-space:nowrap}  .orders-tree .p-treetable-wrapper{max-height:calc(100vh - 16.625rem);overflow:auto}  table tbody tr.qr-code-scanned{background:#e1efe2!important}  table tbody tr.partly-scanned{background:#f5dfe1!important}  table tbody tr.last-scanned{box-shadow:inset 0 0 10px 7px #3a536c40}  table tbody .is-added-after-order-creation{background:#fb8f8f!important}  table tbody .is-wrong-qc{background:#f75151!important}.colors[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;font-size:.875rem;font-weight:500;margin-left:1rem}.colors__color[_ngcontent-%COMP%]{display:flex;align-items:center}.colors__color-block[_ngcontent-%COMP%]{width:1.5rem;height:.75rem;margin-right:.5rem}.colors__color-block_scanned[_ngcontent-%COMP%]{background:#e1efe2}.colors__color-block_partly-scanned[_ngcontent-%COMP%]{background:#f5dfe1}.in-plan[_ngcontent-%COMP%]{background-color:#7c85f585!important}.print-page[_ngcontent-%COMP%]{z-index:9999;background:#fff;left:0;top:0;right:0;display:none;height:100%}@media print{.print-page[_ngcontent-%COMP%]{display:block}}@media print{  .layout-header{display:none}}.ids-container[_ngcontent-%COMP%], .order-ids-container[_ngcontent-%COMP%]{position:relative}.order-ids-container[_ngcontent-%COMP%]   .orders-ids[_ngcontent-%COMP%]{display:none}.order-ids-container[_ngcontent-%COMP%]:hover   .orders-ids[_ngcontent-%COMP%]{display:block;position:absolute;right:-100%;top:0;background-color:#fff;padding:.5rem 1rem;z-index:1;border-radius:.625rem;box-shadow:0 0 6px 5px #00000026}.serial-numbers-container[_ngcontent-%COMP%]{color:#495057!important;position:relative}.serial-numbers-container[_ngcontent-%COMP%]   .serial-numbers[_ngcontent-%COMP%]{display:none;color:#495057!important}.serial-numbers-container[_ngcontent-%COMP%]:hover   .serial-numbers[_ngcontent-%COMP%]{position:absolute;display:block;top:0;left:-11rem;width:11rem;height:auto;padding:.5rem 1rem;color:#495057!important;background-color:#fff;border-radius:.625rem;box-shadow:0 0 6px 5px #00000026;z-index:100}"]}),O=(0,z.gn)([(0,q.c)()],O);var Oa=_(3887),ka=_(6835),Ja=_(8478);function Ma(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(null==t.chain||null==t.chain.customer||null==t.chain.customer.country?null:t.chain.customer.country.name)}}function La(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(null==t.chain.customer||null==t.chain.customer.region?null:t.chain.customer.region.name)}}function Da(n,r){if(1&n&&(e.TgZ(0,"div")(1,"div",3)(2,"div")(3,"h2",9),e._uU(4,"Customer"),e.qZA(),e.TgZ(5,"div",10)(6,"div",11)(7,"h4"),e._uU(8),e.qZA(),e.TgZ(9,"h4"),e._uU(10),e.qZA(),e.TgZ(11,"h4"),e._uU(12),e.qZA(),e.TgZ(13,"h4"),e._uU(14),e.qZA(),e.TgZ(15,"h4"),e._uU(16),e.qZA(),e.TgZ(17,"h4"),e._uU(18),e.qZA(),e.TgZ(19,"h4"),e._uU(20),e.qZA()(),e.TgZ(21,"div",11)(22,"h4"),e._uU(23),e.qZA(),e.TgZ(24,"h4"),e._uU(25),e.qZA(),e.TgZ(26,"h4"),e._uU(27," Country: "),e.YNc(28,Ma,2,1,"span",2),e.qZA(),e.TgZ(29,"h4"),e._uU(30," Region: "),e.YNc(31,La,2,1,"span",2),e.qZA(),e.TgZ(32,"h4"),e._uU(33," Status: "),e.TgZ(34,"span"),e._uU(35),e.ALo(36,"uppercase"),e.ALo(37,"date"),e.qZA()(),e.TgZ(38,"h4"),e._uU(39),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(8),e.hij("Company Name: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.name,""),e.xp6(2),e.hij("Address: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.address,""),e.xp6(2),e.hij("Email: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.email,""),e.xp6(2),e.hij("Phone Number: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.phone_number,""),e.xp6(2),e.hij("Website: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.website,""),e.xp6(2),e.hij("Tax Number: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.tax_number,""),e.xp6(2),e.hij("Register Number: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.registration_number,""),e.xp6(3),e.hij("Nomenclature: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.supplier_nomenclature,""),e.xp6(2),e.hij("Description: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.comment,""),e.xp6(3),e.Q6J("ngIf",null==t.chain||null==t.chain.customer?null:t.chain.customer.country),e.xp6(3),e.Q6J("ngIf",null==t.chain||null==t.chain.customer?null:t.chain.customer.region),e.xp6(4),e.AsE("",e.lcZ(36,14,null==t.chain?null:t.chain.status.name)," - ",e.xi3(37,16,null==t.chain?null:t.chain.estimate_date,"dd.MM.yyyy")," "),e.xp6(4),e.hij(" Comment: ",null==t.chain?null:t.chain.comment," ")}}function Ya(n,r){if(1&n&&(e.TgZ(0,"div",12)(1,"div",10)(2,"div",13)(3,"h3"),e._uU(4,"Serial number"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div",13)(8,"h3"),e._uU(9,"Code"),e.qZA(),e.TgZ(10,"p"),e._uU(11),e.qZA()(),e.TgZ(12,"div",13)(13,"h3"),e._uU(14,"Name"),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA()(),e.TgZ(17,"div",13)(18,"h3"),e._uU(19,"Quantity"),e.qZA(),e.TgZ(20,"p"),e._uU(21),e.qZA()(),e.TgZ(22,"div",13)(23,"h3"),e._uU(24,"Locator"),e.qZA(),e.TgZ(25,"p"),e._uU(26),e.qZA()(),e.TgZ(27,"div",13)(28,"h3"),e._uU(29,"Status"),e.qZA(),e.TgZ(30,"p"),e._uU(31),e.qZA()()(),e.TgZ(32,"div",13)(33,"h3"),e._uU(34,"Quantity"),e.qZA(),e.TgZ(35,"p"),e._uU(36,"_________"),e.qZA()(),e.TgZ(37,"div",13)(38,"h3"),e._uU(39,"Packing"),e.qZA(),e.TgZ(40,"p"),e._uU(41,"_________"),e.qZA()()()),2&n){const t=r.$implicit,i=e.oxw();e.xp6(6),e.Oqu(null==t.warehouse_product.serial_number?null:t.warehouse_product.serial_number.type_with_number),e.xp6(5),e.Oqu(t.warehouse_product.nomenclature.code),e.xp6(5),e.Oqu(t.warehouse_product.nomenclature.name),e.xp6(5),e.Oqu(t.quantity),e.xp6(5),e.Oqu(i.translateLocator(t.warehouse_product.locator)),e.xp6(5),e.Oqu(null==t.qc_delivery_status?null:t.qc_delivery_status.name)}}let Ea=(()=>{class n{constructor(t){this.auth=t,this.products=[],this.currentReqDate=null,this.locators=[],this.currentDate=new Date,this.Nomenclature=E.UG}ngOnInit(){}getNomenclature(t){return t}translateLocator(t){if(!this.locators)return t;const i=this.locators.find(o=>o.id===t);return`${i.name} R:${i.row} C:${i.column} S:${i.shelf} P:${i.place}`}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(V.e8))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-qc-delivery-chain-print-page"]],inputs:{products:"products",orderedProducts:"orderedProducts",chain:"chain",chainId:"chainId",customer:"customer",currentReqDate:"currentReqDate",locators:"locators"},decls:48,vars:13,consts:[[1,"qc-delivery-chain-print-page"],[1,"qc-delivery-chain-print-page__header"],[4,"ngIf"],[1,"qc-delivery-chain-print-page__table"],["class","qc-delivery-chain-print-page__row",4,"ngFor","ngForOf"],[1,"qc-delivery-chain-print-page__bottom"],[1,"qc-delivery-chain-print-page__column"],[1,"qc-delivery-chain-print-page__left"],[1,"qc-delivery-chain-print-page__right"],[2,"white-space","nowrap"],[1,"qc-delivery-chain-print-page__box"],[1,"qc-delivery-chain-print-page__col_double"],[1,"qc-delivery-chain-print-page__row"],[1,"qc-delivery-chain-print-page__col"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),e._uU(4,"Delivery Chain ID"),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA()(),e.TgZ(7,"div"),e._UZ(8,"h2")(9,"p"),e.qZA(),e.TgZ(10,"div")(11,"h2"),e._uU(12,"Delivery Chain Creation Date"),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.ALo(15,"date"),e.qZA()()(),e.YNc(16,Da,40,19,"div",2),e.TgZ(17,"div",3),e.YNc(18,Ya,42,6,"div",4),e.TgZ(19,"div",5)(20,"div",6)(21,"div",7)(22,"div")(23,"h3"),e._uU(24,"Sent"),e.qZA(),e.TgZ(25,"p"),e._uU(26),e.qZA()(),e.TgZ(27,"div")(28,"h3"),e._uU(29,"Date"),e.qZA(),e.TgZ(30,"p"),e._uU(31),e.ALo(32,"date"),e.qZA()(),e.TgZ(33,"div")(34,"h3"),e._uU(35,"Signed"),e.qZA()()(),e.TgZ(36,"div",8)(37,"div")(38,"h3"),e._uU(39,"Retrieved"),e.qZA(),e._UZ(40,"p"),e.qZA(),e.TgZ(41,"div")(42,"h3"),e._uU(43,"Date"),e.qZA(),e._UZ(44,"p"),e.qZA(),e.TgZ(45,"div")(46,"h3"),e._uU(47,"Signed"),e.qZA()()()()()()()),2&t&&(e.xp6(6),e.Oqu(i.chain.id),e.xp6(8),e.Oqu(e.xi3(15,7,null==i.chain?null:i.chain.created_at,"dd.MM.y")),e.xp6(2),e.Q6J("ngIf",i.customer),e.xp6(2),e.Q6J("ngForOf",i.products),e.xp6(8),e.AsE("",i.auth.user.first_name," ",i.auth.user.last_name,""),e.xp6(5),e.Oqu(e.xi3(32,10,i.currentDate,"dd.MM.y")))},dependencies:[g.sg,g.O5,g.gd,g.uU],styles:[".qc-delivery-chain-print-page[_ngcontent-%COMP%]{display:block}.qc-delivery-chain-print-page__header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:10px}.qc-delivery-chain-print-page__header[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding-right:25px;width:25%;margin-bottom:20px}.qc-delivery-chain-print-page__header[_ngcontent-%COMP%]   div.col-2[_ngcontent-%COMP%]{width:50%}.qc-delivery-chain-print-page__box[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.qc-delivery-chain-print-page__row[_ngcontent-%COMP%]{border:2px solid #000;border-bottom:none;padding:10px;border-bottom:1px solid #000;border-top:1px solid #000}@media print{.qc-delivery-chain-print-page__row[_ngcontent-%COMP%]{page-break-after:auto;page-break-before:auto;page-break-inside:avoid}}.qc-delivery-chain-print-page__row[_ngcontent-%COMP%]:last-child{border-bottom:2px solid #000}.qc-delivery-chain-print-page__col_double[_ngcontent-%COMP%]{width:50%;padding:5px}.qc-delivery-chain-print-page__col[_ngcontent-%COMP%]{width:25%;padding:5px}.qc-delivery-chain-print-page__col_half[_ngcontent-%COMP%]{width:12.5%;padding:5px}.qc-delivery-chain-print-page[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;font-weight:500}.qc-delivery-chain-print-page[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:500;margin-bottom:3px}.qc-delivery-chain-print-page__column[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between}.qc-delivery-chain-print-page__column[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:17px;font-weight:500;margin-bottom:6px}.qc-delivery-chain-print-page__column[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:25%}@media print{.qc-delivery-chain-print-page__column[_ngcontent-%COMP%]{page-break-after:auto;page-break-before:auto}}.qc-delivery-chain-print-page__left[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .qc-delivery-chain-print-page__right[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:40px}@media print{.qc-delivery-chain-print-page__bottom[_ngcontent-%COMP%]{page-break-after:auto;page-break-before:auto}}.qc-delivery-chain-print-page__table[_ngcontent-%COMP%]{margin-bottom:60px;margin-top:10px}@media print{.qc-delivery-chain-print-page__table[_ngcontent-%COMP%]{page-break-after:auto}}@media print{.order-product-page.not-last-group[_ngcontent-%COMP%]{page-break-after:always}}"]}),n})();const Fa=["dt"];function Ra(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"a",22),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onGoToChainLink())}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.hij(" #",null==t.chain?null:t.chain.serial_number," ")}}function ja(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(null==t.chain||null==t.chain.customer||null==t.chain.customer.country?null:t.chain.customer.country.name)}}function $a(n,r){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(null==t.chain.customer||null==t.chain.customer.region?null:t.chain.customer.region.name)}}function Ga(n,r){if(1&n&&(e.TgZ(0,"div",23)(1,"h2",24),e._uU(2,"Customer"),e.qZA(),e.TgZ(3,"div",25)(4,"div",26)(5,"h4"),e._uU(6),e.qZA(),e.TgZ(7,"h4"),e._uU(8),e.qZA(),e.TgZ(9,"h4"),e._uU(10),e.qZA(),e.TgZ(11,"h4"),e._uU(12),e.qZA(),e.TgZ(13,"h4"),e._uU(14),e.qZA(),e.TgZ(15,"h4"),e._uU(16),e.qZA(),e.TgZ(17,"h4"),e._uU(18),e.qZA()(),e.TgZ(19,"div",27)(20,"h4"),e._uU(21),e.qZA(),e.TgZ(22,"h4"),e._uU(23),e.qZA(),e.TgZ(24,"h4"),e._uU(25," Country: "),e.YNc(26,ja,2,1,"span",28),e.qZA(),e.TgZ(27,"h4"),e._uU(28," Region: "),e.YNc(29,$a,2,1,"span",28),e.qZA(),e.TgZ(30,"h4"),e._uU(31," Status: "),e.TgZ(32,"span"),e._uU(33),e.ALo(34,"uppercase"),e.ALo(35,"date"),e.qZA()(),e.TgZ(36,"h4"),e._uU(37),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(6),e.hij("Company Name: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.name,""),e.xp6(2),e.hij("Address: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.address,""),e.xp6(2),e.hij("Email: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.email,""),e.xp6(2),e.hij("Phone Number: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.phone_number,""),e.xp6(2),e.hij("Website: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.website,""),e.xp6(2),e.hij("Tax Number: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.tax_number,""),e.xp6(2),e.hij("Register Number: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.registration_number,""),e.xp6(3),e.hij("Nomenclature: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.supplier_nomenclature,""),e.xp6(2),e.hij("Description: ",null==t.chain||null==t.chain.customer?null:t.chain.customer.comment,""),e.xp6(3),e.Q6J("ngIf",null==t.chain||null==t.chain.customer?null:t.chain.customer.country),e.xp6(3),e.Q6J("ngIf",null==t.chain||null==t.chain.customer?null:t.chain.customer.region),e.xp6(4),e.AsE("",e.lcZ(34,14,null==t.chain?null:t.chain.status.name)," - ",e.xi3(35,16,null==t.chain?null:t.chain.estimate_date,"dd.MM.yyyy")," "),e.xp6(4),e.hij(" Comment: ",null==t.chain?null:t.chain.comment," ")}}function Ba(n,r){1&n&&(e.TgZ(0,"p",24),e._uU(1,"Choose the Product to edit"),e.qZA())}function Ha(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",29),e.YNc(1,Ba,2,0,"p",30),e.TgZ(2,"button",31),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onCompleteMaterialQcList(o.QC_STAGES.qty_control))}),e.qZA(),e.TgZ(3,"button",32),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onCompleteMaterialQcList(o.QC_STAGES.packing_control))}),e.qZA(),e.TgZ(4,"button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onResetConfirmation())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedProducts),e.xp6(1),e.Q6J("disabled",0===(null==t.selectedProducts?null:t.selectedProducts.length)||t.chain.qc_delivery_status.qc_stage==t.QC_STAGES.done),e.xp6(1),e.Q6J("disabled",0===(null==t.selectedProducts?null:t.selectedProducts.length)||t.chain.qc_delivery_status.qc_stage==t.QC_STAGES.done),e.xp6(1),e.Q6J("disabled",0===(null==t.selectedProducts?null:t.selectedProducts.length)||t.chain.qc_delivery_status.qc_stage==t.QC_STAGES.done)}}function Ka(n,r){1&n&&(e.TgZ(0,"colgroup"),e._UZ(1,"col",34),e.qZA())}function za(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",35),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th",36)(4,"div",37),e._uU(5," # "),e.qZA()(),e.TgZ(6,"th",36),e._uU(7,"ID"),e.qZA(),e.TgZ(8,"th",38),e._uU(9,"Code"),e.qZA(),e.TgZ(10,"th",38),e._uU(11,"Name"),e.qZA(),e.TgZ(12,"th",39),e._uU(13,"Serial Number"),e.qZA(),e.TgZ(14,"th",40),e._uU(15,"Quantity"),e.qZA(),e.TgZ(16,"th",39),e._uU(17,"Locator"),e.qZA(),e.TgZ(18,"th",39),e._uU(19,"Status"),e.qZA(),e.TgZ(20,"th",41),e._uU(21,"Quantity Confirmation"),e.qZA(),e.TgZ(22,"th",41),e._uU(23,"Packing Confirmation"),e.qZA()())}function Wa(n,r){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.xp6(1),e.hij(" ",t," ")}}function Va(n,r){if(1&n&&(e.TgZ(0,"pek-hover-detailed-info-component",50)(1,"span",51)(2,"div"),e._uU(3),e.qZA(),e.YNc(4,Wa,2,1,"div",52),e.qZA()()),2&n){const t=e.oxw(),i=t.rowIndex,o=t.$implicit,c=e.oxw();e.Q6J("moveLeft",0),e.xp6(1),e.ekj("is-fixed",c.products.length<=10)("is-absolute",c.products.length>10)("is-last",c.products.length-10<=i),e.xp6(2),e.hij(" ",o.id," "),e.xp6(1),e.Q6J("ngForOf",o.ids)}}function Xa(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",53),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,1,!0))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("disabled",1!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)}}function es(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",54),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,1,!1))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("disabled",1!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)}}function ts(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",53),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,2,!0))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("disabled",(2!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)&&3!=t.qc_delivery_status.id)}}function ns(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",54),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,c=e.oxw();return e.KtG(c.onUpdateItems(o,2,!1))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("disabled",(2!=t.qc_delivery_status.qc_stage||t.qc_delivery_status.is_qc_completed)&&3!=t.qc_delivery_status.id)}}function is(n,r){if(1&n&&(e.TgZ(0,"tr",42)(1,"td",35),e._UZ(2,"p-tableCheckbox",43),e.qZA(),e.TgZ(3,"td",36)(4,"div",37)(5,"h3",44),e._uU(6,"#"),e.qZA(),e._uU(7),e.qZA()(),e.TgZ(8,"td",45)(9,"h3",44),e._uU(10,"ID"),e.qZA(),e._uU(11),e.YNc(12,Va,5,9,"pek-hover-detailed-info-component",46),e.qZA(),e.TgZ(13,"td",38)(14,"h3",44),e._uU(15,"Code"),e.qZA(),e.TgZ(16,"span"),e._uU(17),e.qZA()(),e.TgZ(18,"td",47)(19,"h3",44),e._uU(20,"Name"),e.qZA(),e.TgZ(21,"span"),e._uU(22),e.qZA()(),e.TgZ(23,"td",39)(24,"h3",44),e._uU(25,"Serial number"),e.qZA(),e.TgZ(26,"span"),e._uU(27),e.qZA()(),e.TgZ(28,"td",40)(29,"h3",44),e._uU(30,"Required Quantity"),e.qZA(),e._uU(31),e.qZA(),e.TgZ(32,"td",39)(33,"h3",44),e._uU(34,"Locator"),e.qZA(),e.TgZ(35,"span"),e._uU(36),e.qZA()(),e.ynx(37),e.TgZ(38,"td",39)(39,"h3",44),e._uU(40,"Status"),e.qZA(),e._uU(41),e.qZA(),e.TgZ(42,"td",48)(43,"div",49),e.YNc(44,Xa,2,1,"ng-container",28),e.YNc(45,es,2,1,"ng-container",28),e.qZA()(),e.TgZ(46,"td",48)(47,"div",49),e.YNc(48,ts,2,1,"ng-container",28),e.YNc(49,ns,2,1,"ng-container",28),e.qZA()(),e.BQk(),e.qZA()),2&n){const t=r.$implicit,i=r.rowIndex,o=e.oxw();e.Q6J("pSelectableRow",t),e.xp6(2),e.Q6J("value",t),e.xp6(5),e.hij(" ",i+1," "),e.xp6(4),e.hij(" ",t.id," "),e.xp6(1),e.Q6J("ngIf",(null==t.ids?null:t.ids.length)>0),e.xp6(5),e.hij(" ",t.warehouse_product.nomenclature.code," "),e.xp6(5),e.hij(" ",t.warehouse_product.nomenclature.name," "),e.xp6(5),e.hij(" ",null==t.warehouse_product.serial_number?null:t.warehouse_product.serial_number.type_with_number," "),e.xp6(4),e.hij(" ",t.quantity," "),e.xp6(5),e.Oqu(o.translateLocator(t.warehouse_product.locator)),e.xp6(5),e.hij(" ",null==t.qc_delivery_status?null:t.qc_delivery_status.name," "),e.xp6(1),e.ekj("disabled",1!=(null==o.chain||null==o.chain.qc_delivery_status?null:o.chain.qc_delivery_status.qc_stage)),e.xp6(2),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed||1!=t.qc_delivery_status.qc_stage||3===t.qc_delivery_status.id),e.xp6(1),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed&&1===t.qc_delivery_status.qc_stage||2===t.qc_delivery_status.id),e.xp6(1),e.ekj("disabled",2!=t.qc_delivery_status.qc_stage&&3!=t.qc_delivery_status.id),e.xp6(2),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed||2!=t.qc_delivery_status.qc_stage||6===t.qc_delivery_status.id),e.xp6(1),e.Q6J("ngIf",!t.qc_delivery_status.is_qc_completed&&2===t.qc_delivery_status.qc_stage||1===t.qc_delivery_status.qc_stage||5===t.qc_delivery_status.id)}}function os(n,r){1&n&&e._UZ(0,"i",58)}function rs(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function cs(n,r){if(1&n&&(e.TgZ(0,"tr",55)(1,"td",56),e.YNc(2,os,1,0,"i",57),e.YNc(3,rs,2,0,"span",28),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",9),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function as(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",59),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(20);return e.KtG(o.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ss(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",60)(1,"p-button",59),e.NdJ("click",function(){e.CHM(t),e.oxw();const o=e.MAs(20);return e.KtG(o.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function ls(n,r){if(1&n&&(e.TgZ(0,"div",61)(1,"div"),e._UZ(2,"pek-qc-delivery-chain-print-page",62),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("chain",t.chain)("products",t.products)("currentReqDate",t.currentReqDate)("customer",null==t.chain?null:t.chain.customer)("locators",t.locators)}}const _s=function(){return["name"]};let k=class{constructor(r,t,i,o,c,a,s){this.deliveryService=r,this.salesChainService=t,this.auth=i,this.route=o,this.router=c,this.modalService=a,this.locatorService=s,this.link=Q.N.link_url+"dash/",this.isShowPrint=!1,this.destroy$=new b.x,this.QC_STAGES={qty_control:1,packing_control:2,done:3},this.currentReqDate=null,this.selectedProducts=null,this.isLoading=!0,this.products=[],this.locators=[],this.listProducts=[],this.chainId=parseInt(this.route.snapshot.paramMap.get("id")),this.firstPage=0}ngOnInit(){this.getDeliveryChain(),this.getItems(),this.getLocators()}getDeliveryChain(){this.deliveryService.getChainById(this.chainId).subscribe(r=>{this.chain=r,this.isLoading=!1})}getLocators(){this.locatorService.get().subscribe(r=>{this.locators=r})}getItems(){this.selectedProducts=[],this.deliveryService.getDeliveryItems(this.chainId).subscribe(r=>{this.products=r})}complete(){this.modalService.confirm("success").subscribe(r=>{r&&(this.isLoading=!1,this.deliveryService.completeDeliveryQc(+this.chainId).pipe((0,q.t)(this)).subscribe(()=>this.router.navigate(["../../"],{relativeTo:this.route})))})}onUpdateItems(r,t,i){let o=[];this.modalService.confirm("success").pipe((0,y.h)(c=>c)).subscribe(()=>{o.push(r.id),this.salesChainService.updateItem({reservation_ids:o,chain_qc_delivery_status_id:this.chain.qc_delivery_status.id,confirmation_flag:i,qc_stage:t}).pipe((0,q.t)(this)).subscribe(()=>{this.getDeliveryChain(),this.getItems()})})}onResetConfirmation(){let r=[];this.selectedProducts.forEach(i=>{r.push(i.id)}),this.salesChainService.resetConfirmation({reservation_ids:r}).pipe((0,q.t)(this)).subscribe(()=>{this.getDeliveryChain(),this.getItems()})}onCompleteMaterialQcList(r){let t=[];this.modalService.confirm("success").pipe((0,y.h)(i=>i)).subscribe(()=>{this.selectedProducts.forEach(o=>{t.push(o.id)}),this.salesChainService.updateItem({reservation_ids:t,qc_stage:r}).pipe((0,q.t)(this)).subscribe(()=>{this.getDeliveryChain(),this.getItems()})})}onGoToChainLink(){window.open(`/delivery-chains/chains/${this.chainId}`)}printPage(){this.isShowPrint=!0,setTimeout(()=>{window.print()})}onWindowAfterPrint(){this.isShowPrint=!1}printClosed(){this.isShowPrint=!1}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}translateLocator(r){if(!this.locators)return r;const t=this.locators.find(i=>i.id===r);return`${t.name} R:${t.row} C:${t.column} S:${t.shelf} P:${t.place}`}};k.\u0275fac=function(r){return new(r||k)(e.Y36(Oa.a),e.Y36(ka.p),e.Y36(V.e8),e.Y36(C.gz),e.Y36(C.F0),e.Y36(L.Z),e.Y36(Ja._))},k.\u0275cmp=e.Xpm({type:k,selectors:[["pek-qc-delivery-chain"]],viewQuery:function(r,t){if(1&r&&e.Gf(Fa,5),2&r){let i;e.iGM(i=e.CRH())&&(t.dateTable=i.first)}},hostBindings:function(r,t){1&r&&e.NdJ("afterprint",function(){return t.onWindowAfterPrint()},!1,e.Jf7)("afterprint",function(){return t.printClosed()})},decls:29,vars:15,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[3,"click",4,"ngIf"],[1,"page__tools"],["pButton","","type","button","label","Print",1,"p-button-success","mr-2",3,"loading","click"],["pButton","","type","button","icon","pi pi-check","label","Complete",1,"p-button-icon","mr-2",3,"disabled","click"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["selectionMode","single"],["pTemplate","caption"],["scrollHeight","calc(100vh - 18.8rem)","dataKey","id",1,"adaptive-table","print-table",3,"paginator","scrollable","rows","value","first","globalFilterFields","selection","firstChange","selectionChange"],["dt",""],["pTemplate","colgroup"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],["class","print-page",4,"ngIf"],[3,"click"],[1,"table-tools"],[1,"subtitle"],[1,"row"],[1,"col-md-5"],[1,"col-md-7"],[4,"ngIf"],[1,"d-flex","table-caption"],["class","subtitle",4,"ngIf"],["pButton","","type","button","icon","pi pi-check","label","QTY Confirm",1,"ml-auto","mr-2","p-button-success",3,"disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Packing Confirm",1,"mr-2","p-button-success",3,"disabled","click"],["pButton","","type","button","icon","pi pi-spinner","label","Reset Confirmation",1,"mr-2","p-button-danger",3,"disabled","click"],[1,"index-header"],[2,"width","3%"],[1,"text-center",2,"width","5%"],[1,"row-toggler"],[2,"width","15%"],[1,"text-center",2,"width","10%"],[1,"text-center",2,"width","14%"],[1,"text-center",2,"width","4%"],[1,"pagebreak",3,"pSelectableRow"],[3,"value"],[1,"td-title"],[1,"text-center","ids-container","hovered-info",2,"width","5%"],[3,"moveLeft",4,"ngIf"],[1,"serial-numbers-container",2,"width","15%"],[2,"width","4%"],[1,"table-buttons"],[3,"moveLeft"],[1,"ids"],[4,"ngFor","ngForOf"],["pButton","","type","button","icon","pi pi-check",1,"p-button-success","ml-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-times",1,"p-button-danger","ml-2",3,"disabled","click"],[1,"tr-spinner"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[1,"print-page"],[3,"chain","products","currentReqDate","customer","locators"]],template:function(r,t){if(1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5," Products for Delivery Chain "),e.YNc(6,Ra,2,1,"a",4),e.qZA()(),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return t.printPage()}),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(){return t.complete()}),e.qZA()()()(),e.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"p-table",11),e.YNc(14,Ga,38,19,"ng-template",12),e.qZA()()()(),e.TgZ(15,"div",8)(16,"div",9),e.ynx(17),e.TgZ(18,"div",10)(19,"p-table",13,14),e.NdJ("firstChange",function(o){return t.firstPage=o})("selectionChange",function(o){return t.selectedProducts=o}),e.YNc(21,Ha,5,4,"ng-template",12),e.YNc(22,Ka,2,0,"ng-template",15),e.YNc(23,za,24,0,"ng-template",16),e.YNc(24,is,50,19,"ng-template",17),e.YNc(25,cs,4,3,"ng-template",18),e.YNc(26,as,2,0,"ng-template",19),e.qZA()(),e.YNc(27,ss,3,0,"div",20),e.BQk(),e.qZA()(),e.YNc(28,ls,3,5,"div",21)),2&r){const i=e.MAs(20);e.xp6(3),e.Q6J("module","warehouse")("isActive",!0),e.xp6(3),e.Q6J("ngIf",!t.isLoading),e.xp6(2),e.Q6J("loading",t.isLoading),e.xp6(1),e.Q6J("disabled",!(null!=t.chain&&null!=t.chain.qc_delivery_status&&t.chain.qc_delivery_status.is_qc_completed)),e.xp6(10),e.Q6J("paginator",t.products.length>0)("scrollable",!i.paginator)("rows",10)("value",t.products)("first",t.firstPage)("globalFilterFields",e.DdM(14,_s))("selection",t.selectedProducts),e.xp6(8),e.Q6J("ngIf",!i.paginator&&!t.isLoading&&t.products.length>0),e.xp6(1),e.Q6J("ngIf",t.isShowPrint)}},dependencies:[g.sg,g.O5,Z.Hq,Z.zx,I.jx,v.iA,v.Ei,v.UA,v.Mo,N.D,fe.h,Ea,g.gd,g.uU],styles:["@page{size:portrait!important}.table-buttons[_ngcontent-%COMP%]{display:flex}.disabled[_ngcontent-%COMP%]{background:#d6d6d6!important}@media print{.page[_ngcontent-%COMP%], .page__content[_ngcontent-%COMP%]{display:none}}.row-toggler[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.row-toggler[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{margin-right:1.5rem}a[_ngcontent-%COMP%]{cursor:pointer}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.request-info[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:20px}.request-title[_ngcontent-%COMP%]{font-weight:500;font-size:24px;line-height:1.2;margin-bottom:25px}.request-row[_ngcontent-%COMP%]{margin-bottom:25px;box-sizing:border-box;padding-right:30px}.request-row[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-weight:500;font-size:19px;margin:0 0 10px;line-height:1.2}.request-row[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;margin:0}.request-row[_ngcontent-%COMP%]:nth-child(1), .request-row[_ngcontent-%COMP%]:nth-child(2), .request-row[_ngcontent-%COMP%]:nth-child(5), .request-row[_ngcontent-%COMP%]:nth-child(6){width:30%}.request-row[_ngcontent-%COMP%]:nth-child(3), .request-row[_ngcontent-%COMP%]:nth-child(4){width:20%}.user-info[_ngcontent-%COMP%]{font-size:19px;display:flex}.user-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:19px;font-weight:500;margin-bottom:5px}.user-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:25%}.user-info[_ngcontent-%COMP%]{display:none;justify-content:space-between;margin-top:50px}.user-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{height:20px}.user-info[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .user-info[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:25px}.print-info[_ngcontent-%COMP%]{display:none}.root-plans[_ngcontent-%COMP%]{cursor:pointer}.root-plans[_ngcontent-%COMP%]:hover{text-decoration:underline}.toggle-row[_ngcontent-%COMP%]{display:flex;align-items:center;white-space:nowrap}  .orders-tree .p-treetable-wrapper{max-height:calc(100vh - 16.625rem);overflow:auto}  table tbody tr.qr-code-scanned{background:#e1efe2!important}  table tbody tr.partly-scanned{background:#f5dfe1!important}  table tbody tr.last-scanned{box-shadow:inset 0 0 10px 7px #3a536c40}  table tbody .is-added-after-order-creation{background:#fb8f8f!important}  table tbody .is-wrong-qc{background:#f75151!important}.colors[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;font-size:.875rem;font-weight:500;margin-left:1rem}.colors__color[_ngcontent-%COMP%]{display:flex;align-items:center}.colors__color-block[_ngcontent-%COMP%]{width:1.5rem;height:.75rem;margin-right:.5rem}.colors__color-block_scanned[_ngcontent-%COMP%]{background:#e1efe2}.colors__color-block_partly-scanned[_ngcontent-%COMP%]{background:#f5dfe1}.in-plan[_ngcontent-%COMP%]{background-color:#7c85f585!important}.print-page[_ngcontent-%COMP%]{z-index:9999;background:#fff;left:0;top:0;right:0;display:none;height:100%}@media print{.print-page[_ngcontent-%COMP%]{display:block}}@media print{  .layout-header{display:none}}.ids-container[_ngcontent-%COMP%], .order-ids-container[_ngcontent-%COMP%]{position:relative}.order-ids-container[_ngcontent-%COMP%]   .orders-ids[_ngcontent-%COMP%]{display:none}.order-ids-container[_ngcontent-%COMP%]:hover   .orders-ids[_ngcontent-%COMP%]{display:block;position:absolute;right:-100%;top:0;background-color:#fff;padding:.5rem 1rem;z-index:1;border-radius:.625rem;box-shadow:0 0 6px 5px #00000026}.serial-numbers-container[_ngcontent-%COMP%]{color:#495057!important;position:relative}.serial-numbers-container[_ngcontent-%COMP%]   .serial-numbers[_ngcontent-%COMP%]{display:none;color:#495057!important}.serial-numbers-container[_ngcontent-%COMP%]:hover   .serial-numbers[_ngcontent-%COMP%]{position:absolute;display:block;top:0;left:-11rem;width:11rem;height:auto;padding:.5rem 1rem;color:#495057!important;background-color:#fff;border-radius:.625rem;box-shadow:0 0 6px 5px #00000026;z-index:100}"]}),k=(0,z.gn)([(0,q.c)()],k);var us=_(8382);const ds=["paginator"],ps=["dt"];function gs(n,r){1&n&&(e.TgZ(0,"p",20),e._uU(1,"Choose the Protocol to edit"),e.qZA())}function ms(n,r){1&n&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",22),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",23),e._uU(6,"Comment"),e.qZA()())}function hs(n,r){if(1&n&&(e.TgZ(0,"tr",24)(1,"td",21),e._uU(2),e.qZA(),e.TgZ(3,"td",22),e._uU(4),e.qZA(),e.TgZ(5,"td",23),e._uU(6),e.qZA()()),2&n){const t=r.$implicit,i=r.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(i+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.comment)}}function fs(n,r){1&n&&e._UZ(0,"i",28)}function vs(n,r){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function xs(n,r){if(1&n&&(e.TgZ(0,"tr")(1,"td",25),e.YNc(2,fs,1,0,"i",26),e.YNc(3,vs,2,0,"span",27),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",6),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function Zs(n,r){1&n&&(e.TgZ(0,"div",29),e._UZ(1,"i",28),e.qZA())}function qs(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",30)(1,"p-paginator",31,32),e.NdJ("onPageChange",function(o){e.CHM(t);const c=e.oxw();return e.KtG(c.paginate(o))}),e.qZA(),e.TgZ(3,"p-button",33),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onShowAll(!0))}),e._uU(4," All "),e.qZA()()}if(2&n){const t=e.oxw();e.ekj("paginator-wrapper_hide",0===t.protocolsCount),e.xp6(1),e.Q6J("rows",10)("totalRecords",t.protocolsCount)}}function ys(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",34)(1,"p-button",35),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onShowAll(!1))}),e._uU(2," Return pagination "),e.qZA()()}}let J=class{constructor(r,t){this.protocolService=r,this.modalService=t,this.search$=new X.X(null),this.menuItems=[{label:"Selected Protocol",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.editProtocol()},{label:"Remove",icon:"pi pi-trash",command:()=>this.removeProtocol()}]}],this.isLoading=!0,this.isShowAll=!1,this.protocolsCount=0,this.isStartFirstPage=!1,this.currentPage=1,this.query=[{name:"paginated",value:!0},{name:"page",value:this.currentPage}],this.protocols$=this.search$.pipe((0,p.b)(()=>this.isLoading=!0),(0,p.b)(()=>this.prepareForSearch()),(0,ue.w)(()=>(0,us.s)(()=>!this.isShowAll,this.protocolService.getForPagination(this.query).pipe((0,p.b)(i=>this.protocolsCount=i.count),(0,x.U)(i=>i.results)),this.protocolService.get(this.query).pipe((0,p.b)(i=>this.protocolsCount=i.length),(0,x.U)(i=>i)))),(0,p.b)(()=>this.isLoading=!1),(0,q.t)(this))}ngOnInit(){}paginate(r){this.isStartFirstPage||(this.currentPage=r.page+1,this.search$.next())}onShowAll(r){this.isShowAll=r,this.isShowAll||(this.currentPage=1),this.search$.next()}prepareForSearch(){this.selectedProtocol=null,this.query=[{name:"page",value:this.currentPage}],this.isShowAll||this.query.push({name:"paginated",value:!0})}removeProtocol(){this.modalService.confirm("danger").subscribe(r=>{r&&(this.protocolService.deleteProtocol(this.selectedProtocol.id).subscribe(()=>this.search$.next()),this.selectedProtocol=null)})}onCreateProtocol(){this.protocolService.createEditProtocolModal("create").pipe((0,y.h)(r=>Boolean(r)),(0,p.b)(()=>this.search$.next())).subscribe()}editProtocol(){this.protocolService.createEditProtocolModal("edit",this.selectedProtocol).pipe((0,y.h)(r=>Boolean(r)),(0,p.b)(()=>this.search$.next())).subscribe()}};J.\u0275fac=function(r){return new(r||J)(e.Y36(W),e.Y36(L.Z))},J.\u0275cmp=e.Xpm({type:J,selectors:[["pek-protocols"]],viewQuery:function(r,t){if(1&r&&(e.Gf(ds,5),e.Gf(ps,5)),2&r){let i;e.iGM(i=e.CRH())&&(t.paginator=i.first),e.iGM(i=e.CRH())&&(t.dt=i.first)}},decls:24,vars:15,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-plus","label","New Protocol",3,"click"],[1,"page__content"],[1,"page__card"],[1,"d-flex"],["class","subtitle",4,"ngIf"],[1,"ml-auto",3,"model"],[1,"table-pagination-preloader"],["selectionMode","single","scrollHeight","calc(100vh - 19rem)",3,"value","rows","scrollable","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","pagination-preloader pagination-preloader_bord",4,"ngIf"],["class","paginator-wrapper",3,"paginator-wrapper_hide",4,"ngIf"],["class","paginator-return-pagination",4,"ngIf"],[1,"subtitle"],[1,"text-center",2,"width","5%"],[2,"width","45%"],[2,"width","50%"],[3,"pSelectableRow"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],[1,"pagination-preloader","pagination-preloader_bord"],[1,"paginator-wrapper"],[3,"rows","totalRecords","onPageChange"],["paginator",""],["type","button","styleClass","p-button-text",1,"paginator-all",3,"click"],[1,"paginator-return-pagination"],["type","button","styleClass","p-button-text",3,"click"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Protocols"),e.qZA()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return t.onCreateProtocol()}),e.qZA()()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"form")(11,"div",8),e.YNc(12,gs,2,0,"p",9),e._UZ(13,"p-menubar",10),e.qZA()(),e.TgZ(14,"div",11)(15,"p-table",12,13),e.NdJ("selectionChange",function(o){return t.selectedProtocol=o}),e.ALo(17,"async"),e.YNc(18,ms,7,0,"ng-template",14),e.YNc(19,hs,7,4,"ng-template",15),e.YNc(20,xs,4,3,"ng-template",16),e.qZA(),e.YNc(21,Zs,2,0,"div",17),e.qZA(),e.YNc(22,qs,5,4,"div",18),e.YNc(23,ys,3,0,"div",19),e.qZA()()),2&r&&(e.xp6(3),e.Q6J("module","quality-control")("isActive",!0),e.xp6(9),e.Q6J("ngIf",!t.selectedProtocol),e.xp6(1),e.ekj("disabled",!t.selectedProtocol),e.Q6J("model",t.menuItems),e.xp6(2),e.Q6J("value",e.lcZ(17,13,t.protocols$))("rows",10)("scrollable",!0)("selection",t.selectedProtocol),e.xp6(6),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isShowAll),e.xp6(1),e.Q6J("ngIf",t.isShowAll))},dependencies:[g.O5,Z.Hq,Z.zx,I.jx,l._Y,l.JL,he.nm,l.F,v.iA,v.Ei,N.D,ge.D,g.Ov],styles:["form[_ngcontent-%COMP%]{padding:0 0 .75rem}"]}),J=(0,z.gn)([(0,q.c)()],J);const Ts=[{path:"",component:xe,children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",title:"Quality Control",component:wn},{path:"delivery",title:"Quality Control",component:mi},{path:"invoice/:id",title:"Invoice Quality Control",component:_r},{path:"order/:id",title:"Order Quality Control",component:So},{path:"delivery/:id",title:"Delivery to outsourcer Quality Control",component:O},{path:"delivery/chain/:id",title:"Delivery to customer Quality Control",component:k},{path:"protocols",title:"Protocols",component:J}]}];let Cs=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[C.Bz.forChild(Ts),C.Bz]}),n})();var bs=_(6984),Qs=_(7175),As=_(7292);let Ps=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.ez,Cs,bs.m,Qs.x,As.O]}),n})()}}]);