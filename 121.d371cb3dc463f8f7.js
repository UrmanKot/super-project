"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[121],{2121:(je,ge,d)=>{d.r(ge),d.d(ge,{ReportsModule:()=>$u});var m=d(6895),b=d(4269),e=d(4650),Ce=d(9293);let Ze=(()=>{class n{constructor(){this.routes=[{label:"Invoices",commands:["invoices"]},{label:"Cost Reports",commands:["cost-reports"]},{label:"Warehouse Balance",commands:["wh-balance"]},{label:"Out",commands:["out"]},{label:"In",commands:["in"]},{label:"Item Card",commands:["item-card"]},{label:"Accounting Config",commands:["configs"],children:[{label:"Company Accounting Number",commands:["configs/company-number"]},{label:"Nomenclature Accounting Number",commands:["configs/nomenclature-number"]},{label:"Technologies Accounting Number",commands:["configs/technologies-number"]},{label:"Purchase Categories Accounting Number",commands:["configs/purchase-categories-number"]},{label:"Auxiliary Invoices Accounting Number",commands:["configs/auxiliary-invoices-number"]},{label:"Accounting Categories",commands:["configs/accounting-categories"]},{label:"Correlation of Accounting Categories",commands:["configs/correlation"]}]},{label:"Payments Checker",commands:["payments-checker"]}],this.settingRoutes=[{label:"Currencies",commands:["currencies"]},{label:"Additional Expenses",commands:["additional-expenses"]},{label:"Filters",commands:["filters"]}]}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-layout"]],decls:2,vars:3,consts:[[3,"module","routes","settingsRoutes"]],template:function(t,o){1&t&&e._UZ(0,"pek-header",0)(1,"router-outlet"),2&t&&e.Q6J("module","Reports")("routes",o.routes)("settingsRoutes",o.settingRoutes)},dependencies:[b.lC,Ce.G]}),n})();var F=d(655),C=d(9933),Te=d(855),Y=d(7427),v=d(5593),k=d(615),Z=d(805),T=d(5390),A=d(3237);function le(n,i){1&n&&(e.TgZ(0,"p",20),e._uU(1,"Choose the Currency to edit"),e.qZA())}function Ve(n,i){if(1&n&&(e.TgZ(0,"div",17),e.YNc(1,le,2,0,"p",18),e._UZ(2,"p-menubar",19),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedCurrency),e.xp6(1),e.ekj("disabled",!t.selectedCurrency),e.Q6J("model",t.menuItems)}}function He(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",22),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",22),e._uU(6,"Code"),e.qZA(),e.TgZ(7,"th",23),e._uU(8,"Symbol"),e.qZA(),e.TgZ(9,"th",24),e._uU(10,"Active"),e.qZA()())}function Ke(n,i){1&n&&(e.TgZ(0,"span",28),e._uU(1,"YES"),e.qZA())}function ze(n,i){1&n&&(e.TgZ(0,"span",29),e._uU(1,"NO"),e.qZA())}function We(n,i){if(1&n&&(e.TgZ(0,"tr",25)(1,"td",21),e._uU(2),e.qZA(),e.TgZ(3,"td",22),e._uU(4),e.qZA(),e.TgZ(5,"td",22),e._uU(6),e.qZA(),e.TgZ(7,"td",23),e._uU(8),e.qZA(),e.TgZ(9,"td",24),e.YNc(10,Ke,2,0,"span",26),e.YNc(11,ze,2,0,"span",27),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.symbol),e.xp6(2),e.Q6J("ngIf",t.is_active),e.xp6(1),e.Q6J("ngIf",!t.is_active)}}function Xe(n,i){1&n&&e._UZ(0,"i",33)}function et(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function tt(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",30),e.YNc(2,Xe,1,0,"i",31),e.YNc(3,et,2,0,"span",32),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function nt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",34),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(12);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ot(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",35)(1,"p-button",34),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(12);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let D=class{constructor(i,t,o,r){this.currencyService=i,this.router=t,this.route=o,this.modalService=r,this.menuItems=[{label:"Selected Currency",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.onEditCurrency()},{label:"Remove",icon:"pi pi-trash",command:()=>this.onRemoveCurrency()}]}],this.currencies=[],this.isLoading=!0}ngOnInit(){this.getCurrencies()}getCurrencies(){this.currencyService.get().pipe((0,C.t)(this)).subscribe(i=>{this.currencies=i,this.isLoading=!1})}onAddCurrency(){this.currencyService.createEditCurrencyModal("create").subscribe(i=>{i&&this.currencies.unshift(i)})}onEditCurrency(){this.currencyService.createEditCurrencyModal("edit",this.selectedCurrency).subscribe(i=>{if(i){const t=this.currencies.findIndex(o=>o.code===this.selectedCurrency.code);this.currencies[t]=i,this.selectedCurrency=this.currencies[t]}})}onRemoveCurrency(){this.modalService.confirm("danger").subscribe(i=>{i&&this.currencyService.delete(this.selectedCurrency).subscribe(()=>{const t=this.currencies.findIndex(o=>o.code===this.selectedCurrency.code);this.currencies.splice(t,1),this.selectedCurrency=null})})}};D.\u0275fac=function(i){return new(i||D)(e.Y36(Te.t),e.Y36(b.F0),e.Y36(b.gz),e.Y36(Y.Z))},D.\u0275cmp=e.Xpm({type:D,selectors:[["pek-reports-currencies"]],decls:19,vars:8,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-plus","label","New Currency",3,"click"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"d-flex"],["class","subtitle",4,"ngIf"],[1,"ml-auto",3,"model"],[1,"subtitle"],[1,"text-center",2,"width","5%"],[2,"width","30%"],[1,"text-center",2,"width","15%"],[1,"text-center",2,"width","20%"],[3,"pSelectableRow"],["class","badge badge_success",4,"ngIf"],["class","badge badge_danger",4,"ngIf"],[1,"badge","badge_success"],[1,"badge","badge_danger"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Currencies"),e.qZA()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return t.onAddCurrency()}),e.qZA()()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"p-table",9,10),e.NdJ("selectionChange",function(r){return t.selectedCurrency=r}),e.YNc(13,Ve,3,4,"ng-template",11),e.YNc(14,He,11,0,"ng-template",12),e.YNc(15,We,12,7,"ng-template",13),e.YNc(16,tt,4,3,"ng-template",14),e.YNc(17,nt,2,0,"ng-template",15),e.qZA()(),e.YNc(18,ot,3,0,"div",16),e.qZA()()),2&i){const o=e.MAs(12);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(8),e.Q6J("scrollable",!0)("paginator",t.currencies.length>0)("rows",10)("selection",t.selectedCurrency)("value",t.currencies),e.xp6(7),e.Q6J("ngIf",!o.paginator&&!t.isLoading&&t.currencies.length>0)}},dependencies:[m.O5,v.Hq,v.zx,k.nm,Z.jx,T.iA,T.Ei,A.D]}),D=(0,F.gn)([(0,C.c)()],D);var N=d(2340),y=d(4004),s=d(4006),x=d(6319),S=d(1740);let it=(()=>{class n{constructor(t,o,r,a){this.fb=t,this.additionalExpenseService=o,this.dialogRef=r,this.data=a,this.isSaving=!1,this.form=this.fb.group({name:["",[s.kI.required]]})}ngOnInit(){"edit"===this.data.type&&(this.form.addControl("id",new s.NI(this.data.additionalExpense.id)),this.form.patchValue(this.data.additionalExpense))}onSave(){switch(this.isSaving=!0,this.data.type){case"create":this.createAdditionalExpense();break;case"edit":this.editAdditionalExpense()}}createAdditionalExpense(){this.additionalExpenseService.create(this.form.value).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}editAdditionalExpense(){this.additionalExpenseService.updatePartly(this.form.value).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(xe),e.Y36(x.so),e.Y36(x.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-create-edit-additional-expenses"]],decls:12,vars:6,consts:[[1,"modal-header"],[1,"modal-header__title"],[3,"formGroup"],[1,"form-group"],["for","name"],["type","text","id","name","pInputText","","formControlName","name"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button",1,"p-button-success",3,"label","loading","disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"form",2)(5,"div",3)(6,"label",4),e._uU(7,"Name*"),e.qZA(),e._UZ(8,"input",5),e.qZA()()(),e.TgZ(9,"mat-dialog-actions",6),e._UZ(10,"button",7),e.TgZ(11,"button",8),e.NdJ("click",function(){return o.onSave()}),e.qZA()()),2&t&&(e.xp6(2),e.hij(" ",o.data.type," Additional Expense "),e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(6),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("label",o.data.type)("loading",o.isSaving)("disabled",o.form.invalid))},dependencies:[v.Hq,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.ZT,x.xY,x.H8]}),n})();var $=d(529);let xe=(()=>{class n{constructor(t,o){this.httpClient=t,this.dialog=o,this.API_URL=N.N.base_url+N.N.accounting_url,this.url="accounting_services/"}get(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+this.url+o).pipe((0,y.U)(r=>r.data))}create(t){return this.httpClient.post(this.API_URL+this.url,t).pipe((0,y.U)(o=>o.data))}updatePartly(t){return console.log(t),this.httpClient.patch(this.API_URL+this.url+t.id+"/",t).pipe((0,y.U)(o=>o.data))}createExpanse(t){return this.httpClient.post(this.API_URL+"accounting_services_to_list_products/",t).pipe((0,y.U)(o=>o.data))}createExpanseTask(t){return this.httpClient.post(this.API_URL+"accounting_services_to_tasks/",t).pipe((0,y.U)(o=>o.data))}removeExpanse(t){return this.httpClient.delete(this.API_URL+`accounting_services_to_list_products/${t}/`)}removeExpanseTask(t){return this.httpClient.delete(this.API_URL+`accounting_services_to_tasks/${t}/`)}delete(t){return this.httpClient.delete(this.API_URL+this.url+t+"/")}createEditCurrencyModal(t,o){return this.dialog.open(it,{width:"35rem",height:"auto",data:{type:t,additionalExpense:o},autoFocus:!1,enterAnimationDuration:"250ms"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG($.eN),e.LFG(x.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function rt(n,i){1&n&&(e.TgZ(0,"p",20),e._uU(1,"Choose the Additional Expense to edit"),e.qZA())}function at(n,i){if(1&n&&(e.TgZ(0,"div",17),e.YNc(1,rt,2,0,"p",18),e._UZ(2,"p-menubar",19),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedAdditionalExpense),e.xp6(1),e.ekj("disabled",!t.selectedAdditionalExpense),e.Q6J("model",t.menuItems)}}function ct(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",22),e._uU(4,"Name"),e.qZA()())}function st(n,i){if(1&n&&(e.TgZ(0,"tr",23)(1,"td",21),e._uU(2),e.qZA(),e.TgZ(3,"td",22),e._uU(4),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name)}}function lt(n,i){1&n&&e._UZ(0,"i",27)}function pt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function _t(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",24),e.YNc(2,lt,1,0,"i",25),e.YNc(3,pt,2,0,"span",26),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function ut(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",28),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(12);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function dt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"p-button",28),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(12);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let G=class{constructor(i,t,o,r){this.currencyService=i,this.router=t,this.route=o,this.modalService=r,this.menuItems=[{label:"Selected Additional Expenses",items:[{label:"Remove",icon:"pi pi-trash",command:()=>this.onRemoveAdditionalExpenses()}]}],this.additionalExpenses=[],this.isLoading=!0}ngOnInit(){this.getAdditionalExpenses()}getAdditionalExpenses(){this.currencyService.get().pipe((0,C.t)(this)).subscribe(i=>{this.additionalExpenses=i,this.isLoading=!1})}onAddAdditionalExpense(){this.currencyService.createEditCurrencyModal("create").subscribe(i=>{i&&this.additionalExpenses.unshift(i)})}onEditAdditionalExpenses(){this.currencyService.createEditCurrencyModal("edit",this.selectedAdditionalExpense).subscribe(i=>{if(i){const t=this.additionalExpenses.findIndex(o=>o.id===this.selectedAdditionalExpense.id);this.additionalExpenses[t]=i,this.selectedAdditionalExpense=this.additionalExpenses[t]}})}onRemoveAdditionalExpenses(){this.modalService.confirm("danger").subscribe(i=>{i&&this.currencyService.delete(this.selectedAdditionalExpense.name).subscribe(()=>{const t=this.additionalExpenses.findIndex(o=>o.name===this.selectedAdditionalExpense.name);this.additionalExpenses.splice(t,1),this.selectedAdditionalExpense=null})})}};G.\u0275fac=function(i){return new(i||G)(e.Y36(xe),e.Y36(b.F0),e.Y36(b.gz),e.Y36(Y.Z))},G.\u0275cmp=e.Xpm({type:G,selectors:[["pek-reports-additional-expenses"]],decls:19,vars:8,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-plus","label","New Additional Expenses",3,"click"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"d-flex"],["class","subtitle",4,"ngIf"],[1,"ml-auto",3,"model"],[1,"subtitle"],[1,"text-center",2,"width","5%"],[2,"width","95%"],[3,"pSelectableRow"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Additional Expenses"),e.qZA()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return t.onAddAdditionalExpense()}),e.qZA()()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"p-table",9,10),e.NdJ("selectionChange",function(r){return t.selectedAdditionalExpense=r}),e.YNc(13,at,3,4,"ng-template",11),e.YNc(14,ct,5,0,"ng-template",12),e.YNc(15,st,5,3,"ng-template",13),e.YNc(16,_t,4,3,"ng-template",14),e.YNc(17,ut,2,0,"ng-template",15),e.qZA()(),e.YNc(18,dt,3,0,"div",16),e.qZA()()),2&i){const o=e.MAs(12);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(8),e.Q6J("scrollable",!0)("paginator",t.additionalExpenses.length>0)("rows",10)("selection",t.selectedAdditionalExpense)("value",t.additionalExpenses),e.xp6(7),e.Q6J("ngIf",!o.paginator&&!t.isLoading&&t.additionalExpenses.length>0)}},dependencies:[m.O5,v.Hq,v.zx,k.nm,Z.jx,T.iA,T.Ei,A.D]}),G=(0,F.gn)([(0,C.c)()],G);var mt=d(2820),J=d(6767),pe=d(3148),L=d(585),B=d(6242),re=d(528),E=d(1761),_e=d(7613);let gt=(()=>{class n{constructor(t,o,r,a,l,p){this.fb=t,this.dialogRef=o,this.adapterService=r,this.reportFilterService=a,this.columnFilterService=l,this.data=p,this.isSaving=!1,this.form=this.fb.group({name:[null,s.kI.required],nomenclature_name:[""],nomenclature_code:[""],nomenclature_categories:[null],supplier:[null],supplier_category:[null],system_creation_date_after:[null],system_creation_date_before:[null],invoice_reception_date_after:[null],invoice_reception_date_before:[null],items_reception_date_after:[null],items_reception_date_before:[null],is_paid:[null]})}ngOnInit(){"edit"===this.data?.type&&this.getFilterValues()}getFilterValues(){this.filter={...this.data.filter},this.filter.invoice_reception_date_after&&(this.filter.invoice_reception_date_after=new Date(this.data.filter.invoice_reception_date_after)),this.filter.invoice_reception_date_before&&(this.filter.invoice_reception_date_before=new Date(this.data.filter.invoice_reception_date_before)),this.filter.items_reception_date_after&&(this.filter.items_reception_date_after=new Date(this.data.filter.items_reception_date_after)),this.filter.items_reception_date_before&&(this.filter.items_reception_date_before=new Date(this.data.filter.items_reception_date_before)),this.filter.system_creation_date_after&&(this.filter.system_creation_date_after=new Date(this.filter.system_creation_date_after)),this.filter.system_creation_date_before&&(this.filter.system_creation_date_before=new Date(this.filter.system_creation_date_before)),this.filter.supplier_category||(this.filter.supplier_category=null),this.filter.supplier=this.filter.supplier?this.filter.supplier.id:null,this.filter.supplier_category=this.filter.supplier_category?this.filter.supplier_category.id:null,this.filter.nomenclature_categories=this.filter.nomenclature_categories.split(",").map(t=>+t),console.log(this.filter.nomenclature_categories),this.form.patchValue(this.filter)}togglePaidStatus(t){this.form.get("is_paid").patchValue(t)}onSave(){switch(this.isSaving=!0,this.data.type){case"create":this.createInvoiceFilter();break;case"edit":this.editInvoiceFilter()}}createInvoiceFilter(){const t={...this.form.value};t.system_creation_date_after=this.adapterService.dateAdapter(t.system_creation_date_after),t.system_creation_date_before=this.adapterService.dateAdapter(t.system_creation_date_before),t.invoice_reception_date_after=this.adapterService.dateAdapter(t.invoice_reception_date_after),t.invoice_reception_date_before=this.adapterService.dateAdapter(t.invoice_reception_date_before),t.items_reception_date_after=this.adapterService.dateAdapter(t.items_reception_date_after),t.items_reception_date_before=this.adapterService.dateAdapter(t.items_reception_date_before),t.nomenclature_categories&&t.nomenclature_categories.length>0?"string"!=typeof t.nomenclature_categories&&(t.nomenclature_categories=t.nomenclature_categories.join(",")):t.nomenclature_categories="",t.supplier_category||delete t.supplier_category,this.reportFilterService.createFilter(t).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}onSelectCompany(t){this.form.get("supplier").patchValue(t)}onSelectCompanyCategory(t){this.form.get("supplier_category").patchValue(t)}editInvoiceFilter(){const t={...this.form.value};t.system_creation_date_after=this.adapterService.dateAdapter(t.system_creation_date_after),t.system_creation_date_before=this.adapterService.dateAdapter(t.system_creation_date_before),t.invoice_reception_date_after=this.adapterService.dateAdapter(t.invoice_reception_date_after),t.invoice_reception_date_before=this.adapterService.dateAdapter(t.invoice_reception_date_before),t.items_reception_date_after=this.adapterService.dateAdapter(t.items_reception_date_after),t.items_reception_date_before=this.adapterService.dateAdapter(t.items_reception_date_before),t.nomenclature_categories&&t.nomenclature_categories.length>0?"string"!=typeof t.nomenclature_categories&&(t.nomenclature_categories=t.nomenclature_categories.join(",")):t.nomenclature_categories="",t.supplier_category||delete t.supplier_category,t.id=this.data.filter.id,this.reportFilterService.updateFilter(t).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}getCategories(t){this.form.get("nomenclature_categories").patchValue(t?.join(",")??null)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(x.so),e.Y36(J.v),e.Y36(ye),e.Y36(pe.W),e.Y36(x.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-create-edit-report-filter"]],decls:61,vars:22,consts:[[1,"modal-header"],[1,"modal-header__title"],[3,"formGroup"],[1,"row"],[1,"col-12"],["for","name"],["type","text","id","name","pInputText","","formControlName","name"],[1,"col-6"],["for","nomenclature_name"],["type","text","id","nomenclature_name","pInputText","","formControlName","nomenclature_name"],["for","nomenclature_code"],["type","text","id","nomenclature_code","pInputText","","formControlName","nomenclature_code"],[3,"currentCompanyId","selectCompany"],[3,"selectedCategoryId","selectCompanyCategory"],[3,"currentCategoryIds","choiceCategoryFolAllIds"],[3,"filterValue","changeValue"],["formControlName","system_creation_date_after","dataType","date","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],["formControlName","system_creation_date_before","dataType","date","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],["formControlName","invoice_reception_date_after","dataType","date","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],["formControlName","invoice_reception_date_before","dataType","date","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],["formControlName","items_reception_date_after","dataType","date","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],["formControlName","items_reception_date_before","dataType","date","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button",1,"p-button-success",3,"label","loading","disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"form",2)(5,"div",3)(6,"div",4)(7,"label",5),e._uU(8,"Filter Name*"),e.qZA(),e._UZ(9,"input",6),e.qZA(),e.TgZ(10,"div",7)(11,"label",8),e._uU(12,"Nomenclature Name"),e.qZA(),e._UZ(13,"input",9),e.qZA(),e.TgZ(14,"div",7)(15,"label",10),e._uU(16,"Nomenclature Code"),e.qZA(),e._UZ(17,"input",11),e.qZA(),e.TgZ(18,"div",7)(19,"label"),e._uU(20,"Company"),e.qZA(),e.TgZ(21,"pek-company-picker",12),e.NdJ("selectCompany",function(a){return o.onSelectCompany(a)}),e.qZA()(),e.TgZ(22,"div",7)(23,"label"),e._uU(24,"Company Category"),e.qZA(),e.TgZ(25,"pek-company-category-picker",13),e.NdJ("selectCompanyCategory",function(a){return o.onSelectCompanyCategory(a)}),e.qZA()(),e.TgZ(26,"div",7)(27,"label"),e._uU(28,"Warehouse Category"),e.qZA(),e.TgZ(29,"pek-multi-product-categories-picker",14),e.NdJ("choiceCategoryFolAllIds",function(a){return o.getCategories(a)}),e.qZA()(),e.TgZ(30,"div",7)(31,"label"),e._uU(32,"Payment"),e.qZA(),e.TgZ(33,"pek-input-three-values",15),e.NdJ("changeValue",function(a){return o.togglePaidStatus(a)}),e.qZA()(),e.TgZ(34,"div",7)(35,"label"),e._uU(36,"Creation From"),e.qZA(),e._UZ(37,"p-calendar",16),e.qZA(),e.TgZ(38,"div",7)(39,"label"),e._uU(40,"Creation To"),e.qZA(),e._UZ(41,"p-calendar",17),e.qZA(),e.TgZ(42,"div",7)(43,"label"),e._uU(44,"Invoice Recieved From"),e.qZA(),e._UZ(45,"p-calendar",18),e.qZA(),e.TgZ(46,"div",7)(47,"label"),e._uU(48,"Invoice Recieved To"),e.qZA(),e._UZ(49,"p-calendar",19),e.qZA(),e.TgZ(50,"div",7)(51,"label"),e._uU(52,"Items Recieved From"),e.qZA(),e._UZ(53,"p-calendar",20),e.qZA(),e.TgZ(54,"div",7)(55,"label"),e._uU(56,"Items Recieved To"),e.qZA(),e._UZ(57,"p-calendar",21),e.qZA()()()(),e.TgZ(58,"mat-dialog-actions",22),e._UZ(59,"button",23),e.TgZ(60,"button",24),e.NdJ("click",function(){return o.onSave()}),e.qZA()()),2&t&&(e.xp6(2),e.hij(" ",o.data.type," Report Filter "),e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(17),e.Q6J("currentCompanyId",o.form.get("supplier").value),e.xp6(4),e.Q6J("selectedCategoryId",o.form.get("supplier_category").value),e.xp6(4),e.Q6J("currentCategoryIds",o.form.get("nomenclature_categories").value),e.xp6(4),e.Q6J("filterValue",o.columnFilterService.getFilterValue(o.form.get("is_paid").value)),e.xp6(4),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(4),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(4),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(4),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(4),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(4),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(2),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("label",o.data.type)("loading",o.isSaving)("disabled",o.form.invalid))},dependencies:[v.Hq,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.ZT,x.xY,x.H8,L.f,B.i,re.E,E.Q,_e.x],styles:["label[_ngcontent-%COMP%]{width:max-content;font-weight:500;margin-bottom:.75rem}.col-6[_ngcontent-%COMP%], .col-12[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:.875rem}.filters-checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;width:100%}.checkboxes[_ngcontent-%COMP%]{flex-direction:row}"]}),n})(),ye=(()=>{class n{constructor(t,o){this.httpClient=t,this.dialog=o,this.API_URL=N.N.base_url+N.N.accounting_url,this.url="warehouse_balance_filters/"}getFilters(){return this.httpClient.get(this.API_URL+this.url).pipe((0,y.U)(t=>t.data))}createFilter(t){return this.httpClient.post(this.API_URL+this.url,t).pipe((0,y.U)(o=>o.data))}deleteFilter(t){return this.httpClient.delete(this.API_URL+this.url+`${t.id}/`)}updateFilter(t){return this.httpClient.patch(this.API_URL+this.url+`${t.id}/`,t).pipe((0,y.U)(o=>o.data))}createEditReportFilter(t,o){return this.dialog.open(gt,{width:"50rem",height:"auto",panelClass:"modal-overflow-visible",data:{type:t,filter:o},autoFocus:!1,enterAnimationDuration:"250ms"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG($.eN),e.LFG(x.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var ae=d(8783);function ht(n,i){1&n&&(e.TgZ(0,"p",22),e._uU(1,"Choose the Invoice Filter to edit"),e.qZA())}function ft(n,i){if(1&n&&(e.TgZ(0,"div",19),e.YNc(1,ht,2,0,"p",20),e._UZ(2,"p-menubar",21),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedInvoiceFilter),e.xp6(1),e.ekj("disabled",!t.selectedInvoiceFilter),e.Q6J("model",t.menuItemsInvoiceFilter)}}function vt(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",23),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",24),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",25),e._uU(6,"Company"),e.qZA(),e.TgZ(7,"th",26),e._uU(8,"Company Category"),e.qZA(),e.TgZ(9,"th",26),e._uU(10,"Creation From"),e.qZA(),e.TgZ(11,"th",26),e._uU(12,"Creation "),e._UZ(13,"br"),e._uU(14,"To"),e.qZA(),e.TgZ(15,"th",27),e._uU(16,"Invoice "),e._UZ(17,"br"),e._uU(18,"Recieved From"),e.qZA(),e.TgZ(19,"th",26),e._uU(20,"Invoice "),e._UZ(21,"br"),e._uU(22,"Recieved To"),e.qZA(),e.TgZ(23,"th",28),e._uU(24,"Items "),e._UZ(25,"br"),e._uU(26,"Recieved From"),e.qZA(),e.TgZ(27,"th",29),e._uU(28,"Items "),e._UZ(29,"br"),e._uU(30,"Recieved To"),e.qZA(),e.TgZ(31,"th",30),e._uU(32,"Related"),e.qZA(),e.TgZ(33,"th",30),e._uU(34,"Payment"),e.qZA(),e.TgZ(35,"th",30),e._uU(36,"Complete"),e.qZA(),e.TgZ(37,"th",26),e._uU(38,"Type"),e.qZA()())}function Ct(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(null==t.supplier_category?null:t.supplier_category.name)}}function Zt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Tt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function xt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function yt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function bt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function At(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function It(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function qt(n,i){1&n&&e._UZ(0,"i",35)}function Rt(n,i){1&n&&e._UZ(0,"i",36)}function wt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Nt(n,i){1&n&&e._UZ(0,"i",35)}function Ut(n,i){1&n&&e._UZ(0,"i",36)}function Pt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Ft(n,i){1&n&&e._UZ(0,"i",35)}function Jt(n,i){1&n&&e._UZ(0,"i",36)}function kt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function St(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"Invoices"),e.qZA())}function Qt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"Auxiliary Invoices"),e.qZA())}function Mt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Yt(n,i){if(1&n&&(e.TgZ(0,"tr",31)(1,"td",23),e._uU(2),e.qZA(),e.TgZ(3,"td",24),e._uU(4),e.qZA(),e.TgZ(5,"td",25),e._uU(6),e.qZA(),e.TgZ(7,"td",26),e.YNc(8,Ct,2,1,"span",32),e.YNc(9,Zt,2,0,"span",32),e.qZA(),e.TgZ(10,"td",26),e._uU(11),e.ALo(12,"date"),e.YNc(13,Tt,2,0,"span",32),e.qZA(),e.TgZ(14,"td",26),e._uU(15),e.ALo(16,"date"),e.YNc(17,xt,2,0,"span",32),e.qZA(),e.TgZ(18,"td",27),e._uU(19),e.ALo(20,"date"),e.YNc(21,yt,2,0,"span",32),e.qZA(),e.TgZ(22,"td",26),e._uU(23),e.ALo(24,"date"),e.YNc(25,bt,2,0,"span",32),e.qZA(),e.TgZ(26,"td",28),e._uU(27),e.ALo(28,"date"),e.YNc(29,At,2,0,"span",32),e.qZA(),e.TgZ(30,"td",29),e._uU(31),e.ALo(32,"date"),e.YNc(33,It,2,0,"span",32),e.qZA(),e.TgZ(34,"td",30),e.YNc(35,qt,1,0,"i",33),e.YNc(36,Rt,1,0,"i",34),e.YNc(37,wt,2,0,"span",32),e.qZA(),e.TgZ(38,"td",30),e.YNc(39,Nt,1,0,"i",33),e.YNc(40,Ut,1,0,"i",34),e.YNc(41,Pt,2,0,"span",32),e.qZA(),e.TgZ(42,"td",30),e.YNc(43,Ft,1,0,"i",33),e.YNc(44,Jt,1,0,"i",34),e.YNc(45,kt,2,0,"span",32),e.qZA(),e.TgZ(46,"td",26),e.YNc(47,St,2,0,"span",32),e.YNc(48,Qt,2,0,"span",32),e.YNc(49,Mt,2,0,"span",32),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.supplier?t.supplier.name:"All companies"),e.xp6(2),e.Q6J("ngIf",t.supplier_category),e.xp6(1),e.Q6J("ngIf",!t.supplier_category),e.xp6(2),e.hij(" ",e.xi3(12,30,t.system_creation_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.system_creation_date_after),e.xp6(2),e.hij(" ",e.xi3(16,33,t.system_creation_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.system_creation_date_before),e.xp6(2),e.hij(" ",e.xi3(20,36,t.invoice_reception_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.invoice_reception_date_after),e.xp6(2),e.hij(" ",e.xi3(24,39,t.invoice_reception_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.invoice_reception_date_before),e.xp6(2),e.hij(" ",e.xi3(28,42,t.items_reception_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.items_reception_date_after),e.xp6(2),e.hij(" ",e.xi3(32,45,t.items_reception_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.items_reception_date_before),e.xp6(2),e.Q6J("ngIf",!0===t.has_proformas),e.xp6(1),e.Q6J("ngIf",!1===t.has_proformas),e.xp6(1),e.Q6J("ngIf",null===t.has_proformas),e.xp6(2),e.Q6J("ngIf",!0===t.is_paid),e.xp6(1),e.Q6J("ngIf",!1===t.is_paid),e.xp6(1),e.Q6J("ngIf",null===t.is_paid),e.xp6(2),e.Q6J("ngIf",!0===t.completed),e.xp6(1),e.Q6J("ngIf",!1===t.completed),e.xp6(1),e.Q6J("ngIf",null===t.completed),e.xp6(2),e.Q6J("ngIf","0"===t.type),e.xp6(1),e.Q6J("ngIf","1"===t.type),e.xp6(1),e.Q6J("ngIf",!t.type)}}function Ot(n,i){1&n&&e._UZ(0,"i",39)}function Et(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Lt(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",37),e.YNc(2,Ot,1,0,"i",38),e.YNc(3,Et,2,0,"span",32),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",14),e.xp6(1),e.Q6J("ngIf",t.isLoadingInvoiceFilters),e.xp6(1),e.Q6J("ngIf",!t.isLoadingInvoiceFilters)}}function Bt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",40),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(13);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Dt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",41)(1,"p-button",40),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(13);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function $t(n,i){1&n&&(e.TgZ(0,"p",22),e._uU(1,"Choose the Report Filter to edit"),e.qZA())}function Gt(n,i){if(1&n&&(e.TgZ(0,"div",19),e.YNc(1,$t,2,0,"p",20),e._UZ(2,"p-menubar",21),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedReportsFilter),e.xp6(1),e.ekj("disabled",!t.selectedReportsFilter),e.Q6J("model",t.menuItemsReportFilter)}}function jt(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",23),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",42),e._uU(4,"Filter Name"),e.qZA(),e.TgZ(5,"th",43),e._uU(6,"Nomenclature Name"),e.qZA(),e.TgZ(7,"th",43),e._uU(8,"Nomenclature Code"),e.qZA(),e.TgZ(9,"th",44),e._uU(10,"Company"),e.qZA(),e.TgZ(11,"th",26),e._uU(12,"Company Category"),e.qZA(),e.TgZ(13,"th",28),e._uU(14,"Warehouse category"),e.qZA(),e.TgZ(15,"th",26),e._uU(16,"Creation From"),e.qZA(),e.TgZ(17,"th",26),e._uU(18,"Creation "),e._UZ(19,"br"),e._uU(20,"To"),e.qZA(),e.TgZ(21,"th",28),e._uU(22,"Invoice "),e._UZ(23,"br"),e._uU(24,"Recieved From"),e.qZA(),e.TgZ(25,"th",26),e._uU(26,"Invoice "),e._UZ(27,"br"),e._uU(28,"Recieved To"),e.qZA(),e.TgZ(29,"th",28),e._uU(30,"Items "),e._UZ(31,"br"),e._uU(32,"Recieved From"),e.qZA(),e.TgZ(33,"th",29),e._uU(34,"Items "),e._UZ(35,"br"),e._uU(36,"Recieved To"),e.qZA(),e.TgZ(37,"th",30),e._uU(38,"Payment"),e.qZA()())}function Vt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Ht(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Kt(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(null==t.supplier_category?null:t.supplier_category.name)}}function zt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Wt(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Xt(n,i){if(1&n&&(e.TgZ(0,"div",49),e._UZ(1,"pek-multi-product-categories-picker",50),e.qZA()),2&n){const t=e.oxw(2).$implicit,o=e.oxw();e.xp6(1),e.Q6J("isDisabled",!0)("currentCategoryIds",o.getCategories(t.nomenclature_categories))}}function en(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"span")(1,"button",47),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,a=e.oxw();return e.KtG(a.openFilter(r))}),e.qZA(),e.YNc(2,Xt,2,2,"div",48),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("icon",t.opened?"pi pi-eye-slash":"pi pi-eye"),e.xp6(1),e.Q6J("ngIf",t.opened)}}function tn(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function nn(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function on(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function rn(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function an(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function cn(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function sn(n,i){1&n&&e._UZ(0,"i",35)}function ln(n,i){1&n&&e._UZ(0,"i",36)}function pn(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function _n(n,i){if(1&n&&(e.TgZ(0,"tr",31)(1,"td",23),e._uU(2),e.qZA(),e.TgZ(3,"td",42),e._uU(4),e.qZA(),e.TgZ(5,"td",43),e._uU(6),e.YNc(7,Vt,2,0,"span",32),e.qZA(),e.TgZ(8,"td",43),e._uU(9),e.YNc(10,Ht,2,0,"span",32),e.qZA(),e.TgZ(11,"td",44),e._uU(12),e.qZA(),e.TgZ(13,"td",26),e.YNc(14,Kt,2,1,"span",32),e.YNc(15,zt,2,0,"span",32),e.qZA(),e.TgZ(16,"td",45)(17,"div",46),e.YNc(18,Wt,2,0,"span",32),e.YNc(19,en,3,2,"span",32),e.qZA()(),e.TgZ(20,"td",26),e._uU(21),e.ALo(22,"date"),e.YNc(23,tn,2,0,"span",32),e.qZA(),e.TgZ(24,"td",26),e._uU(25),e.ALo(26,"date"),e.YNc(27,nn,2,0,"span",32),e.qZA(),e.TgZ(28,"td",28),e._uU(29),e.ALo(30,"date"),e.YNc(31,on,2,0,"span",32),e.qZA(),e.TgZ(32,"td",26),e._uU(33),e.ALo(34,"date"),e.YNc(35,rn,2,0,"span",32),e.qZA(),e.TgZ(36,"td",28),e._uU(37),e.ALo(38,"date"),e.YNc(39,an,2,0,"span",32),e.qZA(),e.TgZ(40,"td",29),e._uU(41),e.ALo(42,"date"),e.YNc(43,cn,2,0,"span",32),e.qZA(),e.TgZ(44,"td",30),e.YNc(45,sn,1,0,"i",33),e.YNc(46,ln,1,0,"i",34),e.YNc(47,pn,2,0,"span",32),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.nomenclature_name," "),e.xp6(1),e.Q6J("ngIf",!t.nomenclature_name),e.xp6(2),e.hij(" ",t.nomenclature_code," "),e.xp6(1),e.Q6J("ngIf",!t.nomenclature_code),e.xp6(2),e.Oqu(t.supplier?t.supplier.name:"All companies"),e.xp6(2),e.Q6J("ngIf",t.supplier_category),e.xp6(1),e.Q6J("ngIf",!t.supplier_category),e.xp6(3),e.Q6J("ngIf",!t.nomenclature_categories),e.xp6(1),e.Q6J("ngIf",t.nomenclature_categories),e.xp6(2),e.hij(" ",e.xi3(22,27,t.system_creation_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.system_creation_date_after),e.xp6(2),e.hij(" ",e.xi3(26,30,t.system_creation_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.system_creation_date_before),e.xp6(2),e.hij(" ",e.xi3(30,33,t.invoice_reception_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.invoice_reception_date_after),e.xp6(2),e.hij(" ",e.xi3(34,36,t.invoice_reception_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.invoice_reception_date_before),e.xp6(2),e.hij(" ",e.xi3(38,39,t.items_reception_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.items_reception_date_after),e.xp6(2),e.hij(" ",e.xi3(42,42,t.items_reception_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.items_reception_date_before),e.xp6(2),e.Q6J("ngIf",!0===t.is_paid),e.xp6(1),e.Q6J("ngIf",!1===t.is_paid),e.xp6(1),e.Q6J("ngIf",null===t.is_paid)}}function un(n,i){1&n&&e._UZ(0,"i",39)}function dn(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function mn(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",37),e.YNc(2,un,1,0,"i",38),e.YNc(3,dn,2,0,"span",32),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoadingReportFilters),e.xp6(1),e.Q6J("ngIf",!t.isLoadingReportFilters)}}function gn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",40),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(23);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function hn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",41)(1,"p-button",40),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(23);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let fn=(()=>{class n{constructor(t,o,r){this.invoiceFilterService=t,this.reportFilterService=o,this.modalService=r,this.tabIndex=0,this.menuItemsInvoiceFilter=[{label:"Selected Invoice Filter",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.onEditInvoiceFilter()},{label:"Remove",icon:"pi pi-trash",command:()=>this.onRemoveInvoiceFilter()}]}],this.menuItemsReportFilter=[{label:"Selected Report Filter",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.onEditReportFilter()},{label:"Remove",icon:"pi pi-trash",command:()=>this.onRemoveReportFilter()}]}],this.invoiceFilters=[],this.isLoadingInvoiceFilters=!0,this.reportFilters=[],this.isLoadingReportFilters=!0}ngOnInit(){this.getInvoiceFilters(),this.getReportsFilters()}onCreate(){0===this.tabIndex?this.createInvoiceFilter():this.createReportFilter()}getInvoiceFilters(){this.isLoadingInvoiceFilters=!0,this.selectedInvoiceFilter=null,this.invoiceFilters=[],this.invoiceFilterService.getFilters().subscribe(t=>{this.invoiceFilters=t,this.isLoadingInvoiceFilters=!1})}createInvoiceFilter(){this.invoiceFilterService.createEditInvoiceFilter("create").subscribe(t=>{t&&this.getInvoiceFilters()})}onRemoveInvoiceFilter(){this.modalService.confirm("danger").subscribe(t=>{t&&this.invoiceFilterService.deleteFilter(this.selectedInvoiceFilter).subscribe(()=>{this.getInvoiceFilters()})})}onEditInvoiceFilter(){this.invoiceFilterService.createEditInvoiceFilter("edit",this.selectedInvoiceFilter).subscribe(t=>{t&&this.getInvoiceFilters()})}getReportsFilters(){this.isLoadingReportFilters=!0,this.selectedReportsFilter=null,this.reportFilters=[],this.reportFilterService.getFilters().subscribe(t=>{this.reportFilters=t.map(o=>({...o,opened:!1})),this.isLoadingReportFilters=!1})}createReportFilter(){this.reportFilterService.createEditReportFilter("create").subscribe(t=>{t&&this.getReportsFilters()})}onEditReportFilter(){this.reportFilterService.createEditReportFilter("edit",this.selectedReportsFilter).subscribe(t=>{t&&this.getReportsFilters()})}onRemoveReportFilter(){this.modalService.confirm("danger").subscribe(t=>{t&&this.reportFilterService.deleteFilter(this.selectedReportsFilter).subscribe(()=>{this.getReportsFilters()})})}getCategories(t){return t.split(",").map(o=>+o)}openFilter(t){const o=JSON.parse(JSON.stringify(t.opened));this.reportFilters.forEach(r=>r.opened=!1),o||(t.opened=!0)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(mt.u),e.Y36(ye),e.Y36(Y.Z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-filters"]],decls:30,vars:20,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-plus",3,"label","click"],[1,"page__content"],[1,"custom-tabs",3,"activeIndex","activeIndexChange"],[3,"header","selected"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],["rt",""],[1,"d-flex"],["class","subtitle",4,"ngIf"],[1,"ml-auto",3,"model"],[1,"subtitle"],[1,"text-center",2,"width","3%"],[2,"width","15%"],[2,"width","14%"],[1,"text-center",2,"width","6%"],[1,"text-center",2,"width","9%"],[1,"text-center",2,"width","8%"],[1,"text-center",2,"width","7%"],[1,"text-center",2,"width","5%"],[3,"pSelectableRow"],[4,"ngIf"],["class","pi pi-check text-success",4,"ngIf"],["class","pi pi-times text-danger",4,"ngIf"],[1,"pi","pi-check","text-success"],[1,"pi","pi-times","text-danger"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[2,"width","9%"],[2,"width","11%"],[2,"width","10%"],[2,"width","8%"],[1,"d-flex","justify-content-center","filter-wh-category"],["pButton","",1,"cat-eye",3,"icon","click"],["class","category-opened",4,"ngIf"],[1,"category-opened"],[3,"isDisabled","currentCategoryIds"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Filters"),e.qZA()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return o.onCreate()}),e.qZA()()(),e.TgZ(8,"div",6)(9,"p-tabView",7),e.NdJ("activeIndexChange",function(a){return o.tabIndex=a}),e.TgZ(10,"p-tabPanel",8)(11,"div",9)(12,"p-table",10,11),e.NdJ("selectionChange",function(a){return o.selectedInvoiceFilter=a}),e.YNc(14,ft,3,4,"ng-template",12),e.YNc(15,vt,39,0,"ng-template",13),e.YNc(16,Yt,50,48,"ng-template",14),e.YNc(17,Lt,4,3,"ng-template",15),e.YNc(18,Bt,2,0,"ng-template",16),e.qZA()(),e.YNc(19,Dt,3,0,"div",17),e.qZA(),e.TgZ(20,"p-tabPanel",8)(21,"div",9)(22,"p-table",10,18),e.NdJ("selectionChange",function(a){return o.selectedReportsFilter=a}),e.YNc(24,Gt,3,4,"ng-template",12),e.YNc(25,jt,39,0,"ng-template",13),e.YNc(26,_n,48,45,"ng-template",14),e.YNc(27,mn,4,3,"ng-template",15),e.YNc(28,gn,2,0,"ng-template",16),e.qZA()(),e.YNc(29,hn,3,0,"div",17),e.qZA()()()()),2&t){const r=e.MAs(13),a=e.MAs(23);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(4),e.Q6J("label",0===o.tabIndex?"New Invoice Filter":"New Report Filter"),e.xp6(2),e.Q6J("activeIndex",o.tabIndex),e.xp6(1),e.Q6J("header","Invoice Filters")("selected",!0),e.xp6(2),e.Q6J("scrollable",!0)("paginator",o.invoiceFilters.length>0)("rows",10)("selection",o.selectedInvoiceFilter)("value",o.invoiceFilters),e.xp6(7),e.Q6J("ngIf",!r.paginator&&!o.isLoadingInvoiceFilters&&o.invoiceFilters.length>0),e.xp6(1),e.Q6J("header","Reports Filters")("selected",!1),e.xp6(2),e.Q6J("scrollable",!0)("paginator",o.reportFilters.length>0)("rows",10)("selection",o.selectedReportsFilter)("value",o.reportFilters),e.xp6(7),e.Q6J("ngIf",!a.paginator&&!o.isLoadingReportFilters&&o.reportFilters.length>0)}},dependencies:[m.O5,v.Hq,v.zx,k.nm,Z.jx,T.iA,T.Ei,A.D,ae.xf,ae.x4,E.Q,m.uU],styles:[".category-opened[_ngcontent-%COMP%]{z-index:10;position:fixed;width:20rem;margin-top:1rem;background:#fff;border-radius:.625rem}.cat-eye[_ngcontent-%COMP%]{width:2rem!important;height:2rem!important}"]}),n})(),vn=(()=>{class n{constructor(t){this.httpClient=t,this.API_URL=N.N.base_url+N.N.accounting_url,this.url="accounting_services/"}attachFiles(t,o){let r="";return o&&o.forEach((a,l)=>{r+=l>0?"&"+a.name+"="+a.value:"?"+a.name+"="+a.value}),this.httpClient.post(N.N.base_url+"procurement/invoices/compare_db_with_xml/"+r,t).pipe((0,y.U)(a=>a.data))}getExcludePayments(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(N.N.base_url+"procurement/payment_checker_exclude_companies/"+o).pipe((0,y.U)(r=>r.data))}excludePayment(t){return this.httpClient.post(N.N.base_url+"procurement/payment_checker_exclude_companies/",t).pipe((0,y.U)(o=>o.data))}restoreExcludePayment(t){return this.httpClient.delete(N.N.base_url+`procurement/payment_checker_exclude_companies/${t.id}/`).pipe((0,y.U)(o=>o))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG($.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var M=d(5079);const Cn=["addFileInput"],Zn=["dtp"],Tn=["trPayment"],xn=["dts"],yn=["trInvoices"];function bn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.uploadAgain())}),e.qZA()}}function An(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",29)(1,"h4"),e._uU(2,"Added Files:"),e.qZA(),e.TgZ(3,"button",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.generate())}),e.qZA()()}}function In(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",31),e._uU(1),e.TgZ(2,"button",32),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.removeFile(a))}),e._UZ(3,"i",33),e.qZA()()}if(2&n){const t=i.$implicit,o=i.index;e.xp6(1),e.AsE(" ",o+1,". ",t.name," ")}}function qn(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,An,4,0,"div",26),e.TgZ(2,"div",27),e.YNc(3,In,4,2,"div",28),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.files.length>0),e.xp6(2),e.Q6J("ngForOf",t.files)}}function Rn(n,i){1&n&&(e.TgZ(0,"div",34)(1,"h5"),e._uU(2,"In The Process of Forming"),e.qZA(),e._UZ(3,"i",35),e.qZA())}function wn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13)(4,"form",14)(5,"div",15)(6,"div",16)(7,"div",17)(8,"label"),e._uU(9,"Creation From"),e.qZA(),e._UZ(10,"p-calendar",18),e.qZA()(),e.TgZ(11,"div",16)(12,"div",17)(13,"label"),e._uU(14,"Creation To"),e.qZA(),e._UZ(15,"p-calendar",19),e.qZA()()()(),e.TgZ(16,"label",20),e.NdJ("dragover",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onDragOver(r))})("drop",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onDrop(r))}),e.TgZ(17,"div",21)(18,"span"),e._uU(19,"Select files"),e.qZA(),e._uU(20," or drag and drop it here"),e.qZA(),e.TgZ(21,"input",22,23),e.NdJ("change",function(){e.CHM(t);const r=e.MAs(22),a=e.oxw();return e.KtG(a.setFiles(r.files))}),e.qZA()(),e.YNc(23,qn,4,2,"div",24),e.YNc(24,Rn,4,0,"div",25),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.searchForm),e.xp6(6),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(8),e.Q6J("ngIf",!t.isLoadForm),e.xp6(1),e.Q6J("ngIf",t.isLoadForm)}}function Nn(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",58),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",59),e._uU(4," Payment Date "),e._UZ(5,"p-sortIcon",60),e.qZA(),e.TgZ(6,"th",61),e._uU(7," Payment Amount "),e._UZ(8,"p-sortIcon",62),e.qZA(),e.TgZ(9,"th",63),e._uU(10," Payment Supplier "),e._UZ(11,"p-sortIcon",64),e.qZA(),e.TgZ(12,"th",65),e._uU(13," Order ID "),e._UZ(14,"p-sortIcon",66),e.qZA(),e.TgZ(15,"th",67),e._uU(16," Invoice ID "),e._UZ(17,"p-sortIcon",68),e.qZA(),e.TgZ(18,"th",69),e._uU(19," Invoice Date "),e._UZ(20,"p-sortIcon",70),e.qZA(),e.TgZ(21,"th",71),e._uU(22," Invoice Total Price "),e._UZ(23,"p-sortIcon",72),e.qZA(),e.TgZ(24,"th",73),e._uU(25," Invoice Supplier "),e._UZ(26,"p-sortIcon",74),e.qZA(),e.TgZ(27,"th",75),e._uU(28,"Is it correct"),e.qZA()())}function Un(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr",76)(1,"td",58),e._uU(2),e.qZA(),e.TgZ(3,"td",77),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td",78),e._uU(7),e.ALo(8,"moneyFormat"),e.qZA(),e.TgZ(9,"td",78),e._uU(10),e.qZA(),e.TgZ(11,"td",79),e._uU(12),e.qZA(),e.TgZ(13,"td",80),e._uU(14),e.qZA(),e.TgZ(15,"td",80),e._uU(16),e.ALo(17,"date"),e.qZA(),e.TgZ(18,"td",78),e._uU(19),e.ALo(20,"moneyFormat"),e.qZA(),e.TgZ(21,"td",81),e._uU(22),e.qZA(),e.TgZ(23,"td",75)(24,"input",82),e.NdJ("ngModelChange",function(r){const l=e.CHM(t).$implicit;return e.KtG(l.completed=r)})("ngModelChange",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.update())}),e.qZA()()()}if(2&n){const t=i.$implicit,o=i.rowIndex;e.ekj("full",t.full_entry||t.completed)("no-full",!t.full_entry),e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(e.xi3(5,15,t.payment_date,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.lcZ(8,18,t.payment_amount)," \u20ac"),e.xp6(3),e.Oqu(t.xml_company_name),e.xp6(2),e.Oqu(t.order_id),e.xp6(2),e.Oqu(t.invoice_id),e.xp6(2),e.Oqu(e.xi3(17,20,t.invoice_invoice_date,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.lcZ(20,23,t.invoice_total_price)," \u20ac"),e.xp6(3),e.Oqu(t.invoice_supplier_name),e.xp6(2),e.Q6J("ngModel",t.completed)}}function Pn(n,i){1&n&&(e.TgZ(0,"tr")(1,"td",83)(2,"span"),e._uU(3,"No Records Found"),e.qZA()()()),2&n&&(e.xp6(1),e.uIk("colspan",10))}function Fn(n,i){if(1&n&&e.YNc(0,Pn,4,1,"tr",24),2&n){const t=e.oxw(2);e.Q6J("ngIf",0===t.occurrences.length)}}function Jn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",84),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.groupingPayments())}),e.qZA()}}function kn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",85),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.unGroupingPayments())}),e.qZA()}}function Sn(n,i){1&n&&e._UZ(0,"p-sortIcon",96)}function Qn(n,i){1&n&&e._UZ(0,"p-sortIcon",97)}function Mn(n,i){1&n&&e._UZ(0,"p-sortIcon",98)}function Yn(n,i){1&n&&e._UZ(0,"p-sortIcon",99)}function On(n,i){if(1&n&&(e.TgZ(0,"tr",null,86)(2,"th",87),e._uU(3,"#"),e.qZA(),e.TgZ(4,"th",88),e._uU(5," Payment ID "),e.YNc(6,Sn,1,0,"p-sortIcon",89),e.qZA(),e.TgZ(7,"th",90),e._uU(8," Payment Date "),e.YNc(9,Qn,1,0,"p-sortIcon",91),e.qZA(),e.TgZ(10,"th",92),e._uU(11," Payment Amount "),e.YNc(12,Mn,1,0,"p-sortIcon",93),e.qZA(),e.TgZ(13,"th",94),e._uU(14," Payment Supplier "),e.YNc(15,Yn,1,0,"p-sortIcon",95),e.qZA()()),2&n){const t=e.oxw(2);e.ekj("disabled",t.isGroupedPayments),e.xp6(6),e.Q6J("ngIf",!t.isGroupedPayments),e.xp6(3),e.Q6J("ngIf",!t.isGroupedPayments),e.xp6(3),e.Q6J("ngIf",!t.isGroupedPayments),e.xp6(3),e.Q6J("ngIf",!t.isGroupedPayments)}}function En(n,i){if(1&n&&(e.TgZ(0,"tr",103),e._UZ(1,"td",104)(2,"td",105),e.TgZ(3,"td",101),e._uU(4,"Total amount:"),e.qZA(),e.TgZ(5,"td",101),e._uU(6),e.ALo(7,"moneyFormat"),e.qZA(),e._UZ(8,"td",106),e.qZA()),2&n){const t=e.oxw().$implicit;e.ekj("is-grouped",t.isGrouped)("is-last",t.isLast),e.xp6(6),e.hij("",e.lcZ(7,5,t.totalAmount)," \u20ac")}}function Ln(n,i){if(1&n&&(e.TgZ(0,"tr",76)(1,"td",87),e._uU(2),e.qZA(),e.TgZ(3,"td",100),e._uU(4),e.qZA(),e.TgZ(5,"td",101),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td",101),e._uU(9),e.ALo(10,"moneyFormat"),e.qZA(),e.TgZ(11,"td",101),e._uU(12),e.qZA()(),e.YNc(13,En,9,7,"tr",102)),2&n){const t=i.$implicit,o=i.rowIndex;e.ekj("is-first",t.isFirst)("is-grouped",t.isGrouped),e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(e.xi3(7,11,t.date,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.lcZ(10,14,t.amount)," \u20ac"),e.xp6(3),e.Oqu(t.company_name),e.xp6(1),e.Q6J("ngIf",t.isLast)}}function Bn(n,i){1&n&&(e.TgZ(0,"tr")(1,"td",83)(2,"span"),e._uU(3,"No Records Found"),e.qZA()()()),2&n&&(e.xp6(1),e.uIk("colspan",5))}function Dn(n,i){if(1&n&&e.YNc(0,Bn,4,1,"tr",24),2&n){const t=e.oxw(2);e.Q6J("ngIf",0===t.payments.length)}}function $n(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",107),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.join())}),e._uU(1,"Confirm "),e.qZA()}}function Gn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",84),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.groupingInvoices())}),e.qZA()}}function jn(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",85),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.unGroupingInvoices())}),e.qZA()}}function Vn(n,i){1&n&&e._UZ(0,"p-sortIcon",96)}function Hn(n,i){1&n&&e._UZ(0,"p-sortIcon",115)}function Kn(n,i){1&n&&e._UZ(0,"p-sortIcon",116)}function zn(n,i){1&n&&e._UZ(0,"p-sortIcon",117)}function Wn(n,i){if(1&n&&(e.TgZ(0,"tr",null,108)(2,"th",87),e._uU(3,"#"),e.qZA(),e.TgZ(4,"th",88),e._uU(5," Invoice ID "),e.YNc(6,Vn,1,0,"p-sortIcon",89),e.qZA(),e.TgZ(7,"th",109),e._uU(8," Invoice Date "),e.YNc(9,Hn,1,0,"p-sortIcon",110),e.qZA(),e.TgZ(10,"th",111),e._uU(11," Invoice Total Price "),e.YNc(12,Kn,1,0,"p-sortIcon",112),e.qZA(),e.TgZ(13,"th",113),e._uU(14," Invoice Supplier "),e.YNc(15,zn,1,0,"p-sortIcon",114),e.qZA()()),2&n){const t=e.oxw(2);e.ekj("disabled",t.isGroupedInvoices),e.xp6(6),e.Q6J("ngIf",!t.isGroupedInvoices),e.xp6(3),e.Q6J("ngIf",!t.isGroupedInvoices),e.xp6(3),e.Q6J("ngIf",!t.isGroupedInvoices),e.xp6(3),e.Q6J("ngIf",!t.isGroupedInvoices)}}function Xn(n,i){if(1&n&&(e.TgZ(0,"tr",103),e._UZ(1,"td",104)(2,"td",105),e.TgZ(3,"td",101),e._uU(4,"Total amount:"),e.qZA(),e.TgZ(5,"td",101),e._uU(6),e.ALo(7,"moneyFormat"),e.qZA(),e._UZ(8,"td",106),e.qZA()),2&n){const t=e.oxw().$implicit;e.ekj("is-grouped",t.isGrouped)("is-last",t.isLast),e.xp6(6),e.hij("",e.lcZ(7,5,t.totalAmount)," \u20ac")}}function eo(n,i){if(1&n&&(e.TgZ(0,"tr",76)(1,"td",87),e._uU(2),e.qZA(),e.TgZ(3,"td",100),e._uU(4),e.qZA(),e.TgZ(5,"td",101),e._uU(6),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"td",101),e._uU(9),e.ALo(10,"moneyFormat"),e.qZA(),e.TgZ(11,"td",101),e._uU(12),e.qZA()(),e.YNc(13,Xn,9,7,"tr",102)),2&n){const t=i.$implicit,o=i.rowIndex;e.ekj("is-first",t.isFirst)("is-grouped",t.isGrouped),e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(e.xi3(7,11,t.invoice_date,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.lcZ(10,14,t.rounded_converted_total_price)," \u20ac "),e.xp6(3),e.Oqu(t.supplier),e.xp6(1),e.Q6J("ngIf",t.isLast)}}function to(n,i){1&n&&(e.TgZ(0,"tr")(1,"td",83)(2,"span"),e._uU(3,"No Records Found"),e.qZA()()()),2&n&&(e.xp6(1),e.uIk("colspan",5))}function no(n,i){if(1&n&&e.YNc(0,to,4,1,"tr",24),2&n){const t=e.oxw(2);e.Q6J("ngIf",0===t.invoices.length)}}function oo(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",87),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",118),e._uU(4," Name "),e._UZ(5,"p-sortIcon",119),e.qZA()())}function io(n,i){if(1&n&&(e.TgZ(0,"tr",76)(1,"td",87),e._uU(2),e.qZA(),e.TgZ(3,"td",120),e._uU(4),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name)}}function ro(n,i){1&n&&(e.TgZ(0,"tr")(1,"td",83)(2,"span"),e._uU(3,"No Records Found"),e.qZA()()()),2&n&&(e.xp6(1),e.uIk("colspan",2))}function ao(n,i){if(1&n&&e.YNc(0,ro,4,1,"tr",24),2&n){const t=e.oxw(2);e.Q6J("ngIf",0===t.excludePayments.length)}}function co(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",36)(1,"div",37)(2,"h3"),e._uU(3),e.qZA(),e.TgZ(4,"button",38),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.splitIntoParts())}),e.qZA()(),e.TgZ(5,"div",10)(6,"p-table",39,40),e.NdJ("selectionChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedOccurrence=r)}),e.YNc(8,Nn,29,0,"ng-template",41),e.YNc(9,Un,25,25,"ng-template",42),e.YNc(10,Fn,1,1,"ng-template",43),e.qZA()(),e.TgZ(11,"div",44)(12,"div",45)(13,"div",46)(14,"div",47)(15,"h3"),e._uU(16),e.qZA(),e.TgZ(17,"div",48),e.YNc(18,Jn,1,0,"button",49),e.YNc(19,kn,1,0,"button",50),e.TgZ(20,"button",51),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.excludePayment())}),e.qZA()()(),e.TgZ(21,"div",10)(22,"p-table",52,53),e.NdJ("selectionChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedPayment=r)}),e.YNc(24,On,16,6,"ng-template",41),e.YNc(25,Ln,14,16,"ng-template",42),e.YNc(26,Dn,1,1,"ng-template",43),e.qZA()()(),e.YNc(27,$n,2,0,"button",54),e.TgZ(28,"div",46)(29,"div",47)(30,"h3"),e._uU(31),e.qZA(),e.TgZ(32,"div",48),e.YNc(33,Gn,1,0,"button",49),e.YNc(34,jn,1,0,"button",50),e.qZA()(),e.TgZ(35,"div",10)(36,"p-table",52,55),e.NdJ("selectionChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedInvoice=r)}),e.YNc(38,Wn,16,6,"ng-template",41),e.YNc(39,eo,14,16,"ng-template",42),e.YNc(40,no,1,1,"ng-template",43),e.qZA()()()()(),e.TgZ(41,"div",56)(42,"div",47)(43,"h3"),e._uU(44,"Excluded Payments"),e.qZA(),e.TgZ(45,"button",57),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.restorePayment())}),e.qZA()(),e.TgZ(46,"div",10)(47,"p-table",52,40),e.NdJ("selectionChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedExcludePayment=r)}),e.YNc(49,oo,6,0,"ng-template",41),e.YNc(50,io,5,3,"ng-template",42),e.YNc(51,ao,1,1,"ng-template",43),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(3),e.hij("Entries (",t.occurrences.length,")"),e.xp6(1),e.Q6J("disabled",!t.selectedOccurrence),e.xp6(2),e.Q6J("value",t.occurrences)("scrollable",t.occurrences.length>0)("selection",t.selectedOccurrence),e.xp6(10),e.hij("Payments with no matches found (",t.payments.length,")"),e.xp6(2),e.Q6J("ngIf",!t.isGroupedPayments),e.xp6(1),e.Q6J("ngIf",t.isGroupedPayments),e.xp6(1),e.Q6J("disabled",!t.selectedPayment),e.xp6(2),e.Q6J("value",t.isGroupedPayments?t.groupedPayments:t.payments)("scrollable",t.payments.length>0)("selection",t.selectedPayment),e.xp6(5),e.Q6J("ngIf",t.selectedInvoice&&t.selectedPayment),e.xp6(4),e.hij("Invoices with no matches found (",t.invoices.length,")"),e.xp6(2),e.Q6J("ngIf",!t.isGroupedInvoices),e.xp6(1),e.Q6J("ngIf",t.isGroupedInvoices),e.xp6(2),e.Q6J("value",t.isGroupedInvoices?t.groupedInvoices:t.invoices)("scrollable",t.invoices.length>0)("selection",t.selectedInvoice),e.xp6(9),e.Q6J("disabled",!t.selectedExcludePayment),e.xp6(2),e.Q6J("value",t.excludePayments)("scrollable",t.excludePayments.length>0)("selection",t.selectedExcludePayment)}}let so=(()=>{class n{constructor(t,o,r,a){this.accountingService=t,this.fb=o,this.adapterService=r,this.modalService=a,this.files=[],this.isLoadForm=!1,this.isFilesLoading=!1,this.payments=[],this.invoices=[],this.occurrences=[],this.excludePayments=[],this.searchForm=this.fb.group({invoice_date_after:[null],invoice_date_before:[null]}),this.paymentsCompanyDoubles=[],this.paymentsCompanies=[],this.invoicesCompanyDoubles=[],this.invoicesCompanies=[],this.isGroupedPayments=!1,this.isGroupedInvoices=!1,this.groupedPayments=[],this.groupedInvoices=[]}ngOnInit(){this.getFiles(),this.getExcludePayments()}getMaxId(){let t=0;return this.occurrences.forEach(o=>{t<o.id&&(t=o.id)}),t+1}generateTables(){this.selectedOccurrence=null,this.selectedPayment=null,this.selectedInvoice=null,this.payments=[],this.invoices=[],this.occurrences=[],this.data.exact_entries.invoices.forEach(t=>this.occurrences.push(t)),this.data.exact_entries.service_invoices&&this.data.exact_entries.service_invoices.forEach(t=>this.occurrences.push(t)),this.data.similar_entries.invoices.forEach(t=>this.occurrences.push(t)),this.data.similar_entries.service_invoices&&this.data.similar_entries.service_invoices.forEach(t=>this.occurrences.push(t)),this.data.extra_entries.xml_payments&&this.data.extra_entries.xml_payments.forEach(t=>{this.payments.push({...t,amount:parseFloat(t.amount)})}),this.data.extra_entries.invoices.forEach(t=>{this.invoices.push({...t,rounded_converted_total_price:parseFloat(t.rounded_converted_total_price)})}),this.data.extra_entries.service_invoices&&this.data.extra_entries.service_invoices.forEach(t=>{this.invoices.push({...t,rounded_converted_total_price:parseFloat(t.rounded_converted_total_price)})}),this.invoices.forEach(t=>{t.supplier||(t.supplier="")}),this.payments.forEach(t=>{t.company_name||(t.company_name="")}),this.invoices.sort((t,o)=>t.supplier<o.supplier?-1:t.supplier>o.supplier?1:0),this.payments.sort((t,o)=>t.company_name<o.company_name?-1:t.company_name>o.company_name?1:0),this.getPaymentsCompanies(),this.getInvoicesCompanies()}getPaymentsCompanies(){this.paymentsCompanies=[],this.paymentsCompanyDoubles=[],this.payments.forEach(t=>this.paymentsCompanies.push(t.company_name)),this.paymentsCompanies.forEach(t=>{let o=0;for(;this.paymentsCompanies.includes(t);){const r=this.paymentsCompanies.findIndex(a=>a===t);this.paymentsCompanies.splice(r,1),o++}this.paymentsCompanyDoubles.push({company:t,count:o})}),this.paymentsCompanyDoubles=this.paymentsCompanyDoubles.filter(t=>t.count>1)}getInvoicesCompanies(){this.invoicesCompanies=[],this.invoicesCompanyDoubles=[],this.invoices.forEach(t=>this.invoicesCompanies.push(t.supplier)),this.invoicesCompanies.forEach(t=>{let o=0;for(;this.invoicesCompanies.includes(t);){const r=this.invoicesCompanies.findIndex(a=>a===t);this.invoicesCompanies.splice(r,1),o++}this.invoicesCompanyDoubles.push({company:t,count:o})}),this.invoicesCompanyDoubles=this.invoicesCompanyDoubles.filter(t=>t.count>1)}getFiles(){localStorage.getItem("checker")&&(this.data=JSON.parse(localStorage.getItem("checker")),this.isFilesLoading=!0,this.generateTables())}uploadAgain(){localStorage.removeItem("checker"),this.data=null,this.isFilesLoading=!1,this.files=[],this.paymentsCompanyDoubles=[],this.paymentsCompanies=[],this.invoicesCompanyDoubles=[],this.invoicesCompanies=[],this.isGroupedPayments=!1,this.isGroupedInvoices=!1,this.groupedPayments=[],this.groupedInvoices=[],this.searchForm.reset()}onDragOver(t){t.preventDefault()}onDrop(t){t.preventDefault(),Array.from(t.dataTransfer.files).forEach(r=>{"text/xml"===r.type&&this.files.push(r)})}setFiles(t){Array.from(t).forEach(r=>this.files.push(r))}setFile(t){this.files.push(t)}removeFile(t){const o=this.files.findIndex(r=>r===t);this.files.splice(o,1),this.removeFileFromFileList(o)}removeFileFromFileList(t){const o=new DataTransfer,r=this.inputFiles.nativeElement.files;for(let a=0;a<r.length;a++){const l=r[a];t!==a&&o.items.add(l)}this.inputFiles.nativeElement.files=o.files}generate(){this.isLoadForm=!0;const t=new FormData;this.files.forEach((r,a)=>{t.append(`${a+1}.xml`,r,r.name)});const o=[];this.searchForm.get("invoice_date_after").value&&o.push({name:"invoice_date_after",value:this.adapterService.dateAdapter(this.searchForm.get("invoice_date_after").value)}),this.searchForm.get("invoice_date_before").value&&o.push({name:"invoice_date_before",value:this.adapterService.dateAdapter(this.searchForm.get("invoice_date_before").value)}),this.accountingService.attachFiles(t,o).subscribe(r=>{r.exact_entries.invoices=r.exact_entries.invoices.map(a=>({full_entry:!0,type:"invoice",completed:!1,...a})),r.exact_entries.service_invoices=r.exact_entries.service_invoices.map(a=>({full_entry:!0,type:"service-invoice",completed:!1,...a})),r.similar_entries.invoices=r.similar_entries.invoices.map(a=>({full_entry:!1,type:"invoice",completed:!1,...a})),r.similar_entries.service_invoices=r.similar_entries.service_invoices.map(a=>({full_entry:!1,type:"service-invoice",completed:!1,...a})),localStorage.setItem("checker",JSON.stringify(r)),this.data={...r},this.generateTables(),this.isLoadForm=!1,this.isFilesLoading=!0})}splitIntoParts(){const o={id:this.selectedOccurrence.invoice_id,invoice_date:this.selectedOccurrence.invoice_invoice_date,supplier:this.selectedOccurrence.invoice_supplier_name,order_id:this.selectedOccurrence.order_id,rounded_converted_total_price:this.selectedOccurrence.invoice_total_price};this.payments.unshift({id:this.selectedOccurrence.payment_id,company_name:this.selectedOccurrence.xml_company_name,date:this.selectedOccurrence.payment_date,amount:this.selectedOccurrence.payment_amount}),this.invoices.unshift(o),this.getPaymentsCompanies(),this.getInvoicesCompanies(),this.isGroupedPayments&&this.groupingPayments(),this.isGroupedInvoices&&this.groupingInvoices(),this.occurrences=this.occurrences.filter(r=>r.id!==this.selectedOccurrence.id),this.selectedOccurrence=null,this.update()}join(){this.occurrences.unshift({id:this.getMaxId(),type:"invoice",completed:!1,full_entry:!0,payment_id:this.selectedPayment.id,order_id:this.selectedInvoice.order_id,invoice_id:this.selectedInvoice.id,invoice_invoice_date:this.selectedInvoice.invoice_date,invoice_total_price:this.selectedInvoice.rounded_converted_total_price,payment_amount:this.selectedPayment.amount,payment_date:this.selectedPayment.date,invoice_supplier_name:this.selectedInvoice.supplier,xml_company_name:this.selectedPayment.company_name}),this.payments=this.payments.filter(t=>t.id!==this.selectedPayment.id),this.invoices=this.invoices.filter(t=>t.id!==this.selectedInvoice.id),this.getPaymentsCompanies(),this.getInvoicesCompanies(),this.isGroupedPayments&&this.groupingPayments(),this.isGroupedInvoices&&this.groupingInvoices(),this.selectedPayment=null,this.selectedInvoice=null,this.update()}update(){const t=[],o=[],r=[],a=[];this.occurrences.forEach(p=>{p.full_entry?t.push(p):o.push(p)}),this.payments.forEach(p=>{r.push(p)}),this.invoices.forEach(p=>{a.push(p)});const l={exact_entries:{invoices:t},extra_entries:{invoices:a,xml_payments:r},similar_entries:{invoices:o}};localStorage.removeItem("checker"),localStorage.setItem("checker",JSON.stringify(l))}excludePayment(){this.modalService.confirm("success").subscribe(t=>{t&&this.accountingService.excludePayment({name:this.selectedPayment.company_name}).subscribe(r=>{this.payments=this.payments.filter(a=>a.company_name!==r.name),this.excludePayments.push(r),this.selectedPayment=null,this.update()})})}restorePayment(){this.modalService.confirm("success").subscribe(t=>{t&&this.accountingService.restoreExcludePayment({id:this.selectedExcludePayment.id}).subscribe(()=>{const r=this.excludePayments.findIndex(a=>a.id===this.selectedExcludePayment.id);this.excludePayments.splice(r,1),this.selectedExcludePayment=null})})}getExcludePayments(){this.accountingService.getExcludePayments().subscribe(t=>{this.excludePayments=t})}unGroupingPayments(){this.isGroupedPayments=!1,this.dateTablePayments._sortField=null,this.trPayment.nativeElement.querySelectorAll("th").forEach(t=>t.classList.remove("p-highlight"))}unGroupingInvoices(){this.isGroupedInvoices=!1,this.dateTablePayments._sortField=null,this.trInvoices.nativeElement.querySelectorAll("th").forEach(t=>t.classList.remove("p-highlight"))}groupingPayments(){this.dateTablePayments._sortField="company_name",this.groupedPayments=[],this.isGroupedPayments||(this.isGroupedPayments=!0),this.groupedPayments=JSON.parse(JSON.stringify(this.payments));let t=1,o=0;this.groupedPayments.forEach(r=>{this.paymentsCompanyDoubles.find(a=>a.company===r.company_name)&&(1===t&&(r.isFirst=!0),o+=r.amount,r.isGrouped=!0,t===this.paymentsCompanyDoubles.find(a=>a.company===r.company_name).count?(r.isLast=!0,r.totalAmount=o,t=1,o=0):t++)})}groupingInvoices(){this.dateTableInvoices._sortField="supplier",this.groupedInvoices=[],this.isGroupedInvoices||(this.isGroupedInvoices=!0),this.groupedInvoices=JSON.parse(JSON.stringify(this.invoices));let t=1,o=0;this.groupedInvoices.forEach(r=>{this.invoicesCompanyDoubles.find(a=>a.company===r.supplier)&&(1===t&&(r.isFirst=!0),o+=r.rounded_converted_total_price,r.isGrouped=!0,t===this.invoicesCompanyDoubles.find(a=>a.company===r.supplier).count?(r.isLast=!0,r.totalAmount=o,t=1,o=0):t++)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(vn),e.Y36(s.qu),e.Y36(J.v),e.Y36(Y.Z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-payments-checker"]],viewQuery:function(t,o){if(1&t&&(e.Gf(Cn,5),e.Gf(Zn,5),e.Gf(Tn,5),e.Gf(xn,5),e.Gf(yn,5)),2&t){let r;e.iGM(r=e.CRH())&&(o.inputFiles=r.first),e.iGM(r=e.CRH())&&(o.dateTablePayments=r.first),e.iGM(r=e.CRH())&&(o.trPayment=r.first),e.iGM(r=e.CRH())&&(o.dateTableInvoices=r.first),e.iGM(r=e.CRH())&&(o.trInvoices=r.first)}},decls:11,vars:5,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-replay","label","Upload Again",3,"click",4,"ngIf"],[1,"page__content"],["class","page__card",4,"ngIf"],["class","table",4,"ngIf"],["pButton","","type","button","icon","pi pi-replay","label","Upload Again",3,"click"],[1,"page__card"],[1,"form-upload"],[1,"card"],[1,"card-body"],[3,"formGroup"],[1,"row"],[1,"col-3"],[1,"form-group"],["formControlName","invoice_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],["formControlName","invoice_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput"],[1,"drop-area",3,"dragover","drop"],[1,"drop-area-placeholder"],["accept","text/xml","type","file","multiple","multiple","hidden","",3,"change"],["addFileInput",""],[4,"ngIf"],["class","loading",4,"ngIf"],["class","upload-header",4,"ngIf"],[1,"files-list"],["class","file",4,"ngFor","ngForOf"],[1,"upload-header"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Generate",3,"click"],[1,"file"],["pButton","","placement","bottom","ngbTooltip","delete",1,"p-button-danger",3,"click"],[1,"pi","pi-times"],[1,"loading"],[1,"pi","pi-spin","pi-spinner"],[1,"table"],[1,"table-head"],["pButton","","type","button","icon","pi pi-tags","label","Disband",3,"disabled","click"],["scrollHeight","calc(100vh - 335px)","selectionMode","single",1,"table",3,"value","scrollable","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"tables","mt-5"],[1,"tables__inner"],[1,"table-no"],[1,"table-header"],[1,"d-flex"],["pButton","","type","button","icon","pi pi-window-maximize","label","Grouping",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-window-minimize","label","Ungrouping",3,"click",4,"ngIf"],["pButton","","type","button","icon","pi pi-times","label","Exclude",1,"ml-2","p-button-danger",3,"disabled","click"],["dataKey","id","scrollHeight","calc(100vh - 335px)","selectionMode","single",1,"table",3,"value","scrollable","selection","selectionChange"],["dtp",""],["class","btn btn-primary confirm",3,"click",4,"ngIf"],["dts",""],[1,"exclude-payments","mt-5"],["pButton","","type","button","icon","pi pi-reply","label","Restore",3,"disabled","click"],[1,"text-center",2,"width","5%"],["pSortableColumn","payment_date",1,"text-center",2,"width","12%"],["field","payment_date"],["pSortableColumn","payment_amount",1,"text-center",2,"width","15%"],["field","payment_amount"],["pSortableColumn","xml_company_name",1,"text-center",2,"width","15%"],["field","xml_company_name"],["pSortableColumn","order_id",1,"text-center","bord",2,"width","10%"],["field","order_id"],["pSortableColumn","invoice_id",1,"text-center",2,"width","10%"],["field","invoice_id"],["pSortableColumn","invoice_invoice_date",1,"text-center",2,"width","10%"],["field","invoice_invoice_date"],["pSortableColumn","invoice_total_price",1,"text-center",2,"width","15%"],["field","invoice_total_price"],["pSortableColumn","invoice_supplier_name",1,"text-center","bord",2,"width","15%"],["field","invoice_supplier_name"],[1,"text-center",2,"width","8%"],[3,"pSelectableRow"],[1,"text-center",2,"width","12%"],[1,"text-center",2,"width","15%"],[1,"text-center","bord",2,"width","10%"],[1,"text-center",2,"width","10%"],[1,"text-center","bord",2,"width","15%"],["type","checkbox",1,"correct",3,"ngModel","ngModelChange"],[1,"text-center","p-3"],["pButton","","type","button","icon","pi pi-window-maximize","label","Grouping",3,"click"],["pButton","","type","button","icon","pi pi-window-minimize","label","Ungrouping",3,"click"],["trPayment",""],[1,"text-center",2,"width","9%"],["pSortableColumn","id",1,"text-center",2,"width","16%"],["field","id",4,"ngIf"],["pSortableColumn","date",1,"text-center",2,"width","25%"],["field","date",4,"ngIf"],["pSortableColumn","amount",1,"text-center",2,"width","25%"],["field","amount",4,"ngIf"],["pSortableColumn","company_name",1,"text-center",2,"width","25%"],["field","company_name",4,"ngIf"],["field","id"],["field","date"],["field","amount"],["field","company_name"],[1,"text-center",2,"width","16%"],[1,"text-center",2,"width","25%"],["class","weight",3,"is-grouped","is-last",4,"ngIf"],[1,"weight"],[2,"width","9%"],[2,"width","16%"],[2,"width","25%"],[1,"btn","btn-primary","confirm",3,"click"],["trInvoices",""],["pSortableColumn","invoice_date",1,"text-center",2,"width","25%"],["field","invoice_date",4,"ngIf"],["pSortableColumn","rounded_converted_total_price",1,"text-center",2,"width","25%"],["field","total_price",4,"ngIf"],["pSortableColumn","supplier",1,"text-center",2,"width","25%"],["field","supplier",4,"ngIf"],["field","invoice_date"],["field","total_price"],["field","supplier"],["pSortableColumn","name",2,"width","91%"],["field","name"],[2,"width","91%"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Payments Checker"),e.qZA()(),e.TgZ(6,"div",4),e.YNc(7,bn,1,0,"button",5),e.qZA()()(),e.TgZ(8,"div",6),e.YNc(9,wn,25,7,"div",7),e.YNc(10,co,52,23,"div",8),e.qZA()),2&t&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(4),e.Q6J("ngIf",o.isFilesLoading),e.xp6(2),e.Q6J("ngIf",!o.isFilesLoading),e.xp6(1),e.Q6J("ngIf",o.isFilesLoading))},dependencies:[m.sg,m.O5,v.Hq,Z.jx,T.iA,T.lQ,T.Ei,T.fz,s._Y,s.Wl,s.JJ,s.JL,s.sg,s.u,s.On,A.D,L.f,m.uU,M.U],styles:[".form-upload[_ngcontent-%COMP%]{margin:-1.25rem auto 0}.form-upload[_ngcontent-%COMP%]   .drop-area[_ngcontent-%COMP%]{width:100%;border:1px dashed var(--theme-color-primary);cursor:pointer;border-radius:.5rem;margin-bottom:0;display:block;padding:3.75rem 4.5rem;margin-top:1.25rem}.form-upload[_ngcontent-%COMP%]   .drop-area-placeholder[_ngcontent-%COMP%]{text-align:center;font-size:16px}.form-upload[_ngcontent-%COMP%]   .drop-area-placeholder[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500}.form-upload[_ngcontent-%COMP%]   .upload-header[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:500;margin:2rem 0 1.25rem;display:flex;align-items:center;justify-content:space-between}.form-upload[_ngcontent-%COMP%]   .upload-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:500}.form-upload[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]{display:flex;font-size:1rem;align-items:center;margin-bottom:.625rem}.form-upload[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]:last-child{margin-bottom:0}.form-upload[_ngcontent-%COMP%]   .file[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:.75rem;padding:.25rem!important}.form-upload[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{top:0;left:0;right:0;bottom:0;background:#fff;z-index:1;position:absolute;border-radius:.5rem;display:flex;align-items:center;justify-content:center;flex-direction:column}.form-upload[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:1.375rem;font-weight:500;margin-bottom:2rem}.form-upload[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:2rem}p-table[_ngcontent-%COMP%]{margin-bottom:0}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{vertical-align:middle!important;border:1px solid #d7dadc!important;border-right:none!important;border-left:none!important}td[_ngcontent-%COMP%]:last-child, th[_ngcontent-%COMP%]:last-child{border-right:none!important}tr[_ngcontent-%COMP%]:first-child   td[_ngcontent-%COMP%]{vertical-align:middle!important;border-top:none!important}.correct[_ngcontent-%COMP%]{width:23px;height:23px;position:relative;top:2px;cursor:pointer}.bord[_ngcontent-%COMP%]{border-right:1px solid #d7dadc!important}.no-full[_ngcontent-%COMP%]{background:#f9f7e4!important}.full[_ngcontent-%COMP%]{background:#f1f5dd!important}.filters-checker[_ngcontent-%COMP%]{margin-bottom:15px}.table[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1875rem;font-weight:600}.tables[_ngcontent-%COMP%]   .confirm[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px;margin-top:20px;align-self:center}.tables__inner[_ngcontent-%COMP%]{width:100%;display:flex;align-items:flex-start;justify-content:space-between}.table-no[_ngcontent-%COMP%], .exclude-payments[_ngcontent-%COMP%]{width:48%}.page__card[_ngcontent-%COMP%]{padding:2em}.table-head[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.table-head[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.table-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem;min-height:36px}.is-first[_ngcontent-%COMP%]{border-top:2px solid #6c757d!important}.is-last[_ngcontent-%COMP%]{border-bottom:2px solid #6c757d!important}.is-grouped[_ngcontent-%COMP%]{background:#e9e7e7!important}.weight[_ngcontent-%COMP%]{font-weight:500}.disabled[_ngcontent-%COMP%]{pointer-events:none}.disabled[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#495057!important}"]}),n})();var he=d(1135),O=d(3900),ue=d(8675),P=d(7579),Q=d(1884),I=d(8372),g=d(8505),R=d(9300),lo=d(6382),Pe=d(5861),po=d(4313);function _o(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",10),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",11),e._uU(4,"Filter Name"),e.qZA(),e.TgZ(5,"th",12),e._uU(6,"Nomenclature Name"),e.qZA(),e.TgZ(7,"th",12),e._uU(8,"Nomenclature Code"),e.qZA(),e.TgZ(9,"th",13),e._uU(10,"Company"),e.qZA(),e.TgZ(11,"th",14),e._uU(12,"Company Category"),e.qZA(),e.TgZ(13,"th",15),e._uU(14,"Warehouse category"),e.qZA(),e.TgZ(15,"th",14),e._uU(16,"Creation From"),e.qZA(),e.TgZ(17,"th",14),e._uU(18,"Creation "),e._UZ(19,"br"),e._uU(20,"To"),e.qZA(),e.TgZ(21,"th",15),e._uU(22,"Invoice "),e._UZ(23,"br"),e._uU(24,"Recieved From"),e.qZA(),e.TgZ(25,"th",14),e._uU(26,"Invoice "),e._UZ(27,"br"),e._uU(28,"Recieved To"),e.qZA(),e.TgZ(29,"th",15),e._uU(30,"Items "),e._UZ(31,"br"),e._uU(32,"Recieved From"),e.qZA(),e.TgZ(33,"th",16),e._uU(34,"Items "),e._UZ(35,"br"),e._uU(36,"Recieved To"),e.qZA(),e.TgZ(37,"th",17),e._uU(38,"Payment"),e.qZA()())}function uo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function mo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function go(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(null==t.supplier_category?null:t.supplier_category.name)}}function ho(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function fo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function vo(n,i){if(1&n&&(e.TgZ(0,"div",26),e._UZ(1,"pek-multi-product-categories-picker",27),e.qZA()),2&n){const t=e.oxw(2).$implicit,o=e.oxw();e.xp6(1),e.Q6J("isDisabled",!0)("currentCategoryIds",o.getCategories(t.nomenclature_categories))}}function Co(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"span")(1,"button",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,a=e.oxw();return e.KtG(a.openFilter(r))}),e.qZA(),e.YNc(2,vo,2,2,"div",25),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("icon",t.opened?"pi pi-eye-slash":"pi pi-eye"),e.xp6(1),e.Q6J("ngIf",t.opened)}}function Zo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function To(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function xo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function yo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function bo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Ao(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function Io(n,i){1&n&&e._UZ(0,"i",28)}function qo(n,i){1&n&&e._UZ(0,"i",29)}function Ro(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"\u2014"),e.qZA())}function wo(n,i){if(1&n&&(e.TgZ(0,"tr",18)(1,"td",10),e._uU(2),e.qZA(),e.TgZ(3,"td",11),e._uU(4),e.qZA(),e.TgZ(5,"td",12),e._uU(6),e.YNc(7,uo,2,0,"span",19),e.qZA(),e.TgZ(8,"td",12),e._uU(9),e.YNc(10,mo,2,0,"span",19),e.qZA(),e.TgZ(11,"td",13),e._uU(12),e.qZA(),e.TgZ(13,"td",14),e.YNc(14,go,2,1,"span",19),e.YNc(15,ho,2,0,"span",19),e.qZA(),e.TgZ(16,"td",20)(17,"div",21),e.YNc(18,fo,2,0,"span",19),e.YNc(19,Co,3,2,"span",19),e.qZA()(),e.TgZ(20,"td",14),e._uU(21),e.ALo(22,"date"),e.YNc(23,Zo,2,0,"span",19),e.qZA(),e.TgZ(24,"td",14),e._uU(25),e.ALo(26,"date"),e.YNc(27,To,2,0,"span",19),e.qZA(),e.TgZ(28,"td",15),e._uU(29),e.ALo(30,"date"),e.YNc(31,xo,2,0,"span",19),e.qZA(),e.TgZ(32,"td",14),e._uU(33),e.ALo(34,"date"),e.YNc(35,yo,2,0,"span",19),e.qZA(),e.TgZ(36,"td",15),e._uU(37),e.ALo(38,"date"),e.YNc(39,bo,2,0,"span",19),e.qZA(),e.TgZ(40,"td",16),e._uU(41),e.ALo(42,"date"),e.YNc(43,Ao,2,0,"span",19),e.qZA(),e.TgZ(44,"td",17),e.YNc(45,Io,1,0,"i",22),e.YNc(46,qo,1,0,"i",23),e.YNc(47,Ro,2,0,"span",19),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.hij(" ",t.nomenclature_name," "),e.xp6(1),e.Q6J("ngIf",!t.nomenclature_name),e.xp6(2),e.hij(" ",t.nomenclature_code," "),e.xp6(1),e.Q6J("ngIf",!t.nomenclature_code),e.xp6(2),e.Oqu(t.supplier?t.supplier.name:"All companies"),e.xp6(2),e.Q6J("ngIf",t.supplier_category),e.xp6(1),e.Q6J("ngIf",!t.supplier_category),e.xp6(3),e.Q6J("ngIf",!t.nomenclature_categories),e.xp6(1),e.Q6J("ngIf",t.nomenclature_categories),e.xp6(2),e.hij(" ",e.xi3(22,27,t.system_creation_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.system_creation_date_after),e.xp6(2),e.hij(" ",e.xi3(26,30,t.system_creation_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.system_creation_date_before),e.xp6(2),e.hij(" ",e.xi3(30,33,t.invoice_reception_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.invoice_reception_date_after),e.xp6(2),e.hij(" ",e.xi3(34,36,t.invoice_reception_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.invoice_reception_date_before),e.xp6(2),e.hij(" ",e.xi3(38,39,t.items_reception_date_after,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.items_reception_date_after),e.xp6(2),e.hij(" ",e.xi3(42,42,t.items_reception_date_before,"dd/MM/y")," "),e.xp6(2),e.Q6J("ngIf",!t.items_reception_date_before),e.xp6(2),e.Q6J("ngIf",!0===t.is_paid),e.xp6(1),e.Q6J("ngIf",!1===t.is_paid),e.xp6(1),e.Q6J("ngIf",null===t.is_paid)}}function No(n,i){1&n&&e._UZ(0,"i",32)}function Uo(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Po(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",30),e.YNc(2,No,1,0,"i",31),e.YNc(3,Uo,2,0,"span",19),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoadingReportFilters),e.xp6(1),e.Q6J("ngIf",!t.isLoadingReportFilters)}}let Fo=(()=>{class n{constructor(t,o){this.reportFilterService=t,this.dialogRef=o,this.reportFilters=[],this.isLoadingReportFilters=!0}ngOnInit(){this.reportFilterService.getFilters().subscribe(t=>{this.reportFilters=t.map(o=>({...o,opened:!1})),this.isLoadingReportFilters=!1})}onSave(){this.dialogRef.close(this.selectedReportsFilter)}openFilter(t){const o=JSON.parse(JSON.stringify(t.opened));this.reportFilters.forEach(r=>r.opened=!1),o||(t.opened=!0)}getCategories(t){return t.split(",").map(o=>+o)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ye),e.Y36(x.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-filters-modal"]],decls:12,vars:8,consts:[[1,"modal-header"],[1,"modal-header__title"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["rt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button",1,"p-button-success",3,"label","disabled","click"],[1,"text-center",2,"width","3%"],[2,"width","9%"],[2,"width","11%"],[2,"width","10%"],[1,"text-center",2,"width","6%"],[1,"text-center",2,"width","8%"],[1,"text-center",2,"width","7%"],[1,"text-center",2,"width","5%"],[3,"pSelectableRow"],[4,"ngIf"],[2,"width","8%"],[1,"d-flex","justify-content-center","filter-wh-category"],["class","pi pi-check text-success",4,"ngIf"],["class","pi pi-times text-danger",4,"ngIf"],["pButton","",1,"cat-eye",3,"icon","click"],["class","category-opened",4,"ngIf"],[1,"category-opened"],[3,"isDisabled","currentCategoryIds"],[1,"pi","pi-check","text-success"],[1,"pi","pi-times","text-danger"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2," Choice Report Filter "),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"p-table",2,3),e.NdJ("selectionChange",function(a){return o.selectedReportsFilter=a}),e.YNc(6,_o,39,0,"ng-template",4),e.YNc(7,wo,48,45,"ng-template",5),e.YNc(8,Po,4,3,"ng-template",6),e.qZA()(),e.TgZ(9,"mat-dialog-actions",7),e._UZ(10,"button",8),e.TgZ(11,"button",9),e.NdJ("click",function(){return o.onSave()}),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("scrollable",!0)("paginator",o.reportFilters.length>0)("rows",10)("selection",o.selectedReportsFilter)("value",o.reportFilters),e.xp6(6),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("label","Apply Filter")("disabled",!o.selectedReportsFilter))},dependencies:[m.O5,v.Hq,Z.jx,T.iA,T.Ei,x.ZT,x.xY,x.H8,E.Q,m.uU],styles:[".category-opened[_ngcontent-%COMP%]{z-index:10;position:fixed;width:20rem;margin-top:1rem;background:#fff;border-radius:.625rem}.cat-eye[_ngcontent-%COMP%]{width:2rem!important;height:2rem!important}"]}),n})(),ce=(()=>{class n{constructor(t,o,r){this.httpClient=t,this.adapterService=o,this.dialog=r,this.API_URL=N.N.base_url+N.N.accounting_url,this.url="accounting_products/"}get(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+this.url+"all/"+o).pipe((0,y.U)(r=>r.data))}roots(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+"accounting_products_roots/"+o).pipe((0,y.U)(r=>r.data))}balance(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+"stock_balances/"+o).pipe((0,y.U)(r=>r.data))}out(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+"out/"+o).pipe((0,y.U)(r=>r.data))}in(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+"in/"+o).pipe((0,y.U)(r=>r.data))}history(t){return this.httpClient.get(this.API_URL+"warehouse_products/"+t+"/history/").pipe((0,y.U)(o=>o.data))}getById(t){return this.httpClient.get(this.API_URL+this.url+t+"/").pipe((0,y.U)(o=>o.data))}tree(t){return this.httpClient.get(this.API_URL+"tree/"+t+"/").pipe((0,y.U)(o=>o.data))}exportToExcel(t,o){var r=this;return(0,Pe.Z)(function*(){let a="";const l=new po.Workbook;let p;switch(o){case"in":p=l.addWorksheet("Report In"),a="In";break;case"wh-balance":p=l.addWorksheet("Report Warehouse Balance"),a="Warehouse Balance";break;case"out":p=l.addWorksheet("Report Out"),a="Out"}const _=[];p.columns="out"===o?[{header:"#",key:"index",width:10},{header:"Code",key:"code",width:40},{header:"Name",key:"name",width:40},{header:"Quantity",key:"quantity",width:20},{header:"UOM",key:"uom",width:15},{header:"Order",key:"order",width:15},{header:"Invoice",key:"invoice",width:15},{header:"Technology",key:"technology",width:20},{header:"Supplier",key:"supplier",width:36},{header:"Purchase Category",key:"purchaseCategory",width:28},{header:"Written For List",key:"writtenForList",width:36},{header:"Date",key:"date",width:18},{header:"Unit Price",key:"unitPrice",width:15},{header:"Total Price",key:"totalPrice",width:15},{header:"Unit Cost",key:"unitCost",width:15},{header:"Total Cost",key:"totalCost",width:15}]:[{header:"#",key:"index",width:10},{header:"Code",key:"code",width:40},{header:"Name",key:"name",width:40},{header:"Total Quantity",key:"quantity",width:20},{header:"UOM",key:"uom",width:15},{header:"Order",key:"order",width:15},{header:"Invoice",key:"invoice",width:15},{header:"Technology",key:"technology",width:20},{header:"Supplier",key:"supplier",width:36},{header:"Purchase Category",key:"purchaseCategory",width:28},{header:"Date",key:"date",width:18},{header:"Quantity",key:"acceptedQuantity",width:15},{header:"Unit Price",key:"unitPrice",width:15},{header:"Total Price",key:"totalPrice",width:15},{header:"Unit Cost",key:"unitCost",width:15},{header:"Total Cost",key:"totalCost",width:15}],"wh-balance"===o?t.forEach(c=>{const f={code:c.code,name:c.name,quantity:c.total_quantity,category:c.category,order:"physical-inventory"===c.type?c.order.id:c.order,invoice:c.invoice?c.invoice.self_serial_number:"None",technology:c.current_technology,supplier:c.supplier,purchaseCategory:c.purchase_category,date:new Date(c.document_creation_date),acceptedQuantity:c.quantity,supplierTotalCost:c.supplier_total_cost,supplierTotalPrice:c.supplier_total_price,supplierUnitCost:c.supplier_unit_cost,supplierUnitPrice:c.supplier_unit_price};_.push(f)}):"in"===o?t.forEach(c=>{const f={code:c.code,name:c.name,quantity:c.totalQuantity,category:c.category,order:c.order,invoice:c?.invoice?c.invoice:"None",technology:c.current_technology,supplier:c.supplier,purchaseCategory:c.purchase_category,date:new Date(c.document_creation_date),acceptedQuantity:c.quantity,supplierTotalCost:c.supplier_total_cost,supplierTotalPrice:c.supplier_total_price,supplierUnitCost:c.supplier_unit_cost,supplierUnitPrice:c.supplier_unit_price};_.push(f)}):"out"===o&&t.forEach(c=>{const f={code:c.nomenclature.code,name:c.nomenclature.name,quantity:c.quantity,category:c.nomenclature.category,order:c.order,invoice:c.invoice,technology:c.current_technology,supplier:c.supplier,purchaseCategory:c.purchase_category,writtenForList:c.written_off_for_list,date:new Date(c.document_creation_date),supplierTotalCost:c.supplier_total_cost,supplierTotalPrice:c.supplier_total_price,supplierUnitCost:c.supplier_unit_cost,supplierUnitPrice:c.supplier_unit_price};_.push(f)});let h=16;"out"===o&&(h=16);let u=1;for(;u<=h;)p.getColumn(u).alignment={vertical:"middle",horizontal:"center"},p.getColumn(u).font={name:"Calibri",size:12},u++;p.getRow(1).font={name:"Calibri",size:13,bold:!0},"out"===o?(_.forEach((c,f)=>{p.addRow({index:f+1,name:c.name,code:c.code,quantity:c.quantity,uom:c.category?c.category.unit_of_measure?.symbol:"Pcs",order:c.order,invoice:c.invoice?c.invoice.self_serial_number:"None",technology:c.technology?c.technology:"None",supplier:c.supplier,purchaseCategory:c.purchaseCategory&&c.purchaseCategory?.name?c.purchaseCategory.name:"None",writtenForList:c.writtenForList,date:r.adapterService.dateToExcelStringDate(c.date),unitPrice:c.supplierUnitPrice,totalPrice:c.supplierTotalPrice,unitCost:c.supplierUnitCost,totalCost:c.supplierTotalCost})}),p.getColumn(2).alignment={vertical:"middle",horizontal:"left"},p.getColumn(3).alignment={vertical:"middle",horizontal:"left"},p.getColumn(9).alignment={vertical:"middle",horizontal:"left"},p.getColumn(11).alignment={vertical:"middle",horizontal:"left"},p.getColumn(13).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"',p.getColumn(14).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"',p.getColumn(15).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"',p.getColumn(16).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"'):(_.forEach("in"===o?(c,f)=>{p.addRow({index:f+1,name:c.name,code:c.code,quantity:c.quantity,uom:c.category,order:c.order,invoice:c?.invoice,technology:c.technology?c.technology:"None",supplier:c.supplier,purchaseCategory:c.purchaseCategory,date:r.adapterService.dateToExcelStringDate(c.date),acceptedQuantity:c.acceptedQuantity,unitPrice:c.supplierUnitPrice,totalPrice:c.supplierTotalPrice,unitCost:c.supplierUnitCost,totalCost:c.supplierTotalCost})}:(c,f)=>{p.addRow({index:f+1,name:c.name,code:c.code,quantity:c.quantity,uom:c.category,order:c.order,invoice:c.invoice,technology:c.technology?c.technology:"None",supplier:c.supplier,purchaseCategory:c.purchaseCategory&&c.purchaseCategory?.name?c.purchaseCategory.name:"None",date:r.adapterService.dateToExcelStringDate(c.date),acceptedQuantity:c.acceptedQuantity,unitPrice:c.supplierUnitPrice,totalPrice:c.supplierTotalPrice,unitCost:c.supplierUnitCost,totalCost:c.supplierTotalCost})}),p.getColumn(2).alignment={vertical:"middle",horizontal:"left"},p.getColumn(3).alignment={vertical:"middle",horizontal:"left"},p.getColumn(9).alignment={vertical:"middle",horizontal:"left"},p.getColumn(13).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"',p.getColumn(14).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"',p.getColumn(15).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"',p.getColumn(16).numFmt='#,##0.00" \u20ac";[Red]-#,##0.00" \u20ac"'),l.xlsx.writeBuffer().then(c=>{const f=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),oe=window.URL.createObjectURL(f),q=document.createElement("a");document.body.appendChild(q),q.setAttribute("style","display: none"),q.href=oe,q.download=`Report ${a}.xlsx`,q.click(),window.URL.revokeObjectURL(oe),q.remove()})})()}openFilterModal(){return this.dialog.open(Fo,{width:"95vw",height:"auto",data:{},autoFocus:!1,enterAnimationDuration:"250ms"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG($.eN),e.LFG(J.v),e.LFG(x.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var de=d(666);function Jo(n,i){1&n&&e._UZ(0,"div",21)}function ko(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",22),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",23),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",24),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",25),e._uU(8,"UOM"),e.qZA(),e.TgZ(9,"th",25),e._uU(10,"Order"),e.qZA(),e.TgZ(11,"th",26),e._uU(12,"Invoice"),e.qZA(),e.TgZ(13,"th",27),e._uU(14,"Technology"),e.qZA(),e.TgZ(15,"th",28),e._uU(16,"Supplier"),e.qZA(),e.TgZ(17,"th",26),e._uU(18,"Date"),e.qZA(),e.TgZ(19,"th",26),e._uU(20,"Type"),e.qZA(),e.TgZ(21,"th",29),e._uU(22,"Quantity"),e.qZA(),e.TgZ(23,"th",26),e._uU(24,"Unit Price"),e.qZA(),e.TgZ(25,"th",26),e._uU(26,"Total Price"),e.qZA(),e.TgZ(27,"th",26),e._uU(28,"Unit Cost"),e.qZA(),e.TgZ(29,"th",26),e._uU(30,"Total Cost"),e.qZA()())}const So=function(n){return["/dash/procurement/orders/products/",n]};function Qo(n,i){if(1&n&&(e.TgZ(0,"a",33),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,So,t.order)),e.xp6(1),e.Oqu(t.order)}}const Mo=function(n){return["/dash/outsource/outsource-chain/products/",n]};function Yo(n,i){if(1&n&&(e.TgZ(0,"a",33),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Mo,t.order)),e.xp6(1),e.Oqu(t.order)}}const Oo=function(n){return["/dash/accounting/invoices/products/",n]};function Eo(n,i){if(1&n&&(e.TgZ(0,"a",34),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Oo,t.invoice.id)),e.xp6(1),e.Oqu(t.invoice.self_serial_number)}}function Lo(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.document_creation_date,"dd/MM/yyyy")," ")}}function Bo(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"date"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,t.created,"dd/MM/yyyy")," ")}}function Do(n,i){1&n&&(e.ynx(0),e.TgZ(1,"div"),e._uU(2,"out"),e.qZA(),e.TgZ(3,"div"),e._uU(4,"wh balance"),e.qZA(),e.BQk())}function $o(n,i){1&n&&(e.ynx(0),e._uU(1,"in"),e.BQk())}function Go(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"div"),e._uU(2),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.Oqu(t.remains)}}function jo(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.accepted_quantity)}}function Vo(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",22),e._uU(2),e.qZA(),e.TgZ(3,"td",23),e._uU(4),e.qZA(),e.TgZ(5,"td",24),e._uU(6),e.qZA(),e.TgZ(7,"td",25),e._uU(8),e.qZA(),e.TgZ(9,"td",25),e.YNc(10,Qo,2,4,"a",30),e.YNc(11,Yo,2,4,"a",30),e.qZA(),e.TgZ(12,"td",26),e.YNc(13,Eo,2,4,"a",31),e.qZA(),e.TgZ(14,"td",27),e._uU(15),e.qZA(),e.TgZ(16,"td",28),e._uU(17),e.qZA(),e.TgZ(18,"td",26),e.YNc(19,Lo,3,4,"ng-container",32),e.YNc(20,Bo,3,4,"ng-container",32),e.qZA(),e.TgZ(21,"td",26),e.YNc(22,Do,5,0,"ng-container",32),e.YNc(23,$o,2,0,"ng-container",32),e.qZA(),e.TgZ(24,"td",29),e.YNc(25,Go,5,2,"ng-container",32),e.YNc(26,jo,2,1,"ng-container",32),e.qZA(),e.TgZ(27,"td",26),e._uU(28),e.ALo(29,"moneyFormat"),e.qZA(),e.TgZ(30,"td",26),e._uU(31),e.ALo(32,"moneyFormat"),e.qZA(),e.TgZ(33,"td",26),e._uU(34),e.ALo(35,"moneyFormat"),e.qZA(),e.TgZ(36,"td",26),e._uU(37),e.ALo(38,"moneyFormat"),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(null==t.nomenclature?null:t.nomenclature.code),e.xp6(2),e.Oqu(null==t.nomenclature?null:t.nomenclature.name),e.xp6(2),e.AsE(" ",null!=t.nomenclature&&t.nomenclature.category?t.nomenclature.category.unit_of_measure.symbol:"Pcs"," ",null!=t.nomenclature&&t.nomenclature.root_category?t.nomenclature.root_category.unit_of_measure.symbol:"Pcs"," "),e.xp6(2),e.Q6J("ngIf","0"==(null==t.nomenclature?null:t.nomenclature.type)),e.xp6(1),e.Q6J("ngIf","0"!=(null==t.nomenclature?null:t.nomenclature.type)),e.xp6(2),e.Q6J("ngIf",t.invoice),e.xp6(2),e.Oqu(t.current_technology),e.xp6(2),e.Oqu(t.supplier),e.xp6(2),e.Q6J("ngIf",t.document_creation_date),e.xp6(1),e.Q6J("ngIf",t.created),e.xp6(2),e.Q6J("ngIf","in"!==t.type),e.xp6(1),e.Q6J("ngIf","in"===t.type),e.xp6(2),e.Q6J("ngIf",t.quantity),e.xp6(1),e.Q6J("ngIf",t.accepted_quantity),e.xp6(2),e.hij("",e.lcZ(29,20,t.supplier_unit_price)," \u20ac"),e.xp6(3),e.hij("",e.lcZ(32,22,t.supplier_total_price)," \u20ac"),e.xp6(3),e.hij("",e.lcZ(35,24,t.supplier_unit_cost)," \u20ac"),e.xp6(3),e.hij("",e.lcZ(38,26,t.supplier_total_cost)," \u20ac")}}function Ho(n,i){1&n&&e._UZ(0,"i",37)}function Ko(n,i){1&n&&(e.ynx(0),e._uU(1,"No Records Found"),e.BQk())}function zo(n,i){1&n&&(e.ynx(0),e._uU(1,"Select an Nomenclature"),e.BQk())}function Wo(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Ko,2,0,"ng-container",32),e.YNc(2,zo,2,0,"ng-container",32),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.isStarted),e.xp6(1),e.Q6J("ngIf",!t.isStarted)}}function Xo(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",35),e.YNc(2,Ho,1,0,"i",36),e.YNc(3,Wo,3,2,"ng-container",32),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function ei(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",38),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(22);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ti(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",39)(1,"p-button",38),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(22);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let j=class{constructor(i,t,o,r){this.fb=i,this.warehouseProductService=t,this.accountingProductService=o,this.filterService=r,this.isLoading=!1,this.isStarted=!1,this.search$=new he.X(""),this.isLoadingNomenclatures=!1,this.products$=this.search$.pipe((0,Q.x)(),(0,I.b)(150),(0,g.b)(()=>this.isLoadingNomenclatures=!0),(0,O.w)(a=>this.warehouseProductService.getPagination([{name:"type",value:"0"},{name:"paginated",value:!0},{name:"page",value:1},{name:"name",value:a}]).pipe((0,y.U)(l=>l.results.map(p=>({...p,fullName:`(${p.nomenclature.code}) ${p.nomenclature.name}`}))),(0,g.b)(()=>this.isLoadingNomenclatures=!1),(0,ue.O)([]),(0,C.t)(this))),(0,C.t)(this)),this.itemsCount=0,this.loadHistory$=new P.x,this.items$=this.loadHistory$.pipe((0,R.h)(()=>!!this.selectedProduct),(0,g.b)(()=>this.isLoading=!0),(0,g.b)(()=>this.isStarted=!0),(0,g.b)(()=>this.itemsCount=0),(0,O.w)(()=>this.accountingProductService.history(this.selectedProduct.nomenclature.id).pipe((0,y.U)(a=>{let l=[];if(null!==a.accepted.accepted_quantity){let p=a.accepted.accepted_quantity;a.out.forEach(_=>{p-=_.quantity,_.remains=p,_.invoice=a.accepted.invoice,_.nomenclature=a.accepted.nomenclature,_.order=a.accepted.order,_.current_technology=a.accepted.current_technology,_.supplier=a.accepted.supplier,_.supplier_unit_price=a.accepted.supplier_unit_price,_.supplier_total_price=a.accepted.supplier_total_price,_.supplier_unit_cost=a.accepted.supplier_unit_cost,_.supplier_total_cost=a.accepted.supplier_total_cost,l.push(_)}),a.accepted.type="in",l.unshift(a.accepted)}else l=[];return this.itemsCount=l.length,console.log(l),l}),(0,g.b)(()=>this.isLoading=!1),(0,ue.O)([]))),(0,C.t)(this))}ngOnInit(){this.filterService.register("empty",(i,t)=>i)}};j.\u0275fac=function(i){return new(i||j)(e.Y36(s.qu),e.Y36(lo.t),e.Y36(ce),e.Y36(Z.iZ))},j.\u0275cmp=e.Xpm({type:j,selectors:[["pek-reports-item-card"]],decls:30,vars:18,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],[1,"page__content"],[1,"page__card"],[1,"form","mb-2"],[1,"row"],[1,"col-3"],[1,"form-group"],["optionLabel","fullName","filterMatchMode","empty","placeholder","Enter a Nomenclature Name",3,"options","showClear","emptyMessage","emptyFilterMessage","resetFilterOnHide","filter","ngModel","onFilter","onChange","ngModelChange"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","value","paginator","rows"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"d-flex"],[1,"text-center",2,"width","3%"],[2,"width","10%"],[2,"width","11%"],[1,"text-center",2,"width","4%"],[1,"text-center",2,"width","6%"],[1,"text-center",2,"width","7%"],[2,"width","14%"],[1,"text-center",2,"width","5%"],["target","_blank",3,"routerLink",4,"ngIf"],["rel","noopener noreferrer","target","_blank",3,"routerLink",4,"ngIf"],[4,"ngIf"],["target","_blank",3,"routerLink"],["rel","noopener noreferrer","target","_blank",3,"routerLink"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Item Card"),e.qZA()(),e._UZ(6,"div",4),e.qZA()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label"),e._uU(14,"Nomenclature"),e.qZA(),e.TgZ(15,"p-dropdown",11),e.NdJ("onFilter",function(r){let a;return t.search$.next(null!==(a=r.filter)&&void 0!==a?a:"")})("onChange",function(){return t.loadHistory$.next()})("ngModelChange",function(r){return t.selectedProduct=r}),e.ALo(16,"async"),e.qZA()()(),e._UZ(17,"div",9)(18,"div",9)(19,"div",9),e.qZA()(),e.TgZ(20,"div",12)(21,"p-table",13,14),e.ALo(23,"async"),e.YNc(24,Jo,1,0,"ng-template",15),e.YNc(25,ko,31,0,"ng-template",16),e.YNc(26,Vo,39,28,"ng-template",17),e.YNc(27,Xo,4,3,"ng-template",18),e.YNc(28,ei,2,0,"ng-template",19),e.qZA()(),e.YNc(29,ti,3,0,"div",20),e.qZA()()),2&i){const o=e.MAs(22);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(12),e.Q6J("options",e.lcZ(16,14,t.products$))("showClear",!0)("emptyMessage",t.isLoadingNomenclatures?"Loading...":"No Records Found")("emptyFilterMessage",t.isLoadingNomenclatures?"Loading...":"No Records Found")("resetFilterOnHide",!1)("filter",!0)("ngModel",t.selectedProduct),e.xp6(6),e.Q6J("scrollable",!0)("value",e.lcZ(23,16,t.items$))("paginator",t.itemsCount>0)("rows",10),e.xp6(8),e.Q6J("ngIf",!o.paginator&&!t.isLoading&&t.itemsCount>0)}},dependencies:[m.O5,b.yS,v.zx,Z.jx,T.iA,s.JJ,de.Lt,s.On,A.D,m.Ov,m.uU,M.U],styles:[".form[_ngcontent-%COMP%]{margin-top:-.25rem}"]}),j=(0,F.gn)([(0,C.c)()],j);var me=d(9646),fe=d(3310);const ni=["dt"];function oi(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.supplierTotalCost))}}function ii(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.supplierTotalPrice))}}function ri(n,i){1&n&&e._uU(0,"...")}function ai(n,i){}function ci(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",42),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",43),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",43),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",44),e._uU(8,"Total Quantity"),e.qZA(),e.TgZ(9,"th",45),e._uU(10,"UOM"),e.qZA(),e.TgZ(11,"th",45),e._uU(12,"Order"),e.qZA(),e.TgZ(13,"th",46),e._uU(14,"Invoice"),e.qZA(),e.TgZ(15,"th",47),e._uU(16,"Technology"),e.qZA(),e.TgZ(17,"th",48),e._uU(18,"Supplier"),e.qZA(),e.TgZ(19,"th",49),e._uU(20,"Purchase Category"),e.qZA(),e.TgZ(21,"th",46),e._uU(22,"Date"),e.qZA(),e.TgZ(23,"th",46),e._uU(24,"Quantity"),e.qZA(),e.TgZ(25,"th",44),e._uU(26,"Unit Price"),e.qZA(),e.TgZ(27,"th",44),e._uU(28,"Total Price"),e.qZA(),e.TgZ(29,"th",44),e._uU(30,"Unit Cost"),e.qZA(),e.TgZ(31,"th",44),e._uU(32,"Total Cost"),e.qZA()())}const si=function(n){return["/procurement/chains/order/",n]};function li(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,si,t.order)),e.xp6(1),e.Oqu(t.order)}}const pi=function(n){return["/outsourcing/chains/order/",n]};function _i(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,pi,t.order)),e.xp6(1),e.Oqu(t.order)}}const ui=function(n){return["/warehouse/physical-inventory/",n]};function di(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,ui,t.order)),e.xp6(1),e.Oqu(t.order)}}const mi=function(n){return["/reports/invoices/invoice/",n]};function gi(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,mi,t.invoice)),e.xp6(1),e.hij(" ",t.invoice," ")}}function hi(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"None"),e.qZA())}function fi(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",42),e._uU(2),e.qZA(),e.TgZ(3,"td",43),e._uU(4),e.qZA(),e.TgZ(5,"td",43),e._uU(6),e.qZA(),e.TgZ(7,"td",44),e._uU(8),e.qZA(),e.TgZ(9,"td",45),e._uU(10),e.qZA(),e.TgZ(11,"td",45),e.YNc(12,li,2,4,"a",50),e.YNc(13,_i,2,4,"a",50),e.YNc(14,di,2,4,"a",50),e.qZA(),e.TgZ(15,"td",46),e.YNc(16,gi,2,4,"a",50),e.YNc(17,hi,2,0,"span",51),e.qZA(),e.TgZ(18,"td",47),e._uU(19),e.qZA(),e.TgZ(20,"td",48),e._uU(21),e.qZA(),e.TgZ(22,"td",49),e._uU(23),e.qZA(),e.TgZ(24,"td",46),e._uU(25),e.ALo(26,"date"),e.qZA(),e.TgZ(27,"td",46),e._uU(28),e.qZA(),e.TgZ(29,"td",44),e._uU(30),e.ALo(31,"moneyFormat"),e.qZA(),e.TgZ(32,"td",44),e._uU(33),e.ALo(34,"moneyFormat"),e.qZA(),e.TgZ(35,"td",44),e._uU(36),e.ALo(37,"moneyFormat"),e.qZA(),e.TgZ(38,"td",44),e._uU(39),e.ALo(40,"moneyFormat"),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.Oqu(t.category),e.xp6(2),e.Q6J("ngIf","0"===t.type),e.xp6(1),e.Q6J("ngIf","2"===t.type),e.xp6(1),e.Q6J("ngIf","physical-inventory"===t.type),e.xp6(2),e.Q6J("ngIf",t.invoice),e.xp6(1),e.Q6J("ngIf",!t.invoice),e.xp6(2),e.hij(" ",null==t?null:t.current_technology," "),e.xp6(2),e.hij(" ",t.supplier," "),e.xp6(2),e.hij(" ",t.purchase_category," "),e.xp6(2),e.hij(" ",e.xi3(26,19,t.document_creation_date,"dd/MM/yyyy")," "),e.xp6(3),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.lcZ(31,22,t.supplier_unit_price)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(34,24,t.supplier_total_price)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(37,26,t.supplier_unit_cost)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(40,28,t.supplier_total_cost)," \u20ac ")}}function vi(n,i){1&n&&e._UZ(0,"i",55)}function Ci(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Zi(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",53),e.YNc(2,vi,1,0,"i",54),e.YNc(3,Ci,2,0,"span",51),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function Ti(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",56),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(102);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function xi(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",57)(1,"p-button",56),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(102);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let V=class{constructor(i,t,o,r){this.fb=i,this.columnFilterService=t,this.accountingProductService=o,this.adapterService=r,this.isLoading=!1,this.balanceProducts=[],this.query=[],this.count=0,this.supplierTotalCost=0,this.supplierTotalPrice=0,this.isGenerate=!1,this.searchForm=this.fb.group({name:[null],code:[null],supplier:[null],supplier_category:[null],categories:[null],system_creation_date_after:[null],system_creation_date_before:[null],invoice_reception_date_after:[null],invoice_reception_date_before:[null],items_reception_date_after:[null],items_reception_date_before:[null],is_paid:[null],purchase_categories:[null],invoice_date_after:[null],invoice_date_before:[null],nomenclature_accounting_numbers:[null],accounting_type:[null],material_or_service:[null]}),this.search$=new P.x,this.name$=new P.x,this.code$=new P.x,this.balanceProducts$=this.search$.pipe((0,I.b)(150),(0,g.b)(()=>this.prepareForSearch()),(0,O.w)(()=>this.query.length?this.accountingProductService.in(this.query).pipe((0,g.b)(a=>this.countTotals(a)),(0,ue.O)([]),(0,C.t)(this)):(0,me.of)([]).pipe((0,g.b)(()=>this.countTotals([])))),(0,C.t)(this))}ngOnInit(){this.name$.pipe((0,I.b)(250),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.code$.pipe((0,I.b)(250),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.balanceProducts$.pipe((0,C.t)(this)).subscribe()}clearFilters(){this.searchForm.reset(),this.picker.fillSelected([])}countTotals(i){this.supplierTotalCost=0,this.supplierTotalPrice=0,i.forEach(r=>{r.accepted_by_invoices&&(r.date=new Date(r?.accepted_by_invoices[0]?.document_creation_date),r?.accepted_by_invoices.sort((a,l)=>new Date(a.document_creation_date).getTime()-new Date(l.document_creation_date).getTime()),r?.accepted_by_invoices.forEach(a=>{this.supplierTotalCost+=a.supplier_total_cost,this.supplierTotalPrice+=parseFloat(a.supplier_total_price)}))});const t=[];let o=0;i.forEach(r=>{r.accepted_by_orders?.forEach(a=>{o++,t.push({id:o,name:r.name,code:r.code,totalQuantity:r.quantity,category:r.category?r.category.unit_of_measure?.symbol:"Pcs",order:a.order,invoice:a.invoice,current_technology:a.current_technology?a.current_technology:"None",purchase_category:r.purchase_category?r.purchase_category?.name:"None",supplier:a.supplier,document_creation_date:a.document_creation_date,quantity:a.quantity,supplier_unit_price:parseFloat(a.supplier_unit_price),supplier_total_price:a.supplier_total_price,supplier_unit_cost:parseFloat(a.supplier_unit_cost),supplier_total_cost:a.supplier_total_cost,type:r.type})}),r.accepted_by_invoices?.forEach(a=>{o++,t.push({id:o,name:r.name,code:r.code,totalQuantity:r.quantity,category:r.category?r.category.unit_of_measure?.symbol:"Pcs",order:a.order,invoice:a.invoice,current_technology:a.current_technology?a.current_technology:"None",purchase_category:r.purchase_category?r.purchase_category?.name:"None",supplier:a.supplier,document_creation_date:a.document_creation_date,quantity:a.quantity,supplier_unit_price:parseFloat(a.supplier_unit_price),supplier_total_price:a.supplier_total_price,supplier_unit_cost:parseFloat(a.supplier_unit_cost),supplier_total_cost:a.supplier_total_cost,type:r.type})}),r.accepted_by_physical_inventories?.forEach(a=>{o++,console.log(a),t.push({id:o,name:r.name,code:r.code,totalQuantity:r.quantity,category:r.category?r.category.unit_of_measure?.symbol:"Pcs",order:a?.physical_inventory?.id,invoice:"",current_technology:a.current_technology?a.current_technology:"None",purchase_category:r.purchase_category?r.purchase_category?.name:"None",supplier:"Physical Inventory",document_creation_date:a?.physical_inventory?.system_creation_date,quantity:a?.difference_quantity,supplier_unit_price:parseFloat(a.unit_price),supplier_total_price:parseFloat(a.total_price),supplier_unit_cost:parseFloat(a.unit_cost),supplier_total_cost:parseFloat(a.total_cost),type:"physical-inventory"})})}),this.count=t.length,t.sort(function(r,a){return new Date(a.document_creation_date).getTime()-new Date(r.document_creation_date).getTime()||r.code.localeCompare(a.code)}),this.balanceProducts=t.map(r=>r),this.isLoading=!1}prepareForSearch(){this.dt._first=0,this.balanceProducts=[],this.isLoading=!0,this.count=0,this.query=[];for(const i in this.searchForm.controls)null!==this.searchForm.controls[i].value&&""!==this.searchForm.controls[i].value&&(this.searchForm.controls[i].value instanceof Date?this.query.push({name:i,value:this.adapterService.dateAdapter(this.searchForm.controls[i].value)}):this.query.push({name:i,value:this.searchForm.controls[i].value}))}changeAccountingNumber(i){const t=i.target.value.replace(/\s/g,"");t?this.searchForm.get("nomenclature_accounting_numbers").patchValue(t):this.searchForm.get("nomenclature_accounting_numbers").patchValue(null),this.search$.next()}getPaidStatus(i){this.searchForm.get("is_paid").patchValue(i),this.search$.next()}onSelectCompany(i){this.searchForm.get("supplier").patchValue(i),this.search$.next()}onSelectCategory(i){this.searchForm.get("supplier_category").patchValue(i),this.search$.next()}onSelectCategories(i){this.searchForm.get("categories").patchValue(i?.join(",")??null),this.search$.next()}onSelectPurchasedCategories(i){this.searchForm.get("accounting_type").patchValue(null),this.searchForm.get("material_or_service").patchValue(null),i.forEach(t=>{"mp"===t?this.searchForm.get("accounting_type").patchValue(1):"ou"===t?this.searchForm.get("material_or_service").patchValue("material"):"os"===t&&this.searchForm.get("material_or_service").patchValue("service")}),i.find(t=>"ou"===t)&&i.find(t=>"os"===t)&&this.searchForm.get("material_or_service").patchValue("both"),i=i.filter(t=>"number"==typeof t),this.searchForm.get("purchase_categories").patchValue(i.join(",")),this.search$.next()}exportToExcel(){this.isGenerate=!0,this.accountingProductService.exportToExcel(this.balanceProducts,"in").then(()=>{this.isGenerate=!1})}onApplyFilter(){this.accountingProductService.openFilterModal().pipe((0,R.h)(i=>!!i)).subscribe(i=>{const t={...i};t.invoice_reception_date_after&&(t.invoice_reception_date_after=new Date(t.invoice_reception_date_after)),t.invoice_reception_date_before&&(t.invoice_reception_date_before=new Date(t.invoice_reception_date_before)),t.items_reception_date_after&&(t.items_reception_date_after=new Date(t.items_reception_date_after)),t.items_reception_date_before&&(t.items_reception_date_before=new Date(t.items_reception_date_before)),t.system_creation_date_after&&(t.system_creation_date_after=new Date(t.system_creation_date_after)),t.system_creation_date_before&&(t.system_creation_date_before=new Date(t.system_creation_date_before)),t.supplier=t.supplier?t.supplier.id:null,t.supplier_category=t.supplier_category?+t.supplier_category.id:null,t.categories=t.nomenclature_categories.split(",").map(o=>+o),t.code=t.nomenclature_code,t.name=t.nomenclature_name,this.searchForm.patchValue(t),this.picker.fillSelected(t.categories)})}};V.\u0275fac=function(i){return new(i||V)(e.Y36(s.qu),e.Y36(pe.W),e.Y36(ce),e.Y36(J.v))},V.\u0275cmp=e.Xpm({type:V,selectors:[["pek-reports-in"]],viewQuery:function(i,t){if(1&i&&(e.Gf(E.Q,5),e.Gf(ni,5)),2&i){let o;e.iGM(o=e.CRH())&&(t.picker=o.first),e.iGM(o=e.CRH())&&(t.dt=o.first)}},decls:109,vars:41,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf","ngIfElse"],["totalsLoading",""],[1,"page__tools"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Apply Filter",3,"click"],["pButton","","type","button","icon","pi pi-times","label","Clear Filter",1,"p-button-danger","ml-2",3,"click"],["pButton","","type","button","icon","pi pi-file-excel","label","Generate Report",1,"p-button-icon","ml-2",3,"loading","disabled","click"],[1,"page__content"],[1,"page__card"],[1,"form","mb-3",3,"formGroup"],[1,"row"],[1,"col-2"],[1,"form-group"],["type","text","pInputText","","formControlName","name",3,"ngModelChange"],["type","text","pInputText","","formControlName","code",3,"ngModelChange"],[3,"currentCompanyId","selectCompany"],[3,"selectedCategoryId","selectCompanyCategory"],[3,"currentCategoryIds","choiceCategoryFolAllIds"],[3,"filterValue","changeValue"],["formControlName","system_creation_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","system_creation_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],[1,"col-3"],[3,"withReportFilters","choiceCategories"],["pInputText","",3,"input"],["formControlName","invoice_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","ngModelChange"],["formControlName","invoice_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","ngModelChange"],[1,"page__table","report-table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","value"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"text-center",2,"width","3%"],[2,"width","10%"],[1,"text-center",2,"width","6%"],[1,"text-center",2,"width","4%"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","7%"],[2,"width","9%"],[1,"text-center",2,"width","8%"],["target","_blank","rel","noopener noreferrer",3,"routerLink",4,"ngIf"],[4,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"routerLink"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5," In (Total Cost: "),e.YNc(6,oi,3,3,"span",4),e._uU(7," \u20ac, Total Price: "),e.YNc(8,ii,3,3,"span",4),e._uU(9," \u20ac) "),e.qZA(),e.YNc(10,ri,1,0,"ng-template",null,5,e.W1O),e.qZA(),e.TgZ(12,"div",6)(13,"button",7),e.NdJ("click",function(){return t.onApplyFilter()}),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return t.clearFilters()}),e.qZA(),e.TgZ(15,"button",9),e.NdJ("click",function(){return t.exportToExcel()}),e.qZA()()()(),e.TgZ(16,"div",10)(17,"div",11)(18,"form",12)(19,"div",13)(20,"div",14)(21,"div",15)(22,"label"),e._uU(23,"Name"),e.qZA(),e.TgZ(24,"input",16),e.NdJ("ngModelChange",function(r){return t.name$.next(r)}),e.qZA()()(),e.TgZ(25,"div",14)(26,"div",15)(27,"label"),e._uU(28,"Code"),e.qZA(),e.TgZ(29,"input",17),e.NdJ("ngModelChange",function(r){return t.code$.next(r)}),e.qZA()()(),e.TgZ(30,"div",14)(31,"div",15)(32,"label"),e._uU(33,"Company"),e.qZA(),e.TgZ(34,"pek-company-picker",18),e.NdJ("selectCompany",function(r){return t.onSelectCompany(r)}),e.qZA()()(),e.TgZ(35,"div",14)(36,"div",15)(37,"label"),e._uU(38,"Company Category"),e.qZA(),e.TgZ(39,"pek-company-category-picker",19),e.NdJ("selectCompanyCategory",function(r){return t.onSelectCategory(r)}),e.qZA()()(),e.TgZ(40,"div",14)(41,"div",15)(42,"label"),e._uU(43,"Warehouse Category"),e.qZA(),e.TgZ(44,"pek-multi-product-categories-picker",20),e.NdJ("choiceCategoryFolAllIds",function(r){return t.onSelectCategories(r)}),e.qZA()()(),e.TgZ(45,"div",14)(46,"div",15)(47,"label"),e._uU(48,"Paid"),e.qZA(),e.TgZ(49,"pek-input-three-values",21),e.NdJ("changeValue",function(r){return t.getPaidStatus(r)}),e.qZA()()(),e.TgZ(50,"div",14)(51,"div",15)(52,"label"),e._uU(53,"Creation From"),e.qZA(),e.TgZ(54,"p-calendar",22),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(55,"div",14)(56,"div",15)(57,"label"),e._uU(58,"Creation To"),e.qZA(),e.TgZ(59,"p-calendar",23),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(60,"div",14)(61,"div",15)(62,"label"),e._uU(63,"Invoice Recieved From"),e.qZA(),e.TgZ(64,"p-calendar",24),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(65,"div",14)(66,"div",15)(67,"label"),e._uU(68,"Invoice Recieved To"),e.qZA(),e.TgZ(69,"p-calendar",25),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(70,"div",14)(71,"div",15)(72,"label"),e._uU(73,"Items Recieved From"),e.qZA(),e.TgZ(74,"p-calendar",26),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(75,"div",14)(76,"div",15)(77,"label"),e._uU(78,"Items Recieved To"),e.qZA(),e.TgZ(79,"p-calendar",27),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(80,"div",28)(81,"div",15)(82,"label"),e._uU(83,"Purchase Category"),e.qZA(),e.TgZ(84,"pek-multi-purchase-category-picker",29),e.NdJ("choiceCategories",function(r){return t.onSelectPurchasedCategories(r)}),e.qZA()()(),e.TgZ(85,"div",28)(86,"div",15)(87,"label"),e._uU(88,"Nomenclature Accounting Number"),e.qZA(),e.TgZ(89,"input",30),e.NdJ("input",function(r){return t.changeAccountingNumber(r)}),e.qZA()()(),e.TgZ(90,"div",28)(91,"div",15)(92,"label"),e._uU(93,"Invoice Date From"),e.qZA(),e.TgZ(94,"p-calendar",31),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(95,"div",28)(96,"div",15)(97,"label"),e._uU(98,"Invoice Date To"),e.qZA(),e.TgZ(99,"p-calendar",32),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()()()(),e.TgZ(100,"div",33)(101,"p-table",34,35),e.YNc(103,ai,0,0,"ng-template",36),e.YNc(104,ci,33,0,"ng-template",37),e.YNc(105,fi,41,30,"ng-template",38),e.YNc(106,Zi,4,3,"ng-template",39),e.YNc(107,Ti,2,0,"ng-template",40),e.qZA()(),e.YNc(108,xi,3,0,"div",41),e.qZA()()),2&i){const o=e.MAs(11),r=e.MAs(102);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(3),e.Q6J("ngIf",!t.isLoading)("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",!t.isLoading)("ngIfElse",o),e.xp6(7),e.Q6J("loading",t.isGenerate)("disabled",!t.count),e.xp6(3),e.Q6J("formGroup",t.searchForm),e.xp6(16),e.Q6J("currentCompanyId",t.searchForm.get("supplier").value),e.xp6(5),e.Q6J("selectedCategoryId",t.searchForm.get("supplier_category").value),e.xp6(5),e.Q6J("currentCategoryIds",t.searchForm.get("categories").value),e.xp6(5),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchForm.get("is_paid").value)),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("withReportFilters",!0),e.xp6(10),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(2),e.Q6J("scrollable",!0)("paginator",t.count>0)("rows",10)("value",t.balanceProducts),e.xp6(7),e.Q6J("ngIf",!r.paginator&&!t.isLoading&&t.count>0)}},dependencies:[m.O5,b.yS,v.Hq,v.zx,Z.jx,T.iA,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,A.D,L.f,B.i,re.E,E.Q,fe.r,_e.x,m.uU,M.U],styles:[".form[_ngcontent-%COMP%]{margin-top:-.25rem}.report-table[_ngcontent-%COMP%]  p-table tr td, .report-table[_ngcontent-%COMP%]  p-table tr th{font-size:14px!important}"]}),V=(0,F.gn)([(0,C.c)()],V);const yi=["dt"];function bi(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.supplierTotalCost))}}function Ai(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.supplierTotalPrice))}}function Ii(n,i){1&n&&e._uU(0,"...")}function qi(n,i){}function Ri(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",42),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",43),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",43),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",44),e._uU(8,"Total Quantity"),e.qZA(),e.TgZ(9,"th",45),e._uU(10,"UOM"),e.qZA(),e.TgZ(11,"th",45),e._uU(12,"Order"),e.qZA(),e.TgZ(13,"th",46),e._uU(14,"Invoice"),e.qZA(),e.TgZ(15,"th",47),e._uU(16,"Technology"),e.qZA(),e.TgZ(17,"th",48),e._uU(18,"Supplier"),e.qZA(),e.TgZ(19,"th",49),e._uU(20,"Purchase Category"),e.qZA(),e.TgZ(21,"th",46),e._uU(22,"Date"),e.qZA(),e.TgZ(23,"th",46),e._uU(24,"Quantity"),e.qZA(),e.TgZ(25,"th",44),e._uU(26,"Unit Price"),e.qZA(),e.TgZ(27,"th",44),e._uU(28,"Total Price"),e.qZA(),e.TgZ(29,"th",44),e._uU(30,"Unit Cost"),e.qZA(),e.TgZ(31,"th",44),e._uU(32,"Total Cost"),e.qZA()())}const wi=function(n){return["/procurement/chains/order/",n]};function Ni(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,wi,t.order)),e.xp6(1),e.hij(" ",t.order," ")}}const Ui=function(n){return["/outsourcing/chains/order/",n]};function Pi(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Ui,t.order)),e.xp6(1),e.hij(" ",t.order," ")}}const Fi=function(n){return["/warehouse/physical-inventory/",n]};function Ji(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Fi,t.order.id)),e.xp6(1),e.hij(" ",t.order.id," ")}}const ki=function(n){return["/reports/invoices/invoice/",n]};function Si(n,i){if(1&n&&(e.TgZ(0,"a",52),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,ki,t.invoice.id)),e.xp6(1),e.hij(" ",t.invoice.self_serial_number," ")}}function Qi(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"None"),e.qZA())}function Mi(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",42),e._uU(2),e.qZA(),e.TgZ(3,"td",43),e._uU(4),e.qZA(),e.TgZ(5,"td",43),e._uU(6),e.qZA(),e.TgZ(7,"td",44),e._uU(8),e.qZA(),e.TgZ(9,"td",45),e._uU(10),e.qZA(),e.TgZ(11,"td",45),e.YNc(12,Ni,2,4,"a",50),e.YNc(13,Pi,2,4,"a",50),e.YNc(14,Ji,2,4,"a",50),e.qZA(),e.TgZ(15,"td",46),e.YNc(16,Si,2,4,"a",50),e.YNc(17,Qi,2,0,"span",51),e.qZA(),e.TgZ(18,"td",47),e._uU(19),e.qZA(),e.TgZ(20,"td",48),e._uU(21),e.qZA(),e.TgZ(22,"td",49),e._uU(23),e.qZA(),e.TgZ(24,"td",46),e._uU(25),e.ALo(26,"date"),e.qZA(),e.TgZ(27,"td",46),e._uU(28),e.qZA(),e.TgZ(29,"td",44),e._uU(30),e.ALo(31,"moneyFormat"),e.qZA(),e.TgZ(32,"td",44),e._uU(33),e.ALo(34,"moneyFormat"),e.qZA(),e.TgZ(35,"td",44),e._uU(36),e.ALo(37,"moneyFormat"),e.qZA(),e.TgZ(38,"td",44),e._uU(39),e.ALo(40,"moneyFormat"),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.total_quantity),e.xp6(2),e.Oqu(t.category),e.xp6(2),e.Q6J("ngIf","0"===t.type),e.xp6(1),e.Q6J("ngIf","2"===t.type),e.xp6(1),e.Q6J("ngIf","physical-inventory"===t.type),e.xp6(2),e.Q6J("ngIf",t.invoice),e.xp6(1),e.Q6J("ngIf",!t.invoice),e.xp6(2),e.hij(" ",t.current_technology," "),e.xp6(2),e.hij(" ",t.supplier," "),e.xp6(2),e.hij(" ",t.purchase_category," "),e.xp6(2),e.hij(" ",e.xi3(26,19,t.document_creation_date,"dd/MM/yyyy")," "),e.xp6(3),e.hij(" ",t.quantity," "),e.xp6(2),e.hij(" ",e.lcZ(31,22,t.supplier_unit_price)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(34,24,t.supplier_total_price)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(37,26,t.supplier_unit_cost)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(40,28,t.supplier_total_cost)," \u20ac ")}}function Yi(n,i){1&n&&e._UZ(0,"i",55)}function Oi(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Ei(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",53),e.YNc(2,Yi,1,0,"i",54),e.YNc(3,Oi,2,0,"span",51),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function Li(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",56),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(102);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Bi(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",57)(1,"p-button",56),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(102);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let H=class{constructor(i,t,o,r){this.fb=i,this.columnFilterService=t,this.accountingProductService=o,this.adapterService=r,this.isLoading=!1,this.balanceProducts=[],this.query=[],this.count=0,this.supplierTotalCost=0,this.supplierTotalPrice=0,this.isGenerate=!1,this.searchForm=this.fb.group({name:[null],code:[null],supplier:[null],supplier_category:[null],categories:[null],system_creation_date_after:[null],system_creation_date_before:[null],invoice_reception_date_after:[null],invoice_reception_date_before:[null],items_reception_date_after:[null],items_reception_date_before:[null],is_paid:[null],purchase_categories:[null],invoice_date_after:[null],invoice_date_before:[null],nomenclature_accounting_numbers:[null],accounting_type:[null],material_or_service:[null]}),this.search$=new P.x,this.name$=new P.x,this.code$=new P.x,this.balanceProducts$=this.search$.pipe((0,I.b)(150),(0,g.b)(()=>this.prepareForSearch()),(0,O.w)(()=>this.query.length?this.accountingProductService.balance(this.query).pipe((0,g.b)(a=>this.countTotals(a)),(0,ue.O)([]),(0,C.t)(this)):(0,me.of)([]).pipe((0,g.b)(()=>this.countTotals([])))),(0,C.t)(this))}ngOnInit(){this.name$.pipe((0,I.b)(250),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.code$.pipe((0,I.b)(250),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.balanceProducts$.pipe((0,C.t)(this)).subscribe()}clearFilters(){this.searchForm.reset(),this.picker.fillSelected([])}countTotals(i){this.supplierTotalCost=0,this.supplierTotalPrice=0,i.forEach(r=>{r.accepted_by_invoices&&(r.date=new Date(r?.accepted_by_invoices[0]?.document_creation_date),r?.accepted_by_invoices.sort((a,l)=>new Date(a.document_creation_date).getTime()-new Date(l.document_creation_date).getTime()),r?.accepted_by_invoices.forEach(a=>{this.supplierTotalCost+=a.supplier_total_cost,this.supplierTotalPrice+=parseFloat(a.supplier_total_price)}))});const t=[];let o=0;i.forEach(r=>{o++,console.log(r),r.extra_info.forEach(a=>{t.push({id:o,name:r.nomenclature.name,code:r.nomenclature.code,total_quantity:r.total_quantity,category:r.nomenclature.category?r.nomenclature.category?.unit_of_measure?.symbol:"Pcs",order:a.physical_inventory?a.physical_inventory:a.order,invoice:a.physical_inventory?"":a.invoice,current_technology:a.current_technology?a.current_technology:"None",supplier:a.physical_inventory?"Physical Inventory":a?.supplier,purchase_category:r.purchase_category?.name?r.purchase_category?.name:"None",document_creation_date:a.document_creation_date,quantity:a.quantity,supplier_unit_price:a.supplier_unit_price,supplier_total_price:a.supplier_total_price,supplier_unit_cost:a.supplier_unit_cost,supplier_total_cost:a.supplier_total_cost,type:a.physical_inventory?"physical-inventory":r.nomenclature.type})})}),this.count=i.length,t.sort(function(r,a){return new Date(a.document_creation_date).getTime()-new Date(r.document_creation_date).getTime()||r.code.localeCompare(a.code)}),this.balanceProducts=t.map(r=>r),this.isLoading=!1}prepareForSearch(){this.dt._first=0,this.isLoading=!0,this.count=0,this.query=[];for(const i in this.searchForm.controls)null!==this.searchForm.controls[i].value&&""!==this.searchForm.controls[i].value&&(this.searchForm.controls[i].value instanceof Date?this.query.push({name:i,value:this.adapterService.dateAdapter(this.searchForm.controls[i].value)}):this.query.push({name:i,value:this.searchForm.controls[i].value}))}changeAccountingNumber(i){const t=i.target.value.replace(/\s/g,"");t?this.searchForm.get("nomenclature_accounting_numbers").patchValue(t):this.searchForm.get("nomenclature_accounting_numbers").patchValue(null),this.search$.next()}getPaidStatus(i){this.searchForm.get("is_paid").patchValue(i),this.search$.next()}onSelectCompany(i){this.searchForm.get("supplier").patchValue(i),this.search$.next()}onSelectCategory(i){this.searchForm.get("supplier_category").patchValue(i),this.search$.next()}onSelectCategories(i){this.searchForm.get("categories").patchValue(i?.join(",")??null),this.search$.next()}onSelectPurchasedCategories(i){this.searchForm.get("accounting_type").patchValue(null),this.searchForm.get("material_or_service").patchValue(null),i.forEach(t=>{"mp"===t?this.searchForm.get("accounting_type").patchValue(1):"ou"===t?this.searchForm.get("material_or_service").patchValue("material"):"os"===t&&this.searchForm.get("material_or_service").patchValue("service")}),i.find(t=>"ou"===t)&&i.find(t=>"os"===t)&&this.searchForm.get("material_or_service").patchValue("both"),i=i.filter(t=>"number"==typeof t),this.searchForm.get("purchase_categories").patchValue(i.join(","))}exportToExcel(){this.isGenerate=!0,this.accountingProductService.exportToExcel(this.balanceProducts,"wh-balance").then(()=>{this.isGenerate=!1})}onApplyFilter(){this.accountingProductService.openFilterModal().pipe((0,R.h)(i=>!!i)).subscribe(i=>{const t={...i};t.invoice_reception_date_after&&(t.invoice_reception_date_after=new Date(t.invoice_reception_date_after)),t.invoice_reception_date_before&&(t.invoice_reception_date_before=new Date(t.invoice_reception_date_before)),t.items_reception_date_after&&(t.items_reception_date_after=new Date(t.items_reception_date_after)),t.items_reception_date_before&&(t.items_reception_date_before=new Date(t.items_reception_date_before)),t.system_creation_date_after&&(t.system_creation_date_after=new Date(t.system_creation_date_after)),t.system_creation_date_before&&(t.system_creation_date_before=new Date(t.system_creation_date_before)),t.supplier=t.supplier?t.supplier.id:null,t.supplier_category=t.supplier_category?+t.supplier_category.id:null,t.categories=t.nomenclature_categories.split(",").map(o=>+o),t.code=t.nomenclature_code,t.name=t.nomenclature_name,this.searchForm.patchValue(t),this.picker.fillSelected(t.categories)})}};H.\u0275fac=function(i){return new(i||H)(e.Y36(s.qu),e.Y36(pe.W),e.Y36(ce),e.Y36(J.v))},H.\u0275cmp=e.Xpm({type:H,selectors:[["pek-reports-warehouse-balance"]],viewQuery:function(i,t){if(1&i&&(e.Gf(E.Q,5),e.Gf(yi,5)),2&i){let o;e.iGM(o=e.CRH())&&(t.picker=o.first),e.iGM(o=e.CRH())&&(t.dt=o.first)}},decls:109,vars:41,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf","ngIfElse"],["totalsLoading",""],[1,"page__tools"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Apply Filter",3,"click"],["pButton","","type","button","icon","pi pi-times","label","Clear Filter",1,"p-button-danger","ml-2",3,"click"],["pButton","","type","button","icon","pi pi-file-excel","label","Generate Report",1,"p-button-icon","ml-2",3,"loading","disabled","click"],[1,"page__content"],[1,"page__card"],[1,"form","mb-3",3,"formGroup"],[1,"row"],[1,"col-2"],[1,"form-group"],["type","text","pInputText","","formControlName","name",3,"ngModelChange"],["type","text","pInputText","","formControlName","code",3,"ngModelChange"],[3,"currentCompanyId","selectCompany"],[3,"selectedCategoryId","selectCompanyCategory"],[3,"currentCategoryIds","choiceCategoryFolAllIds"],[3,"filterValue","changeValue"],["formControlName","system_creation_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","system_creation_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],[1,"col-3"],[3,"withReportFilters","choiceCategories"],["pInputText","",3,"input"],["formControlName","invoice_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","ngModelChange"],["formControlName","invoice_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","ngModelChange"],[1,"page__table","report-table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","value"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"text-center",2,"width","3%"],[2,"width","10%"],[1,"text-center",2,"width","6%"],[1,"text-center",2,"width","4%"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","7%"],[2,"width","9%"],[1,"text-center",2,"width","8%"],["target","_blank",3,"routerLink",4,"ngIf"],[4,"ngIf"],["target","_blank",3,"routerLink"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5," Warehouse Balance (Total Cost: "),e.YNc(6,bi,3,3,"span",4),e._uU(7," \u20ac, Total Price: "),e.YNc(8,Ai,3,3,"span",4),e._uU(9," \u20ac) "),e.qZA(),e.YNc(10,Ii,1,0,"ng-template",null,5,e.W1O),e.qZA(),e.TgZ(12,"div",6)(13,"button",7),e.NdJ("click",function(){return t.onApplyFilter()}),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return t.clearFilters()}),e.qZA(),e.TgZ(15,"button",9),e.NdJ("click",function(){return t.exportToExcel()}),e.qZA()()()(),e.TgZ(16,"div",10)(17,"div",11)(18,"form",12)(19,"div",13)(20,"div",14)(21,"div",15)(22,"label"),e._uU(23,"Name"),e.qZA(),e.TgZ(24,"input",16),e.NdJ("ngModelChange",function(r){return t.name$.next(r)}),e.qZA()()(),e.TgZ(25,"div",14)(26,"div",15)(27,"label"),e._uU(28,"Code"),e.qZA(),e.TgZ(29,"input",17),e.NdJ("ngModelChange",function(r){return t.code$.next(r)}),e.qZA()()(),e.TgZ(30,"div",14)(31,"div",15)(32,"label"),e._uU(33,"Company"),e.qZA(),e.TgZ(34,"pek-company-picker",18),e.NdJ("selectCompany",function(r){return t.onSelectCompany(r)}),e.qZA()()(),e.TgZ(35,"div",14)(36,"div",15)(37,"label"),e._uU(38,"Company Category"),e.qZA(),e.TgZ(39,"pek-company-category-picker",19),e.NdJ("selectCompanyCategory",function(r){return t.onSelectCategory(r)}),e.qZA()()(),e.TgZ(40,"div",14)(41,"div",15)(42,"label"),e._uU(43,"Warehouse Category"),e.qZA(),e.TgZ(44,"pek-multi-product-categories-picker",20),e.NdJ("choiceCategoryFolAllIds",function(r){return t.onSelectCategories(r)}),e.qZA()()(),e.TgZ(45,"div",14)(46,"div",15)(47,"label"),e._uU(48,"Paid"),e.qZA(),e.TgZ(49,"pek-input-three-values",21),e.NdJ("changeValue",function(r){return t.getPaidStatus(r)}),e.qZA()()(),e.TgZ(50,"div",14)(51,"div",15)(52,"label"),e._uU(53,"Creation From"),e.qZA(),e.TgZ(54,"p-calendar",22),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(55,"div",14)(56,"div",15)(57,"label"),e._uU(58,"Creation To"),e.qZA(),e.TgZ(59,"p-calendar",23),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(60,"div",14)(61,"div",15)(62,"label"),e._uU(63,"Invoice Recieved From"),e.qZA(),e.TgZ(64,"p-calendar",24),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(65,"div",14)(66,"div",15)(67,"label"),e._uU(68,"Invoice Recieved To"),e.qZA(),e.TgZ(69,"p-calendar",25),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(70,"div",14)(71,"div",15)(72,"label"),e._uU(73,"Items Recieved From"),e.qZA(),e.TgZ(74,"p-calendar",26),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(75,"div",14)(76,"div",15)(77,"label"),e._uU(78,"Items Recieved To"),e.qZA(),e.TgZ(79,"p-calendar",27),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(80,"div",28)(81,"div",15)(82,"label"),e._uU(83,"Purchase Category"),e.qZA(),e.TgZ(84,"pek-multi-purchase-category-picker",29),e.NdJ("choiceCategories",function(r){return t.onSelectPurchasedCategories(r)}),e.qZA()()(),e.TgZ(85,"div",28)(86,"div",15)(87,"label"),e._uU(88,"Nomenclature Accounting Number"),e.qZA(),e.TgZ(89,"input",30),e.NdJ("input",function(r){return t.changeAccountingNumber(r)}),e.qZA()()(),e.TgZ(90,"div",28)(91,"div",15)(92,"label"),e._uU(93,"Invoice Date From"),e.qZA(),e.TgZ(94,"p-calendar",31),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(95,"div",28)(96,"div",15)(97,"label"),e._uU(98,"Invoice Date To"),e.qZA(),e.TgZ(99,"p-calendar",32),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()()()(),e.TgZ(100,"div",33)(101,"p-table",34,35),e.YNc(103,qi,0,0,"ng-template",36),e.YNc(104,Ri,33,0,"ng-template",37),e.YNc(105,Mi,41,30,"ng-template",38),e.YNc(106,Ei,4,3,"ng-template",39),e.YNc(107,Li,2,0,"ng-template",40),e.qZA()(),e.YNc(108,Bi,3,0,"div",41),e.qZA()()),2&i){const o=e.MAs(11),r=e.MAs(102);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(3),e.Q6J("ngIf",!t.isLoading)("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",!t.isLoading)("ngIfElse",o),e.xp6(7),e.Q6J("loading",t.isGenerate)("disabled",!t.count),e.xp6(3),e.Q6J("formGroup",t.searchForm),e.xp6(16),e.Q6J("currentCompanyId",t.searchForm.get("supplier").value),e.xp6(5),e.Q6J("selectedCategoryId",t.searchForm.get("supplier_category").value),e.xp6(5),e.Q6J("currentCategoryIds",t.searchForm.get("categories").value),e.xp6(5),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchForm.get("is_paid").value)),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("withReportFilters",!0),e.xp6(10),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(2),e.Q6J("scrollable",!0)("paginator",t.count>0)("rows",10)("value",t.balanceProducts),e.xp6(7),e.Q6J("ngIf",!r.paginator&&!t.isLoading&&t.count>0)}},dependencies:[m.O5,b.yS,v.Hq,v.zx,Z.jx,T.iA,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,A.D,L.f,B.i,re.E,E.Q,fe.r,_e.x,m.uU,M.U],styles:[".form[_ngcontent-%COMP%]{margin-top:-.25rem}.report-table[_ngcontent-%COMP%]  p-table tr td, .report-table[_ngcontent-%COMP%]  p-table tr th{font-size:14px!important}"]}),H=(0,F.gn)([(0,C.c)()],H);var Di=d(8695),$i=d(6913),be=d(5722);const Gi=["dt"];function ji(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.supplierTotalCost))}}function Vi(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.supplierTotalPrice))}}function Hi(n,i){1&n&&e._uU(0,"...")}function Ki(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"p-multiSelect",47),e.NdJ("ngModelChange",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.search$.next())}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("filter",!0)("options",t.lists)}}function zi(n,i){}function Wi(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",48),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",49),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",50),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",51),e._uU(8,"Quantity"),e.qZA(),e.TgZ(9,"th",52),e._uU(10,"UOM"),e.qZA(),e.TgZ(11,"th",52),e._uU(12,"Order"),e.qZA(),e.TgZ(13,"th",52),e._uU(14,"Out Order"),e.qZA(),e.TgZ(15,"th",53),e._uU(16,"Invoice"),e.qZA(),e.TgZ(17,"th",53),e._uU(18,"Technology"),e.qZA(),e.TgZ(19,"th",54),e._uU(20,"Supplier"),e.qZA(),e.TgZ(21,"th",55),e._uU(22,"Purchase Category"),e.qZA(),e.TgZ(23,"th",49),e._uU(24,"Written For List"),e.qZA(),e.TgZ(25,"th",53),e._uU(26,"Date"),e.qZA(),e.TgZ(27,"th",53),e._uU(28,"Write-off Date"),e.qZA(),e.TgZ(29,"th",53),e._uU(30,"Unit Price"),e.qZA(),e.TgZ(31,"th",53),e._uU(32,"Total Price"),e.qZA(),e.TgZ(33,"th",53),e._uU(34,"Unit Cost"),e.qZA(),e.TgZ(35,"th",53),e._uU(36,"Total Cost"),e.qZA()())}const Fe=function(n){return["/procurement/chains/order/",n]};function Xi(n,i){if(1&n&&(e.TgZ(0,"a",58),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Fe,t.order)),e.xp6(1),e.Oqu(t.order)}}const Je=function(n){return["/outsourcing/chains/order/",n]};function er(n,i){if(1&n&&(e.TgZ(0,"a",58),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Je,t.order)),e.xp6(1),e.Oqu(t.order)}}const tr=function(n){return["/warehouse/physical-inventory/",n]};function nr(n,i){if(1&n&&(e.TgZ(0,"a",58),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,tr,t.order)),e.xp6(1),e.Oqu(t.physical_inventory.id)}}function or(n,i){if(1&n&&(e.TgZ(0,"a",58),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Fe,t.out_order_id)),e.xp6(1),e.Oqu(t.out_order_id)}}function ir(n,i){if(1&n&&(e.TgZ(0,"a",58),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,Je,t.out_order_id)),e.xp6(1),e.Oqu(t.out_order_id)}}const rr=function(n){return["/reports/invoices/invoice/",n]};function ar(n,i){if(1&n&&(e.TgZ(0,"a",58),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(2,rr,t.invoice.id)),e.xp6(1),e.Oqu(t.invoice.self_serial_number)}}function cr(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"None"),e.qZA())}function sr(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",48),e._uU(2),e.qZA(),e.TgZ(3,"td",49),e._uU(4),e.qZA(),e.TgZ(5,"td",50),e._uU(6),e.qZA(),e.TgZ(7,"td",51),e._uU(8),e.qZA(),e.TgZ(9,"td",52),e._uU(10),e.qZA(),e.TgZ(11,"td",52),e.YNc(12,Xi,2,4,"a",56),e.YNc(13,er,2,4,"a",56),e.YNc(14,nr,2,4,"a",56),e.qZA(),e.TgZ(15,"td",52),e.YNc(16,or,2,4,"a",56),e.YNc(17,ir,2,4,"a",56),e.qZA(),e.TgZ(18,"td",53),e.YNc(19,ar,2,4,"a",56),e.YNc(20,cr,2,0,"span",57),e.qZA(),e.TgZ(21,"td",53),e._uU(22),e.qZA(),e.TgZ(23,"td",54),e._uU(24),e.qZA(),e.TgZ(25,"td",55),e._uU(26),e.qZA(),e.TgZ(27,"td",49),e._uU(28),e.qZA(),e.TgZ(29,"td",53),e._uU(30),e.ALo(31,"date"),e.qZA(),e.TgZ(32,"td",53),e._uU(33),e.ALo(34,"date"),e.qZA(),e.TgZ(35,"td",53),e._uU(36),e.ALo(37,"moneyFormat"),e.qZA(),e.TgZ(38,"td",53),e._uU(39),e.ALo(40,"moneyFormat"),e.qZA(),e.TgZ(41,"td",53),e._uU(42),e.ALo(43,"moneyFormat"),e.qZA(),e.TgZ(44,"td",53),e._uU(45),e.ALo(46,"moneyFormat"),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.nomenclature.code),e.xp6(2),e.Oqu(t.nomenclature.name),e.xp6(2),e.Oqu(t.quantity),e.xp6(2),e.Oqu(t.nomenclature.category?t.nomenclature.category.unit_of_measure.symbol:"Pcs"),e.xp6(2),e.Q6J("ngIf","0"===t.nomenclature.type&&!t.physical_inventory),e.xp6(1),e.Q6J("ngIf","0"!==t.nomenclature.type&&!t.physical_inventory),e.xp6(1),e.Q6J("ngIf",t.physical_inventory),e.xp6(2),e.Q6J("ngIf","0"===t.nomenclature.type&&!t.physical_inventory),e.xp6(1),e.Q6J("ngIf","0"!==t.nomenclature.type&&!t.physical_inventory),e.xp6(2),e.Q6J("ngIf",t.invoice&&!t.physical_inventory),e.xp6(1),e.Q6J("ngIf",t.physical_inventory),e.xp6(2),e.Oqu(t.current_technology?t.current_technology:"None"),e.xp6(2),e.Oqu(t.supplier),e.xp6(2),e.hij(" ",t.purchase_category?null==t.purchase_category?null:t.purchase_category.name:"None"," "),e.xp6(2),e.Oqu(t.written_off_for_list),e.xp6(2),e.Oqu(e.xi3(31,22,t.document_creation_date,"dd/MM/yyyy")),e.xp6(3),e.Oqu(e.xi3(34,25,t.created,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.lcZ(37,28,t.supplier_unit_price)," \u20ac"),e.xp6(3),e.hij("",e.lcZ(40,30,t.supplier_total_price)," \u20ac"),e.xp6(3),e.hij("",e.lcZ(43,32,t.supplier_unit_cost)," \u20ac"),e.xp6(3),e.hij("",e.lcZ(46,34,t.supplier_total_cost)," \u20ac")}}function lr(n,i){1&n&&e._UZ(0,"i",61)}function pr(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function _r(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",59),e.YNc(2,lr,1,0,"i",60),e.YNc(3,pr,2,0,"span",57),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function ur(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",62),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(130);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function dr(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",63)(1,"p-button",62),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(130);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function mr(n,i){1&n&&(e.TgZ(0,"div",64),e._UZ(1,"i",65),e.qZA())}let K=class{constructor(i,t,o,r,a){this.fb=i,this.columnFilterService=t,this.accountingProductService=o,this.adapterService=r,this.listsService=a,this.searchForm=this.fb.group({name:[""],code:[""],written_off_for_lists:[null],supplier:[null],supplier_category:[null],categories:[null],root_categories:[null],system_creation_date_after:[null],system_creation_date_before:[null],invoice_reception_date_after:[null],invoice_reception_date_before:[null],items_reception_date_after:[null],items_reception_date_before:[null],created_after:[null],created_before:[null],for_completed_lists:[null],is_paid:[null],purchase_categories:[null],invoice_date_after:[null],invoice_date_before:[null],nomenclature_accounting_numbers:[null],accounting_type:[null],material_or_service:[null],for_lists_in_progress:[null]}),this.isLoadingLists=!0,this.isLoading=!1,this.balanceProducts=[],this.query=[],this.count=0,this.supplierTotalCost=0,this.supplierTotalPrice=0,this.isGenerate=!1,this.search$=new P.x,this.name$=new P.x,this.code$=new P.x,this.balanceProducts$=this.search$.pipe((0,I.b)(150),(0,g.b)(()=>this.prepareForSearch()),(0,O.w)(()=>this.query.length?this.accountingProductService.out(this.query).pipe((0,g.b)(l=>this.countTotals(l)),(0,ue.O)([]),(0,C.t)(this)):(0,me.of)([]).pipe((0,g.b)(()=>this.countTotals([])))),(0,C.t)(this))}getLists(){this.listsService.getForFilter().subscribe(i=>{this.lists=i,this.lists.forEach(t=>t.fullName=`(${t.id}) ${t.nomenclature.code} ${t.nomenclature.name}`),this.lists.unshift({id:-1,fullName:"Sold Products"},{id:0,fullName:"Physical Inventory"}),this.isLoadingLists=!1})}ngOnInit(){this.name$.pipe((0,I.b)(250),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.code$.pipe((0,I.b)(250),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.getLists()}clearFilters(){this.searchForm.reset(),this.picker.fillSelected([])}countTotals(i){this.supplierTotalCost=0,this.supplierTotalPrice=0,i.forEach(t=>{this.supplierTotalCost+=t.supplier_total_cost,this.supplierTotalPrice+=parseFloat(t.supplier_total_price)}),this.count=i.length,this.balanceProducts=[...i],this.isLoading=!1}prepareForSearch(){this.dt._first=0,this.isLoading=!0,this.count=0,this.query=[];for(const i in this.searchForm.controls)null!==this.searchForm.controls[i].value&&""!==this.searchForm.controls[i].value&&(this.searchForm.controls[i].value instanceof Date?this.query.push({name:i,value:this.adapterService.dateAdapter(this.searchForm.controls[i].value)}):this.query.push({name:i,value:this.searchForm.controls[i].value}))}exportToExcel(){this.isGenerate=!0,this.accountingProductService.exportToExcel(this.balanceProducts,"out").then(()=>{this.isGenerate=!1})}onApplyFilter(){this.accountingProductService.openFilterModal().pipe((0,R.h)(i=>!!i)).subscribe(i=>{const t={...i};t.invoice_reception_date_after&&(t.invoice_reception_date_after=new Date(t.invoice_reception_date_after)),t.invoice_reception_date_before&&(t.invoice_reception_date_before=new Date(t.invoice_reception_date_before)),t.items_reception_date_after&&(t.items_reception_date_after=new Date(t.items_reception_date_after)),t.items_reception_date_before&&(t.items_reception_date_before=new Date(t.items_reception_date_before)),t.system_creation_date_after&&(t.system_creation_date_after=new Date(t.system_creation_date_after)),t.system_creation_date_before&&(t.system_creation_date_before=new Date(t.system_creation_date_before)),t.supplier=t.supplier?t.supplier.id:null,t.supplier_category=t.supplier_category?+t.supplier_category.id:null,t.categories=t.nomenclature_categories.split(",").map(o=>+o),t.code=t.nomenclature_code,t.name=t.nomenclature_name,this.searchForm.patchValue(t),this.picker.fillSelected(t.categories)})}onSelectCompany(i){this.searchForm.get("supplier").patchValue(i),this.search$.next()}onSelectCategory(i){this.searchForm.get("supplier_category").patchValue(i),this.search$.next()}onSelectCategories(i){this.searchForm.get("categories").patchValue(i?.join(",")??null),this.search$.next()}onSelectPurchasedCategories(i){this.searchForm.get("accounting_type").patchValue(null),this.searchForm.get("material_or_service").patchValue(null),i.forEach(t=>{"mp"===t?this.searchForm.get("accounting_type").patchValue(1):"ou"===t?this.searchForm.get("material_or_service").patchValue("material"):"os"===t&&this.searchForm.get("material_or_service").patchValue("service")}),i.find(t=>"ou"===t)&&i.find(t=>"os"===t)&&this.searchForm.get("material_or_service").patchValue("both"),i=i.filter(t=>"number"==typeof t),this.searchForm.get("purchase_categories").patchValue(i.join(",")),this.search$.next()}getPaidFinishedProducts(i){this.searchForm.get("for_completed_lists").patchValue(i),this.search$.next()}getProgressValue(i){this.searchForm.get("for_lists_in_progress").patchValue(i),this.search$.next()}changeAccountingNumber(i){const t=i.target.value.replace(/\s/g,"");t?this.searchForm.get("nomenclature_accounting_numbers").patchValue(t):this.searchForm.get("nomenclature_accounting_numbers").patchValue(null),this.search$.next()}onSelectProductStructureCategories(i){this.searchForm.get("root_categories").patchValue(i??null),this.search$.next()}};K.\u0275fac=function(i){return new(i||K)(e.Y36(s.qu),e.Y36(pe.W),e.Y36(ce),e.Y36(J.v),e.Y36(Di.X))},K.\u0275cmp=e.Xpm({type:K,selectors:[["pek-reports-out"]],viewQuery:function(i,t){if(1&i&&(e.Gf(E.Q,5),e.Gf(Gi,5)),2&i){let o;e.iGM(o=e.CRH())&&(t.picker=o.first),e.iGM(o=e.CRH())&&(t.dt=o.first)}},decls:140,vars:52,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf","ngIfElse"],["totalsLoading",""],[1,"page__tools"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Apply Filter",3,"click"],["pButton","","type","button","icon","pi pi-times","label","Clear Filter",1,"p-button-danger","ml-2",3,"click"],["pButton","","type","button","icon","pi pi-file-excel","label","Generate Report",1,"p-button-icon","ml-2",3,"loading","disabled","click"],[1,"page__content"],[1,"page__card"],[1,"form","mb-3",3,"formGroup"],[1,"row"],[1,"col-2"],[1,"form-group"],["type","text","pInputText","","formControlName","name",3,"ngModelChange"],["type","text","pInputText","","formControlName","code",3,"ngModelChange"],[3,"currentCompanyId","selectCompany"],[3,"selectedCategoryId","selectCompanyCategory"],[3,"currentCategoryIds","choiceCategoryFolAllIds"],[1,"col-6"],[3,"filterValue","changeValue"],["formControlName","system_creation_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","system_creation_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],[1,"col-4"],[3,"withReportFilters","choiceCategories"],["formControlName","created_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","created_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],[3,"choiceCategories"],["pInputText","",3,"input"],["formControlName","invoice_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","ngModelChange"],["formControlName","invoice_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","ngModelChange"],[1,"page__table","report-table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","value"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],["listLoading",""],["formControlName","written_off_for_lists","placeholder","Choose Written List","optionLabel","fullName","optionValue","id",3,"filter","options","ngModelChange"],[1,"text-center",2,"width","3%"],[2,"width","8%"],[2,"width","10%"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","4%"],[1,"text-center",2,"width","6%"],[2,"width","7%"],[1,"text-center",2,"width","7%"],["rel","noopener noreferrer","target","_blank",3,"routerLink",4,"ngIf"],[4,"ngIf"],["rel","noopener noreferrer","target","_blank",3,"routerLink"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5," Out (Total Cost: "),e.YNc(6,ji,3,3,"span",4),e._uU(7," \u20ac, Total Price: "),e.YNc(8,Vi,3,3,"span",4),e._uU(9," \u20ac) "),e.qZA(),e.YNc(10,Hi,1,0,"ng-template",null,5,e.W1O),e.qZA(),e.TgZ(12,"div",6)(13,"button",7),e.NdJ("click",function(){return t.onApplyFilter()}),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return t.clearFilters()}),e.qZA(),e.TgZ(15,"button",9),e.NdJ("click",function(){return t.exportToExcel()}),e.qZA()()()(),e.TgZ(16,"div",10)(17,"div",11)(18,"form",12)(19,"div",13)(20,"div",14)(21,"div",15)(22,"label"),e._uU(23,"Name"),e.qZA(),e.TgZ(24,"input",16),e.NdJ("ngModelChange",function(r){return t.name$.next(r)}),e.qZA()()(),e.TgZ(25,"div",14)(26,"div",15)(27,"label"),e._uU(28,"Code"),e.qZA(),e.TgZ(29,"input",17),e.NdJ("ngModelChange",function(r){return t.code$.next(r)}),e.qZA()()(),e.TgZ(30,"div",14)(31,"div",15)(32,"label"),e._uU(33,"Company"),e.qZA(),e.TgZ(34,"pek-company-picker",18),e.NdJ("selectCompany",function(r){return t.onSelectCompany(r)}),e.qZA()()(),e.TgZ(35,"div",14)(36,"div",15)(37,"label"),e._uU(38,"Company Category"),e.qZA(),e.TgZ(39,"pek-company-category-picker",19),e.NdJ("selectCompanyCategory",function(r){return t.onSelectCategory(r)}),e.qZA()()(),e.TgZ(40,"div",14)(41,"div",15)(42,"label"),e._uU(43,"Warehouse Category"),e.qZA(),e.TgZ(44,"pek-multi-product-categories-picker",20),e.NdJ("choiceCategoryFolAllIds",function(r){return t.onSelectCategories(r)}),e.qZA()()(),e.TgZ(45,"div",14)(46,"div",13)(47,"div",21)(48,"div",15)(49,"label"),e._uU(50,"Finished Products"),e.qZA(),e.TgZ(51,"pek-input-three-values",22),e.NdJ("changeValue",function(r){return t.getPaidFinishedProducts(r)}),e.qZA()()(),e.TgZ(52,"div",21)(53,"div",15)(54,"label"),e._uU(55,"In Progress"),e.qZA(),e.TgZ(56,"pek-input-three-values",22),e.NdJ("changeValue",function(r){return t.getProgressValue(r)}),e.qZA()()()(),e._UZ(57,"div",15),e.qZA(),e.TgZ(58,"div",14)(59,"div",15)(60,"label"),e._uU(61,"Creation From"),e.qZA(),e.TgZ(62,"p-calendar",23),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(63,"div",14)(64,"div",15)(65,"label"),e._uU(66,"Creation To"),e.qZA(),e.TgZ(67,"p-calendar",24),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(68,"div",14)(69,"div",15)(70,"label"),e._uU(71,"Invoice Recieved From"),e.qZA(),e.TgZ(72,"p-calendar",25),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(73,"div",14)(74,"div",15)(75,"label"),e._uU(76,"Invoice Recieved To"),e.qZA(),e.TgZ(77,"p-calendar",26),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(78,"div",14)(79,"div",15)(80,"label"),e._uU(81,"Items Recieved From"),e.qZA(),e.TgZ(82,"p-calendar",27),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(83,"div",14)(84,"div",15)(85,"label"),e._uU(86,"Items Recieved To"),e.qZA(),e.TgZ(87,"p-calendar",28),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(88,"div",29)(89,"div",15)(90,"label"),e._uU(91,"Written Lists"),e.qZA(),e.YNc(92,Ki,2,2,"ng-container",4),e.qZA()(),e.TgZ(93,"div",29)(94,"div",15)(95,"label"),e._uU(96,"Purchase Category"),e.qZA(),e.TgZ(97,"pek-multi-purchase-category-picker",30),e.NdJ("choiceCategories",function(r){return t.onSelectPurchasedCategories(r)}),e.qZA()()(),e.TgZ(98,"div",14)(99,"div",15)(100,"label"),e._uU(101,"Write-off Date From"),e.qZA(),e.TgZ(102,"p-calendar",31),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(103,"div",14)(104,"div",15)(105,"label"),e._uU(106,"Write-off Date To"),e.qZA(),e.TgZ(107,"p-calendar",32),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(108,"div",29)(109,"div",15)(110,"label"),e._uU(111,"Product Structure Category"),e.qZA(),e.TgZ(112,"pek-multi-product-structure-categories-picker",33),e.NdJ("choiceCategories",function(r){return t.onSelectProductStructureCategories(r)}),e.qZA()()(),e.TgZ(113,"div",29)(114,"div",15)(115,"label"),e._uU(116,"Nomenclature Accounting Number"),e.qZA(),e.TgZ(117,"input",34),e.NdJ("input",function(r){return t.changeAccountingNumber(r)}),e.qZA()()(),e.TgZ(118,"div",14)(119,"div",15)(120,"label"),e._uU(121,"Invoice Date From"),e.qZA(),e.TgZ(122,"p-calendar",35),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(123,"div",14)(124,"div",15)(125,"label"),e._uU(126,"Invoice Date To"),e.qZA(),e.TgZ(127,"p-calendar",36),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()()()(),e.TgZ(128,"div",37)(129,"p-table",38,39),e.ALo(131,"async"),e.YNc(132,zi,0,0,"ng-template",40),e.YNc(133,Wi,37,0,"ng-template",41),e.YNc(134,sr,47,36,"ng-template",42),e.YNc(135,_r,4,3,"ng-template",43),e.YNc(136,ur,2,0,"ng-template",44),e.qZA()(),e.YNc(137,dr,3,0,"div",45),e.qZA()(),e.YNc(138,mr,2,0,"ng-template",null,46,e.W1O)),2&i){const o=e.MAs(11),r=e.MAs(130),a=e.MAs(139);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(3),e.Q6J("ngIf",!t.isLoading)("ngIfElse",o),e.xp6(2),e.Q6J("ngIf",!t.isLoading)("ngIfElse",o),e.xp6(7),e.Q6J("loading",t.isGenerate)("disabled",!t.count),e.xp6(3),e.Q6J("formGroup",t.searchForm),e.xp6(16),e.Q6J("currentCompanyId",t.searchForm.get("supplier").value),e.xp6(5),e.Q6J("selectedCategoryId",t.searchForm.get("supplier_category").value),e.xp6(5),e.Q6J("currentCategoryIds",t.searchForm.get("root_categories").value),e.xp6(7),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchForm.get("for_completed_lists").value)),e.xp6(5),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchForm.get("for_lists_in_progress").value)),e.xp6(6),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("ngIf",!t.isLoadingLists)("ngIfElse",a),e.xp6(5),e.Q6J("withReportFilters",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(15),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0),e.xp6(2),e.Q6J("scrollable",!0)("paginator",t.count>0)("rows",10)("value",e.lcZ(131,50,t.balanceProducts$)),e.xp6(8),e.Q6J("ngIf",!r.paginator&&!t.isLoading&&t.count>0)}},dependencies:[m.O5,b.yS,v.Hq,v.zx,Z.jx,T.iA,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,A.D,L.f,$i.j,B.i,re.E,be.NU,E.Q,fe.r,_e.x,m.Ov,m.uU,M.U],styles:[".form[_ngcontent-%COMP%]{margin-top:-.25rem}.report-table[_ngcontent-%COMP%]  p-table tr td, .report-table[_ngcontent-%COMP%]  p-table tr th{font-size:14px!important}"]}),K=(0,F.gn)([(0,C.c)()],K);var ke=d(8382),Se=d(9558),Ae=d(1997);const gr=["paginator"];function hr(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",22),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",23),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",24),e._uU(6,"Accounting Number"),e.qZA()())}function fr(n,i){1&n&&(e.TgZ(0,"tr",14)(1,"div"),e._UZ(2,"i",28),e.qZA()())}function vr(n,i){if(1&n&&(e.TgZ(0,"tr",25)(1,"td",26),e._uU(2),e.qZA(),e.TgZ(3,"td",23),e._uU(4),e.qZA(),e.TgZ(5,"td",24),e._uU(6),e.qZA()(),e.YNc(7,fr,3,0,"tr",27)),2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(10*(r.currentPage-1)+o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.accounting_number),e.xp6(1),e.Q6J("ngIf",r.isLoading)}}function Cr(n,i){1&n&&e._UZ(0,"i",32)}function Zr(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Tr(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",29),e.YNc(2,Cr,1,0,"i",30),e.YNc(3,Zr,2,0,"span",31),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",3),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function xr(n,i){1&n&&(e.TgZ(0,"div",33),e._UZ(1,"i",32),e.qZA())}function yr(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",34)(1,"p-paginator",35,36),e.NdJ("onPageChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.paginate(r))}),e.qZA(),e.TgZ(3,"p-button",37),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onShowAll(!0))}),e._uU(4," All "),e.qZA()()}if(2&n){const t=e.oxw();e.ekj("paginator-wrapper_hide",0===t.companiesCount),e.xp6(1),e.Q6J("rows",10)("totalRecords",t.companiesCount)}}function br(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",38)(1,"p-button",39),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onShowAll(!1))}),e._uU(2," Return pagination "),e.qZA()()}}let z=class{constructor(i,t,o){this.fb=i,this.companyService=t,this.adapterService=o,this.searchForm=this.fb.group({name:[null],category_id:[null]}),this.currentPage=1,this.isStartFirstPage=!1,this.isShowAll=!1,this.queryKey=this.adapterService.generateQueryKey(this.searchForm),this.query=[],this.isLoading=!0,this.companiesCount=0,this.selectedCompany=null,this.search$=new he.X(null),this.companies$=this.search$.pipe((0,g.b)(()=>this.prepareForSearch()),(0,O.w)(()=>(0,ke.s)(()=>!this.isShowAll,this.companyService.getForPagination(this.query).pipe((0,g.b)(r=>this.companiesCount=r.count),(0,y.U)(r=>r.results)),this.companyService.get(this.query).pipe((0,g.b)(r=>this.companiesCount=r.length)))),(0,g.b)(()=>this.paginateToFistPage()),(0,g.b)(()=>this.isLoading=!1),(0,C.t)(this))}ngOnInit(){}prepareForSearch(){this.isLoading=!0,this.selectedCompany=null;const i=this.adapterService.generateQueryKey(this.searchForm);i!==this.queryKey&&(this.currentPage=1,this.queryKey=i,this.isStartFirstPage=!0),this.query=[{name:"page",value:this.currentPage},{name:"is_purchased_only",value:!0}],this.isShowAll||this.query.push({name:"paginated",value:!0});for(const t in this.searchForm.controls)null!==this.searchForm.controls[t].value&&this.query.push({name:t,value:this.searchForm.controls[t].value})}onSelectCompany(i){this.searchForm.get("name").patchValue(i?.name??null),this.search$.next()}paginateToFistPage(){this.isStartFirstPage&&this.paginator?.changePage(0),this.isStartFirstPage=!1}paginate(i){this.isStartFirstPage||(this.currentPage=i.page+1,this.search$.next())}onShowAll(i){this.isShowAll=i,this.isShowAll||(this.currentPage=1),this.search$.next()}onSelectCompanyCategory(i){this.searchForm.get("category_id").patchValue(i),this.search$.next()}onEditCompanyAccountingNumber(){this.companyService.editCompanyAccountingNumberDialog(this.selectedCompany).pipe((0,R.h)(i=>!!i)).subscribe(()=>this.search$.next())}};z.\u0275fac=function(i){return new(i||z)(e.Y36(s.qu),e.Y36(Se.J),e.Y36(J.v))},z.\u0275cmp=e.Xpm({type:z,selectors:[["pek-reports-company-accounting-number"]],viewQuery:function(i,t){if(1&i&&e.Gf(gr,5),2&i){let o;e.iGM(o=e.CRH())&&(t.paginator=o.first)}},decls:32,vars:12,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"page__card"],[1,"form","mb-3"],[1,"row"],[1,"col-3"],[1,"form-group"],[3,"selectCompanyFull"],[3,"selectCompanyCategory"],[1,"col-3","edit-button"],["pButton","","type","button","icon","pi pi-pencil","label","Edit Accounting Number",3,"disabled","click"],[1,"table-pagination-preloader"],["selectionMode","single","dataKey","id","scrollHeight","calc(100vh - 24.25rem)",3,"rows","scrollable","value","selection","selectionChange"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","pagination-preloader pagination-preloader_bord",4,"ngIf"],["class","paginator-wrapper",3,"paginator-wrapper_hide",4,"ngIf"],["class","paginator-return-pagination",4,"ngIf"],[1,"index-header","text-center",2,"width","5%"],[2,"width","75%"],[1,"text-center",2,"width","20%"],[3,"pSelectableRow"],[1,"text-center",2,"width","5%"],["class","table-pagination-preloader",4,"ngIf"],[1,"fas","fa-circle-notch","fa-spin","fa-3x"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],[1,"pagination-preloader","pagination-preloader_bord"],[1,"paginator-wrapper"],[3,"rows","totalRecords","onPageChange"],["paginator",""],["type","button","styleClass","p-button-text",1,"paginator-all",3,"click"],[1,"paginator-return-pagination"],["type","button","styleClass","p-button-text",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Company Accounting Number"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"form",6)(9,"div",7)(10,"div",8)(11,"div",9)(12,"label"),e._uU(13,"Name"),e.qZA(),e.TgZ(14,"pek-company-picker",10),e.NdJ("selectCompanyFull",function(r){return t.onSelectCompany(r)}),e.qZA()()(),e.TgZ(15,"div",8)(16,"div",9)(17,"label"),e._uU(18,"Category"),e.qZA(),e.TgZ(19,"pek-company-category-picker",11),e.NdJ("selectCompanyCategory",function(r){return t.onSelectCompanyCategory(r)}),e.qZA()()(),e._UZ(20,"div",8),e.TgZ(21,"div",12)(22,"button",13),e.NdJ("click",function(){return t.onEditCompanyAccountingNumber()}),e.qZA()()()(),e.TgZ(23,"div",14)(24,"p-table",15),e.NdJ("selectionChange",function(r){return t.selectedCompany=r}),e.ALo(25,"async"),e.YNc(26,hr,7,0,"ng-template",16),e.YNc(27,vr,8,5,"ng-template",17),e.YNc(28,Tr,4,3,"ng-template",18),e.qZA(),e.YNc(29,xr,2,0,"div",19),e.YNc(30,yr,5,4,"div",20),e.qZA(),e.YNc(31,br,3,0,"div",21),e.qZA()()),2&i&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(19),e.Q6J("disabled",!t.selectedCompany),e.xp6(2),e.Q6J("rows",10)("scrollable",!0)("value",e.lcZ(25,10,t.companies$))("selection",t.selectedCompany),e.xp6(5),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isShowAll),e.xp6(1),e.Q6J("ngIf",t.isShowAll))},dependencies:[m.O5,v.Hq,v.zx,Z.jx,T.iA,T.Ei,s._Y,s.JL,s.F,A.D,Ae.D,B.i,re.E,m.Ov],styles:["form[_ngcontent-%COMP%]{margin-top:-.25rem}.edit-button[_ngcontent-%COMP%]{display:flex}.edit-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto;margin-top:auto;margin-bottom:.5rem}"]}),z=(0,F.gn)([(0,C.c)()],z);var Ar=d(3178),Ir=d(7925);const qr=["paginator"];function Rr(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",29),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",30),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",31),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",32),e._uU(8,"Category"),e.qZA(),e.TgZ(9,"th",33),e._uU(10,"Accounting Number"),e.qZA(),e.TgZ(11,"th",33),e._uU(12,"Is Fixed Asset"),e.qZA(),e.TgZ(13,"th",33),e._uU(14,"Is Non Ressivable"),e.qZA(),e.TgZ(15,"th",33),e._uU(16,"Country of origin"),e.qZA(),e.TgZ(17,"th",32),e._uU(18,"Tariff Code / checked"),e.qZA(),e.TgZ(19,"th",32),e._uU(20,"Weight"),e.qZA()())}function wr(n,i){1&n&&e._UZ(0,"i",37)}function Nr(n,i){1&n&&e._UZ(0,"i",38)}function Ur(n,i){1&n&&e._UZ(0,"i",37)}function Pr(n,i){1&n&&e._UZ(0,"i",38)}function Fr(n,i){if(1&n&&(e.TgZ(0,"tr",34)(1,"td",29),e._uU(2),e.qZA(),e.TgZ(3,"td",30),e._uU(4),e.qZA(),e.TgZ(5,"td",31),e._uU(6),e.qZA(),e.TgZ(7,"td",32),e._uU(8),e.qZA(),e.TgZ(9,"td",32),e._uU(10),e.qZA(),e.TgZ(11,"td",32),e.YNc(12,wr,1,0,"i",35),e.YNc(13,Nr,1,0,"i",36),e.qZA(),e.TgZ(14,"td",32),e.YNc(15,Ur,1,0,"i",35),e.YNc(16,Pr,1,0,"i",36),e.qZA(),e.TgZ(17,"td",32),e._uU(18),e.qZA(),e.TgZ(19,"td",32),e._uU(20),e._UZ(21,"br"),e._uU(22),e.qZA(),e.TgZ(23,"td",32),e._uU(24),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(10*(r.currentPage-1)+o+1),e.xp6(2),e.Oqu(t.code),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(null==t.category?null:t.category.name),e.xp6(2),e.Oqu(t.accounting_number),e.xp6(2),e.Q6J("ngIf",t.is_fixed_asset),e.xp6(1),e.Q6J("ngIf",!t.is_fixed_asset),e.xp6(2),e.Q6J("ngIf",t.is_non_ressivable),e.xp6(1),e.Q6J("ngIf",!t.is_non_ressivable),e.xp6(2),e.Oqu(null==t.country_of_origin_default?null:t.country_of_origin_default.alpha2_code),e.xp6(2),e.hij(" ",t.tariff_code,""),e.xp6(2),e.hij(" ",t.tariff_code_checked," "),e.xp6(2),e.hij("",t.weight," kg")}}function Jr(n,i){1&n&&e._UZ(0,"i",42)}function kr(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Sr(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",39),e.YNc(2,Jr,1,0,"i",40),e.YNc(3,kr,2,0,"span",41),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",10),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function Qr(n,i){1&n&&(e.TgZ(0,"div",43),e._UZ(1,"i",42),e.qZA())}let W=class{constructor(i,t,o){this.fb=i,this.nomenclatureService=t,this.adapterService=o,this.searchForm=this.fb.group({name:[""],code:[""],categories:[""],order_by_accounting_number:[null],order_by_is_fixed_asset:[null],order_by_is_non_ressivable:[null],type:[0],accounting_number:[null],tariff_code:[""],tariff_code_checked:[""],weight:[""]}),this.currentPage=1,this.isStartFirstPage=!1,this.isLoading=!0,this.nomenclaturesCount=0,this.selectedNomenclature=null,this.queryKey=this.adapterService.generateQueryKey(this.searchForm),this.query=[],this.name$=new P.x,this.code$=new P.x,this.accountingNumber$=new P.x,this.tariffCode$=new P.x,this.search$=new he.X(null),this.nomenclatures$=this.search$.pipe((0,g.b)(()=>this.prepareForSearch()),(0,O.w)(()=>this.nomenclatureService.getForPagination(this.query).pipe((0,g.b)(r=>this.nomenclaturesCount=r.count),(0,y.U)(r=>r.results))),(0,g.b)(()=>this.paginateToFistPage()),(0,g.b)(()=>this.isLoading=!1),(0,C.t)(this))}ngOnInit(){this.name$.pipe((0,I.b)(150),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.code$.pipe((0,I.b)(150),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.accountingNumber$.pipe((0,I.b)(150),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.tariffCode$.pipe((0,I.b)(150),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe()}onSelectCategories(i){this.searchForm.get("categories").patchValue(i),this.search$.next()}prepareForSearch(){this.isLoading=!0,this.selectedNomenclature=null;const i=this.adapterService.generateQueryKey(this.searchForm);i!==this.queryKey&&(this.currentPage=1,this.queryKey=i,this.isStartFirstPage=!0),this.query=[{name:"page",value:this.currentPage},{name:"is_purchased_only",value:!0},{name:"paginated",value:!0}];for(const t in this.searchForm.controls)null!==this.searchForm.controls[t].value&&this.query.push({name:t,value:this.searchForm.controls[t].value})}paginateToFistPage(){this.isStartFirstPage&&this.paginator?.changePage(0),this.isStartFirstPage=!1}paginate(i){this.isStartFirstPage||(this.currentPage=i.page+1,this.search$.next())}onAddAccountingNumber(){this.nomenclatureService.addAccountingNumberDialog().pipe((0,R.h)(i=>!!i)).subscribe(()=>this.search$.next())}editNomenclatureAccountingNumber(){this.nomenclatureService.editNomenclatureAccountingNumber(this.selectedNomenclature).pipe((0,R.h)(i=>!!i)).subscribe(()=>this.search$.next())}};W.\u0275fac=function(i){return new(i||W)(e.Y36(s.qu),e.Y36(Ar.g),e.Y36(J.v))},W.\u0275cmp=e.Xpm({type:W,selectors:[["pek-reports-nomenclature-accounting-number"]],viewQuery:function(i,t){if(1&i&&e.Gf(qr,5),2&i){let o;e.iGM(o=e.CRH())&&(t.paginator=o.first)}},decls:49,vars:15,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-plus","label","Add Accounting Number to Category",3,"click"],[1,"page__content"],[1,"page__card"],[1,"form","mb-3",3,"formGroup"],[1,"row"],[1,"col-4"],[1,"form-group"],["for","name"],["id","name","type","text","pInputText","","formControlName","code",1,"form-control",3,"ngModelChange"],["type","text","pInputText","","formControlName","name",1,"form-control",3,"ngModelChange"],[3,"choiceCategories"],["type","text","pInputText","","formControlName","accounting_number",1,"form-control",3,"ngModelChange"],["type","text","pInputText","","formControlName","tariff_code",1,"form-control",3,"ngModelChange"],[1,"col-4","edit-button"],["pButton","","type","button","icon","pi pi-pencil","label","Edit Accounting Number",3,"disabled","click"],[1,"table-pagination-preloader"],["scrollHeight","calc(100vh - 30rem)","selectionMode","single",3,"rows","scrollable","value","selection","selectionChange"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","pagination-preloader pagination-preloader_bord",4,"ngIf"],[1,"paginator-wrapper"],[3,"rows","totalRecords","onPageChange"],["paginator",""],[1,"text-center",2,"width","5%"],[2,"width","10%"],[2,"width","25%"],[1,"text-center",2,"width","10%"],[1,"text-center","sort-label",2,"width","10%"],[3,"pSelectableRow"],["class","pi pi-check check-icon",4,"ngIf"],["class","pi pi-times times-icon",4,"ngIf"],[1,"pi","pi-check","check-icon"],[1,"pi","pi-times","times-icon"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],[1,"pagination-preloader","pagination-preloader_bord"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Nomenclature Accounting Number"),e.qZA()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return t.onAddAccountingNumber()}),e.qZA()()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"form",8)(11,"div",9)(12,"div",10)(13,"div",11)(14,"label",12),e._uU(15,"Code"),e.qZA(),e.TgZ(16,"input",13),e.NdJ("ngModelChange",function(){return t.code$.next()}),e.qZA()()(),e.TgZ(17,"div",10)(18,"div",11)(19,"label",12),e._uU(20,"Name"),e.qZA(),e.TgZ(21,"input",14),e.NdJ("ngModelChange",function(){return t.name$.next()}),e.qZA()()(),e.TgZ(22,"div",10)(23,"div",11)(24,"label"),e._uU(25,"Categories"),e.qZA(),e.TgZ(26,"pek-multi-categories-picker",15),e.NdJ("choiceCategories",function(r){return t.onSelectCategories(r)}),e.qZA()()(),e.TgZ(27,"div",10)(28,"div",11)(29,"label",12),e._uU(30,"Accounting Number"),e.qZA(),e.TgZ(31,"input",16),e.NdJ("ngModelChange",function(){return t.accountingNumber$.next()}),e.qZA()()(),e.TgZ(32,"div",10)(33,"div",11)(34,"label",12),e._uU(35,"Tariff Code"),e.qZA(),e.TgZ(36,"input",17),e.NdJ("ngModelChange",function(){return t.tariffCode$.next()}),e.qZA()()(),e.TgZ(37,"div",18)(38,"button",19),e.NdJ("click",function(){return t.editNomenclatureAccountingNumber()}),e.qZA()()()(),e.TgZ(39,"div",20)(40,"p-table",21),e.NdJ("selectionChange",function(r){return t.selectedNomenclature=r}),e.ALo(41,"async"),e.YNc(42,Rr,21,0,"ng-template",22),e.YNc(43,Fr,25,14,"ng-template",23),e.YNc(44,Sr,4,3,"ng-template",24),e.qZA(),e.YNc(45,Qr,2,0,"div",25),e.TgZ(46,"div",26)(47,"p-paginator",27,28),e.NdJ("onPageChange",function(r){return t.paginate(r)}),e.qZA()()()()()),2&i&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(7),e.Q6J("formGroup",t.searchForm),e.xp6(28),e.Q6J("disabled",!t.selectedNomenclature),e.xp6(2),e.Q6J("rows",10)("scrollable",!0)("value",e.lcZ(41,13,t.nomenclatures$))("selection",t.selectedNomenclature),e.xp6(5),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.ekj("paginator-wrapper_hide",0===t.nomenclaturesCount),e.xp6(1),e.Q6J("rows",10)("totalRecords",t.nomenclaturesCount))},dependencies:[m.O5,v.Hq,Z.jx,T.iA,T.Ei,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,A.D,Ae.D,Ir.M,m.Ov],styles:["form[_ngcontent-%COMP%]{margin-top:-.25rem}.check-icon[_ngcontent-%COMP%]{color:var(--theme-color-success)}.times-icon[_ngcontent-%COMP%]{color:var(--theme-color-danger)}.edit-button[_ngcontent-%COMP%]{display:flex}.edit-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto;margin-top:auto;margin-bottom:.5rem}"]}),W=(0,F.gn)([(0,C.c)()],W);var Mr=d(176);const Yr=["paginator"];function Or(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",15),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",16),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",16),e._uU(6,"Description"),e.qZA(),e.TgZ(7,"th",17),e._uU(8,"Accounting Number"),e.qZA()())}function Er(n,i){if(1&n&&(e.TgZ(0,"tr",18)(1,"td",19),e._uU(2),e.qZA(),e.TgZ(3,"td",16),e._uU(4),e.qZA(),e.TgZ(5,"td",16),e._uU(6),e.qZA(),e.TgZ(7,"td",17),e._uU(8),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description),e.xp6(2),e.Oqu(t.accounting_number)}}function Lr(n,i){1&n&&e._UZ(0,"i",23)}function Br(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Dr(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",20),e.YNc(2,Lr,1,0,"i",21),e.YNc(3,Br,2,0,"span",22),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",4),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function $r(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",24),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(11);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Gr(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",25)(1,"p-button",24),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(11);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let X=class{constructor(i){this.technologiesService=i,this.technologiesCount=0,this.isStartFirstPage=!1,this.isLoading=!0,this.technologies=[]}ngOnInit(){this.getTechnologies()}getTechnologies(){this.technologiesService.get().subscribe(i=>{this.technologies=i,this.isLoading=!1})}onEditTechnologyAccountingNumber(){this.technologiesService.editTechnologyAccountingNumber(this.selectedTechnology).pipe((0,R.h)(i=>!!i)).subscribe(i=>{const t=this.technologies.findIndex(o=>o.id===i.id);this.technologies[t].accounting_number=i.accounting_number})}};X.\u0275fac=function(i){return new(i||X)(e.Y36(Mr.$))},X.\u0275cmp=e.Xpm({type:X,selectors:[["pek-reports-technologies-accounting-number"]],viewQuery:function(i,t){if(1&i&&e.Gf(Yr,5),2&i){let o;e.iGM(o=e.CRH())&&(t.paginator=o.first)}},decls:17,vars:9,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"page__card"],[1,"edit-button"],["pButton","","type","button","icon","pi pi-pencil","label","Edit Accounting Number",3,"disabled","click"],["selectionMode","single","scrollHeight","calc(100vh - 19rem)",3,"rows","scrollable","paginator","value","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"index-header","text-center",2,"width","5%"],[2,"width","40%"],[1,"text-center",2,"width","15%"],[3,"pSelectableRow"],[1,"text-center",2,"width","5%"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Technologies Accounting Number"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"button",7),e.NdJ("click",function(){return t.onEditTechnologyAccountingNumber()}),e.qZA()(),e.TgZ(10,"p-table",8,9),e.NdJ("selectionChange",function(r){return t.selectedTechnology=r}),e.YNc(12,Or,9,0,"ng-template",10),e.YNc(13,Er,9,5,"ng-template",11),e.YNc(14,Dr,4,3,"ng-template",12),e.YNc(15,$r,2,0,"ng-template",13),e.qZA()(),e.YNc(16,Gr,3,0,"div",14),e.qZA()),2&i){const o=e.MAs(11);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(6),e.Q6J("disabled",!t.selectedTechnology),e.xp6(1),e.Q6J("rows",10)("scrollable",!0)("paginator",t.technologies.length>0)("value",t.technologies)("selection",t.selectedTechnology),e.xp6(6),e.Q6J("ngIf",!o.paginator&&!t.isLoading&&t.technologies.length>0)}},dependencies:[m.O5,v.Hq,v.zx,Z.jx,T.iA,T.Ei,A.D],styles:[".edit-button[_ngcontent-%COMP%]{display:flex;padding:.5rem 0;margin-bottom:.5rem!important;margin-top:-.25rem}.edit-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}"]}),X=(0,F.gn)([(0,C.c)()],X);var se=d(7896),Qe=d(1853),Ie=d(6106),w=d(6237);function jr(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",13)(1,"button",14),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onExpandAll())}),e.qZA(),e.TgZ(2,"button",15),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onCollapseAll())}),e.qZA(),e.TgZ(3,"button",16),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onEditAccountingNumber())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",!t.selectedNode)}}function Vr(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",17),e._uU(2,"Name"),e.qZA(),e.TgZ(3,"th",18),e._uU(4,"Description"),e.qZA(),e.TgZ(5,"th",19),e._uU(6,"Material"),e.qZA(),e.TgZ(7,"th",19),e._uU(8,"Accounting Number"),e.qZA()())}function Hr(n,i){if(1&n&&(e.TgZ(0,"tr",20)(1,"td",18)(2,"div",21),e._UZ(3,"p-treeTableToggler",22),e.TgZ(4,"span"),e._uU(5),e.qZA()()(),e.TgZ(6,"td",18),e._uU(7),e.qZA(),e.TgZ(8,"td",19),e._uU(9),e.qZA(),e.TgZ(10,"td",19),e._uU(11),e.qZA()()),2&n){const t=i.$implicit,o=i.rowData;e.Q6J("ttRow",t)("ttSelectableRow",t),e.xp6(3),e.Q6J("rowNode",t),e.xp6(2),e.Oqu(o.name),e.xp6(2),e.hij(" ",o.description," "),e.xp6(2),e.hij(" ",o.is_material?"Tangible":"Intangible"," "),e.xp6(2),e.hij(" ",o.accounting_number," ")}}function Kr(n,i){1&n&&e._UZ(0,"i",26)}function zr(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Wr(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",23),e.YNc(2,Kr,1,0,"i",24),e.YNc(3,zr,2,0,"span",25),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}let Xr=(()=>{class n{constructor(t,o){this.purchasingCategoryService=t,this.treeService=o,this.isLoading=!0,this.purchasingCategories=[],this.categoriesTree=[],this.expanseMap={},this.isSavingCategory=!1}ngOnInit(){this.getPurchasingCategory()}getPurchasingCategory(){this.purchasingCategoryService.getAll().subscribe(t=>{this.purchasingCategories=t,this.createTree(),this.isLoading=!1})}createTree(){this.categoriesTree&&this.treeService.mapExpansion(this.categoriesTree,this.expanseMap),this.categoriesTree=this.treeService.createTree(this.purchasingCategories,this.expanseMap)}onExpandAll(){const t=(0,se.Z)(this.categoriesTree);t.forEach(o=>{this.expandCollapseRecursive(o,!0)}),this.categoriesTree=t}onCollapseAll(){const t=(0,se.Z)(this.categoriesTree);t.forEach(o=>{this.expandCollapseRecursive(o,!1)}),this.categoriesTree=t}expandCollapseRecursive(t,o){t.expanded=o,t.children&&t.children.forEach(r=>{this.expandCollapseRecursive(r,o)})}onEditAccountingNumber(){this.purchasingCategoryService.editAccountingNumberCategory(this.selectedNode.data).subscribe(t=>{if(t){const o=this.purchasingCategories.findIndex(r=>r.id===t.id);this.purchasingCategories[o]=t,this.selectedNode=null,this.createTree()}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Qe.$),e.Y36(Ie.r))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-purchase-categories-accounting-number"]],decls:15,vars:5,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 19.2rem)",3,"value","selection","scrollable","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"d-flex"],["pButton","","type","button","icon","pi pi-angle-down","label","Expand All",1,"ml-auto","mr-2",3,"click"],["pButton","","type","button","icon","pi pi-angle-up","label","Collapse All",3,"click"],["pButton","","type","button","icon","pi pi-pencil","label","Edit Accounting Number",1,"ml-2",3,"disabled","click"],[2,"width","30%","padding-left","48px"],[2,"width","30%"],[1,"text-center",2,"width","20%"],[3,"ttRow","ttSelectableRow"],[1,"table-toggle"],[3,"rowNode"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Purchase Categories Accounting Number"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"p-treeTable",7,8),e.NdJ("selectionChange",function(a){return o.selectedNode=a}),e.YNc(11,jr,4,1,"ng-template",9),e.YNc(12,Vr,9,0,"ng-template",10),e.YNc(13,Hr,12,7,"ng-template",11),e.YNc(14,Wr,4,3,"ng-template",12),e.qZA()()()()()),2&t&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(6),e.Q6J("value",o.categoriesTree)("selection",o.selectedNode)("scrollable",!0))},dependencies:[m.O5,v.Hq,Z.jx,w.iw,w.gc,w.V4,w.e2,A.D]}),n})();var Me=d(3500);function ea(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",13)(1,"button",14),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onExpandAll())}),e.qZA(),e.TgZ(2,"button",15),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onCollapseAll())}),e.qZA(),e.TgZ(3,"button",16),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onEditAccountingNumber())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",!t.selectedNode)}}function ta(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",17),e._uU(2,"Name"),e.qZA(),e.TgZ(3,"th",18),e._uU(4,"Comment"),e.qZA(),e.TgZ(5,"th",19),e._uU(6,"Accounting Number"),e.qZA()())}function na(n,i){if(1&n&&(e.TgZ(0,"tr",20)(1,"td",21),e._UZ(2,"p-treeTableToggler",22),e._uU(3),e.qZA(),e.TgZ(4,"td",21),e._uU(5),e.qZA(),e.TgZ(6,"td",23),e._uU(7),e.qZA()()),2&n){const t=i.$implicit,o=i.rowData;e.Q6J("ttRow",t)("ttSelectableRow",t),e.xp6(2),e.Q6J("rowNode",t),e.xp6(1),e.hij(" ",o.name," "),e.xp6(2),e.hij(" ",o.comment," "),e.xp6(2),e.hij(" ",o.accounting_number," ")}}function oa(n,i){1&n&&e._UZ(0,"i",27)}function ia(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function ra(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",24),e.YNc(2,oa,1,0,"i",25),e.YNc(3,ia,2,0,"span",26),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",3),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}let aa=(()=>{class n{constructor(t,o){this.baseServicesService=t,this.treeService=o,this.isLoading=!0,this.baseServices=[],this.categoriesTree=[],this.expanseMap={}}ngOnInit(){this.getPurchasingCategory()}getPurchasingCategory(){this.baseServicesService.get().subscribe(t=>{this.baseServices=t,this.createTree(),this.isLoading=!1})}createTree(){this.categoriesTree&&this.treeService.mapExpansion(this.categoriesTree,this.expanseMap),this.categoriesTree=this.treeService.createTree(this.baseServices,this.expanseMap)}onExpandAll(){const t=(0,se.Z)(this.categoriesTree);t.forEach(o=>{this.expandCollapseRecursive(o,!0)}),this.categoriesTree=t}onCollapseAll(){const t=(0,se.Z)(this.categoriesTree);t.forEach(o=>{this.expandCollapseRecursive(o,!1)}),this.categoriesTree=t}expandCollapseRecursive(t,o){t.expanded=o,t.children&&t.children.forEach(r=>{this.expandCollapseRecursive(r,o)})}onEditAccountingNumber(){this.baseServicesService.editAccountingNumberCategory(this.selectedNode.data).subscribe(t=>{if(t){const o=this.baseServices.findIndex(r=>r.id===t.id);this.baseServices[o]=t,this.selectedNode=null,this.createTree()}})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Me.Q),e.Y36(Ie.r))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-auxiliary-invoices-accounting-number"]],decls:15,vars:5,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 19.2rem)",3,"value","selection","scrollable","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"d-flex"],["pButton","","type","button","icon","pi pi-angle-down","label","Expand All",1,"ml-auto","mr-2",3,"click"],["pButton","","type","button","icon","pi pi-angle-up","label","Collapse All",3,"click"],["pButton","","type","button","icon","pi pi-pencil","label","Edit Accounting Number",1,"ml-2",3,"disabled","click"],[2,"padding-left","48px","width","35%"],[1,"priority-2",2,"width","35%"],[1,"priority-2","text-center",2,"width","30%"],[3,"ttRow","ttSelectableRow"],[2,"width","35%"],[3,"rowNode"],[1,"text-center",2,"width","30%"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Auxiliary Invoices Accounting Number"),e.qZA()()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6)(9,"p-treeTable",7,8),e.NdJ("selectionChange",function(a){return o.selectedNode=a}),e.YNc(11,ea,4,1,"ng-template",9),e.YNc(12,ta,7,0,"ng-template",10),e.YNc(13,na,8,6,"ng-template",11),e.YNc(14,ra,4,3,"ng-template",12),e.qZA()()()()()),2&t&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(6),e.Q6J("value",o.categoriesTree)("selection",o.selectedNode)("scrollable",!0))},dependencies:[m.O5,v.Hq,Z.jx,w.iw,w.gc,w.V4,w.e2,A.D]}),n})(),ca=(()=>{class n{constructor(t,o,r,a){this.fb=t,this.accountingCategoriesService=o,this.dialogRef=r,this.data=a,this.isSaving=!1,this.form=this.fb.group({name:["",[s.kI.required]],accounting_number:[null]})}ngOnInit(){"edit"===this.data.type&&(this.form.addControl("id",new s.NI(this.data.category.id)),this.form.patchValue(this.data.category))}changeNumber(){const t=JSON.parse(JSON.stringify(this.form.get("accounting_number").value+""));t.length>8&&this.form.get("accounting_number").patchValue(t.slice(0,-1))}onSave(){switch(this.isSaving=!0,this.data.type){case"create":this.createCategory();break;case"edit":this.editCategory()}}createCategory(){this.accountingCategoriesService.createAccountingCategory(this.form.value).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}editCategory(){this.accountingCategoriesService.editAccountingCategory(this.form.value).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(ve),e.Y36(x.so),e.Y36(x.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-create-edit-accounting-category"]],decls:16,vars:6,consts:[[1,"modal-header"],[1,"modal-header__title"],[3,"formGroup"],[1,"form-group"],["for","name"],["type","text","id","name","pInputText","","formControlName","name"],["for","accounting-number"],["id","accounting-number","pInputText","","formControlName","accounting_number",3,"input"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button",1,"p-button-success",3,"label","loading","disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"form",2)(5,"div",3)(6,"label",4),e._uU(7,"Name*"),e.qZA(),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"div",3)(10,"label",6),e._uU(11,"Accounting Number"),e.qZA(),e.TgZ(12,"input",7),e.NdJ("input",function(){return o.changeNumber()}),e.qZA()()()(),e.TgZ(13,"mat-dialog-actions",8),e._UZ(14,"button",9),e.TgZ(15,"button",10),e.NdJ("click",function(){return o.onSave()}),e.qZA()()),2&t&&(e.xp6(2),e.hij(" ",o.data.type," Accounting Category "),e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(10),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("label",o.data.type)("loading",o.isSaving)("disabled",o.form.invalid))},dependencies:[v.Hq,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,x.ZT,x.xY,x.H8]}),n})();function sa(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",8),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedCategory=r)}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("options",t.categories)("ngModel",t.selectedCategory)("showClear",!0)("filter",!0)}}function la(n,i){1&n&&(e.TgZ(0,"div",9),e._UZ(1,"i",10),e.qZA())}let pa=(()=>{class n{constructor(t,o,r){this.accountingCategoriesService=t,this.dialogRef=o,this.data=r,this.isLoading=!0,this.categories=[]}ngOnInit(){this.getCategories()}getCategories(){this.accountingCategoriesService.get().pipe().subscribe(t=>{this.categories=t,this.data.category&&(this.selectedCategory=this.data.category),this.isLoading=!1})}onSelect(){this.dialogRef.close(this.selectedCategory)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(ve),e.Y36(x.so),e.Y36(x.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-accounting-category-picker"]],decls:11,vars:4,consts:[[1,"modal-header"],[1,"modal-header__title"],[1,"region-picker"],["placeholder","Select Accounting Category","optionLabel","name",3,"options","ngModel","showClear","filter","ngModelChange",4,"ngIf","ngIfElse"],["spinner",""],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button",1,"p-button-success",3,"label","click"],["placeholder","Select Accounting Category","optionLabel","name",3,"options","ngModel","showClear","filter","ngModelChange"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2," Choice Accounting Category "),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"div",2),e.YNc(5,sa,1,4,"p-dropdown",3),e.qZA(),e.YNc(6,la,2,0,"ng-template",null,4,e.W1O),e.qZA(),e.TgZ(8,"mat-dialog-actions",5),e._UZ(9,"button",6),e.TgZ(10,"button",7),e.NdJ("click",function(){return o.onSelect()}),e.qZA()()),2&t){const r=e.MAs(7);e.xp6(5),e.Q6J("ngIf",!o.isLoading)("ngIfElse",r),e.xp6(4),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("label","Choice Category")}},dependencies:[m.O5,v.Hq,s.JJ,x.ZT,x.xY,x.H8,de.Lt,s.On]}),n})(),ve=(()=>{class n{constructor(t,o){this.httpClient=t,this.dialog=o,this.API_URL=N.N.base_url+N.N.accounting_url,this.url="accounting_categories/"}getForPagination(t=[]){t.push({name:"paginated",value:!0});let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+this.url+o).pipe((0,y.U)(r=>r.data))}get(t=[]){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+this.url+o).pipe((0,y.U)(r=>r.data))}createAccountingCategory(t){return this.httpClient.post(this.API_URL+this.url,t).pipe((0,y.U)(o=>o.data))}editAccountingCategory(t){return this.httpClient.patch(this.API_URL+this.url+t.id+"/",t).pipe((0,y.U)(o=>o.data))}delete(t){return this.httpClient.delete(this.API_URL+this.url+t.id+"/")}createEditCurrencyModal(t,o){return this.dialog.open(ca,{width:"30rem",height:"auto",data:{type:t,category:o},autoFocus:!1,enterAnimationDuration:"250ms"}).afterClosed()}openAccountingCategoryPicker(t){return this.dialog.open(pa,{width:"30rem",height:"auto",data:{category:t},autoFocus:!1,enterAnimationDuration:"250ms",panelClass:"modal-overflow-visible"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG($.eN),e.LFG(x.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function _a(n,i){1&n&&(e.TgZ(0,"p",20),e._uU(1,"Choose the Accounting Category to edit"),e.qZA())}function ua(n,i){if(1&n&&(e.TgZ(0,"div",17),e.YNc(1,_a,2,0,"p",18),e._UZ(2,"p-menubar",19),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedCategory),e.xp6(1),e.ekj("disabled",!t.selectedCategory),e.Q6J("model",t.menuItems)}}function da(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",22),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",23),e._uU(6,"Accounting Number"),e.qZA()())}function ma(n,i){if(1&n&&(e.TgZ(0,"tr",24)(1,"td",21),e._uU(2),e.qZA(),e.TgZ(3,"td",22),e._uU(4),e.qZA(),e.TgZ(5,"td",23),e._uU(6),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(t.accounting_number)}}function ga(n,i){1&n&&e._UZ(0,"i",28)}function ha(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function fa(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",25),e.YNc(2,ga,1,0,"i",26),e.YNc(3,ha,2,0,"span",27),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function va(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",29),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(12);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Ca(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",30)(1,"p-button",29),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(12);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}let ee=class{constructor(i,t){this.accountingCategoriesService=i,this.modalService=t,this.menuItems=[{label:"Selected Accounting Category",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.onEditCategory()},{label:"Remove",icon:"pi pi-trash",command:()=>this.onRemoveCategory()}]}],this.categories=[],this.isLoading=!0}ngOnInit(){this.getCategories()}getCategories(){this.accountingCategoriesService.get().pipe((0,C.t)(this)).subscribe(i=>{this.categories=i,this.isLoading=!1})}onAddCategory(){this.accountingCategoriesService.createEditCurrencyModal("create").subscribe(i=>{i&&this.categories.unshift(i)})}onEditCategory(){this.accountingCategoriesService.createEditCurrencyModal("edit",this.selectedCategory).subscribe(i=>{if(i){const t=this.categories.findIndex(o=>o.id===this.selectedCategory.id);this.categories[t]=i,this.selectedCategory=this.categories[t]}})}onRemoveCategory(){this.modalService.confirm("danger").subscribe(i=>{i&&this.accountingCategoriesService.delete(this.selectedCategory).subscribe(()=>{const t=this.categories.findIndex(o=>o.id===this.selectedCategory.id);this.categories.splice(t,1),this.selectedCategory=null})})}};ee.\u0275fac=function(i){return new(i||ee)(e.Y36(ve),e.Y36(Y.Z))},ee.\u0275cmp=e.Xpm({type:ee,selectors:[["pek-reports-accounting-categories"]],decls:19,vars:8,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-plus","label","New Currency",3,"click"],[1,"page__content"],[1,"page__card"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[1,"d-flex"],["class","subtitle",4,"ngIf"],[1,"ml-auto",3,"model"],[1,"subtitle"],[1,"text-center",2,"width","5%"],[2,"width","70%"],[2,"width","25%"],[3,"pSelectableRow"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Accounting Categories"),e.qZA()(),e.TgZ(6,"div",4)(7,"button",5),e.NdJ("click",function(){return t.onAddCategory()}),e.qZA()()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"p-table",9,10),e.NdJ("selectionChange",function(r){return t.selectedCategory=r}),e.YNc(13,ua,3,4,"ng-template",11),e.YNc(14,da,7,0,"ng-template",12),e.YNc(15,ma,7,4,"ng-template",13),e.YNc(16,fa,4,3,"ng-template",14),e.YNc(17,va,2,0,"ng-template",15),e.qZA()(),e.YNc(18,Ca,3,0,"div",16),e.qZA()()),2&i){const o=e.MAs(12);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(8),e.Q6J("scrollable",!0)("paginator",t.categories.length>0)("rows",10)("selection",t.selectedCategory)("value",t.categories),e.xp6(7),e.Q6J("ngIf",!o.paginator&&!t.isLoading&&t.categories.length>0)}},dependencies:[m.O5,v.Hq,v.zx,k.nm,Z.jx,T.iA,T.Ei,A.D]}),ee=(0,F.gn)([(0,C.c)()],ee);var U=d(8746),Za=d(3442);function Ta(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",19)(1,"button",20),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onEditAccountingTypeCategory())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("loading",t.isSavingTypeCategory)("disabled",!t.selectedAccountingType)}}function xa(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",21),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",22),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",23),e._uU(6,"Accounting Category"),e.qZA()())}function ya(n,i){if(1&n&&(e.TgZ(0,"tr",24)(1,"td",21),e._uU(2),e.qZA(),e.TgZ(3,"td",25),e._uU(4),e.qZA(),e.TgZ(5,"td",26),e._uU(6),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.name),e.xp6(2),e.Oqu(null==t.accounting_category?null:t.accounting_category.name)}}function ba(n,i){1&n&&e._UZ(0,"i",30)}function Aa(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Ia(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",27),e.YNc(2,ba,1,0,"i",28),e.YNc(3,Aa,2,0,"span",29),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoadingAccountingTypes),e.xp6(1),e.Q6J("ngIf",!t.isLoadingAccountingTypes)}}function qa(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",31),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(11);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Ra(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",32)(1,"p-button",31),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(11);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function wa(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",19)(1,"button",33),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onExpandAll())}),e.qZA(),e.TgZ(2,"button",34),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onCollapseAll())}),e.qZA(),e.TgZ(3,"button",35),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onEditAccountingCategory())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("loading",t.isSavingCategory)("disabled",!t.selectedNode)}}function Na(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",36),e._uU(2,"Name"),e.qZA(),e.TgZ(3,"th",37),e._uU(4,"Description"),e.qZA(),e.TgZ(5,"th",38),e._uU(6,"Material"),e.qZA(),e.TgZ(7,"th",38),e._uU(8,"Accounting Category"),e.qZA()())}function Ua(n,i){if(1&n&&(e.TgZ(0,"tr",39)(1,"td",37)(2,"div",40),e._UZ(3,"p-treeTableToggler",41),e.TgZ(4,"span"),e._uU(5),e.qZA()()(),e.TgZ(6,"td",37),e._uU(7),e.qZA(),e.TgZ(8,"td",38),e._uU(9),e.qZA(),e.TgZ(10,"td",38),e._uU(11),e.qZA()()),2&n){const t=i.$implicit,o=i.rowData;e.Q6J("ttRow",t)("ttSelectableRow",t),e.xp6(3),e.Q6J("rowNode",t),e.xp6(2),e.Oqu(o.name),e.xp6(2),e.hij(" ",o.description," "),e.xp6(2),e.hij(" ",o.is_material?"Tangible":"Intangible"," "),e.xp6(2),e.hij(" ",null==o.accounting_category?null:o.accounting_category.name," ")}}function Pa(n,i){1&n&&e._UZ(0,"i",30)}function Fa(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Ja(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",27),e.YNc(2,Pa,1,0,"i",28),e.YNc(3,Fa,2,0,"span",29),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}let ka=(()=>{class n{constructor(t,o,r,a){this.purchasingCategoryService=t,this.accountingTypesService=o,this.accountingCategoriesService=r,this.treeService=a,this.tabIndex=0,this.accountingTypes=[],this.isLoadingAccountingTypes=!0,this.isLoading=!0,this.purchasingCategories=[],this.categoriesTree=[],this.isSavingCategory=!1,this.isSavingTypeCategory=!1,this.expanseMap={}}ngOnInit(){this.getPurchasingCategory(),this.getAccountingTypes()}getAccountingTypes(){this.accountingTypesService.getAccountingTypes().subscribe(t=>{this.accountingTypes=t,this.accountingTypes=this.accountingTypes.filter(o=>"Purchased"!==o.name),this.isLoadingAccountingTypes=!1,this.selectedAccountingType=null})}getPurchasingCategory(){this.purchasingCategoryService.getAll().subscribe(t=>{this.purchasingCategories=t,this.createTree(),this.isLoading=!1})}createTree(){this.categoriesTree&&this.treeService.mapExpansion(this.categoriesTree,this.expanseMap),this.categoriesTree=this.treeService.createTree(this.purchasingCategories,this.expanseMap)}onExpandAll(){const t=(0,se.Z)(this.categoriesTree);t.forEach(o=>{this.expandCollapseRecursive(o,!0)}),this.categoriesTree=t}onCollapseAll(){const t=(0,se.Z)(this.categoriesTree);t.forEach(o=>{this.expandCollapseRecursive(o,!1)}),this.categoriesTree=t}expandCollapseRecursive(t,o){t.expanded=o,t.children&&t.children.forEach(r=>{this.expandCollapseRecursive(r,o)})}onEditAccountingCategory(){this.accountingCategoriesService.openAccountingCategoryPicker(this.selectedNode.data.accounting_category).pipe((0,R.h)(t=>!1!==t)).subscribe(t=>{this.isSavingCategory=!0,this.purchasingCategoryService.update({accounting_category:t?.id??null},this.selectedNode.data.id).pipe((0,U.x)(()=>this.isSavingCategory=!1)).subscribe(r=>{const a=this.purchasingCategories.findIndex(l=>l.id===r.id);this.purchasingCategories[a].accounting_category=r.accounting_category,this.selectedNode=null,this.createTree()})})}onEditAccountingTypeCategory(){this.accountingCategoriesService.openAccountingCategoryPicker(this.selectedAccountingType.accounting_category).pipe((0,R.h)(t=>!1!==t)).subscribe(t=>{this.isSavingTypeCategory=!0,this.accountingTypesService.updateAccountingType({accounting_category:t?.id??null,id:this.selectedAccountingType.id}).pipe((0,U.x)(()=>this.isSavingTypeCategory=!1)).subscribe(r=>{const a=this.accountingTypes.findIndex(l=>l.id===r.id);this.accountingTypes[a].accounting_category=r.accounting_category,this.selectedNode=null,this.createTree()})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Qe.$),e.Y36(Za.f),e.Y36(ve),e.Y36(Ie.r))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-correlation"]],decls:26,vars:15,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"custom-tabs",3,"activeIndex","activeIndexChange"],[3,"header","selected"],[1,"page__table"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["st",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[3,"header"],["selectionMode","single","scrollHeight","calc(100vh - 22rem)",3,"value","selection","scrollable","selectionChange"],["dt",""],[1,"d-flex"],["pButton","","type","button","icon","pi pi-pencil","label","Edit Accounting Category",1,"ml-auto","p-button-icon",3,"loading","disabled","click"],[1,"text-center",2,"width","5%"],[2,"width","45%"],[2,"width","55%"],[3,"pSelectableRow"],[2,"width","25%"],[2,"width","35%"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],["pButton","","type","button","icon","pi pi-angle-down","label","Expand All",1,"ml-auto","mr-2",3,"click"],["pButton","","type","button","icon","pi pi-angle-up","label","Collapse All",3,"click"],["pButton","","type","button","icon","pi pi-pencil","label","Edit Accounting Category",1,"ml-2","p-button-icon",3,"loading","disabled","click"],[2,"width","30%","padding-left","48px"],[2,"width","30%"],[1,"text-center",2,"width","20%"],[3,"ttRow","ttSelectableRow"],[1,"table-toggle"],[3,"rowNode"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Correlation of Accounting Categories"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"p-tabView",5),e.NdJ("activeIndexChange",function(a){return o.tabIndex=a}),e.TgZ(8,"p-tabPanel",6)(9,"div",7)(10,"p-table",8,9),e.NdJ("selectionChange",function(a){return o.selectedAccountingType=a}),e.YNc(12,Ta,2,2,"ng-template",10),e.YNc(13,xa,7,0,"ng-template",11),e.YNc(14,ya,7,4,"ng-template",12),e.YNc(15,Ia,4,3,"ng-template",13),e.YNc(16,qa,2,0,"ng-template",14),e.qZA()(),e.YNc(17,Ra,3,0,"div",15),e.qZA(),e.TgZ(18,"p-tabPanel",16)(19,"div",7)(20,"p-treeTable",17,18),e.NdJ("selectionChange",function(a){return o.selectedNode=a}),e.YNc(22,wa,4,2,"ng-template",10),e.YNc(23,Na,9,0,"ng-template",11),e.YNc(24,Ua,12,7,"ng-template",12),e.YNc(25,Ja,4,3,"ng-template",13),e.qZA()()()()()),2&t){const r=e.MAs(11);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(4),e.Q6J("activeIndex",o.tabIndex),e.xp6(1),e.Q6J("header","Reports Accounting Types")("selected",!0),e.xp6(2),e.Q6J("scrollable",!0)("paginator",o.accountingTypes.length>0)("rows",10)("selection",o.selectedAccountingType)("value",o.accountingTypes),e.xp6(7),e.Q6J("ngIf",!r.paginator&&!o.isLoadingAccountingTypes&&o.accountingTypes.length>0),e.xp6(1),e.Q6J("header","Procurement Categories"),e.xp6(2),e.Q6J("value",o.categoriesTree)("selection",o.selectedNode)("scrollable",!0)}},dependencies:[m.O5,v.Hq,v.zx,Z.jx,T.iA,T.Ei,w.iw,w.gc,w.V4,w.e2,A.D,ae.xf,ae.x4]}),n})();var qe=d(4128),Ye=d(5757),Oe=d(4075),Sa=d(9512);function Qa(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-dropdown",2),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.number=r)})("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onChange(r))}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("filter",!0)("showClear",!0)("ngModel",t.number)("options",t.numbers)}}function Ma(n,i){1&n&&(e.TgZ(0,"div",3),e._UZ(1,"i",4),e.qZA())}let Ya=(()=>{class n{constructor(t){this.companyService=t,this.valueChange=new e.vpe,this.isLoading=!0,this.numbers=[]}ngOnInit(){this.companyService.getAccountingNumbers().pipe((0,g.b)(t=>this.numbers=t.map(o=>({id:o}))),(0,g.b)(()=>this.isLoading=!1)).subscribe()}writeValue(t){this.setValue(t)}registerOnChange(t){this.valueChange.subscribe(t)}registerOnTouched(t){}setValue(t){this.number=t,this.valueChange.emit(this.number)}onChange(t){this.setValue(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Se.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-accounting-number-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[e._Bn([{provide:s.JU,useExisting:(0,e.Gpc)(()=>n),multi:!0}])],decls:3,vars:2,consts:[["optionValue","id","optionLabel","id","placeholder","Choose Accounting Number",3,"filter","showClear","ngModel","options","ngModelChange",4,"ngIf","ngIfElse"],["spinner",""],["optionValue","id","optionLabel","id","placeholder","Choose Accounting Number",3,"filter","showClear","ngModel","options","ngModelChange"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(t,o){if(1&t&&(e.YNc(0,Qa,1,4,"p-dropdown",0),e.YNc(1,Ma,2,0,"ng-template",null,1,e.W1O)),2&t){const r=e.MAs(2);e.Q6J("ngIf",!o.isLoading)("ngIfElse",r)}},dependencies:[m.O5,s.JJ,de.Lt,s.On]}),n})();const Oa=["dt"],Ea=["st"];function La(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"h1"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.lnq("",t.invoicesHeader," (Total: ",t.totals.invoices," \u20ac / Pure Total: ",t.pureTotals.invoices," \u20ac)")}}function Ba(n,i){if(1&n&&(e.ynx(0),e.TgZ(1,"h1"),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.lnq("",t.invoicesProformaHeader," (Total: ",t.totals.proformasInvoices," \u20ac / Pure Total: ",t.pureTotals.proformasInvoices," \u20ac)")}}function Da(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",50),e.NdJ("click",function(r){e.CHM(t),e.oxw();const a=e.MAs(13);return e.KtG(a.toggle(r))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.isLoadingInvoices||t.allInvoices&&0===t.allInvoices.length||!t.allInvoices)("loading",t.isGenerating)}}function $a(n,i){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",50),e.NdJ("click",function(r){e.CHM(t),e.oxw();const a=e.MAs(13);return e.KtG(a.toggle(r))}),e.qZA(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.isLoadingProformaInvoices||t.allProformasInvoices&&0===t.allProformasInvoices.length||!t.allProformasInvoices)("loading",t.isGeneratingProforma)}}function Ga(n,i){1&n&&e._UZ(0,"div",51)}function ja(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",52),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",53)(4,"div",54),e._uU(5," Creation Date "),e._UZ(6,"p-sortIcon",55),e.qZA()(),e.TgZ(7,"th",56)(8,"div",54),e._uU(9," Invoice Date "),e._UZ(10,"p-sortIcon",57),e.qZA()(),e.TgZ(11,"th",58)(12,"div",54),e._uU(13," Invoice Reception "),e._UZ(14,"p-sortIcon",59),e.qZA()(),e.TgZ(15,"th",60)(16,"div",54),e._uU(17," Items Reception "),e._UZ(18,"p-sortIcon",61),e.qZA()(),e.TgZ(19,"th",62)(20,"div",54),e._uU(21," Invoice Number "),e._UZ(22,"p-sortIcon",63),e.qZA()(),e.TgZ(23,"th",64)(24,"div",54),e._uU(25," Company "),e._UZ(26,"p-sortIcon",65),e.qZA()(),e.TgZ(27,"th",66)(28,"div",54),e._uU(29," Supplier Serial Num "),e._UZ(30,"p-sortIcon",67),e.qZA()(),e.TgZ(31,"th",68)(32,"div",54),e._uU(33," Purchase Category "),e._UZ(34,"p-sortIcon",69),e.qZA()(),e.TgZ(35,"th",70)(36,"div",54),e._uU(37," Total Price "),e._UZ(38,"p-sortIcon",71),e.qZA()(),e.TgZ(39,"th",72)(40,"div",54),e._uU(41," Pure Total Price "),e._UZ(42,"p-sortIcon",73),e.qZA()(),e.TgZ(43,"th",74)(44,"div",54),e._uU(45," Other Currency "),e._UZ(46,"p-sortIcon",75),e.qZA()(),e.TgZ(47,"th",76)(48,"div",54),e._uU(49," Order ID "),e._UZ(50,"p-sortIcon",77),e.qZA()(),e.TgZ(51,"th",78)(52,"div",54),e._uU(53," Related "),e._UZ(54,"p-sortIcon",79),e.qZA()(),e.TgZ(55,"th",80)(56,"div",54),e._uU(57," Payment "),e._UZ(58,"p-sortIcon",81),e.qZA()(),e.TgZ(59,"th",82)(60,"div",54),e._uU(61," Payment Amount "),e._UZ(62,"p-sortIcon",83),e.qZA()(),e.TgZ(63,"th",84)(64,"div",54),e._uU(65," Completed "),e._UZ(66,"p-sortIcon",85),e.qZA()()())}function Va(n,i){1&n&&e._UZ(0,"i",96)}function Ha(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",e.lcZ(2,2,t.otherCurrency)," ",null==t.currency?null:t.currency.symbol," ")}}function Ka(n,i){1&n&&(e.TgZ(0,"i"),e._uU(1,","),e.qZA())}function za(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Ka,2,0,"i",4),e.qZA()),2&n){const t=i.$implicit,o=i.index,r=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t.self_serial_number,""),e.xp6(1),e.Q6J("ngIf",o!==r.proformas.length-1)}}function Wa(n,i){if(1&n&&(e.ynx(0),e.YNc(1,za,3,2,"span",97),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.proformas)}}function Xa(n,i){1&n&&(e.ynx(0),e._uU(1," Not Related"),e.BQk())}function ec(n,i){1&n&&e._UZ(0,"i",98)}function tc(n,i){1&n&&e._UZ(0,"i",99)}function nc(n,i){if(1&n&&(e.TgZ(0,"tr",86)(1,"td",87),e._uU(2),e.qZA(),e.TgZ(3,"td",88),e._uU(4),e.ALo(5,"date"),e.YNc(6,Va,1,0,"i",89),e.qZA(),e.TgZ(7,"td",90),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",90),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",90),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td",90),e._uU(17),e.qZA(),e.TgZ(18,"td",91),e._uU(19),e.qZA(),e.TgZ(20,"td",90),e._uU(21),e.qZA(),e.TgZ(22,"td",90),e._uU(23),e.qZA(),e.TgZ(24,"td",90),e._uU(25),e.ALo(26,"moneyFormat"),e.qZA(),e.TgZ(27,"td",90),e._uU(28),e.ALo(29,"moneyFormat"),e.qZA(),e.TgZ(30,"td",90),e.YNc(31,Ha,3,4,"ng-container",4),e.qZA(),e.TgZ(32,"td",92),e._uU(33),e.qZA(),e.TgZ(34,"td",93),e.YNc(35,Wa,2,1,"ng-container",4),e.YNc(36,Xa,2,0,"ng-container",4),e.qZA(),e.TgZ(37,"td",92),e._uU(38),e.ALo(39,"titlecase"),e.qZA(),e.TgZ(40,"td",90),e._uU(41),e.ALo(42,"number"),e.qZA(),e.TgZ(43,"td",92),e.YNc(44,ec,1,0,"i",94),e.YNc(45,tc,1,0,"i",95),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.hij("",e.xi3(5,21,t.system_creation_date,"dd/MM/yyyy")," "),e.xp6(2),e.Q6J("ngIf",t.related_files),e.xp6(2),e.Oqu(e.xi3(9,24,t.invoice_date,"dd/MM/yyyy")),e.xp6(3),e.Oqu(e.xi3(12,27,t.invoice_reception_date,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.xi3(15,30,t.items_reception_date,"dd/MM/yyyy")," "),e.xp6(3),e.Oqu(t.self_serial_number),e.xp6(2),e.hij("",t.supplier?t.supplier.name:""," "),e.xp6(2),e.Oqu(t.supplier_serial_number?t.supplier_serial_number:"None"),e.xp6(2),e.hij("",t.purchase_category?t.purchase_category.name:"None"," "),e.xp6(2),e.hij(" ",e.lcZ(26,33,t.total_price_converted)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(29,35,t.pure_total_price_converted)," \u20ac "),e.xp6(3),e.Q6J("ngIf","EUR"!==t.currency.code),e.xp6(2),e.Oqu(t.order?t.order.id:"Manual Invoice"),e.xp6(2),e.Q6J("ngIf",t.proformas.length>0),e.xp6(1),e.Q6J("ngIf",0===t.proformas.length),e.xp6(2),e.Oqu(e.lcZ(39,37,t.payment_status)),e.xp6(3),e.hij("",e.xi3(42,39,t.paid_interest?t.paid_interest:"0","1.2-2"),"% "),e.xp6(3),e.Q6J("ngIf",t.completed),e.xp6(1),e.Q6J("ngIf",!t.completed)}}function oc(n,i){1&n&&e._UZ(0,"i",102)}function ic(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function rc(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",100),e.YNc(2,oc,1,0,"i",101),e.YNc(3,ic,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoadingInvoices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingInvoices)}}function ac(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",103),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(114);return e.KtG(r.paginator=!1)}),e._uU(1," All "),e.qZA()}}function cc(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",104)(1,"p-button",103),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(114);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function sc(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",17)(1,"label"),e._uU(2,"Accounting Number"),e.qZA(),e.TgZ(3,"pek-accounting-number-picker",31),e.NdJ("ngModelChange",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.searchProforma$.next())}),e.qZA()()}}function lc(n,i){1&n&&e._UZ(0,"div",51)}function pc(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",52),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",53)(4,"div",54),e._uU(5," Creation Date "),e._UZ(6,"p-sortIcon",55),e.qZA()(),e.TgZ(7,"th",56)(8,"div",54),e._uU(9," Invoice Date "),e._UZ(10,"p-sortIcon",57),e.qZA()(),e.TgZ(11,"th",58)(12,"div",54),e._uU(13," Invoice Reception "),e._UZ(14,"p-sortIcon",59),e.qZA()(),e.TgZ(15,"th",60)(16,"div",54),e._uU(17," Items Reception "),e._UZ(18,"p-sortIcon",61),e.qZA()(),e.TgZ(19,"th",62)(20,"div",54),e._uU(21," Invoice Number "),e._UZ(22,"p-sortIcon",63),e.qZA()(),e.TgZ(23,"th",64)(24,"div",54),e._uU(25," Company "),e._UZ(26,"p-sortIcon",65),e.qZA()(),e.TgZ(27,"th",66)(28,"div",54),e._uU(29," Supplier Serial Num "),e._UZ(30,"p-sortIcon",67),e.qZA()(),e.TgZ(31,"th",68)(32,"div",54),e._uU(33," Purchase Category "),e._UZ(34,"p-sortIcon",69),e.qZA()(),e.TgZ(35,"th",70)(36,"div",54),e._uU(37," Total Price "),e._UZ(38,"p-sortIcon",71),e.qZA()(),e.TgZ(39,"th",72)(40,"div",54),e._uU(41," Pure Total Price "),e._UZ(42,"p-sortIcon",73),e.qZA()(),e.TgZ(43,"th",74)(44,"div",54),e._uU(45," Other Currency "),e._UZ(46,"p-sortIcon",75),e.qZA()(),e.TgZ(47,"th",76)(48,"div",54),e._uU(49," Order ID "),e._UZ(50,"p-sortIcon",77),e.qZA()(),e.TgZ(51,"th",78)(52,"div",54),e._uU(53," Related "),e._UZ(54,"p-sortIcon",79),e.qZA()(),e.TgZ(55,"th",80)(56,"div",54),e._uU(57," Payment "),e._UZ(58,"p-sortIcon",81),e.qZA()(),e.TgZ(59,"th",82)(60,"div",54),e._uU(61," Payment Amount "),e._UZ(62,"p-sortIcon",83),e.qZA()(),e.TgZ(63,"th",84)(64,"div",54),e._uU(65," Completed "),e._UZ(66,"p-sortIcon",85),e.qZA()()())}function _c(n,i){1&n&&e._UZ(0,"i",96)}function uc(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",e.lcZ(2,2,t.otherCurrency)," ",null==t.currency?null:t.currency.symbol," ")}}function dc(n,i){1&n&&(e.TgZ(0,"i"),e._uU(1,","),e.qZA())}function mc(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.YNc(2,dc,2,0,"i",4),e.qZA()),2&n){const t=i.$implicit,o=i.index,r=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t,""),e.xp6(1),e.Q6J("ngIf",o!==r.general_invoices.length-1)}}function gc(n,i){if(1&n&&(e.ynx(0),e.YNc(1,mc,3,2,"div",97),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.general_invoices)}}function hc(n,i){1&n&&(e.ynx(0),e._uU(1," Not Related"),e.BQk())}function fc(n,i){1&n&&e._UZ(0,"i",98)}function vc(n,i){1&n&&e._UZ(0,"i",99)}function Cc(n,i){if(1&n&&(e.TgZ(0,"tr",86)(1,"td",87),e._uU(2),e.qZA(),e.TgZ(3,"td",88),e._uU(4),e.ALo(5,"date"),e.YNc(6,_c,1,0,"i",89),e.qZA(),e.TgZ(7,"td",90),e._uU(8),e.ALo(9,"date"),e.qZA(),e.TgZ(10,"td",90),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",90),e._uU(14),e.ALo(15,"date"),e.qZA(),e.TgZ(16,"td",90),e._uU(17),e.qZA(),e.TgZ(18,"td",91),e._uU(19),e.qZA(),e.TgZ(20,"td",90),e._uU(21),e.qZA(),e.TgZ(22,"td",90),e._uU(23),e.qZA(),e.TgZ(24,"td",90),e._uU(25),e.ALo(26,"moneyFormat"),e.qZA(),e.TgZ(27,"td",90),e._uU(28),e.ALo(29,"moneyFormat"),e.qZA(),e.TgZ(30,"td",90),e.YNc(31,uc,3,4,"ng-container",4),e.qZA(),e.TgZ(32,"td",92),e._uU(33),e.qZA(),e.TgZ(34,"td",93),e.YNc(35,gc,2,1,"ng-container",4),e.YNc(36,hc,2,0,"ng-container",4),e.qZA(),e.TgZ(37,"td",92),e._uU(38),e.ALo(39,"titlecase"),e.qZA(),e.TgZ(40,"td",90),e._uU(41),e.ALo(42,"number"),e.qZA(),e.TgZ(43,"td",92),e.YNc(44,fc,1,0,"i",94),e.YNc(45,vc,1,0,"i",95),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex;e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.hij("",e.xi3(5,21,t.system_creation_date,"dd/MM/yyyy")," "),e.xp6(2),e.Q6J("ngIf",t.related_files),e.xp6(2),e.Oqu(e.xi3(9,24,t.invoice_date,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.xi3(12,27,t.invoice_reception_date,"dd/MM/yyyy")," "),e.xp6(3),e.hij("",e.xi3(15,30,t.items_reception_date,"dd/MM/yyyy")," "),e.xp6(3),e.Oqu(t.self_proforma_serial_number),e.xp6(2),e.hij("",t.supplier?t.supplier.name:""," "),e.xp6(2),e.Oqu(t.supplier_serial_number?t.supplier_serial_number:"None"),e.xp6(2),e.hij("",t.purchase_category?t.purchase_category.name:"None"," "),e.xp6(2),e.hij(" ",e.lcZ(26,33,t.total_price_converted)," \u20ac "),e.xp6(3),e.hij(" ",e.lcZ(29,35,t.pure_total_price_converted?t.pure_total_price_converted:0)," \u20ac "),e.xp6(3),e.Q6J("ngIf","EUR"!==t.currency.code),e.xp6(2),e.Oqu(t.order?t.order.id:"Manual Invoice"),e.xp6(2),e.Q6J("ngIf",t.general_invoices.length>0),e.xp6(1),e.Q6J("ngIf",0===t.general_invoices.length),e.xp6(2),e.Oqu(e.lcZ(39,37,t.payment_status)),e.xp6(3),e.hij("",e.xi3(42,39,t.paid_interest?t.paid_interest:"0","1.2-2"),"% "),e.xp6(3),e.Q6J("ngIf",t.completed),e.xp6(1),e.Q6J("ngIf",!t.completed)}}function Zc(n,i){1&n&&e._UZ(0,"i",102)}function Tc(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function xc(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",100),e.YNc(2,Zc,1,0,"i",101),e.YNc(3,Tc,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.isLoadingProformaInvoices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingProformaInvoices)}}function yc(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",103),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(211);return e.KtG(r.paginator=!1)}),e._uU(1," All "),e.qZA()}}function bc(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",104)(1,"p-button",103),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(211);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function Ac(n,i){1&n&&(e.TgZ(0,"div",105),e._UZ(1,"i",106),e.qZA())}let te=class{constructor(i,t,o,r,a,l){this.fb=i,this.columnFilterService=t,this.adapterService=o,this.invoiceService=r,this.serviceInvoiceService=a,this.modalService=l,this.isGenerating=!1,this.isGeneratingProforma=!1,this.reportItems=[{label:"XML",icon:"pi pi-file-edit",command:()=>this.generateXmlForAll()},{label:"Intrastat",icon:"pi pi-file-export",command:()=>this.generateIntrastatForAll()},{label:"Excel",icon:"pi pi-file-excel",command:()=>this.generateExel()}],this.tabIndex=0,this.menuItems=[{label:"Selected Invoice",items:[{label:"Go To Order",icon:"pi pi-angle-double-right",command:()=>this.onGoToOrder()},{label:"Files",icon:"pi pi-file",command:()=>this.onOpenFiles()},{label:"Edit",icon:"pi pi-pencil",command:()=>this.onEditInvoice()},{label:"Remove",icon:"pi pi-trash",command:()=>this.onRemoveInvoice()}]}],this.menuItemsProforma=[{label:"Selected Proforma Invoice",items:[{label:"Go To Order",icon:"pi pi-angle-double-right",command:()=>this.onGoToOrder()},{label:"Files",icon:"pi pi-file",command:()=>this.onOpenFiles()},{label:"Edit",icon:"pi pi-pencil",command:()=>this.onEditInvoice()},{label:"Remove",icon:"pi pi-trash",command:()=>this.onRemoveInvoice()}]}],this.invoicesTypes=[{value:!1,name:"Invoices"},{value:!0,name:"Auxiliary Invoices"}],this.searchForm=this.fb.group({supplier:[null],supplier_category:[null],system_creation_date_after:[null],system_creation_date_before:[null],invoice_reception_date_after:[null],invoice_reception_date_before:[null],items_reception_date_after:[null],items_reception_date_before:[null],invoice_date_after:[null],invoice_date_before:[null],has_related:[null],is_paid:[null],completed:[null],purchase_categories:[null],accounting_type:[null],material_or_service:[null],supplier__accounting_number:[null],service_accounting_number:[null],supplier_serial_number:[null],type:[null]}),this.searchFormProforma=this.fb.group({supplier:[null],supplier_category:[null],system_creation_date_after:[null],system_creation_date_before:[null],invoice_reception_date_after:[null],invoice_reception_date_before:[null],items_reception_date_after:[null],items_reception_date_before:[null],invoice_date_after:[null],invoice_date_before:[null],has_related:[null],is_paid:[null],completed:[null],purchase_categories:[null],accounting_type:[null],material_or_service:[null],supplier__accounting_number:[null],service_accounting_number:[null],supplier_serial_number:[null],type:[null]}),this.totals={invoices:0,proformasInvoices:0},this.pureTotals={invoices:0,proformasInvoices:0},this.accountingNumbers=[],this.search$=new P.x,this.searchProforma$=new P.x,this.allInvoices=[],this.allProformasInvoices=[],this.isLoadingInvoices=!1,this.isLoadingProformaInvoices=!1,this.isLoadingAccountingNumbers=!0,this.query=[],this.queryProforma=[],this.allInvoices$=this.search$.pipe((0,I.b)(150),(0,g.b)(()=>this.prepareForSearch()),(0,O.w)(()=>this.query.length>1?!1===this.searchForm.get("type").value?this.invoiceService.get(this.query).pipe((0,g.b)(p=>{this.allInvoices=p,this.allInvoices=this.getFields(this.allInvoices),this.allInvoices.sort((_,h)=>new Date(h.system_creation_date).getTime()-new Date(_.system_creation_date).getTime()),this.countTotals(this.allInvoices,"invoices"),this.isLoadingInvoices=!1}),(0,C.t)(this)):!0===this.searchForm.get("type").value?this.serviceInvoiceService.get(this.query).pipe((0,g.b)(p=>{this.allInvoices=p,this.allInvoices=this.getFields(this.allInvoices),this.allInvoices.forEach(_=>_.isAux=!0),this.allInvoices.sort((_,h)=>new Date(h.system_creation_date).getTime()-new Date(_.system_creation_date).getTime()),this.countTotals(this.allInvoices,"invoices"),this.isLoadingInvoices=!1}),(0,C.t)(this)):(0,qe.D)({invoices:this.invoiceService.get(this.query),serviceInvoices:this.serviceInvoiceService.get(this.query)}).pipe((0,g.b)(({invoices:p,serviceInvoices:_})=>{_=_.map(h=>(h.isAux=!0,h)),p=p.map(h=>(h.isAux=!1,h)),this.allInvoices=[...p,..._],this.allInvoices=this.getFields(this.allInvoices),this.allInvoices.sort((h,u)=>new Date(u.system_creation_date).getTime()-new Date(h.system_creation_date).getTime()),this.countTotals(this.allInvoices,"invoices"),this.isLoadingInvoices=!1}),(0,C.t)(this)):(0,me.of)([]).pipe((0,g.b)(()=>this.countTotals([],"invoices")),(0,g.b)(()=>this.isLoadingInvoices=!1))),(0,C.t)(this)),this.allInvoicesProforma$=this.searchProforma$.pipe((0,I.b)(150),(0,g.b)(()=>this.prepareForSearchProforma()),(0,O.w)(()=>this.queryProforma.length>1?!1===this.searchFormProforma.get("type").value?this.invoiceService.get(this.queryProforma).pipe((0,g.b)(p=>{this.allProformasInvoices=p,this.allProformasInvoices=this.getFields(this.allProformasInvoices),this.allProformasInvoices.sort((_,h)=>new Date(h.system_creation_date).getTime()-new Date(_.system_creation_date).getTime()),this.countTotals(this.allProformasInvoices,"proformasInvoices"),this.isLoadingProformaInvoices=!1}),(0,C.t)(this)):!0===this.searchFormProforma.get("type").value?this.serviceInvoiceService.get(this.queryProforma).pipe((0,g.b)(p=>{this.allProformasInvoices=p,this.allProformasInvoices.forEach(_=>_.isAux=!0),this.allProformasInvoices=this.getFields(this.allProformasInvoices),this.allProformasInvoices.sort((_,h)=>new Date(h.system_creation_date).getTime()-new Date(_.system_creation_date).getTime()),this.countTotals(this.allProformasInvoices,"proformasInvoices"),this.isLoadingProformaInvoices=!1}),(0,C.t)(this)):(0,qe.D)({invoices:this.invoiceService.get(this.queryProforma),serviceInvoices:this.serviceInvoiceService.get(this.queryProforma)}).pipe((0,g.b)(({invoices:p,serviceInvoices:_})=>{_=_.map(h=>(h.isAux=!0,h)),p=p.map(h=>(h.isAux=!1,h)),this.allProformasInvoices=[...p,..._],this.allProformasInvoices=this.getFields(this.allProformasInvoices),this.allProformasInvoices.sort((h,u)=>new Date(u.system_creation_date).getTime()-new Date(h.system_creation_date).getTime()),this.countTotals(this.allProformasInvoices,"proformasInvoices"),this.isLoadingProformaInvoices=!1}),(0,C.t)(this)):(0,me.of)([]).pipe((0,g.b)(()=>this.countTotals([],"proformasInvoices")),(0,g.b)(()=>this.isLoadingProformaInvoices=!1))),(0,C.t)(this))}countTotals(i,t){this.totals[t]=0,i.forEach(o=>{this.totals[t]+=o.total_price_converted}),this.pureTotals[t]=0,i.forEach(o=>{this.pureTotals[t]+=o.pure_total_price_converted}),this.totals[t]=this.adapterService.convertToMoneyFormat(this.totals[t]),this.pureTotals[t]=this.adapterService.convertToMoneyFormat(this.pureTotals[t])}get invoicesHeader(){let i="";return null===this.searchForm.get("type").value?i="All":this.searchForm.get("type").value&&(i="Auxiliary"),`${i} Invoices`}get invoicesProformaHeader(){let i="";return null===this.searchFormProforma.get("type").value?i="All":this.searchFormProforma.get("type").value&&(i="Auxiliary"),`${i} Proforma Invoices`}ngOnInit(){this.allInvoices$.pipe((0,C.t)(this)).subscribe(),this.allInvoicesProforma$.pipe((0,C.t)(this)).subscribe()}getFields(i){return i.map(t=>(t.otherCurrency="EUR"!==t.currency.code?t.total_price:null,t.is_proforma?(t.relatedStatus=0!==t.general_invoices.length,t.general_invoices&&t.general_invoices.forEach(o=>{(t.relatedId<o||!t.relatedId)&&(t.relatedId=o)})):(t.relatedStatus=0!==t.proformas.length,t.proformas&&t.proformas.forEach(o=>{(t.invoiceId<o||!t.invoiceId)&&(t.relatedId=o.id)})),t.paid_interest=parseFloat(t.paid_interest),t)),i}onSelectCompany(i){this.searchForm.get("supplier").patchValue(i),this.search$.next()}onSelectCategory(i){this.searchForm.get("supplier_category").patchValue(i),this.search$.next()}getPaidStatus(i){this.searchForm.get("is_paid").patchValue(i),this.search$.next()}getRelatedStatus(i){this.searchForm.get("has_related").patchValue(i),this.search$.next()}getCompletedStatus(i){this.searchForm.get("completed").patchValue(i),this.search$.next()}onSelectPurchasedCategories(i){this.searchForm.get("accounting_type").patchValue(null),this.searchForm.get("material_or_service").patchValue(null),i.forEach(t=>{"mp"===t?this.searchForm.get("accounting_type").patchValue(1):"ou"===t?this.searchForm.get("material_or_service").patchValue("material"):"os"===t&&this.searchForm.get("material_or_service").patchValue("service")}),i.find(t=>"ou"===t)&&i.find(t=>"os"===t)&&this.searchForm.get("material_or_service").patchValue("both"),i=i.filter(t=>"number"==typeof t),this.searchForm.get("purchase_categories").patchValue(i.join(",")),this.search$.next()}getServiceAccountingNumber(i,t){const o=i.target.value.replace(/\s/g,"");t?(o?this.searchFormProforma.get("service_accounting_number").patchValue(o):this.searchFormProforma.get("service_accounting_number").patchValue(null),this.searchProforma$.next()):(o?this.searchForm.get("service_accounting_number").patchValue(o):this.searchForm.get("service_accounting_number").patchValue(null),this.search$.next())}getSupplierSerialNumber(i){const t=i.target.value;this.searchForm.get("supplier_serial_number").patchValue(t),this.search$.next()}prepareForSearch(){this.dt._first=0,this.allInvoices=[],this.isLoadingInvoices=!0,this.query=[],this.query.push({name:"is_proforma",value:!1});for(const i in this.searchForm.controls)null!==this.searchForm.controls[i].value&&""!==this.searchForm.controls[i].value&&(this.searchForm.controls[i].value instanceof Date?this.query.push({name:i,value:this.adapterService.dateAdapter(this.searchForm.controls[i].value)}):this.query.push({name:i,value:this.searchForm.controls[i].value}))}prepareForSearchProforma(){this.st._first=0,this.allProformasInvoices=[],this.isLoadingProformaInvoices=!0,this.queryProforma=[],this.queryProforma.push({name:"is_proforma",value:!0});for(const i in this.searchFormProforma.controls)null!==this.searchFormProforma.controls[i].value&&""!==this.searchFormProforma.controls[i].value&&(this.searchFormProforma.controls[i].value instanceof Date?this.queryProforma.push({name:i,value:this.adapterService.dateAdapter(this.searchFormProforma.controls[i].value)}):this.queryProforma.push({name:i,value:this.searchFormProforma.controls[i].value}))}onApplyFilter(){this.invoiceService.openFilterModal().subscribe(i=>{i&&(0===this.tabIndex?this.searchForm.patchValue(i):this.searchFormProforma.patchValue(i))})}clearFilters(){0===this.tabIndex?this.searchForm.reset():this.searchFormProforma.reset()}onCreateAuxiliaryInvoice(){0===this.tabIndex?this.serviceInvoiceService.openCreateModal(!1).subscribe():this.serviceInvoiceService.openCreateModal(!0).subscribe()}onEditInvoice(){0===this.tabIndex?window.open("reports/invoices/"+(this.selectedInvoice.isAux?"service-invoice/"+this.selectedInvoice.id:"invoice/"+this.selectedInvoice.id),"_blank"):window.open("reports/invoices/"+(this.selectedProformaInvoice.isAux?"service-invoice/"+this.selectedProformaInvoice.id:"invoice/"+this.selectedProformaInvoice.id),"_blank")}onRemoveInvoice(){this.modalService.confirm("danger").subscribe(i=>{0===this.tabIndex?this.selectedInvoice.isAux?this.serviceInvoiceService.delete(this.selectedInvoice.id).subscribe(()=>{this.allInvoices=this.allInvoices.filter(t=>t.id!==this.selectedInvoice.id),this.selectedInvoice=null}):this.invoiceService.delete(this.selectedInvoice.id).subscribe(()=>{this.allInvoices=this.allInvoices.filter(t=>t.id!==this.selectedInvoice.id),this.selectedInvoice=null}):this.selectedProformaInvoice.isAux?this.serviceInvoiceService.delete(this.selectedProformaInvoice.id).subscribe(()=>{this.allProformasInvoices=this.allProformasInvoices.filter(t=>t.id!==this.selectedProformaInvoice.id),this.selectedProformaInvoice=null}):this.invoiceService.delete(this.selectedProformaInvoice.id).subscribe(()=>{this.allProformasInvoices=this.allProformasInvoices.filter(t=>t.id!==this.selectedProformaInvoice.id),this.selectedProformaInvoice=null})})}onGoToOrder(){0===this.tabIndex?this.selectedInvoice.order&&(1===this.selectedInvoice.order.accounting_type?window.open(`/procurement/chains/order/${this.selectedInvoice.order.id}`,"_blank"):2===this.selectedInvoice.order.accounting_type&&window.open(`/outsourcing/chains/order/${this.selectedInvoice.order.id}`,"_blank")):this.selectedProformaInvoice.order&&(1===this.selectedProformaInvoice.order.accounting_type?window.open(`/procurement/chains/order/${this.selectedProformaInvoice.order.id}`,"_blank"):2===this.selectedProformaInvoice.order.accounting_type&&window.open(`/outsourcing/chains/order/${this.selectedProformaInvoice.order.id}`,"_blank"))}onOpenFiles(){0===this.tabIndex?this.selectedInvoice.isAux?this.serviceInvoiceService.serviceInvoiceFiles(this.selectedInvoice).subscribe(i=>{i&&(this.selectedInvoice.related_files=!!i.invoiceLength)}):this.invoiceService.invoiceFiles(this.selectedInvoice).subscribe(i=>{i&&(this.selectedInvoice.related_files=!!i.invoiceLength)}):this.selectedProformaInvoice.isAux?this.serviceInvoiceService.serviceInvoiceFiles(this.selectedProformaInvoice).subscribe(i=>{i&&(this.selectedProformaInvoice.related_files=!!i.invoiceLength)}):this.invoiceService.invoiceFiles(this.selectedProformaInvoice).subscribe(i=>{i&&(this.selectedProformaInvoice.related_files=!!i.invoiceLength)})}onSelectCompanyProforma(i){this.searchFormProforma.get("supplier").patchValue(i),this.searchProforma$.next()}onSelectCategoryProforma(i){this.searchFormProforma.get("supplier_category").patchValue(i),this.searchProforma$.next()}getPaidStatusProforma(i){this.searchFormProforma.get("is_paid").patchValue(i),this.searchProforma$.next()}getRelatedStatusProforma(i){this.searchFormProforma.get("has_related").patchValue(i),this.searchProforma$.next()}getCompletedStatusProforma(i){this.searchFormProforma.get("completed").patchValue(i),this.searchProforma$.next()}onSelectPurchasedCategoriesProforma(i){this.searchFormProforma.get("accounting_type").patchValue(null),this.searchFormProforma.get("material_or_service").patchValue(null),i.forEach(t=>{"mp"===t?this.searchFormProforma.get("accounting_type").patchValue(1):"ou"===t?this.searchFormProforma.get("material_or_service").patchValue("material"):"os"===t&&this.searchFormProforma.get("material_or_service").patchValue("service")}),i.find(t=>"ou"===t)&&i.find(t=>"os"===t)&&this.searchFormProforma.get("material_or_service").patchValue("both"),i=i.filter(t=>"number"==typeof t),this.searchFormProforma.get("purchase_categories").patchValue(i.join(",")),this.searchProforma$.next()}generateExel(){this.invoiceService.generateExel(0===this.tabIndex?this.allInvoices:this.allProformasInvoices)}generateXmlForAll(){0===this.tabIndex?(this.isGenerating=!0,this.generateXML(this.allInvoices,this.dt._value)):(this.isGeneratingProforma=!0,this.generateXML(this.allProformasInvoices,this.st._value))}generateXmlNoDdvForAll(){0===this.tabIndex?(this.isGenerating=!0,this.generateNoDdvXML(this.allInvoices,this.dt._value)):(this.isGeneratingProforma=!0,this.generateNoDdvXML(this.allProformasInvoices,this.st._value))}generateIntrastatForAll(){0===this.tabIndex?(this.isGenerating=!0,this.generateIntrastatXML(this.allInvoices,this.dt._value)):(this.isGeneratingProforma=!0,this.generateIntrastatXML(this.allProformasInvoices,this.st._value))}generateIntrastatXML(i,t){t=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(i)),t.sort((a,l)=>new Date(a.invoice_date).getTime()-new Date(l.invoice_date).getTime()),i&&i.sort((a,l)=>new Date(a.invoice_date).getTime()-new Date(l.invoice_date).getTime());let o=[];o=i||t;const r=[];o.forEach(a=>{a.isAux||r.push({invoice_id:a.id})}),this.invoiceService.renderIntrastatXML(r).pipe((0,U.x)(()=>{this.isGenerating=!1,this.isGeneratingProforma=!1})).subscribe()}generateNoDdvXML(i,t){t=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(i)),t.sort((a,l)=>new Date(a.invoice_date).getTime()-new Date(l.invoice_date).getTime()),i&&i.sort((a,l)=>new Date(a.invoice_date).getTime()-new Date(l.invoice_date).getTime());let o=[];o=i||t;const r=[];o.forEach(a=>{r.push(a.isAux?{service_invoice_id:a.id}:{invoice_id:a.id})}),this.invoiceService.generateNoDdvXML(r).pipe((0,U.x)(()=>{this.isGenerating=!1,this.isGeneratingProforma=!1})).subscribe(a=>{this.invoiceService.downloadXmlFile(a,"no-ddv")})}generateXML(i,t){t=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(i)),t.sort((o,r)=>new Date(o.invoice_date).getTime()-new Date(r.invoice_date).getTime()),i&&i.sort((o,r)=>new Date(o.invoice_date).getTime()-new Date(r.invoice_date).getTime()),this.invoiceService.renderXML().subscribe(o=>{if(o){let r=[];r=i||t;const a=[];r.forEach(p=>{a.push(p.isAux?{service_invoice_id:p.id}:{invoice_id:p.id})});const l={start_number:parseInt(o,10),ids:a};this.invoiceService.generateXML(l).subscribe(p=>{this.invoiceService.downloadXmlFile(p),this.isGenerating=!1,this.isGeneratingProforma=!1},p=>{this.invoiceService.editInvoiceToGenerateXml(p).subscribe(_=>{_?this.repeatGenerateXML(i,t,o):(this.isGenerating=!1,this.isGeneratingProforma=!1)})})}})}repeatGenerateXML(i,t,o){let r=[];r=i||t;const a=[];r.forEach(p=>{a.push(p.isAux?{service_invoice_id:p.id}:{invoice_id:p.id})});const l={start_number:parseInt(o,10),ids:a};this.invoiceService.generateXML(l).subscribe(p=>{this.invoiceService.downloadXmlFile(p),this.isGenerating=!1,this.isGeneratingProforma=!1},p=>{this.invoiceService.editInvoiceToGenerateXml(p).subscribe(_=>{_?this.repeatGenerateXML(i,t,o):(this.isGenerating=!1,this.isGeneratingProforma=!1)})})}};te.\u0275fac=function(i){return new(i||te)(e.Y36(s.qu),e.Y36(pe.W),e.Y36(J.v),e.Y36(Ye.q),e.Y36(Oe.G),e.Y36(Y.Z))},te.\u0275cmp=e.Xpm({type:te,selectors:[["pek-reports-invoices"]],viewQuery:function(i,t){if(1&i&&(e.Gf(Oa,5),e.Gf(Ea,5)),2&i){let o;e.iGM(o=e.CRH())&&(t.dt=o.first),e.iGM(o=e.CRH())&&(t.st=o.first)}},decls:220,vars:97,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf"],[1,"page__tools"],["pButton","","type","button","icon","pi pi-plus","label","New Auxiliary Invoice",1,"ml-auto","p-button-icon","mr-2",3,"click"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Apply Filter",1,"mr-2",3,"click"],["pButton","","type","button","icon","pi pi-times","label","Clear Filter",1,"p-button-danger","mr-2",3,"click"],[3,"model","popup"],["menu",""],[1,"page__content"],[1,"custom-tabs",3,"activeIndex","activeIndexChange"],[3,"header","selected"],[1,"form","mb-2",3,"formGroup"],[1,"row"],[1,"col-2"],[1,"form-group"],[3,"currentCompanyId","selectCompany"],[3,"selectedCategoryId","selectCompanyCategory"],["formControlName","system_creation_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","system_creation_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["placeholder","Choice Type","optionValue","value","optionLabel","name","formControlName","type",3,"options","showClear","ngModelChange"],[1,"checkboxes"],[1,"checkbox"],[3,"filterValue","changeValue"],["formControlName","invoice_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","items_reception_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],[3,"withReportFilters","choiceCategories"],["formControlName","supplier__accounting_number",3,"ngModelChange"],["formControlName","invoice_date_after","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["formControlName","invoice_date_before","dateFormat","dd/mm/yy",3,"showButtonBar","readonlyInput","showClear","ngModelChange"],["pInputText","",3,"input"],[1,"col-4","menu-bar"],[1,"ml-auto",3,"model"],["selectionMode","single","scrollHeight","calc(100vh - 19rem)",3,"rows","scrollable","paginator","value","selection","selectionChange"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],[3,"header"],["class","form-group",4,"ngIf"],[1,"col-6","menu-bar"],["st",""],["loadingAccountingNumber",""],["type","button","pButton","","icon","pi pi-file","label","Generate Report",1,"p-button-icon",3,"disabled","loading","click"],[1,"table-header"],[1,"index-header","text-center",2,"width","3%"],["pSortableColumn","system_creation_date",2,"width","6%"],[1,"td-col"],["field","system_creation_date"],["pSortableColumn","invoice_date",1,"text-center",2,"width","6%"],["field","invoice_date"],["pSortableColumn","invoice_reception_date",1,"text-center",2,"width","6%"],["field","invoice_reception_date"],["pSortableColumn","items_reception_date",1,"text-center",2,"width","6%"],["field","items_reception_date"],["pSortableColumn","self_serial_number",1,"text-center",2,"width","6%"],["field","self_serial_number"],["pSortableColumn","supplier.name",2,"width","8%"],["field","supplier.name"],["pSortableColumn","supplier_serial_number",1,"text-center",2,"width","6%"],["field","supplier_serial_number"],["pSortableColumn","purchase_category",1,"text-center",2,"width","6%"],["field","purchase_category"],["pSortableColumn","total_price_converted",1,"text-center",2,"width","6%"],["field","total_price_converted"],["pSortableColumn","pure_total_price_converted",1,"text-center",2,"width","6%"],["field","pure_total_price_converted"],["pSortableColumn","otherCurrency",1,"text-center",2,"width","6%"],["field","otherCurrency"],["pSortableColumn","order.id",1,"text-center",2,"width","5%"],["field","order.id"],["pSortableColumn","relatedId",1,"text-center",2,"width","8%"],["field","relatedId"],["pSortableColumn","payment_status",1,"text-center",2,"width","5%"],["field","payment_status"],["pSortableColumn","paid_interest",1,"text-center",2,"width","6%"],["field","paid_interest"],["pSortableColumn","completed",1,"text-center",2,"width","5%"],["field","completed"],[1,"invoice-table-tr",3,"pSelectableRow"],[1,"text-center",2,"width","3%"],[2,"width","6%"],["class","pi pi-paperclip",4,"ngIf"],[1,"text-center",2,"width","6%"],[2,"width","8%"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","8%"],["class","pi pi-check text-success",4,"ngIf"],["class","pi pi-times-circle text-danger",4,"ngIf"],[1,"pi","pi-paperclip"],[4,"ngFor","ngForOf"],[1,"pi","pi-check","text-success"],[1,"pi","pi-times-circle","text-danger"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(i,t){if(1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.YNc(4,La,3,3,"ng-container",4),e.YNc(5,Ba,3,3,"ng-container",4),e.qZA(),e.TgZ(6,"div",5)(7,"button",6),e.NdJ("click",function(){return t.onCreateAuxiliaryInvoice()}),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return t.onApplyFilter()}),e.qZA(),e.TgZ(9,"button",8),e.NdJ("click",function(){return t.clearFilters()}),e.qZA(),e.YNc(10,Da,2,2,"ng-container",4),e.YNc(11,$a,2,2,"ng-container",4),e._UZ(12,"p-tieredMenu",9,10),e.qZA()()(),e.TgZ(14,"div",11)(15,"p-tabView",12),e.NdJ("activeIndexChange",function(r){return t.tabIndex=r}),e.TgZ(16,"p-tabPanel",13)(17,"form",14)(18,"div",15)(19,"div",16)(20,"div",17)(21,"label"),e._uU(22,"Company"),e.qZA(),e.TgZ(23,"pek-company-picker",18),e.NdJ("selectCompany",function(r){return t.onSelectCompany(r)}),e.qZA()()(),e.TgZ(24,"div",16)(25,"div",17)(26,"label"),e._uU(27,"Company Category"),e.qZA(),e.TgZ(28,"pek-company-category-picker",19),e.NdJ("selectCompanyCategory",function(r){return t.onSelectCategory(r)}),e.qZA()()(),e.TgZ(29,"div",16)(30,"div",17)(31,"label"),e._uU(32,"Creation From"),e.qZA(),e.TgZ(33,"p-calendar",20),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(34,"div",16)(35,"div",17)(36,"label"),e._uU(37,"Creation To"),e.qZA(),e.TgZ(38,"p-calendar",21),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(39,"div",16)(40,"div",17)(41,"label"),e._uU(42,"Type"),e.qZA(),e.TgZ(43,"p-dropdown",22),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(44,"div",16)(45,"div",23)(46,"div",24)(47,"div",17)(48,"label"),e._uU(49,"Related"),e.qZA(),e.TgZ(50,"pek-input-three-values",25),e.NdJ("changeValue",function(r){return t.getRelatedStatus(r)}),e.qZA()()(),e.TgZ(51,"div",24)(52,"div",17)(53,"label"),e._uU(54,"Payment"),e.qZA(),e.TgZ(55,"pek-input-three-values",25),e.NdJ("changeValue",function(r){return t.getPaidStatus(r)}),e.qZA()()(),e.TgZ(56,"div",24)(57,"div",17)(58,"label"),e._uU(59,"Completed"),e.qZA(),e.TgZ(60,"pek-input-three-values",25),e.NdJ("changeValue",function(r){return t.getCompletedStatus(r)}),e.qZA()()()()(),e.TgZ(61,"div",16)(62,"div",17)(63,"label"),e._uU(64,"Invoice Recieved From"),e.qZA(),e.TgZ(65,"p-calendar",26),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(66,"div",16)(67,"div",17)(68,"label"),e._uU(69,"Invoice Recieved To"),e.qZA(),e.TgZ(70,"p-calendar",27),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(71,"div",16)(72,"div",17)(73,"label"),e._uU(74,"Items Recieved From"),e.qZA(),e.TgZ(75,"p-calendar",28),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(76,"div",16)(77,"div",17)(78,"label"),e._uU(79,"Items Recieved To"),e.qZA(),e.TgZ(80,"p-calendar",29),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(81,"div",16)(82,"div",17)(83,"label"),e._uU(84,"Purchase Category"),e.qZA(),e.TgZ(85,"pek-multi-purchase-category-picker",30),e.NdJ("choiceCategories",function(r){return t.onSelectPurchasedCategories(r)}),e.qZA()()(),e.TgZ(86,"div",16)(87,"div",17)(88,"label"),e._uU(89,"Accounting Number"),e.qZA(),e.TgZ(90,"pek-accounting-number-picker",31),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(91,"div",16)(92,"div",17)(93,"label"),e._uU(94,"Invoice Date From"),e.qZA(),e.TgZ(95,"p-calendar",32),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(96,"div",16)(97,"div",17)(98,"label"),e._uU(99,"Invoice Date To"),e.qZA(),e.TgZ(100,"p-calendar",33),e.NdJ("ngModelChange",function(){return t.search$.next()}),e.qZA()()(),e.TgZ(101,"div",16)(102,"div",17)(103,"label"),e._uU(104,"Service Accounting Number"),e.qZA(),e.TgZ(105,"input",34),e.NdJ("input",function(r){return t.getServiceAccountingNumber(r,!1)}),e.qZA()()(),e.TgZ(106,"div",16)(107,"div",17)(108,"label"),e._uU(109,"Supplier Serial Number"),e.qZA(),e.TgZ(110,"input",34),e.NdJ("input",function(r){return t.getSupplierSerialNumber(r)}),e.qZA()()(),e.TgZ(111,"div",35),e._UZ(112,"p-menubar",36),e.qZA()()(),e.TgZ(113,"p-table",37,38),e.NdJ("selectionChange",function(r){return t.selectedInvoice=r}),e.YNc(115,Ga,1,0,"ng-template",39),e.YNc(116,ja,67,0,"ng-template",40),e.YNc(117,nc,46,42,"ng-template",41),e.YNc(118,rc,4,3,"ng-template",42),e.YNc(119,ac,2,0,"ng-template",43),e.qZA(),e.YNc(120,cc,3,0,"div",44),e.qZA(),e.TgZ(121,"p-tabPanel",45)(122,"form",14)(123,"div",15)(124,"div",16)(125,"div",17)(126,"label"),e._uU(127,"Company"),e.qZA(),e.TgZ(128,"pek-company-picker",18),e.NdJ("selectCompany",function(r){return t.onSelectCompanyProforma(r)}),e.qZA()()(),e.TgZ(129,"div",16)(130,"div",17)(131,"label"),e._uU(132,"Company Category"),e.qZA(),e.TgZ(133,"pek-company-category-picker",19),e.NdJ("selectCompanyCategory",function(r){return t.onSelectCategoryProforma(r)}),e.qZA()()(),e.TgZ(134,"div",16)(135,"div",17)(136,"label"),e._uU(137,"Creation From"),e.qZA(),e.TgZ(138,"p-calendar",20),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(139,"div",16)(140,"div",17)(141,"label"),e._uU(142,"Creation To"),e.qZA(),e.TgZ(143,"p-calendar",21),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(144,"div",16)(145,"div",17)(146,"label"),e._uU(147,"Type"),e.qZA(),e.TgZ(148,"p-dropdown",22),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(149,"div",16)(150,"div",23)(151,"div",24)(152,"div",17)(153,"label"),e._uU(154,"Related"),e.qZA(),e.TgZ(155,"pek-input-three-values",25),e.NdJ("changeValue",function(r){return t.getRelatedStatusProforma(r)}),e.qZA()()(),e.TgZ(156,"div",24)(157,"div",17)(158,"label"),e._uU(159,"Payment"),e.qZA(),e.TgZ(160,"pek-input-three-values",25),e.NdJ("changeValue",function(r){return t.getPaidStatusProforma(r)}),e.qZA()()(),e.TgZ(161,"div",24)(162,"div",17)(163,"label"),e._uU(164,"Completed"),e.qZA(),e.TgZ(165,"pek-input-three-values",25),e.NdJ("changeValue",function(r){return t.getCompletedStatusProforma(r)}),e.qZA()()()()(),e.TgZ(166,"div",16)(167,"div",17)(168,"label"),e._uU(169,"Invoice Recieved From"),e.qZA(),e.TgZ(170,"p-calendar",26),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(171,"div",16)(172,"div",17)(173,"label"),e._uU(174,"Invoice Recieved To"),e.qZA(),e.TgZ(175,"p-calendar",27),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(176,"div",16)(177,"div",17)(178,"label"),e._uU(179,"Items Recieved From"),e.qZA(),e.TgZ(180,"p-calendar",28),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(181,"div",16)(182,"div",17)(183,"label"),e._uU(184,"Items Recieved To"),e.qZA(),e.TgZ(185,"p-calendar",29),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(186,"div",16)(187,"div",17)(188,"label"),e._uU(189,"Purchase Category"),e.qZA(),e.TgZ(190,"pek-multi-purchase-category-picker",30),e.NdJ("choiceCategories",function(r){return t.onSelectPurchasedCategoriesProforma(r)}),e.qZA()()(),e.TgZ(191,"div",16),e.YNc(192,sc,4,0,"div",46),e.qZA(),e.TgZ(193,"div",16)(194,"div",17)(195,"label"),e._uU(196,"Invoice Date From"),e.qZA(),e.TgZ(197,"p-calendar",32),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(198,"div",16)(199,"div",17)(200,"label"),e._uU(201,"Invoice Date To"),e.qZA(),e.TgZ(202,"p-calendar",33),e.NdJ("ngModelChange",function(){return t.searchProforma$.next()}),e.qZA()()(),e.TgZ(203,"div",16)(204,"div",17)(205,"label"),e._uU(206,"Service Accounting Number"),e.qZA(),e.TgZ(207,"input",34),e.NdJ("input",function(r){return t.getServiceAccountingNumber(r,!0)}),e.qZA()()(),e.TgZ(208,"div",47),e._UZ(209,"p-menubar",36),e.qZA()()(),e.TgZ(210,"p-table",37,48),e.NdJ("selectionChange",function(r){return t.selectedProformaInvoice=r}),e.YNc(212,lc,1,0,"ng-template",39),e.YNc(213,pc,67,0,"ng-template",40),e.YNc(214,Cc,46,42,"ng-template",41),e.YNc(215,xc,4,3,"ng-template",42),e.YNc(216,yc,2,0,"ng-template",43),e.qZA(),e.YNc(217,bc,3,0,"div",44),e.qZA()()(),e.YNc(218,Ac,2,0,"ng-template",null,49,e.W1O)),2&i){const o=e.MAs(114),r=e.MAs(211);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(1),e.Q6J("ngIf",0===t.tabIndex),e.xp6(1),e.Q6J("ngIf",1===t.tabIndex),e.xp6(5),e.Q6J("ngIf",0===t.tabIndex),e.xp6(1),e.Q6J("ngIf",1===t.tabIndex),e.xp6(1),e.Q6J("model",t.reportItems)("popup",!0),e.xp6(3),e.Q6J("activeIndex",t.tabIndex),e.xp6(1),e.Q6J("header",t.invoicesHeader)("selected",!0),e.xp6(1),e.Q6J("formGroup",t.searchForm),e.xp6(6),e.Q6J("currentCompanyId",t.searchForm.get("supplier").value),e.xp6(5),e.Q6J("selectedCategoryId",t.searchForm.get("supplier_category").value),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("options",t.invoicesTypes)("showClear",!0),e.xp6(7),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchForm.get("has_related").value)),e.xp6(5),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchForm.get("is_paid").value)),e.xp6(5),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchForm.get("completed").value)),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("withReportFilters",!0),e.xp6(10),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(12),e.ekj("disabled",!t.selectedInvoice),e.Q6J("model",t.menuItems),e.xp6(1),e.Q6J("rows",10)("scrollable",!0)("paginator",t.allInvoices.length>0)("value",t.allInvoices)("selection",t.selectedInvoice),e.xp6(7),e.Q6J("ngIf",!o.paginator&&!t.isLoadingInvoices&&t.allInvoices.length>0),e.xp6(1),e.Q6J("header",t.invoicesProformaHeader),e.xp6(1),e.Q6J("formGroup",t.searchFormProforma),e.xp6(6),e.Q6J("currentCompanyId",t.searchFormProforma.get("supplier").value),e.xp6(5),e.Q6J("selectedCategoryId",t.searchFormProforma.get("supplier_category").value),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("options",t.invoicesTypes)("showClear",!0),e.xp6(7),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchFormProforma.get("has_related").value)),e.xp6(5),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchFormProforma.get("is_paid").value)),e.xp6(5),e.Q6J("filterValue",t.columnFilterService.getFilterValue(t.searchFormProforma.get("completed").value)),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("withReportFilters",!0),e.xp6(2),e.Q6J("ngIf",t.tabIndex),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("showButtonBar",!0)("readonlyInput",!0)("showClear",!0),e.xp6(7),e.ekj("disabled",!t.selectedProformaInvoice),e.Q6J("model",t.menuItemsProforma),e.xp6(1),e.Q6J("rows",10)("scrollable",!0)("paginator",t.allProformasInvoices.length>0)("value",t.allProformasInvoices)("selection",t.selectedProformaInvoice),e.xp6(7),e.Q6J("ngIf",!r.paginator&&!t.isLoadingProformaInvoices&&t.allProformasInvoices.length>0)}},dependencies:[m.sg,m.O5,v.Hq,v.zx,k.nm,Z.jx,T.iA,T.lQ,T.Ei,T.fz,S.o,s._Y,s.JJ,s.JL,s.sg,s.u,de.Lt,A.D,ae.xf,ae.x4,Sa.yp,L.f,B.i,re.E,fe.r,_e.x,Ya,m.JJ,m.rS,m.uU,M.U],styles:[".table-header[_ngcontent-%COMP%]{display:flex;align-items:center}.table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:500;font-size:1.125rem}.form[_ngcontent-%COMP%]{margin-top:-.25rem}.checkboxes[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:.5rem}.checkboxes[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.checkboxes[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex-direction:column;align-items:center;justify-content:center}.td-col[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.825rem;justify-content:center;text-align:center}.invoice-table-tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.825rem!important}.menu-bar[_ngcontent-%COMP%]{display:flex;align-items:flex-end;padding-bottom:.5rem}"]}),te=(0,F.gn)([(0,C.c)()],te);var Ee=d(6195),Ic=d(9384),Re=d(1989),qc=d(6186);function Rc(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-treeSelect",3),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedService=r)})("ngModelChange",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onChoiceService())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("filter",!0)("options",t.servicesTree)("ngModel",t.selectedService)("showClear",!0)}}function wc(n,i){1&n&&(e.TgZ(0,"div",4),e._UZ(1,"i",5),e.qZA())}let Nc=(()=>{class n{constructor(t){this.baseServicesService=t,this.choiceService=new e.vpe,this.isLoading=!0,this.services=[],this.servicesTree=[]}ngOnInit(){this.baseServicesService.get().subscribe(t=>{this.services=t,this.createTree(),this.findService(),this.isLoading=!1})}findService(){const t=o=>{o.forEach(r=>{r.data.id!==this.currentServiceId?r.children.length>0&&t(r.children):this.selectedService=r})};t(this.servicesTree)}createTree(){const t=r=>{r.forEach(a=>{const l=this.services.filter(p=>p.parent===a.data.id);l.length>0&&(a.children=l.map(p=>({label:p.name,data:p,children:[]})),t(a.children))})},o=this.services.filter(r=>!r.parent).map(r=>({label:r.name,data:r,children:[]}));t(o),this.servicesTree=[...o]}onChoiceService(){this.selectedService||(this.selectedService=null),this.choiceService.emit(this.selectedService?.data?.id??null)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Me.Q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-base-service-picker"]],inputs:{currentServiceId:"currentServiceId"},outputs:{choiceService:"choiceService"},decls:4,vars:2,consts:[[1,"base-service-picker"],["selectionMode","single","placeholder","Choice Service Name",3,"filter","options","ngModel","showClear","ngModelChange",4,"ngIf","ngIfElse"],["spinner",""],["selectionMode","single","placeholder","Choice Service Name",3,"filter","options","ngModel","showClear","ngModelChange"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,Rc,1,4,"p-treeSelect",1),e.YNc(2,wc,2,0,"ng-template",null,2,e.W1O),e.qZA()),2&t){const r=e.MAs(3);e.xp6(1),e.Q6J("ngIf",!o.isLoading)("ngIfElse",r)}},dependencies:[m.O5,s.JJ,s.On,qc.mP]}),n})(),Uc=(()=>{class n{constructor(t,o,r,a){this.fb=t,this.servicesService=o,this.dialogRef=r,this.data=a,this.isSaving=!1,this.form=this.fb.group({base_service:[null,[s.kI.required]],ddv:[22,[s.kI.required,s.kI.min(0)]],discount:[0,[s.kI.required,s.kI.min(0)]],fixed_discount:[!1],invoice:[this.data.invoiceId],pure_price:[0,[s.kI.required,s.kI.min(0)]]})}ngOnInit(){"edit"===this.data.type&&(this.form.addControl("id",this.fb.control(this.data.service.id)),this.data.service.discount=Math.round(100*this.data.service.discount)/100,this.form.patchValue(this.data.service),this.form.get("base_service").patchValue(this.data.service.base_service.id))}onSave(){switch(this.isSaving=!0,this.data.type){case"create":this.createInvoiceService();break;case"edit":this.editInvoiceService()}}createInvoiceService(){const t=this.form.value;"service"===this.data.invoiceType&&(delete t.invoice,t.service_invoice=this.data.invoiceId),this.servicesService.create(t).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}editInvoiceService(){this.servicesService.updatePartly(this.form.value).subscribe({next:o=>this.dialogRef.close(o),error:()=>this.isSaving=!1})}onSelectService(t){this.form.get("base_service").patchValue(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(we),e.Y36(x.so),e.Y36(x.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-create-edit-invoice-service"]],decls:34,vars:8,consts:[[1,"modal-header"],[1,"modal-header__title"],[3,"formGroup"],[1,"row"],[1,"col-12"],[1,"form-group"],["for","name"],[3,"currentServiceId","choiceService"],["for","total_price"],["pInputText","","formControlName","pure_price","step","0.1","type","number","id","total_price","required","required"],[1,"col-6"],["for","discount"],["pInputText","","formControlName","discount","type","number","step","0.1","id","discount","required","required"],[1,"d-block"],["formControlName","fixed_discount","inputId","binary",3,"binary"],["for","ddv"],["pInputText","","formControlName","ddv","type","number","step","0.1","id","ddv"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],["pButton","","type","button",1,"p-button-success",3,"label","loading","disabled","click"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"form",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"label",6),e._uU(9,"Service*"),e.qZA(),e.TgZ(10,"pek-base-service-picker",7),e.NdJ("choiceService",function(a){return o.onSelectService(a)}),e.qZA()()(),e.TgZ(11,"div",4)(12,"div",5)(13,"label",8),e._uU(14," Price* "),e.qZA(),e._UZ(15,"input",9),e.qZA()(),e.TgZ(16,"div",10)(17,"div",5)(18,"label",11),e._uU(19," Discount* "),e.qZA(),e._UZ(20,"input",12),e.qZA()(),e.TgZ(21,"div",10)(22,"div",5)(23,"label",13),e._uU(24," Fixed Discount "),e.qZA(),e._UZ(25,"p-checkbox",14),e.qZA()(),e.TgZ(26,"div",4)(27,"div",5)(28,"label",15),e._uU(29," DDV* "),e.qZA(),e._UZ(30,"input",16),e.qZA()()()()(),e.TgZ(31,"mat-dialog-actions",17),e._UZ(32,"button",18),e.TgZ(33,"button",19),e.NdJ("click",function(){return o.onSave()}),e.qZA()()),2&t&&(e.xp6(2),e.hij(" ",o.data.type," Invoice Service "),e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(6),e.Q6J("currentServiceId",+o.form.get("base_service").value),e.xp6(15),e.Q6J("binary",!0),e.xp6(7),e.Q6J("mat-dialog-close",!1),e.xp6(1),e.Q6J("label",o.data.type)("loading",o.isSaving)("disabled",o.form.invalid))},dependencies:[v.Hq,S.o,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.sg,s.u,x.ZT,x.xY,x.H8,Re.XZ,Nc]}),n})(),we=(()=>{class n{constructor(t,o){this.http=t,this.dialog=o,this.API_URL=N.N.base_url+N.N.procurement_url,this.url="services/"}get(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.http.get(this.API_URL+this.url+o).pipe((0,y.U)(r=>r.data))}get_files(t){return this.http.get(this.API_URL+"payment_files/"+t+"/").pipe((0,y.U)(o=>o.data))}attach(t,o){return this.http.post(this.API_URL+"payment_files/"+o+"/",t).pipe((0,y.U)(r=>r.data))}create(t){return this.http.post(this.API_URL+this.url,t).pipe((0,y.U)(o=>o.data))}update(t){return this.http.put(this.API_URL+this.url+t.id+"/",t)}updatePartly(t){return this.http.patch(this.API_URL+this.url+t.id+"/",t)}delete(t){return this.http.delete(this.API_URL+this.url+t+"/")}createEditServiceModal(t,o,r,a){return this.dialog.open(Uc,{width:"50rem",height:"auto",panelClass:"modal-overflow-visible",data:{type:t,invoiceId:o,invoiceType:r,service:a},autoFocus:!1,enterAnimationDuration:"250ms"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG($.eN),e.LFG(x.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Pc=d(5505),Le=d(2660),Fc=d(8666);function Jc(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function kc(n,i){1&n&&(e.ynx(0),e._uU(1,"(QC Processed) "),e.BQk())}function Sc(n,i){if(1&n&&(e.TgZ(0,"a",34),e._UZ(1,"button",35),e.qZA()),2&n){const t=e.oxw();e.Q6J("routerLink","/manufacturing/orders/order/"+(null==t.invoice||null==t.invoice.order?null:t.invoice.order.id))}}function Qc(n,i){if(1&n&&(e.TgZ(0,"a",36),e._UZ(1,"button",35),e.qZA()),2&n){const t=e.oxw();e.Q6J("href","/outsourcing/chains/order/"+(null==t.invoice||null==t.invoice.order?null:t.invoice.order.id),e.LSH)}}function Mc(n,i){if(1&n&&(e.TgZ(0,"a",36),e._UZ(1,"button",35),e.qZA()),2&n){const t=e.oxw();e.Q6J("href","procurement/chains/order/"+(null==t.invoice||null==t.invoice.order?null:t.invoice.order.id),e.LSH)}}function Yc(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function Oc(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function Ec(n,i){1&n&&(e.ynx(0),e._uU(1,"Invoice"),e.BQk())}function Lc(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function Bc(n,i){1&n&&(e.ynx(0),e._uU(1,"Invoice"),e.BQk())}function Dc(n,i){if(1&n&&e._UZ(0,"input",59),2&n){const t=e.oxw(2);e.s9C("value",null==t.invoice?null:t.invoice.self_serial_number)}}function $c(n,i){if(1&n&&e._UZ(0,"input",59),2&n){const t=e.oxw(2);e.s9C("value",null==t.invoice?null:t.invoice.self_proforma_serial_number)}}function Gc(n,i){if(1&n&&e._UZ(0,"p-multiSelect",61),2&n){const t=e.oxw(3);e.Q6J("disabled",!t.related.length)("options",t.related)}}function jc(n,i){if(1&n&&(e.TgZ(0,"div",39)(1,"div",40)(2,"label"),e._uU(3," Relation With Proforma Invoice"),e.qZA(),e.YNc(4,Gc,1,2,"p-multiSelect",60),e.qZA()()),2&n){const t=e.oxw(2),o=e.MAs(66);e.xp6(4),e.Q6J("ngIf",!t.isLoadingRelated)("ngIfElse",o)}}function Vc(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" (",null==t.invoice||null==t.invoice.currency?null:t.invoice.currency.symbol,") ")}}function Hc(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" (",null==t.invoice||null==t.invoice.currency?null:t.invoice.currency.symbol,") ")}}function Kc(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",50)(1,"div",40)(2,"label"),e._uU(3," Exchange Rate"),e.qZA(),e.TgZ(4,"input",62),e.NdJ("ngModelChange",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.changeRate())}),e.qZA()()()}}function zc(n,i){if(1&n&&(e.TgZ(0,"div",50)(1,"div",40)(2,"label"),e._uU(3,"Total Price In EUR"),e.qZA(),e._UZ(4,"input",63),e.ALo(5,"moneyFormat"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.s9C("value",e.lcZ(5,1,t.form.get("total_price").value*t.form.get("exchange_rate").value))}}function Wc(n,i){1&n&&(e.ynx(0),e.TgZ(1,"div",50)(2,"div",40)(3,"label"),e._uU(4,"Weight*"),e.qZA(),e._UZ(5,"input",64),e.qZA()(),e.TgZ(6,"div",50)(7,"div",40)(8,"label"),e._uU(9,"Width"),e.qZA(),e._UZ(10,"input",65),e.qZA()(),e.TgZ(11,"div",50)(12,"div",40)(13,"label"),e._uU(14,"Height"),e.qZA(),e._UZ(15,"input",66),e.qZA()(),e.TgZ(16,"div",50)(17,"div",40)(18,"label"),e._uU(19,"Length"),e.qZA(),e._UZ(20,"input",67),e.qZA()(),e.BQk())}const Xc=function(){return{standalone:!0}};function es(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"form",37)(1,"div",38)(2,"div",39)(3,"div",40)(4,"label"),e._uU(5," Supplier "),e.YNc(6,Oc,2,0,"ng-container",4),e.YNc(7,Ec,2,0,"ng-container",4),e._uU(8," Number "),e.qZA(),e._UZ(9,"input",41),e.qZA()(),e.TgZ(10,"div",39)(11,"div",40)(12,"label"),e._uU(13," Internal "),e.YNc(14,Lc,2,0,"ng-container",4),e.YNc(15,Bc,2,0,"ng-container",4),e._uU(16," Number "),e.qZA(),e.YNc(17,Dc,1,1,"input",42),e.YNc(18,$c,1,1,"input",42),e.qZA()(),e.TgZ(19,"div",39)(20,"div",40)(21,"label"),e._uU(22,"Supplier* "),e.qZA(),e.TgZ(23,"pek-company-picker",43),e.NdJ("selectCompany",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectCompany(r))}),e.qZA()()(),e.YNc(24,jc,5,2,"div",44),e.TgZ(25,"div",39)(26,"div",40)(27,"label"),e._uU(28," Total Price* "),e.YNc(29,Vc,2,1,"ng-container",4),e.qZA(),e._UZ(30,"input",45),e.qZA()(),e.TgZ(31,"div",39)(32,"div",40)(33,"label"),e._uU(34,"Pure Total Price "),e.YNc(35,Hc,2,1,"ng-container",4),e.qZA(),e.TgZ(36,"input",46),e.NdJ("input",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.pureTotalChange())}),e.qZA()()(),e.TgZ(37,"div",39)(38,"div",40)(39,"label"),e._uU(40,"Currency"),e.qZA(),e.TgZ(41,"pek-currency-picker",47),e.NdJ("valueChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.changeCurrency(r))}),e.qZA()()(),e.YNc(42,Kc,5,0,"div",48),e.YNc(43,zc,6,3,"div",48),e.qZA(),e.TgZ(44,"h2",49),e._uU(45,"Dates On Document"),e.qZA(),e.TgZ(46,"div",38)(47,"div",50)(48,"div",40)(49,"label"),e._uU(50,"Invoice Date"),e.qZA(),e._UZ(51,"p-calendar",51),e.qZA()(),e.TgZ(52,"div",50)(53,"div",40)(54,"label"),e._uU(55,"Due Date"),e.qZA(),e._UZ(56,"p-calendar",52),e.qZA()(),e.TgZ(57,"div",50)(58,"div",40)(59,"label"),e._uU(60,"Invoice Reception Date"),e.qZA(),e._UZ(61,"p-calendar",53),e.qZA()(),e.TgZ(62,"div",50),e._UZ(63,"div",40),e.qZA()(),e.TgZ(64,"h2",49),e._uU(65,"System Date"),e.qZA(),e.TgZ(66,"div",38)(67,"div",50)(68,"div",40)(69,"label"),e._uU(70,"Date*"),e.qZA(),e._UZ(71,"p-calendar",54),e.qZA()(),e.TgZ(72,"div",50)(73,"div",40)(74,"label"),e._uU(75,"Items Reception Date"),e.qZA(),e._UZ(76,"p-calendar",55),e.qZA()(),e.TgZ(77,"div",50)(78,"div",40)(79,"label"),e._uU(80,"Set Physical Characteristics"),e.qZA(),e.TgZ(81,"div")(82,"p-checkbox",56),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.updateCharacteristic(r))}),e.qZA()()()(),e.YNc(83,Wc,21,0,"ng-container",4),e.qZA(),e.TgZ(84,"div",57)(85,"button",58),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.saveInvoice())}),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(6),e.Q6J("ngIf",null==t.invoice?null:t.invoice.is_proforma),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(7),e.Q6J("ngIf",null==t.invoice?null:t.invoice.is_proforma),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(2),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(1),e.Q6J("ngIf",null==t.invoice?null:t.invoice.is_proforma),e.xp6(5),e.Q6J("currentCompanyId",t.form.get("supplier").value),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(5),e.Q6J("ngIf",null==t.invoice?null:t.invoice.currency),e.xp6(6),e.Q6J("ngIf",null==t.invoice?null:t.invoice.currency),e.xp6(6),e.Q6J("currency",t.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"!==t.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"!==t.form.get("currency").value),e.xp6(8),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(10),e.Q6J("showClear",!0)("readonlyInput",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(6),e.Q6J("ngModel",t.form.get("set_physical_characteristics").value)("binary",!0)("ngModelOptions",e.DdM(30,Xc)),e.xp6(1),e.Q6J("ngIf",t.form.get("set_physical_characteristics").value),e.xp6(2),e.Q6J("disabled",t.form.invalid)("loading",t.isSaving)}}function ts(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function ns(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",78),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.openRmaFiles())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.disabledRmaFiles())}}function os(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",79),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.allocateToToolRequest())}),e.qZA()}}function is(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",80),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.allocateProducts())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",0===t.selectedInvoiceProducts.length)}}function rs(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",81),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.cancelAllocatedProducts())}),e.qZA()}}function as(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",82),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.rma())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.disabled())}}function cs(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",83),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.complete())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",(null==t.invoice?null:t.invoice.qc_completed)&&(null==t.invoice?null:t.invoice.completed))("loading",t.isCompletingOrCancellation)}}function ss(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",84),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.cancellation())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("loading",t.isCompletingOrCancellation)}}function ls(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",68),e.YNc(1,ns,1,1,"button",69),e.YNc(2,os,1,0,"button",70),e.YNc(3,is,1,1,"button",71),e.YNc(4,rs,1,0,"button",72),e.YNc(5,as,1,1,"button",73),e.TgZ(6,"button",74),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addInvoiceItem())}),e.qZA(),e.YNc(7,cs,1,2,"button",75),e.YNc(8,ss,1,1,"button",76),e.TgZ(9,"button",77),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.distributePrice())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.completed)),e.xp6(1),e.Q6J("ngIf",t.isAllocatingMode),e.xp6(1),e.Q6J("ngIf",t.hasAllocatedProducts&&!(null!=t.invoice&&t.invoice.completed)),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(1),e.Q6J("disabled",null==t.invoice?null:t.invoice.qc_completed),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.qc_completed||null!=t.invoice&&t.invoice.completed)),e.xp6(1),e.Q6J("ngIf",null==t.invoice?null:t.invoice.completed)}}function ps(n,i){1&n&&(e.TgZ(0,"div",68),e._UZ(1,"button",85),e.qZA())}function _s(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",86),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",87),e._uU(4,"Code"),e.qZA(),e.TgZ(5,"th",87),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"th",87),e._uU(8,"Root Lists"),e.qZA(),e.TgZ(9,"th",88),e._uU(10,"RMA Comment"),e.qZA(),e.TgZ(11,"th",89),e._uU(12,"Quantity"),e.qZA(),e.TgZ(13,"th",90),e._uU(14,"Allocated Quantity"),e.qZA(),e.TgZ(15,"th",91),e._uU(16,"Price"),e.qZA(),e.TgZ(17,"th",91),e._uU(18,"Other Currency"),e.qZA(),e.TgZ(19,"th",91),e._uU(20,"DDV"),e.qZA(),e.TgZ(21,"th",91),e._uU(22,"Discount"),e.qZA(),e.TgZ(23,"th",91),e._uU(24,"Passed"),e.qZA()())}function us(n,i){1&n&&(e.TgZ(0,"p",94),e._uU(1,"Choose the Invoice Item to edit"),e.qZA())}function ds(n,i){if(1&n&&(e.TgZ(0,"div",68),e.YNc(1,us,2,0,"p",92),e._UZ(2,"p-menubar",93),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedInvoiceProducts.length),e.xp6(1),e.ekj("disabled",!t.selectedInvoiceProducts.length||t.selectedInvoiceProducts.length>1),e.Q6J("model",t.invoiceProductsMenuItems)}}function ms(n,i){if(1&n&&e._UZ(0,"p-tableCheckbox",104),2&n){const t=e.oxw().$implicit;e.Q6J("value",t)}}function gs(n,i){1&n&&(e.TgZ(0,"b"),e._uU(1,"(RMA)"),e.qZA())}function hs(n,i){1&n&&(e.TgZ(0,"b"),e._uU(1," (Reordered)"),e.qZA())}function fs(n,i){1&n&&(e.TgZ(0,"b"),e._uU(1," (Received)"),e.qZA())}const Be=function(n){return["/manufacturing/plans/plan",n]};function vs(n,i){if(1&n&&(e.TgZ(0,"a",108),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.Q6J("routerLink",e.VKq(4,Be,t.list.id)),e.xp6(1),e.lnq(" ",t.list.list_product.nomenclature.code,"~",t.list.list_product.nomenclature.name," (",t.count,") ")}}function Cs(n,i){if(1&n&&(e.TgZ(0,"a",108),e._uU(1),e.qZA()),2&n){const t=i.$implicit,o=e.oxw(4).$implicit;e.Q6J("routerLink",e.VKq(4,Be,t.id)),e.xp6(1),e.lnq(" ",o.list.list_product.nomenclature.code,"~",o.list.list_product.nomenclature.name," (",o.count,") ")}}function Zs(n,i){if(1&n&&e.YNc(0,Cs,2,6,"a",109),2&n){const t=e.oxw(3).$implicit;e.Q6J("ngForOf",t.list.serial_numbers)}}function Ts(n,i){1&n&&e.YNc(0,Zs,1,1,"ng-template")}function xs(n,i){if(1&n&&(e.YNc(0,vs,2,6,"a",107),e.YNc(1,Ts,1,0,null,4)),2&n){const t=e.oxw().$implicit;e.Q6J("ngIf",t.list.serial_numbers.length<1),e.xp6(1),e.Q6J("ngIf",t.list.serial_numbers.length>=1)}}function ys(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"a",110),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(4).$implicit,a=e.oxw();return e.KtG(a.showProductionLists(r.root_production_plans))}),e._uU(1),e.qZA()}if(2&n){const t=e.oxw(3).$implicit;e.xp6(1),e.lnq(" ",t.list.list_product.nomenclature.code,"~",t.list.list_product.nomenclature.name," (",t.count,") ")}}function bs(n,i){1&n&&e.YNc(0,ys,2,3,"ng-template")}function As(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"a",110),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2).$implicit,a=e.oxw();return e.KtG(a.showProductionLists(r.root_production_plans))}),e._uU(1),e.qZA(),e.YNc(2,bs,1,0,null,4)}if(2&n){const t=e.oxw().$implicit;e.xp6(1),e.lnq(" ",t.list.list_product.nomenclature.code,"~",t.list.list_product.nomenclature.name," (",t.count,") "),e.xp6(1),e.Q6J("ngIf",t.list.serial_numbers.length>=1)}}function Is(n,i){if(1&n&&(e.TgZ(0,"span",105),e.YNc(1,xs,2,2,"ng-template",106),e.YNc(2,As,3,4,"ng-template",106),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",1===t.count),e.xp6(1),e.Q6J("ngIf",t.count>1)}}function qs(n,i){1&n&&e._UZ(0,"i",111)}function Rs(n,i){if(1&n&&(e.TgZ(0,"span")(1,"a",113),e._uU(2),e.qZA(),e._UZ(3,"br"),e.qZA()),2&n){const t=i.$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("href",o.link+"/media/"+t.file,e.LSH),e.xp6(1),e.hij(" ",o.getName(t.file)," ")}}function ws(n,i){if(1&n&&(e.TgZ(0,"pek-hover-detailed-info-component"),e.YNc(1,Rs,4,2,"span",112),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",null==t?null:t.rma_files)}}function Ns(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.AsE(" ",t.totalQuantityAllocated," ",t.nomenclature.category?null==t.nomenclature.category||null==t.nomenclature.category.unit_of_measure?null:t.nomenclature.category.unit_of_measure.symbol:"Pcs"," ")}}function Us(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.supplier_unit_price*o.form.get("exchange_rate").value)," ")}}function Ps(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.supplier_unit_price)," ")}}function Fs(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,2,t.supplier_unit_price)," ",null==o.invoice||null==o.invoice.currency?null:o.invoice.currency.symbol,"")}}function Js(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" ",null==t.invoice.currency?null:t.invoice.currency.symbol,"")}}function ks(n,i){1&n&&(e.ynx(0),e._uU(1,"%"),e.BQk())}function Ss(n,i){1&n&&(e.TgZ(0,"div",118),e._uU(1,"Passed"),e.qZA())}function Qs(n,i){1&n&&(e.TgZ(0,"div",119),e._uU(1,"Not Passed"),e.qZA())}function Ms(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ss,2,0,"div",116),e.YNc(2,Qs,2,0,"div",117),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf","passed"===t.passed),e.xp6(1),e.Q6J("ngIf","notPassed"===t.passed)}}function Ys(n,i){1&n&&e._uU(0," - ")}function Os(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Ms,3,2,"div",114),e.YNc(2,Ys,1,0,"ng-template",null,115,e.W1O),e.BQk()),2&n){const t=e.MAs(3),o=e.oxw().$implicit,r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.shownPassedStat(o))("ngIfElse",t)}}function Es(n,i){1&n&&(e.TgZ(0,"div",118),e._uU(1,"Passed"),e.qZA())}function Ls(n,i){1&n&&(e.TgZ(0,"div",119),e._uU(1,"Not Passed"),e.qZA())}function Bs(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Es,2,0,"div",116),e.YNc(2,Ls,2,0,"div",117),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf","passed"===t.passed),e.xp6(1),e.Q6J("ngIf","notPassed"===t.passed)}}function Ds(n,i){1&n&&e._uU(0," - ")}function $s(n,i){if(1&n&&(e.ynx(0),e.YNc(1,Bs,3,2,"div",114),e.YNc(2,Ds,1,0,"ng-template",null,115,e.W1O),e.BQk()),2&n){const t=e.MAs(3),o=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","Reordered"===o.rma_status||"Received"===o.rma_status&&o.quality_control)("ngIfElse",t)}}function Gs(n,i){if(1&n&&(e.TgZ(0,"tr",95)(1,"td",96)(2,"div",97),e.YNc(3,ms,1,1,"p-tableCheckbox",98),e.TgZ(4,"span"),e._uU(5),e.qZA()()(),e.TgZ(6,"td",87),e._uU(7),e.YNc(8,gs,2,0,"b",4),e.YNc(9,hs,2,0,"b",4),e.YNc(10,fs,2,0,"b",4),e.qZA(),e.TgZ(11,"td",87),e._uU(12),e.qZA(),e.TgZ(13,"td",87)(14,"div",99)(15,"div",99),e.YNc(16,Is,3,2,"span",100),e.qZA()()(),e.TgZ(17,"td",101)(18,"a",102),e.YNc(19,qs,1,0,"i",103),e._uU(20),e.qZA(),e.YNc(21,ws,2,1,"pek-hover-detailed-info-component",4),e.qZA(),e.TgZ(22,"td",89),e._uU(23),e.qZA(),e.TgZ(24,"td",90),e.YNc(25,Ns,2,2,"span",4),e.qZA(),e.TgZ(26,"td",91),e.YNc(27,Us,3,3,"ng-container",4),e.YNc(28,Ps,3,3,"ng-container",4),e._uU(29," \u20ac "),e.qZA(),e.TgZ(30,"td",91),e.YNc(31,Fs,3,4,"ng-container",4),e.qZA(),e.TgZ(32,"td",91),e._uU(33),e.qZA(),e.TgZ(34,"td",91),e._uU(35),e.ALo(36,"number"),e.YNc(37,Js,2,1,"ng-container",4),e.YNc(38,ks,2,0,"ng-container",4),e.qZA(),e.TgZ(39,"td",91),e.YNc(40,Os,4,2,"ng-container",4),e.YNc(41,$s,4,2,"ng-container",4),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.Q6J("pSelectableRow",r.isViewingMode?null:t),e.xp6(3),e.Q6J("ngIf",r.isAllocatingMode),e.xp6(2),e.hij(" ",o+1," "),e.xp6(2),e.hij("",t.nomenclature.code," "),e.xp6(1),e.Q6J("ngIf",t.rma_comment),e.xp6(1),e.Q6J("ngIf",("notPassed"===(null==t?null:t.passed)||!(null!=t&&t.passed))&&"Reordered"===(null==t?null:t.rma_status)),e.xp6(1),e.Q6J("ngIf",("notPassed"===(null==t?null:t.passed)||!(null!=t&&t.passed))&&"Received"===(null==t?null:t.rma_status)),e.xp6(2),e.Oqu(t.nomenclature.name),e.xp6(4),e.Q6J("ngForOf",r.getRootLists(t.equalInvoiceProducts)),e.xp6(3),e.Q6J("ngIf",(null==t.rma_files?null:t.rma_files.length)>0&&t.rma_comment),e.xp6(1),e.hij(" ",t.rma_comment," "),e.xp6(1),e.Q6J("ngIf",(null==t||null==t.rma_files?null:t.rma_files.length)>0&&(null==t?null:t.rma_comment)),e.xp6(2),e.AsE("",t.totalQuantity," ",null==t.nomenclature.category||null==t.nomenclature.category.unit_of_measure?null:t.nomenclature.category.unit_of_measure.symbol,""),e.xp6(2),e.Q6J("ngIf",t.totalQuantityAllocated),e.xp6(2),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"===r.form.get("currency").value),e.xp6(3),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(2),e.hij("",t.ddv,"%"),e.xp6(2),e.hij("",e.xi3(36,24,t.discount,"1.0")," "),e.xp6(2),e.Q6J("ngIf",t.fixed_discount),e.xp6(1),e.Q6J("ngIf",!t.fixed_discount),e.xp6(2),e.Q6J("ngIf",t.passed&&!t.rma_comment),e.xp6(1),e.Q6J("ngIf",t.rma_comment)}}function js(n,i){1&n&&e._UZ(0,"i",122)}function Vs(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Hs(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",120),e.YNc(2,js,1,0,"i",121),e.YNc(3,Vs,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",14),e.xp6(1),e.Q6J("ngIf",t.isLoadingInvoiceProducts),e.xp6(1),e.Q6J("ngIf",!t.isLoadingInvoiceProducts)}}function Ks(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",123),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(28);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function zs(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",124)(1,"p-button",123),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(28);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function Ws(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function Xs(n,i){1&n&&(e.TgZ(0,"p",94),e._uU(1,"Choose the Invoice Service to edit"),e.qZA())}function el(n,i){if(1&n&&(e.TgZ(0,"div",68),e.YNc(1,Xs,2,0,"p",92),e._UZ(2,"p-menubar",125),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedService),e.xp6(1),e.ekj("disabled",!t.selectedService),e.Q6J("model",t.invoiceServiceMenuItems)}}function tl(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",126),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",127),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",91),e._uU(6,"Price"),e.qZA(),e.TgZ(7,"th",91),e._uU(8,"Other currency"),e.qZA(),e.TgZ(9,"th",91),e._uU(10,"DDV"),e.qZA(),e.TgZ(11,"th",91),e._uU(12,"Discount"),e.qZA(),e.TgZ(13,"th",91),e._uU(14,"Total Price"),e.qZA()())}function nl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.pure_price*o.form.get("exchange_rate").value)," ")}}function ol(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.pure_price)," ")}}function il(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,2,t.pure_price)," ",null==o.invoice||null==o.invoice.currency?null:o.invoice.currency.symbol,"")}}function rl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.ddv_discount_price*o.form.get("exchange_rate").value)," ")}}function al(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.ddv_discount_price)," ")}}function cl(n,i){if(1&n&&(e.TgZ(0,"tr",95)(1,"td",89),e._uU(2),e.qZA(),e.TgZ(3,"td",127),e._uU(4),e.qZA(),e.TgZ(5,"td",91),e.YNc(6,nl,3,3,"ng-container",4),e.YNc(7,ol,3,3,"ng-container",4),e._uU(8," \u20ac "),e.qZA(),e.TgZ(9,"td",91),e.YNc(10,il,3,4,"ng-container",4),e.qZA(),e.TgZ(11,"td",91),e._uU(12),e.qZA(),e.TgZ(13,"td",91),e._uU(14),e.ALo(15,"number"),e.qZA(),e.TgZ(16,"td",91),e.YNc(17,rl,3,3,"ng-container",4),e.YNc(18,al,3,3,"ng-container",4),e._uU(19," \u20ac "),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.Q6J("pSelectableRow",r.isViewingMode?null:t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.base_service.name),e.xp6(2),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"===r.form.get("currency").value),e.xp6(3),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(2),e.hij("",t.ddv,"%"),e.xp6(2),e.hij("",e.xi3(15,10,t.discount,"1.0"),"%"),e.xp6(3),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"===r.form.get("currency").value)}}function sl(n,i){1&n&&e._UZ(0,"i",122)}function ll(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function pl(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",120),e.YNc(2,sl,1,0,"i",121),e.YNc(3,ll,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",12),e.xp6(1),e.Q6J("ngIf",t.isLoadingServices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingServices)}}function _l(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",123),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(44);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function ul(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",124)(1,"p-button",123),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(44);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function dl(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",68)(1,"button",128),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.openInvoiceFilesModal())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.isLoadingFiles)}}function ml(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",89),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",129),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",91),e._uU(6,"Actions"),e.qZA()())}function gl(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",130),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",130)(6,"div",131)(7,"button",132),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onDownloadFile(a))}),e.qZA(),e.TgZ(8,"button",133),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onRemoveFile(a.id))}),e.qZA()()()()}if(2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.xp6(2),e.Oqu(o+1),e.xp6(2),e.hij(" ",r.getFileName(t.file)," "),e.xp6(3),e.Q6J("loading",r.addition.has(t.id)),e.xp6(1),e.Q6J("loading",r.deletion.has(t.id))}}function hl(n,i){1&n&&e._UZ(0,"i",122)}function fl(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function vl(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",120),e.YNc(2,hl,1,0,"i",121),e.YNc(3,fl,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoadingFiles),e.xp6(1),e.Q6J("ngIf",!t.isLoadingFiles)}}function Cl(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",123),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(56);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function Zl(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",124)(1,"p-button",123),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(56);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function Tl(n,i){1&n&&(e.TgZ(0,"div",134),e._UZ(1,"i",122),e.qZA())}function xl(n,i){1&n&&(e.TgZ(0,"div",135),e._UZ(1,"i",136),e.qZA())}let yl=(()=>{class n{constructor(t,o,r,a,l,p,_,h){this.route=t,this.fb=o,this.invoiceService=r,this.adapterService=a,this.modalService=l,this.invoiceProductService=p,this.servicesService=_,this.invoiceProductRmaFilesService=h,this.isCompletingOrCancellation=!1,this.invoiceProductsMenuItems=[{label:"Selected Invoice Item",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.editInvoiceProduct()},{label:"Delivery Date",icon:"pi pi-calendar",command:()=>this.deliveryDate(),disabled:!0},{label:"Confirm the delivery of the item",icon:"pi pi-check",command:()=>this.confirmDelivery(),disabled:!0},{label:"Remove",icon:"pi pi-trash",command:()=>this.deleteInvoiceProduct()}]}],this.invoiceServiceMenuItems=[{label:"Selected Invoice Service",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.editInvoiceService()},{label:"Remove",icon:"pi pi-trash",command:()=>this.removeInvoiceService()}]}],this.isPureTotalChanged=!1,this.files=[],this.isSaving=!1,this.isLoadingFiles=!0,this.invoice=null,this.related=[],this.deletion=new Set,this.addition=new Set,this.invoiceProducts=[],this.selectedInvoiceProducts=[],this.invoiceServices=[],this.isLoadingServices=!0,this.isLoadingInvoiceProducts=!0,this.isViewingMode=!1,this.haveSaved=!1,this.isLoadingRelated=!0,this.isLoading=!1,this.form=this.fb.group({supplier_serial_number:[""],supplier:[{value:null},s.kI.required],total_price:[{value:0,disabled:this.isViewingMode},s.kI.required],pure_total_price:[{value:0,disabled:!1}],id:[null,s.kI.required],currency:[null,s.kI.required],system_creation_date:[null,s.kI.required],invoice_date:[null],items_reception_date:[null],set_physical_characteristics:[null],due_date:[null],invoice_reception_date:[null],weight:[null],width:[null],length:[null],height:[null],delivery_days:[null],proformas:[[]],exchange_rate:[1]}),this.hasAllocatedProducts=!1,this.link=N.N.image_path}ngOnInit(){this.route.paramMap.pipe((0,y.U)(t=>t.get("id")),(0,g.b)(t=>this.invoiceId=+t),(0,g.b)(t=>this.form.get("id").patchValue(+t)),(0,g.b)(()=>this.getInvoice()),(0,g.b)(()=>this.getFiles()),(0,g.b)(()=>this.getInvoiceProducts()),(0,g.b)(()=>this.getServices())).subscribe()}getFiles(){this.files=[],this.isLoadingFiles=!0,this.invoiceService.getFiles(+this.invoiceId).subscribe(t=>{this.files=t,this.isLoadingFiles=!1})}getInvoice(){this.isPureTotalChanged=!1,this.isLoading=!0,this.invoiceService.getById(this.invoiceId).subscribe(t=>{this.invoice=t,this.invoice.total_price=Math.round(100*this.invoice.total_price)/100,t.supplier?this.invoiceService.get([{name:"supplier",value:t.supplier?.id},{name:"is_proforma",value:!t.is_proforma}]).subscribe(o=>{this.related=o,this.isLoadingRelated=!1}):this.isLoadingRelated=!1,null!=this.invoice.invoice_date&&(this.invoice.invoice_date=new Date(this.invoice.invoice_date)),null!=this.invoice.system_creation_date&&(this.invoice.system_creation_date=new Date(this.invoice.system_creation_date)),null!=this.invoice.due_date&&(this.invoice.due_date=new Date(this.invoice.due_date)),null!=this.invoice.invoice_reception_date&&(this.invoice.invoice_reception_date=new Date(this.invoice.invoice_reception_date)),null!=this.invoice.items_reception_date&&(this.invoice.items_reception_date=new Date(this.invoice.items_reception_date)),this.invoice.order||this.form.get("supplier").enable(),this.form.patchValue(this.invoice),this.invoice.supplier&&this.form.get("supplier").patchValue(this.invoice.supplier.id),this.invoice.proformas&&this.form.get("proformas").patchValue(this.invoice.proformas.map(o=>o.id)),this.invoice.currency&&this.form.get("currency").patchValue(this.invoice.currency.code),this.invoice.delivery_days&&(this.haveSaved=!0),this.isLoading=!1})}getServices(){this.selectedService=null,this.isLoadingServices=!0,this.invoiceServices=[],this.servicesService.get([{name:"invoice",value:this.invoiceId}]).subscribe(t=>{this.invoiceServices=t,this.invoiceServices=t,this.invoice?.pure_total_price&&this.form.get("pure_total_price").setValue(this.invoice.pure_total_price.toFixed(2)),this.isLoadingServices=!1})}getInvoiceProducts(){this.hasAllocatedProducts=!1,this.isLoadingInvoiceProducts=!0,this.selectedInvoiceProducts=[],this.invoiceProducts=[],this.invoiceProductService.get([{name:"invoice",value:this.invoiceId}]).subscribe(t=>{const o=[];t.forEach(r=>{if(r.passed=null,!o.find(a=>a.nomenclature.id===r.nomenclature.id&&a.current_technology===r.current_technology)){let a=[],l=[],p=[],_=[];const h=t.filter(u=>u.nomenclature.id===r.nomenclature.id&&u.current_technology===r.current_technology);if(h.forEach(u=>{u.notPassedQuantity=u.quantity-u.passed_quantity}),a=h.filter(u=>u.passed_quantity>0&&!u.not_passed_quantity),l=h.filter(u=>u.not_passed_quantity>0&&!u.passed_quantity),p=h.filter(u=>!u.passed_quantity&&!u.not_passed_quantity),_=h.filter(u=>u.passed_quantity&&u.not_passed_quantity),_.length&&_.forEach(u=>{const c={...u},f={...u};c.equalInvoiceProducts=JSON.parse(JSON.stringify(a)),c.totalQuantity=c.passed_quantity,c.totalFreeQuantity=c.order_product_free_quantity,c.totalQuantityAllocated=c.allocated_quantity,this.checkIfHasAllocatedProduct(c),c.passed="passed",c.rma_status=null,c.rma_comment="",c.products=[c],o.push(c),f.equalInvoiceProducts=JSON.parse(JSON.stringify(p)),f.totalQuantity=f.not_passed_quantity,f.totalFreeQuantity=f.order_product_free_quantity,f.totalQuantityAllocated=f.allocated_quantity,this.checkIfHasAllocatedProduct(f),f.passed="notPassed",f.rma_status=f?.rma_status??"",f.rma_comment=f?.rma_comment??"",f.rma_status!==Ee.Ro.RECEIVED&&(f.passed="notPassed"),f.products=[f],o.push(f)}),a.length){const u={...r};u.equalInvoiceProducts=JSON.parse(JSON.stringify(a)),u.totalQuantity=a.reduce((c,f)=>c+f.passed_quantity,0),u.totalFreeQuantity=this.onlyUnique(p,"order_product_id").reduce((c,f)=>c+f.order_product_free_quantity,0),u.totalQuantityAllocated=a.reduce((c,f)=>c+f.allocated_quantity,0),this.checkIfHasAllocatedProduct(u),u.passed="passed",u.rma_status=null,u.rma_comment="",u.products=[...a],o.push(u)}if(l.length){const u={...r};u.equalInvoiceProducts=JSON.parse(JSON.stringify(p)),u.totalQuantity=l.reduce((c,f)=>c+f.not_passed_quantity,0),u.totalFreeQuantity=this.onlyUnique(p,"order_product_id").reduce((c,f)=>c+f.order_product_free_quantity,0),u.passed="notPassed",u.rma_status=l.find(c=>c.rma_status)?.rma_status,u.rma_comment=l.find(c=>c.rma_comment)?.rma_comment??"",u.rma_status!==Ee.Ro.RECEIVED&&(u.passed="notPassed"),u.products=[...l],o.push(u)}if(p.length){const u={...r};u.totalQuantity=p.reduce((c,f)=>c+f.quantity,0),u.totalFreeQuantity=this.onlyUnique(p,"order_product_id").reduce((c,f)=>c+f.order_product_free_quantity,0),u.totalQuantityAllocated=p.reduce((c,f)=>c+f.allocated_quantity,0),this.checkIfHasAllocatedProduct(u),u.rma_status=p.find(c=>c.rma_status)?.rma_status,u.rma_comment=p.find(c=>c.rma_comment)?.rma_comment??"",u.equalInvoiceProducts=JSON.parse(JSON.stringify(p)),u.products=[...p],o.push(u)}}}),this.invoiceProducts=o.map((r,a)=>({...r,uid:a})),this.invoiceProducts.sort((r,a)=>a.rma_comment.localeCompare(r.rma_comment)),this.isLoadingInvoiceProducts=!1})}onlyUnique(t,o){return t.filter((r,a)=>!t.slice(a+1).some(l=>l[o]===r[o]))}checkIfHasAllocatedProduct(t){t.totalQuantityAllocated>0&&(this.hasAllocatedProducts=!0)}onSelectCompany(t){this.form.get("supplier").patchValue(t)}changeCurrency(t){this.form.get("currency").patchValue(t?.code??null),this.invoice.currency.symbol=t?.symbol??"None","EUR"===this.form.get("currency").value&&(this.form.get("exchange_rate").setValue(1),this.form.get("pure_total_price").setValue(this.form.get("pure_total_price").value.toFixed(2)))}calculatePureTotalPrice(){let t=0;return this.invoiceProducts.forEach(o=>{const r=parseFloat(o.supplier_unit_price);let a=r-r*parseFloat(o.discount)/100;a*=o.quantity,t+=a}),this.invoiceServices.forEach(o=>{const r=parseFloat(o.pure_price);t+=r-r*parseFloat(o.discount)/100}),t=parseFloat(t.toFixed(3)),t}changeRate(){}updateCharacteristic(t){this.form.get("set_physical_characteristics").setValue(t),this.form.get("set_physical_characteristics").value?(this.form.get("weight").setValidators([s.kI.required]),this.form.get("set_physical_characteristics").updateValueAndValidity()):(this.form.get("weight").setValidators([]),this.form.get("set_physical_characteristics").updateValueAndValidity())}showProductionLists(t){}getRootLists(t){const o=[];return t.forEach(r=>{r.root_production_plans&&r.root_production_plans.forEach(a=>{if(a){const l=o.find(p=>p.list.root_nomenclature?.id===a.root_nomenclature?.id);l?l.count++:o.push({list:a,count:1})}})}),o}getFileName(t){const o=t.split("/");return o[o.length-1]}onRemoveFile(t){this.modalService.confirm("danger").subscribe(o=>{o&&(this.deletion.add(t),this.invoiceService.removeFile(t).pipe((0,U.x)(()=>this.deletion.delete(t))).subscribe(()=>{const r=this.files.findIndex(a=>a.id===t);this.files.splice(r,1)}))})}onDownloadFile(t){this.addition.add(t.id),this.invoiceService.downloadFile(t.id).pipe((0,U.x)(()=>this.addition.delete(t.id))).subscribe(o=>{const r=this.getFileName(t.file);this.adapterService.downloadFile(r,o)})}openInvoiceFilesModal(){this.invoiceService.openInvoiceFilesModal(+this.invoiceId).subscribe(t=>{this.getFiles()})}createInvoiceService(){this.servicesService.createEditServiceModal("create",+this.invoiceId,"invoice").subscribe(t=>{t&&(this.getServices(),this.getInvoice())})}editInvoiceService(){this.servicesService.createEditServiceModal("edit",+this.invoiceId,"invoice",this.selectedService).subscribe(t=>{t&&(this.getServices(),this.getInvoice())})}removeInvoiceService(){this.modalService.confirm("danger").subscribe(t=>{t&&this.servicesService.delete(this.selectedService.id).subscribe(()=>{this.getServices(),this.getInvoice()})})}saveInvoice(){if(this.form.valid){this.isSaving=!0;let t={...this.form.value};t.system_creation_date=this.adapterService.dateAdapter(this.form.value.system_creation_date),t.due_date=this.adapterService.dateAdapter(this.form.value.due_date),t.invoice_reception_date=this.adapterService.dateAdapter(this.form.value.invoice_reception_date),t.invoice_date=this.adapterService.dateAdapter(this.form.get("invoice_date").value),delete t.pure_total_price,this.isPureTotalChanged&&this.invoice.pure_total_price!==this.form.get("pure_total_price").value&&(t.manual_pure_total_price=this.form.get("pure_total_price").value),this.haveSaved=!0,this.invoiceService.updatePartly(t).pipe((0,U.x)(()=>this.isSaving=!1)).subscribe(()=>{this.getInvoice()})}}cancellation(){this.modalService.confirm("success").pipe((0,R.h)(Boolean)).subscribe(()=>{this.isCompletingOrCancellation=!0,this.invoiceService.cancellation(this.invoice.id).pipe((0,U.x)(()=>this.isCompletingOrCancellation=!1),(0,I.b)(500),(0,g.b)(()=>this.getInvoice()),(0,g.b)(()=>this.getInvoiceProducts())).subscribe()})}complete(){this.modalService.confirm("success").pipe((0,R.h)(Boolean)).subscribe(()=>{this.isCompletingOrCancellation=!0,this.invoiceService.updatePartly({id:this.invoice.id,completed:!0}).pipe((0,U.x)(()=>this.isCompletingOrCancellation=!1),(0,I.b)(500),(0,g.b)(()=>this.getInvoice()),(0,g.b)(()=>this.getInvoiceProducts())).subscribe()})}distributePrice(){this.invoiceService.distributeModal(+this.invoiceId).pipe((0,R.h)(Boolean),(0,g.b)(()=>this.getInvoice()),(0,g.b)(()=>this.getInvoiceProducts()),(0,g.b)(()=>this.getServices())).subscribe()}addInvoiceItem(){this.invoiceService.addInvoiceProductModal(+this.invoiceId).pipe((0,R.h)(Boolean),(0,g.b)(()=>this.getInvoice()),(0,g.b)(()=>this.getInvoiceProducts())).subscribe()}deleteInvoiceProduct(){const o=this.selectedInvoiceProducts[0].equalInvoiceProducts.map(r=>r.id).map(r=>this.invoiceProductService.delete(r));this.modalService.confirm("danger").pipe((0,R.h)(Boolean),(0,O.w)(()=>(0,qe.D)([...o])),(0,g.b)(()=>this.getInvoice()),(0,g.b)(()=>this.getInvoiceProducts())).subscribe()}editInvoiceProduct(){this.invoiceProductService.createEditInvoiceProductModal("edit",+this.invoiceId,this.selectedInvoiceProducts[0]).pipe((0,R.h)(Boolean),(0,g.b)(()=>this.getInvoice()),(0,g.b)(()=>this.getInvoiceProducts())).subscribe()}rma(){this.invoiceProductService.rma(this.selectedInvoiceProducts).subscribe(t=>{("refund"===t||"return"===t||"leave"===t)&&(this.getInvoice(),this.getInvoiceProducts())})}disabled(){return 0===this.selectedInvoiceProducts?.length||!this.selectedInvoiceProducts?.every(t=>t.rma_comment)||this.selectedInvoiceProducts.every(t=>t.rma_status)}disabledRmaFiles(){return 0===this.selectedInvoiceProducts?.length||this.selectedInvoiceProducts?.length>1&&0===this.selectedInvoiceProducts[0]?.rma_files?.length||!this.selectedInvoiceProducts?.every(t=>t.rma_comment)}deliveryDate(){this.invoiceProductService.deliveryDate(this.selectedInvoiceProducts[0]).pipe((0,U.x)(Boolean)).subscribe(t=>{t&&(this.getInvoice(),this.getInvoiceProducts())})}confirmDelivery(){this.modalService.confirm("success").subscribe(t=>{if(t){const o=[];this.selectedInvoiceProducts[0].products.forEach(r=>o.push({id:r.id,rma_status:1})),this.invoiceProductService.updateSeveralPartly(o).subscribe(()=>{this.getInvoice(),this.getInvoiceProducts()})}})}productsSelectionChange(){this.invoiceProductsMenuItems[0].items[1].disabled=Boolean(!this.selectedInvoiceProducts[0]?.rma_comment||!("notPassed"!==this.selectedInvoiceProducts[0]?.passed||this.selectedInvoiceProducts[0]?.passed)||"Reordered"!==this.selectedInvoiceProducts[0]?.rma_status),this.invoiceProductsMenuItems[0].items[2].disabled=Boolean(!this.selectedInvoiceProducts[0]?.rma_comment||!("notPassed"!==this.selectedInvoiceProducts[0]?.passed||this.selectedInvoiceProducts[0]?.passed)||"Reordered"!==this.selectedInvoiceProducts[0]?.rma_status)}openRmaFiles(){this.invoiceProductRmaFilesService.invoiceProductsRmaFiles(this.selectedInvoiceProducts[0].rma_files).subscribe()}getName(t){const o=t.split("/");return o[o.length-1]}shownPassedStat(t){return t.quality_control||t.equalInvoiceProducts.some(o=>o.quality_control)}pureTotalChange(){this.isPureTotalChanged=!0}allocateToToolRequest(){this.isAllocatingMode=!this.isAllocatingMode,this.selectedInvoiceProducts=[],this.selectedInvoiceProducts=[...this.selectedInvoiceProducts]}allocateProducts(){this.invoiceService.allocateToToolRequestModal(this.selectedInvoiceProducts).pipe((0,R.h)(Boolean),(0,I.b)(500)).subscribe(t=>{this.isAllocatingMode=!1,this.getInvoiceProducts()})}cancelAllocatedProducts(){this.modalService.confirm("danger").subscribe(t=>{t&&this.invoiceService.cancel_allocation_for_area_locator(this.invoiceId).pipe((0,I.b)(500)).subscribe(o=>{this.getInvoiceProducts()})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b.gz),e.Y36(s.qu),e.Y36(Ye.q),e.Y36(J.v),e.Y36(Y.Z),e.Y36(Ic.J),e.Y36(we),e.Y36(Pc.J))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-invoice-page"]],decls:67,vars:32,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf"],[1,"page__tools"],[3,"ngSwitch"],["target","_blank",3,"routerLink",4,"ngSwitchCase"],["target","_blank",3,"href",4,"ngSwitchCase"],[1,"page__content"],[1,"reports-invoice-page"],[1,"mb-4"],[1,"reports-invoice-page__card","reports-invoice-page__info","mb-4"],[3,"formGroup",4,"ngIf","ngIfElse"],[1,"block-header","mb-4"],["class","d-flex",4,"ngIf"],[1,"page__card","mb-4"],[1,"page__table"],["selectionMode","multiple","scrollHeight","calc(100vh - 18.8rem)","dataKey","uid",3,"scrollable","paginator","rows","selection","value","selectionChange"],["it",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],["pButton","","type","button","icon","pi pi-plus","label","New Service",3,"disabled","click"],["selectionMode","single",3,"rows","paginator","value","selection","selectionChange"],["st",""],[1,"page__card"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["fs",""],["infoLoading",""],["spinner",""],["target","_blank",3,"routerLink"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Go To Order"],["target","_blank",3,"href"],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"form-group"],["type","text","pInputText","","formControlName","supplier_serial_number"],["pInputText","","type","text","disabled","",3,"value",4,"ngIf"],[3,"currentCompanyId","selectCompany"],["class","col-6",4,"ngIf"],["pInputText","","formControlName","total_price","type","number","step","0.01"],["pInputText","","type","number","step","0.01","formControlName","pure_total_price",3,"input"],[3,"currency","valueChange"],["class","col-3",4,"ngIf"],[1,"mt-4"],[1,"col-3"],["formControlName","invoice_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],["formControlName","due_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],["formControlName","invoice_reception_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],["formControlName","system_creation_date","dataType","date","dateFormat","dd/mm/yy",3,"showClear","readonlyInput"],["formControlName","items_reception_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],["id","other",3,"ngModel","binary","ngModelOptions","ngModelChange"],[1,"d-flex","mt-2"],["pButton","","type","button","label","Save",1,"ml-auto",3,"disabled","loading","click"],["pInputText","","type","text","disabled","",3,"value"],["formControlName","proformas","optionLabel","self_proforma_serial_number","optionValue","id","placeholder","Select Relation",3,"disabled","options",4,"ngIf","ngIfElse"],["formControlName","proformas","optionLabel","self_proforma_serial_number","optionValue","id","placeholder","Select Relation",3,"disabled","options"],["pInputText","","formControlName","exchange_rate","type","number","step","0.0001",3,"ngModelChange"],["pInputText","","disabled","","readonly","","type","text","step","0.01",1,"form-control",3,"value"],["pInputText","","type","number","step","0.01","placeholder","Enter width in kilograms","formControlName","weight"],["pInputText","","type","number","step","0.01","placeholder","Enter width in centimeters","formControlName","width"],["pInputText","","type","number","step","0.01","placeholder","Enter height in centimeters","formControlName","height"],["pInputText","","type","number","step","0.01","placeholder","Enter length in centimeters","formControlName","length"],[1,"d-flex"],["pButton","","class","mr-2","type","button","icon","pi pi-cog","label","RMA Files",3,"disabled","click",4,"ngIf"],["pButton","","class","mr-2","type","button","icon","pi pi-sort-alt","label","Allocate To Tool Area",3,"click",4,"ngIf"],["pButton","","class","mr-2","type","button","icon","pi pi-reply","label","Allocate",3,"disabled","click",4,"ngIf"],["pButton","","class","mr-2","type","button","icon","pi pi-sort-alt-slash","label","Cancel Tool Allocation",3,"click",4,"ngIf"],["pButton","","class","mr-2","type","button","icon","pi pi-cog","label","RMA",3,"disabled","click",4,"ngIf"],["pButton","","type","button","icon","pi pi-plus","label","New Item",1,"mr-2",3,"disabled","click"],["pButton","","class","mr-2 p-button-success p-button-icon","type","button","icon","pi pi-check","label","Complete",3,"disabled","loading","click",4,"ngIf"],["pButton","","class","mr-2 p-button-danger p-button-icon","type","button","icon","pi pi-times","label","Cancellation",3,"loading","click",4,"ngIf"],["pButton","","type","button","icon","pi pi-sliders-v","label","Price Distribution",1,"p-button-icon",3,"click"],["pButton","","type","button","icon","pi pi-cog","label","RMA Files",1,"mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-sort-alt","label","Allocate To Tool Area",1,"mr-2",3,"click"],["pButton","","type","button","icon","pi pi-reply","label","Allocate",1,"mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-sort-alt-slash","label","Cancel Tool Allocation",1,"mr-2",3,"click"],["pButton","","type","button","icon","pi pi-cog","label","RMA",1,"mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Complete",1,"mr-2","p-button-success","p-button-icon",3,"disabled","loading","click"],["pButton","","type","button","icon","pi pi-times","label","Cancellation",1,"mr-2","p-button-danger","p-button-icon",3,"loading","click"],["pButton","","type","button","icon","pi pi-plus","label","Add File",1,"ml-auto"],[1,"index-header","text-center",2,"width","3%"],[2,"width","15%"],[2,"width","10%"],[1,"text-center",2,"width","5%"],[1,"text-center",2,"width","13%"],[1,"text-center",2,"width","10%"],["class","subtitle",4,"ngIf"],[1,"ml-auto","invoice-product-menubar",3,"model"],[1,"subtitle"],[3,"pSelectableRow"],[1,"text-center",2,"width","3%"],[1,"selection-td"],["class","mr-2",3,"value",4,"ngIf"],[1,"root-count-wrapper"],["class","d-block",4,"ngFor","ngForOf"],[1,"hovered-info",2,"width","15%"],["href","javascript:void(0)",1,"rma-files"],["class","pi pi-paperclip mr-2",4,"ngIf"],[1,"mr-2",3,"value"],[1,"d-block"],[3,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"routerLink",4,"ngIf"],["target","_blank","rel","noopener noreferrer",3,"routerLink"],["target","_blank","rel","noopener noreferrer",3,"routerLink",4,"ngFor","ngForOf"],["href","javascript:void(0)",3,"click"],[1,"pi","pi-paperclip","mr-2"],[4,"ngFor","ngForOf"],[3,"href"],[4,"ngIf","ngIfElse"],["notPassed",""],["class","text-success",4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"text-success"],[1,"text-danger"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],[1,"ml-auto",3,"model"],[1,"index-header","text-center",2,"width","5%"],[2,"width","45%"],["pButton","","type","button","icon","pi pi-plus","label","Add File",1,"ml-auto",3,"disabled","click"],[2,"width","85%"],[1,"text-center"],[1,"d-flex","justify-content-center"],["pButton","","type","button","icon","pi pi-download",1,"p-button-primary","p-button-rounded","p-button-outlined","p-button-rounded_small","mr-2",3,"loading","click"],["pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","p-button-rounded","p-button-outlined","p-button-rounded_small",3,"loading","click"],[1,"info-loading"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e.YNc(5,Jc,2,0,"ng-container",4),e._uU(6," Invoice Edit "),e.YNc(7,kc,2,0,"ng-container",4),e.qZA()(),e.TgZ(8,"div",5),e.ynx(9,6),e.YNc(10,Sc,2,1,"a",7),e.YNc(11,Qc,2,1,"a",8),e.YNc(12,Mc,2,1,"a",8),e.BQk(),e.qZA()()(),e.TgZ(13,"div",9)(14,"div",10)(15,"h2",11),e.YNc(16,Yc,2,0,"ng-container",4),e._uU(17," Invoice Info "),e.qZA(),e.TgZ(18,"div",12),e.YNc(19,es,86,31,"form",13),e.qZA(),e.TgZ(20,"div",14)(21,"h2"),e.YNc(22,ts,2,0,"ng-container",4),e._uU(23," Invoice Items "),e.qZA(),e.YNc(24,ls,10,8,"div",15),e.qZA(),e.TgZ(25,"div",16)(26,"div",17)(27,"p-table",18,19),e.NdJ("selectionChange",function(a){return o.selectedInvoiceProducts=a})("selectionChange",function(){return o.productsSelectionChange()}),e.YNc(29,ps,2,0,"ng-template",20),e.YNc(30,_s,25,0,"ng-template",21),e.YNc(31,ds,3,4,"ng-template",20),e.YNc(32,Gs,42,27,"ng-template",22),e.YNc(33,Hs,4,3,"ng-template",23),e.YNc(34,Ks,2,0,"ng-template",24),e.qZA()(),e.YNc(35,zs,3,0,"div",25),e.qZA(),e.TgZ(36,"div",14)(37,"h2"),e.YNc(38,Ws,2,0,"ng-container",4),e._uU(39," Invoice Services "),e.qZA(),e.TgZ(40,"button",26),e.NdJ("click",function(){return o.createInvoiceService()}),e.qZA()(),e.TgZ(41,"div",16)(42,"div",17)(43,"p-table",27,28),e.NdJ("selectionChange",function(a){return o.selectedService=a}),e.YNc(45,el,3,4,"ng-template",20),e.YNc(46,tl,15,0,"ng-template",21),e.YNc(47,cl,20,13,"ng-template",22),e.YNc(48,pl,4,3,"ng-template",23),e.YNc(49,_l,2,0,"ng-template",24),e.qZA()(),e.YNc(50,ul,3,0,"div",25),e.qZA(),e.TgZ(51,"h2",11),e._uU(52,"Files"),e.qZA(),e.TgZ(53,"div",29)(54,"div",17)(55,"p-table",30,31),e.NdJ("selectionChange",function(a){return o.selectedFile=a}),e.YNc(57,dl,2,1,"ng-template",20),e.YNc(58,ml,7,0,"ng-template",21),e.YNc(59,gl,9,4,"ng-template",22),e.YNc(60,vl,4,3,"ng-template",23),e.YNc(61,Cl,2,0,"ng-template",24),e.qZA()(),e.YNc(62,Zl,3,0,"div",25),e.qZA()()(),e.YNc(63,Tl,2,0,"ng-template",null,32,e.W1O),e.YNc(65,xl,2,0,"ng-template",null,33,e.W1O)),2&t){const r=e.MAs(28),a=e.MAs(44),l=e.MAs(56),p=e.MAs(64);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(2),e.Q6J("ngIf",null==o.invoice?null:o.invoice.is_proforma),e.xp6(2),e.Q6J("ngIf",null==o.invoice?null:o.invoice.qc_completed),e.xp6(2),e.Q6J("ngSwitch",null==o.invoice||null==o.invoice.order?null:o.invoice.order.accounting_type),e.xp6(1),e.Q6J("ngSwitchCase",3),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",1),e.xp6(4),e.Q6J("ngIf",null==o.invoice?null:o.invoice.is_proforma),e.xp6(3),e.Q6J("ngIf",!o.isLoading)("ngIfElse",p),e.xp6(3),e.Q6J("ngIf",null==o.invoice?null:o.invoice.is_proforma),e.xp6(2),e.Q6J("ngIf",!o.isLoading),e.xp6(3),e.Q6J("scrollable",!0)("paginator",o.invoiceProducts.length>0)("rows",10)("selection",o.selectedInvoiceProducts)("value",o.invoiceProducts),e.xp6(8),e.Q6J("ngIf",!r.paginator&&!o.isLoadingInvoiceProducts&&o.invoiceProducts.length>0),e.xp6(3),e.Q6J("ngIf",null==o.invoice?null:o.invoice.is_proforma),e.xp6(2),e.Q6J("disabled",o.isLoadingServices),e.xp6(3),e.Q6J("rows",10)("paginator",o.invoiceServices.length>0)("value",o.invoiceServices)("selection",o.selectedService),e.xp6(7),e.Q6J("ngIf",!a.paginator&&!o.isLoadingServices&&o.invoiceServices.length>0),e.xp6(5),e.Q6J("scrollable",!0)("paginator",o.files.length>0)("rows",10)("selection",o.selectedFile)("value",o.files),e.xp6(7),e.Q6J("ngIf",!l.paginator&&!o.isLoadingFiles&&o.files.length>0)}},dependencies:[m.sg,m.O5,m.RF,m.n9,b.yS,v.Hq,v.zx,k.nm,Z.jx,T.iA,T.Ei,T.UA,S.o,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,s.On,Re.XZ,A.D,L.f,B.i,Le.Q,be.NU,Fc.h,m.JJ,M.U],styles:[".reports-invoice-page[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1875rem;font-weight:600}.reports-invoice-page[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{margin-top:-.25rem}.reports-invoice-page__info[_ngcontent-%COMP%]{line-height:1.4;padding:1rem 1.75rem 1.125rem;border-radius:1rem;box-shadow:0 0 .5rem #00000010;background:#fff;position:relative}.reports-invoice-page__info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin-bottom:.75rem}.reports-invoice-page__info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500}.block-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.info-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:41rem}.invoice-product-menubar[_ngcontent-%COMP%]  .p-submenu-list{width:15rem!important}.rma-files[_ngcontent-%COMP%]{-webkit-text-decoration-style:dashed;text-decoration-style:dashed}"]}),n})();function bl(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function Al(n,i){1&n&&(e.ynx(0),e._uU(1,"(QC Processed) "),e.BQk())}function Il(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function ql(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function Rl(n,i){1&n&&(e.ynx(0),e._uU(1,"Invoice"),e.BQk())}function wl(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function Nl(n,i){1&n&&(e.ynx(0),e._uU(1,"Invoice"),e.BQk())}function Ul(n,i){if(1&n&&e._UZ(0,"input",53),2&n){const t=e.oxw(2);e.s9C("value",null==t.invoice?null:t.invoice.self_serial_number)}}function Pl(n,i){if(1&n&&e._UZ(0,"input",53),2&n){const t=e.oxw(2);e.s9C("value",null==t.invoice?null:t.invoice.self_proforma_serial_number)}}function Fl(n,i){if(1&n&&e._UZ(0,"p-multiSelect",55),2&n){const t=e.oxw(3);e.Q6J("disabled",!t.related.length)("options",t.related)}}function Jl(n,i){if(1&n&&(e.TgZ(0,"div",34)(1,"div",35)(2,"label"),e._uU(3," Relation With Proforma Invoice"),e.qZA(),e.YNc(4,Fl,1,2,"p-multiSelect",54),e.qZA()()),2&n){const t=e.oxw(2),o=e.MAs(50);e.xp6(4),e.Q6J("ngIf",!t.isLoadingRelated)("ngIfElse",o)}}function kl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" (",null==t.invoice||null==t.invoice.currency?null:t.invoice.currency.symbol,") ")}}function Sl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.hij(" (",null==t.invoice||null==t.invoice.currency?null:t.invoice.currency.symbol,") ")}}function Ql(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",45)(1,"div",35)(2,"label"),e._uU(3," Exchange Rate"),e.qZA(),e.TgZ(4,"input",56),e.NdJ("ngModelChange",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.changeRate())}),e.qZA()()()}}function Ml(n,i){if(1&n&&(e.TgZ(0,"div",45)(1,"div",35)(2,"label"),e._uU(3,"Total Price In EUR"),e.qZA(),e._UZ(4,"input",57),e.ALo(5,"moneyFormat"),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(4),e.s9C("value",e.lcZ(5,1,t.form.get("total_price").value*t.form.get("exchange_rate").value))}}function Yl(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"form",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"label"),e._uU(5," Supplier "),e.YNc(6,ql,2,0,"ng-container",4),e.YNc(7,Rl,2,0,"ng-container",4),e._uU(8," Number "),e.qZA(),e._UZ(9,"input",36),e.qZA()(),e.TgZ(10,"div",34)(11,"div",35)(12,"label"),e._uU(13," Internal "),e.YNc(14,wl,2,0,"ng-container",4),e.YNc(15,Nl,2,0,"ng-container",4),e._uU(16," Number "),e.qZA(),e.YNc(17,Ul,1,1,"input",37),e.YNc(18,Pl,1,1,"input",37),e.qZA()(),e.TgZ(19,"div",34)(20,"div",35)(21,"label"),e._uU(22,"Supplier* "),e.qZA(),e.TgZ(23,"pek-company-picker",38),e.NdJ("selectCompany",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectCompany(r))}),e.qZA()()(),e.YNc(24,Jl,5,2,"div",39),e.TgZ(25,"div",34)(26,"div",35)(27,"label"),e._uU(28," Total Price* "),e.YNc(29,kl,2,1,"ng-container",4),e.qZA(),e._UZ(30,"input",40),e.qZA()(),e.TgZ(31,"div",34)(32,"div",35)(33,"label"),e._uU(34,"Pure Total Price "),e.YNc(35,Sl,2,1,"ng-container",4),e.qZA(),e.TgZ(36,"input",41),e.NdJ("input",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.pureTotalChange())}),e.qZA()()(),e.TgZ(37,"div",34)(38,"div",35)(39,"label"),e._uU(40,"Currency"),e.qZA(),e.TgZ(41,"pek-currency-picker",42),e.NdJ("valueChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.changeCurrency(r))}),e.qZA()()(),e.YNc(42,Ql,5,0,"div",43),e.YNc(43,Ml,6,3,"div",43),e.qZA(),e.TgZ(44,"h2",44),e._uU(45,"Dates On Document"),e.qZA(),e.TgZ(46,"div",33)(47,"div",45)(48,"div",35)(49,"label"),e._uU(50,"Invoice Date"),e.qZA(),e._UZ(51,"p-calendar",46),e.qZA()(),e.TgZ(52,"div",45)(53,"div",35)(54,"label"),e._uU(55,"Due Date"),e.qZA(),e._UZ(56,"p-calendar",47),e.qZA()(),e.TgZ(57,"div",45)(58,"div",35)(59,"label"),e._uU(60,"Invoice Reception Date"),e.qZA(),e._UZ(61,"p-calendar",48),e.qZA()(),e.TgZ(62,"div",45),e._UZ(63,"div",35),e.qZA()(),e.TgZ(64,"h2",44),e._uU(65,"System Date"),e.qZA(),e.TgZ(66,"div",33)(67,"div",45)(68,"div",35)(69,"label"),e._uU(70,"Date*"),e.qZA(),e._UZ(71,"p-calendar",49),e.qZA()(),e.TgZ(72,"div",45)(73,"div",35)(74,"label"),e._uU(75,"Items Reception Date"),e.qZA(),e._UZ(76,"p-calendar",50),e.qZA()()(),e.TgZ(77,"div",51)(78,"button",52),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.saveInvoice())}),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(6),e.Q6J("ngIf",null==t.invoice?null:t.invoice.is_proforma),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(7),e.Q6J("ngIf",null==t.invoice?null:t.invoice.is_proforma),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(2),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(1),e.Q6J("ngIf",null==t.invoice?null:t.invoice.is_proforma),e.xp6(5),e.Q6J("currentCompanyId",t.form.get("supplier").value),e.xp6(1),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.is_proforma)),e.xp6(5),e.Q6J("ngIf",null==t.invoice?null:t.invoice.currency),e.xp6(6),e.Q6J("ngIf",null==t.invoice?null:t.invoice.currency),e.xp6(6),e.Q6J("currency",t.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"!==t.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"!==t.form.get("currency").value),e.xp6(8),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(10),e.Q6J("showClear",!0)("readonlyInput",!0),e.xp6(5),e.Q6J("readonlyInput",!0)("showClear",!0),e.xp6(2),e.Q6J("disabled",t.form.invalid)("loading",t.isSaving)}}function Ol(n,i){1&n&&(e.ynx(0),e._uU(1,"Proforma"),e.BQk())}function El(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.createInvoiceService())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",t.isLoadingServices)}}function Ll(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",59),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.complete())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("disabled",(null==t.invoice?null:t.invoice.qc_completed)&&(null==t.invoice?null:t.invoice.completed))("loading",t.isCompletingOrCancellation)}}function Bl(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cancellation())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("loading",t.isCompletingOrCancellation)}}function Dl(n,i){1&n&&(e.TgZ(0,"p",63),e._uU(1,"Choose the Invoice Service to edit"),e.qZA())}function $l(n,i){if(1&n&&(e.TgZ(0,"div",11),e.YNc(1,Dl,2,0,"p",61),e._UZ(2,"p-menubar",62),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.selectedService),e.xp6(1),e.ekj("disabled",!t.selectedService),e.Q6J("model",t.invoiceServiceMenuItems)}}function Gl(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",64),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",65),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",66),e._uU(6,"Price"),e.qZA(),e.TgZ(7,"th",66),e._uU(8,"Other currency"),e.qZA(),e.TgZ(9,"th",66),e._uU(10,"DDV"),e.qZA(),e.TgZ(11,"th",66),e._uU(12,"Discount"),e.qZA(),e.TgZ(13,"th",66),e._uU(14,"Total Price"),e.qZA()())}function jl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.pure_price*o.form.get("exchange_rate").value)," ")}}function Vl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.pure_price)," ")}}function Hl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.AsE("",e.lcZ(2,2,t.pure_price)," ",null==o.invoice||null==o.invoice.currency?null:o.invoice.currency.symbol,"")}}function Kl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit,o=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.ddv_discount_price*o.form.get("exchange_rate").value)," ")}}function zl(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.ddv_discount_price)," ")}}function Wl(n,i){if(1&n&&(e.TgZ(0,"tr",67)(1,"td",68),e._uU(2),e.qZA(),e.TgZ(3,"td",65),e._uU(4),e.qZA(),e.TgZ(5,"td",66),e.YNc(6,jl,3,3,"ng-container",4),e.YNc(7,Vl,3,3,"ng-container",4),e._uU(8," \u20ac "),e.qZA(),e.TgZ(9,"td",66),e.YNc(10,Hl,3,4,"ng-container",4),e.qZA(),e.TgZ(11,"td",66),e._uU(12),e.qZA(),e.TgZ(13,"td",66),e._uU(14),e.ALo(15,"number"),e.qZA(),e.TgZ(16,"td",66),e.YNc(17,Kl,3,3,"ng-container",4),e.YNc(18,zl,3,3,"ng-container",4),e._uU(19," \u20ac "),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.Q6J("pSelectableRow",r.isViewingMode?null:t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.base_service.name),e.xp6(2),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"===r.form.get("currency").value),e.xp6(3),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(2),e.hij("",t.ddv,"%"),e.xp6(2),e.hij("",e.xi3(15,10,t.discount,"1.0"),"%"),e.xp6(3),e.Q6J("ngIf","EUR"!==r.form.get("currency").value),e.xp6(1),e.Q6J("ngIf","EUR"===r.form.get("currency").value)}}function Xl(n,i){1&n&&e._UZ(0,"i",71)}function ep(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function tp(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",69),e.YNc(2,Xl,1,0,"i",70),e.YNc(3,ep,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",12),e.xp6(1),e.Q6J("ngIf",t.isLoadingServices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingServices)}}function np(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",72),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(26);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function op(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",73)(1,"p-button",72),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(26);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function ip(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",75),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.bindInvoice())}),e.qZA()}if(2&n){const t=e.oxw(2);e.Q6J("disabled",t.isLoadingBindedInvoices)("loading",t.isBinding)}}function rp(n,i){if(1&n&&(e.TgZ(0,"div",10)(1,"h2"),e._uU(2,"Binded Invoices"),e.qZA(),e.TgZ(3,"div",11),e.YNc(4,ip,1,2,"button",74),e.qZA()()),2&n){const t=e.oxw();e.xp6(4),e.Q6J("ngIf",!(null!=t.invoice&&t.invoice.completed))}}function ap(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",77),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.deleteBindInvoice())}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled",!t.selectedBindInvoice||(null==t.invoice?null:t.invoice.completed))("loading",t.isDeleteBinding)}}function cp(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",64),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",78),e._uU(4,"ID"),e.qZA(),e.TgZ(5,"th",79),e._uU(6,"Self Serial Number"),e.qZA()())}function sp(n,i){if(1&n&&(e.TgZ(0,"tr",67)(1,"td",68),e._uU(2),e.qZA(),e.TgZ(3,"td",78),e._uU(4),e.qZA(),e.TgZ(5,"td",80),e._uU(6),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw(2);e.Q6J("pSelectableRow",r.isViewingMode?null:t),e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(t.id),e.xp6(2),e.Oqu(t.self_serial_number)}}function lp(n,i){1&n&&e._UZ(0,"i",71)}function pp(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function _p(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",69),e.YNc(2,lp,1,0,"i",70),e.YNc(3,pp,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(1),e.uIk("colspan",10),e.xp6(1),e.Q6J("ngIf",t.isLoadingBindedInvoices),e.xp6(1),e.Q6J("ngIf",!t.isLoadingBindedInvoices)}}function up(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",72),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(3);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function dp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",73)(1,"p-button",72),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(3);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}const mp=function(){return[]};function gp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"p-table",28,76),e.NdJ("selectionChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.selectedBindInvoice=r)}),e.YNc(4,ap,2,2,"ng-template",19),e.YNc(5,cp,7,0,"ng-template",20),e.YNc(6,sp,7,4,"ng-template",21),e.YNc(7,_p,4,3,"ng-template",22),e.YNc(8,up,2,0,"ng-template",23),e.qZA()(),e.YNc(9,dp,3,0,"div",24),e.qZA()}if(2&n){const t=e.MAs(3),o=e.oxw();let r;e.xp6(2),e.Q6J("scrollable",!0)("paginator",(null==o.invoice||null==o.invoice.to_invoices?null:o.invoice.to_invoices.length)>0)("rows",10)("selection",o.selectedBindInvoice)("value",null!==(r=null==o.invoice?null:o.invoice.to_invoices)&&void 0!==r?r:e.DdM(6,mp)),e.xp6(7),e.Q6J("ngIf",!t.paginator&&!o.isLoadingBindedInvoices&&(null==o.invoice?null:o.invoice.to_invoices.length)>0)}}function hp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",11)(1,"button",81),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.openInvoiceFilesModal())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.isLoadingFiles)}}function fp(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",68),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",82),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",66),e._uU(6,"Actions"),e.qZA()())}function vp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",83),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td",83)(6,"div",84)(7,"button",85),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onDownloadFile(a))}),e.qZA(),e.TgZ(8,"button",86),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.onRemoveFile(a.id))}),e.qZA()()()()}if(2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.xp6(2),e.Oqu(o+1),e.xp6(2),e.hij(" ",r.getFileName(t.file)," "),e.xp6(3),e.Q6J("loading",r.addition.has(t.id)),e.xp6(1),e.Q6J("loading",r.deletion.has(t.id))}}function Cp(n,i){1&n&&e._UZ(0,"i",71)}function Zp(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Tp(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",69),e.YNc(2,Cp,1,0,"i",70),e.YNc(3,Zp,2,0,"span",4),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",5),e.xp6(1),e.Q6J("ngIf",t.isLoadingFiles),e.xp6(1),e.Q6J("ngIf",!t.isLoadingFiles)}}function xp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"p-button",72),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(40);return e.KtG(r.paginator=!1)}),e._uU(1,"All "),e.qZA()}}function yp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",73)(1,"p-button",72),e.NdJ("click",function(){e.CHM(t),e.oxw();const r=e.MAs(40);return e.KtG(r.paginator=!0)}),e._uU(2," Return pagination "),e.qZA()()}}function bp(n,i){1&n&&(e.TgZ(0,"div",87),e._UZ(1,"i",71),e.qZA())}function Ap(n,i){1&n&&(e.TgZ(0,"div",88),e._UZ(1,"i",89),e.qZA())}let Ip=(()=>{class n{constructor(t,o,r,a,l,p,_){this.modalService=t,this.route=o,this.router=r,this.servicesService=a,this.adapterService=l,this.invoiceService=p,this.fb=_,this.isCompletingOrCancellation=!1,this.isDeleteBinding=!1,this.isBinding=!1,this.isLoadingBindedInvoices=!1,this.isPureTotalChanged=!1,this.invoiceServiceMenuItems=[{label:"Selected Invoice Service",items:[{label:"Edit",icon:"pi pi-pencil",command:()=>this.editInvoiceService()},{label:"Remove",icon:"pi pi-trash",command:()=>this.removeInvoiceService()}]}],this.deletion=new Set,this.addition=new Set,this.isLoading=!0,this.isViewingMode=!1,this.files=[],this.isLoadingFiles=!0,this.invoiceId=this.route.snapshot.paramMap.get("id"),this.isLoadingRelated=!0,this.form=this.fb.group({supplier_serial_number:[""],supplier:[{value:null},s.kI.required],supplier_total_price:[{value:0,disabled:!1},s.kI.required],total_price:[{value:0,disabled:this.isViewingMode}],pure_total_price:[{value:0,disabled:!1}],id:[this.invoiceId,s.kI.required],currency:[null,s.kI.required],system_creation_date:[null],invoice_date:[null],items_reception_date:[null],due_date:[null],invoice_reception_date:[null],proformas:[[]],exchange_rate:[1]}),this.related=[],this.isSaving=!1,this.isLoadingServices=!1}ngOnInit(){this.getInvoice(),this.getFiles(),this.getServices()}getInvoice(){this.isPureTotalChanged=!1,this.isLoading=!0,this.isLoadingBindedInvoices=!0,this.selectedBindInvoice=null,this.invoice&&(this.invoice.to_invoices=[]),this.invoiceService.getById(+this.invoiceId).subscribe(t=>{this.invoice=t,t.supplier?this.invoiceService.get([{name:"supplier",value:t.supplier.id},{name:"is_proforma",value:!t.is_proforma}]).subscribe(o=>{this.related=o,this.isLoadingRelated=!1}):this.isLoadingRelated=!1,this.invoice.total_price=Math.round(100*this.invoice.total_price)/100,this.invoice.order||this.form.get("supplier").enable(),null!=this.invoice.invoice_date&&(this.invoice.invoice_date=new Date(this.invoice.invoice_date)),null!=this.invoice.system_creation_date&&(this.invoice.system_creation_date=new Date(this.invoice.system_creation_date)),null!=this.invoice.due_date&&(this.invoice.due_date=new Date(this.invoice.due_date)),null!=this.invoice.invoice_reception_date&&(this.invoice.invoice_reception_date=new Date(this.invoice.invoice_reception_date)),null!=this.invoice.items_reception_date&&(this.invoice.items_reception_date=new Date(this.invoice.items_reception_date)),this.form.patchValue(this.invoice),this.invoice.supplier&&this.form.get("supplier").patchValue(this.invoice.supplier.id),this.invoice.currency&&this.form.get("currency").patchValue(this.invoice.currency.code),this.invoice.proformas&&this.form.get("proformas").patchValue(this.invoice.proformas.map(o=>o.id)),this.isLoading=!1,this.isLoadingBindedInvoices=!1})}getServices(){this.selectedService=null,this.isLoadingServices=!0,this.invoiceServices=[],this.servicesService.get([{name:"service_invoice",value:this.invoiceId}]).subscribe(t=>{this.invoiceServices=t,this.invoice?.pure_total_price&&this.form.get("pure_total_price").setValue(this.invoice.pure_total_price.toFixed(2)),this.isLoadingServices=!1})}onSelectCompany(t){this.form.get("supplier").patchValue(t)}changeCurrency(t){this.form.get("currency").patchValue(t?.code??null),this.invoice.currency.symbol=t?.symbol??"None","EUR"===this.form.get("currency").value&&(this.form.get("exchange_rate").setValue(1),this.form.get("pure_total_price").setValue(this.form.get("pure_total_price").value.toFixed(2)))}calculatePureTotalPrice(){let t=0;return this.invoiceServices.forEach(o=>{const r=parseFloat(o.pure_price);t+=r-r*parseFloat(o.discount)/100}),t=parseFloat(t.toFixed(3)),t}saveInvoice(){if(this.form.valid){this.isSaving=!0;const t=this.form.value;t.system_creation_date=this.adapterService.dateAdapter(this.form.value.system_creation_date),t.due_date=this.adapterService.dateAdapter(this.form.value.due_date),t.invoice_reception_date=this.adapterService.dateAdapter(this.form.value.invoice_reception_date),t.invoice_date=this.adapterService.dateAdapter(this.form.value.invoice_date),this.isPureTotalChanged&&this.invoice.pure_total_price!==this.form.get("pure_total_price").value&&(t.manual_pure_total_price=this.form.get("pure_total_price").value),this.invoiceService.updatePartly(t).pipe((0,U.x)(()=>this.isSaving=!1)).subscribe(()=>{this.getInvoice()})}}changeRate(){}getFileName(t){const o=t.split("/");return o[o.length-1]}onRemoveFile(t){this.modalService.confirm("danger").subscribe(o=>{o&&(this.deletion.add(t),this.invoiceService.removeFile(t).pipe((0,U.x)(()=>this.deletion.delete(t))).subscribe(()=>{const r=this.files.findIndex(a=>a.id===t);this.files.splice(r,1)}))})}onDownloadFile(t){this.addition.add(t.id),this.invoiceService.downloadFile(t.id).pipe((0,U.x)(()=>this.addition.delete(t.id))).subscribe(o=>{const r=this.getFileName(t.file);this.adapterService.downloadFile(r,o)})}openInvoiceFilesModal(){this.invoiceService.openInvoiceFilesModal(+this.invoiceId).subscribe(t=>{this.getFiles()})}getFiles(){this.files=[],this.isLoadingFiles=!0,this.invoiceService.getFiles(+this.invoiceId).subscribe(t=>{this.files=t,this.isLoadingFiles=!1})}createInvoiceService(){this.servicesService.createEditServiceModal("create",+this.invoiceId,"service").subscribe(t=>{t&&(this.getServices(),this.getInvoice())})}editInvoiceService(){this.servicesService.createEditServiceModal("edit",+this.invoiceId,"service",this.selectedService).subscribe(t=>{t&&(this.getServices(),this.getInvoice())})}removeInvoiceService(){this.modalService.confirm("danger").subscribe(t=>{t&&this.servicesService.delete(this.selectedService.id).subscribe(()=>{this.getServices(),this.getInvoice()})})}cancellation(){this.modalService.confirm("success").pipe((0,R.h)(Boolean)).subscribe(()=>{this.isCompletingOrCancellation=!0,this.invoiceService.cancellation({id:this.invoice.id,completed:!1}).pipe((0,U.x)(()=>this.isCompletingOrCancellation=!1),(0,g.b)(()=>this.invoice.completed=!1)).subscribe()})}complete(){this.modalService.confirm("success").pipe((0,R.h)(Boolean)).subscribe(()=>{this.isCompletingOrCancellation=!0,this.invoiceService.updatePartly({id:this.invoice.id,completed:!0}).pipe((0,U.x)(()=>this.isCompletingOrCancellation=!1),(0,g.b)(()=>this.invoice.completed=!0)).subscribe()})}bindInvoice(){this.invoiceService.bindInvoiceModal(this.invoice.is_proforma).subscribe(t=>{if(t){this.isBinding=!0;const o=[];this.invoice.to_invoices.forEach(a=>{o.push(a.id)}),o.push(t.id),this.invoiceService.bindInvoice(this.invoice.id,{to_invoices:o}).pipe((0,U.x)(()=>this.isBinding=!1)).subscribe(()=>{this.getInvoice()})}})}deleteBindInvoice(){this.modalService.confirm("danger").subscribe(t=>{if(t){this.isDeleteBinding=!0;let o=[];this.invoice.to_invoices.forEach(a=>{o.push(a.id)}),o=o.filter(a=>a!==this.selectedBindInvoice.id),this.invoiceService.bindInvoice(this.invoice.id,{to_invoices:o}).pipe((0,U.x)(()=>this.isDeleteBinding=!1)).subscribe(()=>{this.getInvoice()})}})}pureTotalChange(){this.isPureTotalChanged=!0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(Y.Z),e.Y36(b.gz),e.Y36(b.F0),e.Y36(we),e.Y36(J.v),e.Y36(Oe.G),e.Y36(s.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-service-invoice-page"]],decls:51,vars:24,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[4,"ngIf"],[1,"page__content"],[1,"reports-invoice-page"],[1,"mb-4"],[1,"reports-invoice-page__card","reports-invoice-page__info","mb-4"],[3,"formGroup",4,"ngIf","ngIfElse"],[1,"block-header","mb-4"],[1,"d-flex"],["pButton","","type","button","icon","pi pi-plus","label","New Service",3,"disabled","click",4,"ngIf"],["pButton","","class","ml-2 mr-2 p-button-success p-button-icon","type","button","icon","pi pi-check","label","Complete",3,"disabled","loading","click",4,"ngIf"],["pButton","","class","mr-2 p-button-danger p-button-icon","type","button","icon","pi pi-times","label","Cancellation",3,"loading","click",4,"ngIf"],[1,"page__card","mb-4"],[1,"page__table"],["selectionMode","single",3,"rows","paginator","value","selection","selectionChange"],["st",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","paginatorright"],["class","paginator-return-pagination",4,"ngIf"],["class","block-header mb-4",4,"ngIf"],["class","page__card mb-4",4,"ngIf"],[1,"page__card"],["selectionMode","single","scrollHeight","calc(100vh - 18.8rem)",3,"scrollable","paginator","rows","selection","value","selectionChange"],["fs",""],["infoLoading",""],["spinner",""],[3,"formGroup"],[1,"row"],[1,"col-6"],[1,"form-group"],["type","text","pInputText","","formControlName","supplier_serial_number"],["pInputText","","type","text","disabled","",3,"value",4,"ngIf"],[3,"currentCompanyId","selectCompany"],["class","col-6",4,"ngIf"],["pInputText","","formControlName","total_price","type","number","step","0.01"],["pInputText","","type","number","step","0.01","formControlName","pure_total_price",3,"input"],[3,"currency","valueChange"],["class","col-3",4,"ngIf"],[1,"mt-4"],[1,"col-3"],["formControlName","invoice_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],["formControlName","due_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],["formControlName","invoice_reception_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],["formControlName","system_creation_date","dataType","date","dateFormat","dd/mm/yy",3,"showClear","readonlyInput"],["formControlName","items_reception_date","dataType","date","dateFormat","dd/mm/yy",3,"readonlyInput","showClear"],[1,"d-flex","mt-2"],["pButton","","type","button","label","Save",1,"ml-auto",3,"disabled","loading","click"],["pInputText","","type","text","disabled","",3,"value"],["formControlName","proformas","optionLabel","self_proforma_serial_number","optionValue","id","placeholder","Select Relation",3,"disabled","options",4,"ngIf","ngIfElse"],["formControlName","proformas","optionLabel","self_proforma_serial_number","optionValue","id","placeholder","Select Relation",3,"disabled","options"],["pInputText","","formControlName","exchange_rate","type","number","step","0.0001",3,"ngModelChange"],["pInputText","","disabled","","readonly","","type","text","step","0.01",1,"form-control",3,"value"],["pButton","","type","button","icon","pi pi-plus","label","New Service",3,"disabled","click"],["pButton","","type","button","icon","pi pi-check","label","Complete",1,"ml-2","mr-2","p-button-success","p-button-icon",3,"disabled","loading","click"],["pButton","","type","button","icon","pi pi-times","label","Cancellation",1,"mr-2","p-button-danger","p-button-icon",3,"loading","click"],["class","subtitle",4,"ngIf"],[1,"ml-auto",3,"model"],[1,"subtitle"],[1,"index-header","text-center",2,"width","5%"],[2,"width","45%"],[1,"text-center",2,"width","10%"],[3,"pSelectableRow"],[1,"text-center",2,"width","5%"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],["type","button","styleClass","p-button-text",3,"click"],[1,"paginator-return-pagination"],["pButton","","type","button","icon","pi pi-plus","class","ml-auto p-button-icon","label","Bind Invoice",3,"disabled","loading","click",4,"ngIf"],["pButton","","type","button","icon","pi pi-plus","label","Bind Invoice",1,"ml-auto","p-button-icon",3,"disabled","loading","click"],["bs",""],["pButton","","type","button","icon","pi pi-times","label","Delete Bind Invoice",1,"ml-auto","p-button-danger","p-button-icon",3,"disabled","loading","click"],[1,"text-center",2,"width","45%"],[1,"text-center",2,"width","50%"],[1,"text-center",2,"width","55%"],["pButton","","type","button","icon","pi pi-plus","label","Add File",1,"ml-auto",3,"disabled","click"],[2,"width","85%"],[1,"text-center"],[1,"d-flex","justify-content-center"],["pButton","","type","button","icon","pi pi-download",1,"p-button-primary","p-button-rounded","p-button-outlined","p-button-rounded_small","mr-2",3,"loading","click"],["pButton","","type","button","icon","pi pi-trash",1,"p-button-danger","p-button-rounded","p-button-outlined","p-button-rounded_small",3,"loading","click"],[1,"info-loading"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e.YNc(5,bl,2,0,"ng-container",4),e._uU(6," Invoice Edit "),e.YNc(7,Al,2,0,"ng-container",4),e.qZA()()()(),e.TgZ(8,"div",5)(9,"div",6)(10,"h2",7),e.YNc(11,Il,2,0,"ng-container",4),e._uU(12," Invoice Info "),e.qZA(),e.TgZ(13,"div",8),e.YNc(14,Yl,79,26,"form",9),e.qZA(),e.TgZ(15,"div",10)(16,"h2"),e.YNc(17,Ol,2,0,"ng-container",4),e._uU(18," Invoice Services "),e.qZA(),e.TgZ(19,"div",11),e.YNc(20,El,1,1,"button",12),e.YNc(21,Ll,1,2,"button",13),e.YNc(22,Bl,1,1,"button",14),e.qZA()(),e.TgZ(23,"div",15)(24,"div",16)(25,"p-table",17,18),e.NdJ("selectionChange",function(a){return o.selectedService=a}),e.YNc(27,$l,3,4,"ng-template",19),e.YNc(28,Gl,15,0,"ng-template",20),e.YNc(29,Wl,20,13,"ng-template",21),e.YNc(30,tp,4,3,"ng-template",22),e.YNc(31,np,2,0,"ng-template",23),e.qZA()(),e.YNc(32,op,3,0,"div",24),e.qZA(),e.YNc(33,rp,5,1,"div",25),e.YNc(34,gp,10,7,"div",26),e.TgZ(35,"h2",7),e._uU(36,"Files"),e.qZA(),e.TgZ(37,"div",27)(38,"div",16)(39,"p-table",28,29),e.NdJ("selectionChange",function(a){return o.selectedFile=a}),e.YNc(41,hp,2,1,"ng-template",19),e.YNc(42,fp,7,0,"ng-template",20),e.YNc(43,vp,9,4,"ng-template",21),e.YNc(44,Tp,4,3,"ng-template",22),e.YNc(45,xp,2,0,"ng-template",23),e.qZA()(),e.YNc(46,yp,3,0,"div",24),e.qZA()()(),e.YNc(47,bp,2,0,"ng-template",null,30,e.W1O),e.YNc(49,Ap,2,0,"ng-template",null,31,e.W1O)),2&t){const r=e.MAs(26),a=e.MAs(40),l=e.MAs(48);e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(2),e.Q6J("ngIf",null==o.invoice?null:o.invoice.is_proforma),e.xp6(2),e.Q6J("ngIf",null==o.invoice?null:o.invoice.qc_completed),e.xp6(4),e.Q6J("ngIf",null==o.invoice?null:o.invoice.is_proforma),e.xp6(3),e.Q6J("ngIf",!o.isLoading)("ngIfElse",l),e.xp6(3),e.Q6J("ngIf",null==o.invoice?null:o.invoice.is_proforma),e.xp6(3),e.Q6J("ngIf",!(null!=o.invoice&&o.invoice.completed)),e.xp6(1),e.Q6J("ngIf",!(null!=o.invoice&&o.invoice.qc_completed||null!=o.invoice&&o.invoice.completed)),e.xp6(1),e.Q6J("ngIf",null==o.invoice?null:o.invoice.completed),e.xp6(3),e.Q6J("rows",10)("paginator",o.invoiceServices.length>0)("value",o.invoiceServices)("selection",o.selectedService),e.xp6(7),e.Q6J("ngIf",!r.paginator&&!o.isLoadingServices&&o.invoiceServices.length>0),e.xp6(1),e.Q6J("ngIf",!(null!=o.invoice&&o.invoice.is_proforma)),e.xp6(1),e.Q6J("ngIf",!(null!=o.invoice&&o.invoice.is_proforma)),e.xp6(5),e.Q6J("scrollable",!0)("paginator",o.files.length>0)("rows",10)("selection",o.selectedFile)("value",o.files),e.xp6(7),e.Q6J("ngIf",!a.paginator&&!o.isLoadingFiles&&o.files.length>0)}},dependencies:[m.O5,v.Hq,v.zx,k.nm,Z.jx,T.iA,T.Ei,S.o,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,A.D,L.f,B.i,Le.Q,be.NU,m.JJ,M.U],styles:[".reports-invoice-page[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.1875rem;font-weight:600}.reports-invoice-page[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{margin-top:-.25rem}.reports-invoice-page__info[_ngcontent-%COMP%]{line-height:1.4;padding:1rem 1.75rem 1.125rem;border-radius:1rem;box-shadow:0 0 .5rem #00000010;background:#fff;position:relative}.reports-invoice-page__info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;margin-bottom:.75rem}.reports-invoice-page__info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-weight:500}.block-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.info-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:41rem}"]}),n})();function qp(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",14),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",15),e._uU(4,"Service"),e.qZA(),e.TgZ(5,"th",16),e._uU(6,"Price"),e.qZA(),e._UZ(7,"th",17),e.qZA())}function Rp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr")(1,"td",18),e._uU(2),e.qZA(),e.TgZ(3,"td",15),e._uU(4),e.qZA(),e.TgZ(5,"td",16),e._uU(6),e.ALo(7,"moneyFormat"),e.qZA(),e.TgZ(8,"td",17)(9,"button",19),e.NdJ("click",function(){const a=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.remove(a.id))}),e.qZA()()()}if(2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.xp6(2),e.Oqu(o+1),e.xp6(2),e.Oqu(null==t?null:t.accountingservice),e.xp6(2),e.hij("",e.lcZ(7,4,null==t?null:t.value)," \u20ac"),e.xp6(3),e.Q6J("loading",r.deletion.has(t.id))}}function wp(n,i){1&n&&(e.TgZ(0,"tr")(1,"td",20)(2,"span"),e._uU(3,"No Records Found"),e.qZA()()()),2&n&&(e.xp6(1),e.uIk("colspan",10))}let Np=(()=>{class n{constructor(t,o,r,a,l){this.data=t,this.dialogRef=o,this.additionalExpenseService=r,this.fb=a,this.modalService=l,this.form=this.fb.group({value:[null,[s.kI.required]],accountingservice:[null,[s.kI.required,s.kI.min(0)]]}),this.servicesType=[{label:"Production cost",value:"Production cost"},{label:"Small material",value:"Small material"}],this.services=[],this.deletion=new Set}ngOnInit(){this.services=JSON.parse(JSON.stringify(this.data.services)),this.services=this.services.map(t=>t)}add(){const t={...this.form.value};"old"===this.data.type?t.listproduct=this.data.id:t.task=this.data.id,this.isPending=!0,"old"===this.data.type?this.additionalExpenseService.createExpanse(t).pipe((0,U.x)(()=>this.isPending=!1),(0,g.b)(()=>{this.form.reset()})).subscribe(o=>{this.data.services.push(o),this.services.push(o),this.services=this.services.map(r=>r)}):this.additionalExpenseService.createExpanseTask(t).pipe((0,U.x)(()=>this.isPending=!1),(0,g.b)(()=>{this.form.reset()})).subscribe(o=>{this.data.services.push(o),this.services.push(o),this.services=this.services.map(r=>r)})}remove(t){this.modalService.confirm("danger").pipe((0,R.h)(Boolean)).subscribe(()=>{this.deletion.add(t),"old"===this.data.type?this.additionalExpenseService.removeExpanse(t).subscribe(o=>{const r=this.data.services.findIndex(a=>a.id===t);this.data.services.splice(r,1),this.services.splice(r,1),this.deletion.delete(t),this.services=this.services.map(a=>a)}):this.additionalExpenseService.removeExpanseTask(t).subscribe(o=>{const r=this.data.services.findIndex(a=>a.id===t);this.data.services.splice(r,1),this.services.splice(r,1),this.deletion.delete(t),this.services=this.services.map(a=>a)})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(x.WI),e.Y36(x.so),e.Y36(xe),e.Y36(s.qu),e.Y36(Y.Z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-additional-expenses-modal"]],decls:21,vars:11,consts:[[1,"modal-header"],[1,"modal-header__title"],[1,"form-row",3,"formGroup"],[1,"form-group"],["formControlName","accountingservice","placeholder","Service","optionValue","value","optionLabel","label",3,"showClear","options"],["pInputText","","type","number","formControlName","value"],["pButton","","type","button","icon","pi pi-plus","label","Add",1,"p-button-icon",3,"loading","disabled","click"],["selectionMode","single","scrollHeight","calc(100vh - 19rem)",3,"rows","scrollable","paginator","value","selection","selectionChange"],["st",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"justify-content-between"],["pButton","","type","button","label","Cancel",1,"p-button-danger",3,"mat-dialog-close"],[1,"index-header","text-center",2,"width","10%"],[1,"text-center",2,"width","45%"],[1,"text-center",2,"width","30%"],[2,"width","15%"],[1,"text-center",2,"width","10%"],["pButton","","icon","pi pi-times","type","button",1,"p-button-danger","p-button-icon",3,"loading","click"],[1,"text-center","p-4"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h2",1),e._uU(2," Additional Expenses "),e.qZA()(),e.TgZ(3,"mat-dialog-content")(4,"form",2)(5,"div",3)(6,"label"),e._uU(7,"Service*"),e.qZA(),e._UZ(8,"p-dropdown",4),e.qZA(),e.TgZ(9,"div",3)(10,"label"),e._uU(11,"Cost*"),e.qZA(),e._UZ(12,"input",5),e.qZA(),e.TgZ(13,"button",6),e.NdJ("click",function(){return o.add()}),e.qZA()(),e.TgZ(14,"p-table",7,8),e.NdJ("selectionChange",function(a){return o.selectedProformaInvoice=a}),e.YNc(16,qp,8,0,"ng-template",9),e.YNc(17,Rp,10,6,"ng-template",10),e.YNc(18,wp,4,1,"ng-template",11),e.qZA()(),e.TgZ(19,"mat-dialog-actions",12),e._UZ(20,"button",13),e.qZA()),2&t&&(e.xp6(4),e.Q6J("formGroup",o.form),e.xp6(4),e.Q6J("showClear",!0)("options",o.servicesType),e.xp6(5),e.Q6J("loading",o.isPending)("disabled",o.form.invalid),e.xp6(1),e.Q6J("rows",10)("scrollable",!0)("paginator",o.services.length>0)("value",o.services)("selection",o.selectedProformaInvoice),e.xp6(6),e.Q6J("mat-dialog-close",!1))},dependencies:[v.Hq,Z.jx,T.iA,S.o,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,x.ZT,x.xY,x.H8,de.Lt,M.U],styles:[".form-row[_ngcontent-%COMP%]{display:flex;gap:.75rem;align-items:flex-end;margin-bottom:.5rem;margin-top:-.25rem}.form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{width:50%}.form-row[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:.625rem}.remove-btn[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:center;color:var(--theme-color-danger)}"]}),n})(),Ne=(()=>{class n{constructor(t,o){this.httpClient=t,this.dialog=o,this.API_URL=N.N.base_url+N.N.production_url}costReportsPagination(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+"tasks/cost_reports_list/"+o).pipe((0,y.U)(r=>r.data))}costReports(t){let o="";return t&&t.forEach((r,a)=>{o+=a>0?"&"+r.name+"="+r.value:"?"+r.name+"="+r.value}),this.httpClient.get(this.API_URL+"tasks/cost_reports_list/"+o).pipe((0,y.U)(r=>r.data))}getCostReport(t){return this.httpClient.get(this.API_URL+"tasks/"+t+"/cost_report/").pipe((0,y.U)(o=>o.data))}additionalExpensesModal(t,o,r){return this.dialog.open(Np,{width:"50rem",height:"auto",data:{type:t,id:o,services:r},autoFocus:!1,panelClass:"modal-overflow-visible",enterAnimationDuration:"250ms"}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG($.eN),e.LFG(x.uw))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Up=d(9832),Pp=d(9642);const Fp=["paginator"];function Jp(n,i){1&n&&(e.TgZ(0,"p",28),e._uU(1,"Choose the Cost Reports to edit"),e.qZA())}function kp(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",29),e._uU(2,"#"),e.qZA(),e.TgZ(3,"th",30),e._uU(4,"ID"),e.qZA(),e.TgZ(5,"th",31),e._uU(6,"Code"),e.qZA(),e.TgZ(7,"th",32),e._uU(8,"Name"),e.qZA(),e.TgZ(9,"th",33),e._uU(10,"Date"),e.qZA(),e.TgZ(11,"th",33),e._uU(12,"Cost SUM"),e.qZA()())}function Sp(n,i){1&n&&(e.TgZ(0,"b"),e._uU(1,"(old)"),e.qZA())}function Qp(n,i){if(1&n&&(e.TgZ(0,"tr",34)(1,"td",35),e._uU(2),e.qZA(),e.TgZ(3,"td",30),e._uU(4),e.qZA(),e.TgZ(5,"td",31),e._uU(6),e.YNc(7,Sp,2,0,"b",36),e.qZA(),e.TgZ(8,"td",32),e._uU(9),e.qZA(),e.TgZ(10,"td",33),e._uU(11),e.ALo(12,"date"),e.qZA(),e.TgZ(13,"td",33),e._uU(14),e.ALo(15,"moneyFormat"),e.qZA()()),2&n){const t=i.$implicit,o=i.rowIndex,r=e.oxw();e.Q6J("pSelectableRow",t),e.xp6(2),e.Oqu(10*(r.currentPage-1)+o+1),e.xp6(2),e.Oqu(t.list_product_id),e.xp6(2),e.hij("",t.nomenclature.code," "),e.xp6(1),e.Q6J("ngIf",t.is_old_cost_report),e.xp6(2),e.Oqu(t.nomenclature.name),e.xp6(2),e.Oqu(e.xi3(12,8,t.completed,"dd/MM/yyyy")),e.xp6(3),e.hij("",e.lcZ(15,11,t.total_cost)," \u20ac")}}function Mp(n,i){1&n&&e._UZ(0,"i",39)}function Yp(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Op(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",37),e.YNc(2,Mp,1,0,"i",38),e.YNc(3,Yp,2,0,"span",36),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",10),e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading)}}function Ep(n,i){1&n&&(e.TgZ(0,"div",40),e._UZ(1,"i",39),e.qZA())}function Lp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",41)(1,"p-paginator",42,43),e.NdJ("onPageChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.paginate(r))}),e.qZA(),e.TgZ(3,"p-button",44),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onShowAll(!0))}),e._uU(4," All "),e.qZA()()}if(2&n){const t=e.oxw();e.ekj("paginator-wrapper_hide",0===t.reportsCount),e.xp6(1),e.Q6J("rows",10)("totalRecords",t.reportsCount)}}function Bp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",45)(1,"p-button",46),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.onShowAll(!1))}),e._uU(2," Return pagination "),e.qZA()()}}let ne=class{constructor(i,t,o,r,a){this.fb=i,this.adapterService=t,this.costReportsService=o,this.router=r,this.route=a,this.currentPage=1,this.isStartFirstPage=!1,this.searchForm=this.fb.group({list_product__nomenclature__name:[null],name:[null],list_product__nomenclature__code:[null],code:[null],warehouse:[null],locator:[null]}),this.name$=new P.x,this.code$=new P.x,this.search$=new he.X(null),this.isShowAll=!1,this.queryKey=this.adapterService.generateQueryKey(this.searchForm),this.query=[],this.isLoading=!0,this.reportsCount=0,this.selectedReport=null,this.reports$=this.search$.pipe((0,g.b)(()=>this.prepareForSearch()),(0,O.w)(()=>(0,ke.s)(()=>!this.isShowAll,this.costReportsService.costReportsPagination(this.query).pipe((0,g.b)(l=>this.reportsCount=l.count),(0,y.U)(l=>l.results)),this.costReportsService.costReports(this.query).pipe((0,g.b)(l=>this.reportsCount=l.length)))),(0,g.b)(()=>this.paginateToFistPage()),(0,g.b)(()=>this.isLoading=!1),(0,C.t)(this))}ngOnInit(){this.name$.pipe((0,I.b)(150),(0,g.b)(()=>this.searchForm.get("name").patchValue(this.searchForm.get("list_product__nomenclature__name").value)),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe(),this.code$.pipe((0,I.b)(150),(0,g.b)(()=>this.searchForm.get("code").patchValue(this.searchForm.get("list_product__nomenclature__code").value)),(0,g.b)(()=>this.search$.next()),(0,Q.x)(),(0,C.t)(this)).subscribe()}prepareForSearch(){this.isLoading=!0,this.selectedReport=null;const i=this.adapterService.generateQueryKey(this.searchForm);i!==this.queryKey&&(this.currentPage=1,this.queryKey=i,this.isStartFirstPage=!0),this.query=[{name:"page",value:this.currentPage}],this.isShowAll||this.query.push({name:"paginated",value:!0});for(const t in this.searchForm.controls)null!==this.searchForm.controls[t].value&&""!==this.searchForm.controls[t].value&&this.query.push({name:t,value:this.searchForm.controls[t].value})}paginate(i){this.isStartFirstPage||(this.currentPage=i.page+1,this.search$.next())}onShowAll(i){this.isShowAll=i,this.isShowAll||(this.currentPage=1),this.search$.next()}paginateToFistPage(){this.isStartFirstPage&&this.paginator?.changePage(0),this.isStartFirstPage=!1}onSelectWarehouse(i){this.searchForm.get("warehouse").patchValue(i),this.search$.next()}onSelectLocator(i){this.searchForm.get("locator").patchValue(i),this.search$.next()}};ne.\u0275fac=function(i){return new(i||ne)(e.Y36(s.qu),e.Y36(J.v),e.Y36(Ne),e.Y36(b.F0),e.Y36(b.gz))},ne.\u0275cmp=e.Xpm({type:ne,selectors:[["pek-reports-cost-reports"]],viewQuery:function(i,t){if(1&i&&e.Gf(Fp,5),2&i){let o;e.iGM(o=e.CRH())&&(t.paginator=o.first)}},decls:49,vars:20,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__tools"],[1,"page__content"],[1,"page__card"],[1,"form","mb-3",3,"formGroup"],[1,"row"],[1,"col-3"],[1,"form-group"],["type","text","pInputText","","formControlName","list_product__nomenclature__name",3,"ngModelChange"],["type","text","pInputText","","formControlName","list_product__nomenclature__code",3,"ngModelChange"],[3,"selectWarehouse"],[3,"warehouseId","isAllLocators","isDisabled","selectLocator"],["inputId","binary",3,"binary"],[1,"col-12","mt-1"],[1,"d-flex"],["class","subtitle",4,"ngIf"],["pButton","","type","button","icon","pi pi-angle-double-right","label","Cost Report","target","_blank",1,"ml-auto","p-button-icon",3,"routerLink"],[1,"table-pagination-preloader"],["selectionMode","single","scrollHeight","calc(100vh - 24.25rem)",3,"rows","scrollable","value","selection","selectionChange"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","pagination-preloader pagination-preloader_bord",4,"ngIf"],["class","paginator-wrapper",3,"paginator-wrapper_hide",4,"ngIf"],["class","paginator-return-pagination",4,"ngIf"],[1,"subtitle"],[1,"index-header","text-center",2,"width","5%"],[1,"text-center",2,"width","8%"],[2,"width","22%"],[2,"width","40%"],[1,"text-center",2,"width","15%"],[3,"pSelectableRow"],[1,"text-center",2,"width","5%"],[4,"ngIf"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],[1,"pagination-preloader","pagination-preloader_bord"],[1,"paginator-wrapper"],[3,"rows","totalRecords","onPageChange"],["paginator",""],["type","button","styleClass","p-button-text",1,"paginator-all",3,"click"],[1,"paginator-return-pagination"],["type","button","styleClass","p-button-text",3,"click"]],template:function(i,t){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Cost Reports"),e.qZA()(),e._UZ(6,"div",4),e.qZA()(),e.TgZ(7,"div",5)(8,"div",6)(9,"form",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"label"),e._uU(14,"Name"),e.qZA(),e.TgZ(15,"input",11),e.NdJ("ngModelChange",function(){return t.name$.next()}),e.qZA()()(),e.TgZ(16,"div",9)(17,"div",10)(18,"label"),e._uU(19,"Code"),e.qZA(),e.TgZ(20,"input",12),e.NdJ("ngModelChange",function(){return t.code$.next()}),e.qZA()()(),e.TgZ(21,"div",9)(22,"div",10)(23,"label"),e._uU(24,"Warehouse"),e.qZA(),e.TgZ(25,"pek-warehouse-picker",13),e.NdJ("selectWarehouse",function(r){return t.onSelectWarehouse(r)}),e.qZA()()(),e.TgZ(26,"div",9)(27,"div",10)(28,"label"),e._uU(29,"Locator"),e.qZA(),e.TgZ(30,"pek-locator-picker",14),e.NdJ("selectLocator",function(r){return t.onSelectLocator(r)}),e.qZA()()(),e.TgZ(31,"div",9)(32,"div",10)(33,"label"),e._uU(34,"Zero price"),e.qZA(),e._UZ(35,"p-checkbox",15),e.qZA()(),e.TgZ(36,"div",16)(37,"div",17),e.YNc(38,Jp,2,0,"p",18),e._UZ(39,"a",19),e.qZA()()()(),e.TgZ(40,"div",20)(41,"p-table",21),e.NdJ("selectionChange",function(r){return t.selectedReport=r}),e.ALo(42,"async"),e.YNc(43,kp,13,0,"ng-template",22),e.YNc(44,Qp,16,13,"ng-template",23),e.YNc(45,Op,4,3,"ng-template",24),e.qZA(),e.YNc(46,Ep,2,0,"div",25),e.YNc(47,Lp,5,4,"div",26),e.qZA(),e.YNc(48,Bp,3,0,"div",27),e.qZA()()),2&i&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(6),e.Q6J("formGroup",t.searchForm),e.xp6(21),e.Q6J("warehouseId",t.searchForm.get("warehouse").value)("isAllLocators",!1)("isDisabled",!0),e.xp6(5),e.Q6J("binary",!0),e.xp6(3),e.Q6J("ngIf",!t.selectedReport),e.xp6(1),e.ekj("disabled",!t.selectedReport),e.Q6J("routerLink",null!=t.selectedReport&&t.selectedReport.is_old_cost_report?"old/"+(null==t.selectedReport?null:t.selectedReport.list_product_id):"new/"+(null==t.selectedReport?null:t.selectedReport.task_id)),e.xp6(2),e.Q6J("rows",10)("scrollable",!0)("value",e.lcZ(42,18,t.reports$))("selection",t.selectedReport),e.xp6(5),e.Q6J("ngIf",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isShowAll),e.xp6(1),e.Q6J("ngIf",t.isShowAll))},dependencies:[m.O5,b.yS,v.Hq,v.zx,Z.jx,T.iA,T.Ei,S.o,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,Re.XZ,A.D,Ae.D,Up.$,Pp.D,m.Ov,m.uU,M.U],styles:[".col-3[_ngcontent-%COMP%]{width:20%}.form[_ngcontent-%COMP%]{margin-top:-.25rem}"]}),ne=(0,F.gn)([(0,C.c)()],ne);var De=d(733);function Dp(n,i){1&n&&(e.TgZ(0,"div",22),e._UZ(1,"i",23),e.qZA())}function $p(n,i){if(1&n&&(e.TgZ(0,"div",24)(1,"span"),e._uU(2),e.ALo(3,"moneyFormat"),e.qZA()()),2&n){const t=i.$implicit;e.xp6(2),e.AsE("",t.accountingservice," : ",e.lcZ(3,2,t.value)," \u20ac ")}}function Gp(n,i){1&n&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2,"Additional Expenses None"),e.qZA()())}function jp(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",12)(1,"button",26),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.services())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.selectedNode||(null==t.selectedNode?null:t.selectedNode.parent))}}function Vp(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",27),e._uU(2,"Code"),e.qZA(),e.TgZ(3,"th",28),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",29),e._uU(6,"UOM"),e.qZA(),e.TgZ(7,"th",30),e._uU(8,"Serial Numbers"),e.qZA(),e.TgZ(9,"th",31),e._uU(10,"Protocol"),e.qZA(),e.TgZ(11,"th",31),e._uU(12,"Quantity"),e.qZA(),e.TgZ(13,"th",29),e._uU(14,"Order"),e.qZA(),e.TgZ(15,"th",32),e._uU(16,"Invoice"),e.qZA(),e.TgZ(17,"th",33),e._uU(18,"Supplier"),e.qZA(),e.TgZ(19,"th",34),e._uU(20,"Technology"),e.qZA(),e.TgZ(21,"th",32),e._uU(22,"Date"),e.qZA(),e.TgZ(23,"th",32),e._uU(24,"Unit Price"),e.qZA(),e.TgZ(25,"th",32),e._uU(26,"Total Price"),e.qZA(),e.TgZ(27,"th",32),e._uU(28,"Unit Cost"),e.qZA(),e.TgZ(29,"th",32),e._uU(30,"Total Cost"),e.qZA(),e.TgZ(31,"th",32),e._uU(32,"Price SUM"),e.qZA(),e.TgZ(33,"th",32),e._uU(34,"Cost SUM"),e.qZA()())}function Hp(n,i){1&n&&(e.TgZ(0,"b"),e._uU(1,"(S)"),e.qZA())}function Kp(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.serial_number.type_with_number?t.serial_number.type_with_number:t.serial_number.id," ")}}function zp(n,i){if(1&n&&(e.TgZ(0,"div")(1,"div"),e.YNc(2,Kp,2,1,"span",40),e.qZA()()),2&n){const t=i.$implicit;e.xp6(2),e.Q6J("ngIf",t.serial_number)}}function Wp(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.warehouse_product_qc_protocol.protocol.name,"\n")}}function Xp(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Wp,2,1,"span",40),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",t.warehouse_product_qc_protocol)}}function e_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Xp,2,1,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function t_(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",t.warehouse_product_qc_protocol.protocol.name,"\n")}}function n_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,t_,2,1,"span",40),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngIf",t.warehouse_product_qc_protocol)}}function o_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.quantity," ")}}function i_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,o_,2,1,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function r_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",t.quantity," ")}}function a_(n,i){if(1&n&&(e.TgZ(0,"a",47),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink","/manufacturing/orders/order/"+(null==t||null==t.order?null:t.order.id)),e.xp6(1),e.Oqu(null==t||null==t.order?null:t.order.id)}}function c_(n,i){if(1&n&&(e.TgZ(0,"a",47),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink","/outsourcing/chains/order/"+(null==t||null==t.order?null:t.order.id)),e.xp6(1),e.Oqu(null==t||null==t.order?null:t.order.id)}}function s_(n,i){if(1&n&&(e.TgZ(0,"a",47),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("routerLink","/procurement/chains/order/"+(null==t||null==t.order?null:t.order.id)),e.xp6(1),e.Oqu(null==t||null==t.order?null:t.order.id)}}function l_(n,i){if(1&n&&(e.TgZ(0,"div"),e.ynx(1,45),e.YNc(2,a_,2,2,"a",46),e.YNc(3,c_,2,2,"a",46),e.YNc(4,s_,2,2,"a",46),e.BQk(),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngSwitch",null==t||null==t.order?null:t.order.accounting_type),e.xp6(1),e.Q6J("ngSwitchCase",3),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",1)}}function p_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,l_,5,4,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function __(n,i){if(1&n&&(e.TgZ(0,"a",47),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.Q6J("routerLink","/manufacturing/orders/order/"+(null==t||null==t.order?null:t.order.id)),e.xp6(1),e.Oqu(null==t||null==t.order?null:t.order.id)}}function u_(n,i){if(1&n&&(e.TgZ(0,"a",47),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.Q6J("routerLink","/outsourcing/chains/order/"+(null==t||null==t.order?null:t.order.id)),e.xp6(1),e.Oqu(null==t||null==t.order?null:t.order.id)}}function d_(n,i){if(1&n&&(e.TgZ(0,"a",47),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).rowData;e.Q6J("routerLink","/procurement/chains/order/"+(null==t||null==t.order?null:t.order.id)),e.xp6(1),e.Oqu(null==t||null==t.order?null:t.order.id)}}function m_(n,i){if(1&n&&(e.TgZ(0,"div"),e.ynx(1,45),e.YNc(2,__,2,2,"a",46),e.YNc(3,u_,2,2,"a",46),e.YNc(4,d_,2,2,"a",46),e.BQk(),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngSwitch",null==t||null==t.order?null:t.order.accounting_type),e.xp6(1),e.Q6J("ngSwitchCase",3),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",1)}}function g_(n,i){if(1&n&&(e.TgZ(0,"div")(1,"a",48),e._uU(2),e.qZA()()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("routerLink","/reports/invoices/invoice/"+(null==t.invoice?null:t.invoice.id)),e.xp6(1),e.Oqu(null==t.invoice?null:t.invoice.self_serial_number)}}function h_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,g_,3,2,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function f_(n,i){if(1&n&&(e.TgZ(0,"div")(1,"a",48),e._uU(2),e.qZA()()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("routerLink","/reports/invoices/invoice/"+(null==t.invoice?null:t.invoice.id)),e.xp6(1),e.Oqu(null==t.invoice?null:t.invoice.self_serial_number)}}function v_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.supplier?t.supplier:"None"," ")}}function C_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,v_,2,1,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function Z_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",t.supplier?t.supplier:"None"," ")}}function T_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",t.technology?t.technology:"None"," ")}}function x_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,T_,2,1,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function y_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",t.technology?t.technology:"None"," ")}}function b_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,null==t?null:t.document_creation_date,"dd/MM/yyyy")," ")}}function A_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,b_,3,4,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function I_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,null==t?null:t.document_creation_date,"dd/MM/yyyy")," ")}}function q_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.unit_price)," \u20ac ")}}function R_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,q_,3,3,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function w_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.unit_price)," \u20ac ")}}function N_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.final_supplier_unit_price)," \u20ac ")}}function U_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.total_price)," \u20ac ")}}function P_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,U_,3,3,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function F_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.total_price)," \u20ac ")}}function J_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.final_supplier_total_price)," \u20ac ")}}function k_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.unit_cost)," \u20ac ")}}function S_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,k_,3,3,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function Q_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.unit_cost)," \u20ac ")}}function M_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.total_cost)," \u20ac ")}}function Y_(n,i){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,M_,3,3,"div",43),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngForOf",t.products)}}function O_(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.total_cost)," \u20ac ")}}function E_(n,i){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"moneyFormat"),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.total_price_calculated)," \u20ac ")}}function L_(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.order_product_total_price)," \u20ac ")}}function B_(n,i){if(1&n&&(e.ynx(0),e.YNc(1,L_,3,3,"span",40),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngIf",t.order_product_total_price)}}function D_(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw(2).rowData;e.xp6(1),e.hij("",e.lcZ(2,1,t.total_cost_calculated)," \u20ac")}}function $_(n,i){if(1&n&&(e.ynx(0),e.YNc(1,D_,3,3,"span",40),e.BQk()),2&n){const t=e.oxw().rowData;e.xp6(1),e.Q6J("ngIf",t.total_cost_calculated)}}const G_=function(n){return{"padding-left":n}};function j_(n,i){if(1&n&&(e.TgZ(0,"tr",35)(1,"td",36)(2,"div",37),e._UZ(3,"p-treeTableToggler",38),e.TgZ(4,"span",39),e._uU(5),e.qZA()()(),e.TgZ(6,"td"),e._uU(7),e.YNc(8,Hp,2,0,"b",40),e.qZA(),e.TgZ(9,"td",41),e._uU(10),e.qZA(),e.TgZ(11,"td",42),e.YNc(12,zp,3,1,"div",43),e.qZA(),e.TgZ(13,"td",44),e.YNc(14,e_,2,1,"div",40),e.YNc(15,n_,2,1,"div",40),e.qZA(),e.TgZ(16,"td",41),e.YNc(17,i_,2,1,"div",40),e.YNc(18,r_,2,1,"div",40),e.qZA(),e.TgZ(19,"td",41),e.YNc(20,p_,2,1,"div",40),e.YNc(21,m_,5,4,"div",40),e.qZA(),e.TgZ(22,"td",41),e.YNc(23,h_,2,1,"div",40),e.YNc(24,f_,3,2,"div",40),e.qZA(),e.TgZ(25,"td"),e.YNc(26,C_,2,1,"div",40),e.YNc(27,Z_,2,1,"div",40),e.qZA(),e.TgZ(28,"td",41),e.YNc(29,x_,2,1,"div",40),e.YNc(30,y_,2,1,"div",40),e.qZA(),e.TgZ(31,"td",41),e.YNc(32,A_,2,1,"div",40),e.YNc(33,I_,3,4,"div",40),e.qZA(),e.TgZ(34,"td",41),e.YNc(35,R_,2,1,"div",40),e.YNc(36,w_,3,3,"div",40),e.YNc(37,N_,3,3,"div",40),e.qZA(),e.TgZ(38,"td",41),e.YNc(39,P_,2,1,"div",40),e.YNc(40,F_,3,3,"div",40),e.YNc(41,J_,3,3,"div",40),e.qZA(),e.TgZ(42,"td",41),e.YNc(43,S_,2,1,"div",40),e.YNc(44,Q_,3,3,"div",40),e.qZA(),e.TgZ(45,"td",41),e.YNc(46,Y_,2,1,"div",40),e.YNc(47,O_,3,3,"div",40),e.qZA(),e.TgZ(48,"td",41),e.YNc(49,E_,3,3,"ng-container",40),e.qZA(),e.TgZ(50,"td",41),e.YNc(51,B_,2,1,"ng-container",40),e.YNc(52,$_,2,1,"ng-container",40),e.qZA()()),2&n){const t=i.$implicit,o=i.rowData,r=e.oxw();e.ekj("hide",r.isHidden(o)&&r.hide)("close",o.close),e.Q6J("ttRow",t)("ttSelectableRow",t),e.xp6(1),e.Q6J("ngStyle",e.VKq(42,G_,10*t.level+"px")),e.xp6(2),e.ekj("hide-toggle",r.hide&&!r.hideToggle(t.node)),e.Q6J("rowNode",t),e.xp6(2),e.hij(" ",o.nomenclature.code," "),e.xp6(2),e.hij(" ",o.nomenclature.name," "),e.xp6(1),e.Q6J("ngIf","1"===o.nomenclature.bulk_or_serial),e.xp6(2),e.hij(" ",null!=o.nomenclature&&o.nomenclature.category?null==o.nomenclature||null==o.nomenclature.category||null==o.nomenclature.category.unit_of_measure?null:o.nomenclature.category.unit_of_measure.symbol:"Pcs"," "),e.xp6(2),e.Q6J("ngForOf",o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products&&(null==o?null:o.unit_price)),e.xp6(1),e.Q6J("ngIf","1"===o.nomenclature.type&&(null==o?null:o.final_supplier_unit_price)),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products&&(null==o?null:o.total_price)),e.xp6(1),e.Q6J("ngIf","1"===o.nomenclature.type&&(null==o?null:o.final_supplier_total_price)),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products&&(null==o?null:o.unit_cost)),e.xp6(2),e.Q6J("ngIf",o.products),e.xp6(1),e.Q6J("ngIf",!o.products&&(null==o?null:o.total_cost)),e.xp6(2),e.Q6J("ngIf",o.total_price_calculated>=0),e.xp6(2),e.Q6J("ngIf",o.order_product_total_price),e.xp6(1),e.Q6J("ngIf",(null==o?null:o.total_cost_calculated)>=0&&!o.order_product_total_price)}}function V_(n,i){1&n&&e._UZ(0,"i",23)}function H_(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function K_(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",49),e.YNc(2,V_,1,0,"i",50),e.YNc(3,H_,2,0,"span",40),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",18),e.xp6(1),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading)}}function W_(n,i){1&n&&(e.TgZ(0,"div",23),e._UZ(1,"i",24),e.qZA())}function X_(n,i){if(1&n&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"moneyFormat"),e.qZA()()),2&n){const t=i.$implicit;e.xp6(2),e.AsE("",t.accountingservice," : ",e.lcZ(3,2,t.value)," \u20ac ")}}function eu(n,i){1&n&&(e.TgZ(0,"div",26)(1,"span"),e._uU(2,"Additional Expenses None"),e.qZA()())}function tu(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",12)(1,"button",27),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.services())}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.selectedNode||(null==t.selectedNode?null:t.selectedNode.parent))}}function nu(n,i){1&n&&(e.TgZ(0,"tr")(1,"th",28),e._uU(2,"Code"),e.qZA(),e.TgZ(3,"th",29),e._uU(4,"Name"),e.qZA(),e.TgZ(5,"th",30),e._uU(6,"Required Qty"),e.qZA(),e.TgZ(7,"th",31),e._uU(8,"UOM"),e.qZA(),e.TgZ(9,"th",31),e._uU(10,"Order"),e.qZA(),e.TgZ(11,"th",32),e._uU(12,"Invoice"),e.qZA(),e.TgZ(13,"th",33),e._uU(14,"Supplier"),e.qZA(),e.TgZ(15,"th",32),e._uU(16,"Date"),e.qZA(),e.TgZ(17,"th",32),e._uU(18,"Quantity"),e.qZA(),e.TgZ(19,"th",32),e._uU(20,"Unit Price"),e.qZA(),e.TgZ(21,"th",32),e._uU(22,"Total Price"),e.qZA(),e.TgZ(23,"th",32),e._uU(24,"Unit Cost"),e.qZA(),e.TgZ(25,"th",32),e._uU(26,"Total Cost"),e.qZA(),e.TgZ(27,"th",32),e._uU(28,"Price SUM"),e.qZA(),e.TgZ(29,"th",32),e._uU(30,"Cost SUM"),e.qZA()())}function ou(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",null==t.assembly_info.order?null:t.assembly_info.order.id," ")}}const iu=function(n){return["/procurement/chains/order/",n]};function ru(n,i){if(1&n&&(e.TgZ(0,"li",43)(1,"a",44),e._uU(2),e.qZA()()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,iu,null==t.order?null:t.order.id)),e.xp6(1),e.Oqu(null==t||null==t.order?null:t.order.id)}}function au(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,ru,3,4,"li",42),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function cu(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",null==t.assembly_info.invoice?null:t.assembly_info.invoice.self_serial_number," ")}}const su=function(n){return["/reports/invoices/invoice/",n]};function lu(n,i){if(1&n&&(e.TgZ(0,"li")(1,"a",44),e._uU(2),e.qZA()()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,su,null==t.invoice?null:t.invoice.id)),e.xp6(1),e.Oqu(null==t.invoice?null:t.invoice.self_serial_number)}}function pu(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,lu,3,4,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function _u(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",t.assembly_info.supplier," ")}}function uu(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Oqu(t.supplier)}}function du(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,uu,2,1,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function mu(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.xi3(2,1,t.assembly_info.document_creation_date,"dd/MM/yyyy")," ")}}function gu(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"date"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij("",e.xi3(2,1,t.document_creation_date,"dd/MM/yyyy")," ")}}function hu(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,gu,3,4,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function fu(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",t.assembly_info.accepted_quantity," ")}}function vu(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Oqu(t.quantity)}}function Cu(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,vu,2,1,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function Zu(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.assembly_info.supplier_unit_price)," \u20ac ")}}function Tu(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij("",e.lcZ(2,1,t.unit_price)," \u20ac")}}function xu(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,Tu,3,3,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function yu(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.assembly_info.supplier_total_price)," \u20ac ")}}function bu(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij("",e.lcZ(2,1,t.total_price)," \u20ac")}}function Au(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,bu,3,3,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function Iu(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.assembly_info.supplier_unit_cost)," \u20ac ")}}function qu(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij("",e.lcZ(2,1,t.unit_cost)," \u20ac")}}function Ru(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,qu,3,3,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function wu(n,i){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.assembly_info.supplier_total_cost)," \u20ac ")}}function Nu(n,i){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.hij("",e.lcZ(2,1,t.total_cost)," \u20ac")}}function Uu(n,i){if(1&n&&(e.TgZ(0,"ul",41),e.YNc(1,Nu,3,3,"li",45),e.qZA()),2&n){const t=e.oxw().rowData;e.ekj("m-0",t.from_products),e.xp6(1),e.Q6J("ngForOf",t.from_products)}}function Pu(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.sumTotal)," \u20ac ")}}function Fu(n,i){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"moneyFormat"),e.qZA()),2&n){const t=e.oxw().rowData;e.xp6(1),e.hij(" ",e.lcZ(2,1,t.sumCost)," \u20ac ")}}const Ju=function(n){return{"padding-left":n}};function ku(n,i){if(1&n&&(e.TgZ(0,"tr",34)(1,"td",35),e._UZ(2,"p-treeTableToggler",36),e.TgZ(3,"span",37),e._uU(4),e.qZA()(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",38),e._uU(8),e.qZA(),e.TgZ(9,"td",38),e._uU(10),e.qZA(),e.TgZ(11,"td",38),e.YNc(12,ou,2,1,"div",39),e.YNc(13,au,2,3,"ul",40),e.qZA(),e.TgZ(14,"td",38),e.YNc(15,cu,2,1,"div",39),e.YNc(16,pu,2,3,"ul",40),e.qZA(),e.TgZ(17,"td"),e.YNc(18,_u,2,1,"div",39),e.YNc(19,du,2,3,"ul",40),e.qZA(),e.TgZ(20,"td",38),e.YNc(21,mu,3,4,"div",39),e.YNc(22,hu,2,3,"ul",40),e.qZA(),e.TgZ(23,"td",38),e.YNc(24,fu,2,1,"div",39),e.YNc(25,Cu,2,3,"ul",40),e.qZA(),e.TgZ(26,"td",38),e.YNc(27,Zu,3,3,"div",39),e.YNc(28,xu,2,3,"ul",40),e.qZA(),e.TgZ(29,"td",38),e.YNc(30,yu,3,3,"div",39),e.YNc(31,Au,2,3,"ul",40),e.qZA(),e.TgZ(32,"td",38),e.YNc(33,Iu,3,3,"div",39),e.YNc(34,Ru,2,3,"ul",40),e.qZA(),e.TgZ(35,"td",38),e.YNc(36,wu,3,3,"div",39),e.YNc(37,Uu,2,3,"ul",40),e.qZA(),e.TgZ(38,"td",38),e.YNc(39,Pu,3,3,"span",39),e.qZA(),e.TgZ(40,"td",38),e.YNc(41,Fu,3,3,"span",39),e.qZA()()),2&n){const t=i.$implicit,o=i.rowData,r=e.oxw();e.ekj("hide",!o.visible&&r.hide),e.Q6J("ttRow",t)("ttRow",t)("ttSelectableRow",t),e.xp6(1),e.Q6J("ngStyle",e.VKq(31,Ju,10*t.level+"px")),e.xp6(1),e.Q6J("rowNode",t),e.xp6(2),e.hij(" ",o.nomenclature.code," "),e.xp6(2),e.hij(" ",o.nomenclature.name," "),e.xp6(2),e.hij(" ",o.required_quantity," "),e.xp6(2),e.hij(" ",o.nomenclature.category?o.nomenclature.category.unit_of_measure.symbol:"Pcs"," "),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",o.assembly_info),e.xp6(1),e.Q6J("ngIf",o.from_products),e.xp6(2),e.Q6J("ngIf",r.isShowSum(o)),e.xp6(2),e.Q6J("ngIf",r.isShowSum(o))}}function Su(n,i){1&n&&e._UZ(0,"i",24)}function Qu(n,i){1&n&&(e.TgZ(0,"span"),e._uU(1,"No Records Found"),e.qZA())}function Mu(n,i){if(1&n&&(e.TgZ(0,"tr")(1,"td",46),e.YNc(2,Su,1,0,"i",47),e.YNc(3,Qu,2,0,"span",39),e.qZA()()),2&n){const t=e.oxw();e.xp6(1),e.uIk("colspan",15),e.xp6(1),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading)}}const Yu=[{path:"",component:Ze,children:[{path:"invoices",title:"Invoices",component:te},{path:"invoices/invoice/:id",component:yl},{path:"invoices/service-invoice/:id",component:Ip},{path:"cost-reports",title:"Cost Reports",component:ne},{path:"cost-reports/new/:id",title:"Cost Report",component:(()=>{class n{constructor(t,o,r,a){this.route=t,this.accountingProductsService=o,this.adapterService=r,this.costReportsService=a,this.productId=this.route.snapshot.paramMap.get("id"),this.additionalExpenses=[],this.loading=!0,this.parentIds=new Set,this.res=[],this.hide=!0,this.counts=0,this.rootId=null}getAll(){this.additionalExpenses=[],this.selectedNode=null,this.costReportsService.getCostReport(this.productId).subscribe(t=>{t.accounting_services?.length>0&&t.accounting_services.forEach(o=>{this.additionalExpenses.push(o)}),this.treeProducts=this.tree(t),this.loading=!1})}hideElements(){this.treeProducts.forEach(o=>(o=>{o.children&&o.children.forEach(r=>{r.children?r.children.forEach(a=>{!a.data.sumCost&&!a.data.sumCost&&(a.data.visible=!1)}):!r.data.sumCost&&!r.data.sumCost&&(r.data.visible=!1)})})(o))}countSum(){const t=r=>(r.children&&r.children.forEach(a=>{a.children?(a.data.hasChildren=!0,a.data?.assembly_info?.forEach(l=>{a.data.sumCost+=parseFloat(l.supplier_total_cost)}),a.data?.written_off_warehouse_products?.forEach(l=>{a.data.sumCost+=parseFloat(l.total_cost)}),r.data.sumCost+=t(a)):(a.data?.assembly_info?.forEach(l=>{a.data.sumCost+=parseFloat(l.supplier_total_cost),r.data.sumCost+=parseFloat(l.supplier_total_cost)}),a.data?.written_off_warehouse_products?.forEach(l=>{a.data.sumCost+=parseFloat(l.total_cost),r.data.sumCost+=parseFloat(l.total_cost)}))}),r.data.sumCost),o=r=>(r.children&&r.children.forEach(a=>{a.children?(a.data.hasChildren=!0,a.data?.assembly_info?.forEach(l=>{a.data.sumTotal+=parseFloat(l.supplier_total_price)}),a.data?.written_off_warehouse_products?.forEach(l=>{a.data.sumTotal+=parseFloat(l.total_price)}),r.data.sumTotal+=o(a)):(a.data?.assembly_info?.forEach(l=>{a.data.sumTotal+=parseFloat(l.supplier_total_price),r.data.sumTotal+=parseFloat(l.supplier_total_price)}),a.data?.written_off_warehouse_products?.forEach(l=>{a.data.sumTotal+=parseFloat(l.total_price),r.data.sumTotal+=parseFloat(l.total_price)}))}),r.data.sumTotal);this.treeProducts.forEach(r=>{r.data?.assembly_info?.forEach(a=>{r.data.sumCost+=parseFloat(a.supplier_total_cost),r.data.sumTotal+=parseFloat(a.supplier_total_price)}),r.data?.written_off_warehouse_products?.forEach(a=>{r.data.sumCost+=parseFloat(a.total_cost),r.data.sumTotal+=parseFloat(a.total_price)}),r.data.hasChildren=!0,r.data.sumCost=t(r),r.data.sumTotal=o(r)})}treeAdapter(t,o,r=!0){const a=[];t.forEach(_=>{_.list_product.id===o&&(_.list_product.parent=null),a.push({data:_})});const l=[],p=a.reduce((_,h,u)=>(_[h.data.list_product.id]=u,_),{});return a.forEach(_=>{if(null===_.data.list_product.parent)return _.expanded=r,void l.push(_);const h=a[p[_.data.list_product.parent]];h.children=[...h.children||[],_],0===h.children.length&&delete h.children}),l}ngOnInit(){this.getAll()}tree(t){const o=[],r=(_,h)=>{_&&_.forEach(u=>{let c=null;c=h.data?h.data.nomenclature.id:h.nomenclature.id,c===u.data.nomenclature.id&&(h.children=_[0].children,h.data?.assemblies.length>0&&(h.data.builders=[h.data,h.data.assemblies[0]])),u.data?.assemblies?.forEach(q=>{u.children.push({data:q,children:[],expanded:!1,parent:h})}),r(u.children,u);const f=[];u?.data?.manufactured?.forEach(q=>{f.find(ie=>ie.nomenclature.id===q.nomenclature.id)||(q.products=u.data.manufactured.filter(Ue=>Ue.nomenclature.id===q.nomenclature.id),f.push(q))}),f.length>0&&f.forEach(q=>{u.children.push({data:q,expanded:!1,children:null})});const oe=[];u?.data?.purchased?.forEach(q=>{oe.find(ie=>ie.nomenclature.id===q.nomenclature.id)||(q.products=u.data.purchased.filter(Ue=>Ue.nomenclature.id===q.nomenclature.id),oe.push(q))}),oe.length>0&&oe.forEach(q=>{u.children.push({data:q,expanded:!1,children:null})})})},a={data:t,expanded:!0,children:[],parent:null};t.assemblies.forEach(_=>{a.children.push({data:_,children:[],expanded:!1})});const l=new Map;t.manufactured.forEach(_=>{if(l.get(_.nomenclature.id)){l.set(_.nomenclature.id,l.get(_.nomenclature.id)+1);const h=_.nomenclature.id,u=t.purchased.filter(c=>c.nomenclature.id===h);if(t.purchased=t.purchased.filter(c=>c.nomenclature.id!==h),u.length>0){const c=u[0];c.items=u,t.purchased.push(c)}}else l.set(_.nomenclature.id,1)}),t.manufactured.forEach(_=>{a.children.push({data:_,expanded:!1,children:null})});const p=new Map;return t.purchased.forEach(_=>{if(p.get(_.nomenclature.id)){p.set(_.nomenclature.id,p.get(_.nomenclature.id)+1);const h=_.nomenclature.id,u=t.purchased.filter(c=>c.nomenclature.id===h);if(t.purchased=t.purchased.filter(c=>c.nomenclature.id!==h),u.length>0){const c=u[0];c.items=u,t.purchased.push(c)}}else p.set(_.nomenclature.id,1)}),t.purchased.forEach(_=>{a.children.push({data:_,expanded:!1,children:null,parent:t})}),r(a.children,t),o.push(a),console.log(o),o}hideToggle(t){return!!t?.children&&t.children.some(o=>o.data.visible)}services(){this.costReportsService.additionalExpensesModal("new",this.treeProducts[0].data.id,this.additionalExpenses).subscribe()}isHidden(t){return"1"!==t.nomenclature.type&&(t.items?t.items.every(o=>!(parseFloat(o.total_cost)||parseFloat(o.unit_cost)||parseFloat(o.total_price)||parseFloat(o.unit_price))):!(parseFloat(t.total_cost)||parseFloat(t.unit_cost)||parseFloat(t.total_price)||parseFloat(t.unit_price)))}showInvoice(t){return"number"==typeof t}expandCollapseRecursive(t,o){t.expanded=o,t.children&&t.children.forEach(r=>{this.expandCollapseRecursive(r,o)})}expandCollapse(t=!0){const o=De(this.treeProducts);o.forEach(r=>{this.expandCollapseRecursive(r,t)}),this.treeProducts=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b.gz),e.Y36(ce),e.Y36(J.v),e.Y36(Ne))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-new-cost-report"]],decls:27,vars:10,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"mb-4"],[1,"page__card","mb-4"],[1,"row","pt-3"],["class","d-flex justify-content-center",4,"ngIf"],["class","col-6",4,"ngFor","ngForOf"],["class","additional-none pl-3",4,"ngIf"],[1,"cost-page-header","mb-4"],[1,"d-flex"],["pButton","","type","button","icon","pi pi-angle-down","label","Expand All",1,"mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-angle-up","label","Collapse All",1,"mr-2",3,"disabled","click"],[1,"page__card","cost-report-table"],["selectionMode","single",3,"value","selection","resizableColumns","selectionChange"],["tt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"d-flex","justify-content-center"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],[1,"col-6"],[1,"additional-none","pl-3"],["pButton","","type","button","icon","pi pi-plus","label","Additional Expenses",1,"ml-auto",3,"disabled","click"],[1,"th-code",2,"width","16%"],[2,"width","11%"],[1,"text-center",2,"width","3%"],[1,"text-center",2,"width","10%"],[1,"text-center",2,"width","6%"],[1,"text-center",2,"width","5%"],[2,"width","9%"],[1,"text-center",2,"width","7%"],[3,"ttRow","ttSelectableRow"],[3,"ngStyle"],[1,"toggle-row"],[3,"rowNode"],[1,"drag-cursor"],[4,"ngIf"],[1,"text-center"],[1,"text-center","word-break","serials"],[4,"ngFor","ngForOf"],[1,"text-center","word-break"],[3,"ngSwitch"],["target","_blank",3,"routerLink",4,"ngSwitchCase"],["target","_blank",3,"routerLink"],[3,"routerLink"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Cost Report"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"h2",5),e._uU(8,"Additional Expenses"),e.qZA(),e.TgZ(9,"div",6)(10,"div",7),e.YNc(11,Dp,2,0,"div",8),e.YNc(12,$p,4,4,"div",9),e.YNc(13,Gp,3,0,"div",10),e.qZA()(),e.TgZ(14,"div",11)(15,"h2"),e._uU(16,"Cost Report"),e.qZA(),e.TgZ(17,"div",12)(18,"button",13),e.NdJ("click",function(){return o.expandCollapse()}),e.qZA(),e.TgZ(19,"button",14),e.NdJ("click",function(){return o.expandCollapse(!1)}),e.qZA()()(),e.TgZ(20,"div",15)(21,"p-treeTable",16,17),e.NdJ("selectionChange",function(a){return o.selectedNode=a}),e.YNc(23,jp,2,1,"ng-template",18),e.YNc(24,Vp,35,0,"ng-template",19),e.YNc(25,j_,53,44,"ng-template",20),e.YNc(26,K_,4,3,"ng-template",21),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(8),e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("ngForOf",o.additionalExpenses),e.xp6(1),e.Q6J("ngIf",0===o.additionalExpenses.length&&!o.loading),e.xp6(5),e.Q6J("disabled",o.loading),e.xp6(1),e.Q6J("disabled",o.loading),e.xp6(2),e.Q6J("value",o.treeProducts)("selection",o.selectedNode)("resizableColumns",!0))},dependencies:[m.sg,m.O5,m.PC,m.RF,m.n9,b.yS,v.Hq,Z.jx,w.iw,w.gc,w.V4,w.e2,A.D,m.uU,M.U],styles:[".cost-page-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.cost-report-table[_ngcontent-%COMP%]     li{list-style:none;margin-bottom:5px}.cost-report-table[_ngcontent-%COMP%]     li:last-child{margin-bottom:0}.cost-report-table[_ngcontent-%COMP%]     li:focus{outline:none}.cost-report-table[_ngcontent-%COMP%]     .p-treetable-wrapper td{font-size:14px!important}.cost-report-table[_ngcontent-%COMP%]     .p-treetable-wrapper th{font-size:14px!important}h2[_ngcontent-%COMP%]{font-size:1.1875rem;font-weight:600}.additional-none[_ngcontent-%COMP%]{font-weight:500}.th-code[_ngcontent-%COMP%]{padding-left:44px!important}ul[_ngcontent-%COMP%]{margin:5px 0}.info-list[_ngcontent-%COMP%]{margin:0!important;padding:0!important}.hide[_ngcontent-%COMP%]{display:none}"]}),n})()},{path:"cost-reports/old/:id",title:"Cost Report",component:(()=>{class n{constructor(t,o,r,a){this.route=t,this.accountingProductsService=o,this.adapterService=r,this.costReportsService=a,this.productId=this.route.snapshot.paramMap.get("id"),this.additionalExpenses=[],this.loading=!0,this.parentIds=new Set,this.res=[],this.rootId=null,this.hide=!0}ngOnInit(){this.getAll()}getAll(){this.additionalExpenses=[],this.selectedNode=null,this.accountingProductsService.tree(this.productId).subscribe(t=>{t.forEach(a=>{a.from_products.sort((l,p)=>new Date(l.invoice_creation_date).getTime()-new Date(p.invoice_creation_date).getTime())});let o={0:3,1:1,2:2};t.sort((a,l)=>o[a.nomenclature.type]-o[l.nomenclature.type]),(t=t.map(a=>(a.sumTotal=0,a.sumCost=0,a))).forEach(a=>{a.accounting_services.length>0&&a.accounting_services.forEach(l=>{this.additionalExpenses.push(l)})}),t.forEach(a=>{this.parentIds.add(a.parent)});let r=null;this.parentIds.forEach(a=>{t.find(p=>p.id===a)||(r=t.find(p=>p.parent)?.id,this.rootId=r)}),t.forEach(a=>{null===a.parent&&(r=a.parent,this.rootId=r)}),this.res=t,this.countSum2(),this.treeProducts=this.adapterService.treeAdapter(t,this.productId),console.log(this.additionalExpenses),this.loading=!1})}isShowSum(t){let o=!1;return this.parentIds.has(t.id)&&(o=!0),o}countSum2(){var t=this;return(0,Pe.Z)(function*(){let o;o=t.res.find(null!==t.rootId?_=>t.rootId===_.id:_=>null===_.parent);const r=_=>{let h=0;return t.res.filter(c=>c.parent===_.id).forEach(c=>{c.from_products.forEach(f=>{h+=parseFloat(f.total_price)}),c.sumTotal=r(c)}),h},a=_=>{let h=_.sumTotal;return t.res.filter(c=>c.parent===_.id).forEach(c=>{c.sumTotal=a(c),h+=c.sumTotal}),h},l=_=>{let h=0;return t.res.filter(c=>c.parent===_.id).forEach(c=>{c.from_products.forEach(f=>{h+=parseFloat(f.total_cost)}),c.sumCost=l(c)}),h},p=_=>{let h=_.sumCost;return t.res.filter(c=>c.parent===_.id).forEach(c=>{c.sumCost=p(c),h+=c.sumCost}),h};o.sumTotal=r(o),o.sumTotal=a(o),o.sumCost=l(o),o.sumCost=p(o),o.assembly_info&&(o.sumTotal+=parseFloat(o.assembly_info.supplier_total_price),o.sumCost+=parseFloat(o.assembly_info.supplier_total_cost)),t.res.forEach(_=>{const h=_.from_products.filter(u=>{if(u.total_cost>0||u.total_price>0||u.unit_cost>0||u.unit_price>0||_.sumTotal>0||_.sumCost>0)return u}).length;_.visible=Boolean(h>0)}),o.visible=!0})()}countSum(){let t=0;const o=new Set;this.res.forEach(p=>{p.parent?o.add(p.parent):t=p.id}),o.forEach(p=>{let _=0,h=0;this.res.filter(c=>c.parent===p).forEach(c=>{c.from_products.length>0?c.from_products.forEach(f=>{_+=f.total_price,h+=f.total_cost}):(_+=0,h+=0)});const u=this.res.find(c=>c.id===p);u.sumTotal=_,u.sumCost=h,u.from_products.forEach(c=>{u.sumTotal+=c.total_price,u.sumCost+=c.total_cost})});let r=0,a=0;o.forEach(p=>{r+=this.res.find(_=>_.id===p).sumTotal,a+=this.res.find(_=>_.id===p).sumCost});const l=this.res.find(p=>p.id===t);l.sumTotal=r,l.sumCost=a,l.from_products?.forEach(p=>{l.sumTotal+=p.total_price,l.sumCost+=p.total_cost})}onToggleHide(){this.hide=!this.hide}expandCollapseRecursive(t,o){t.expanded=o,t.children&&t.children.forEach(r=>{this.expandCollapseRecursive(r,o)})}expandCollapse(t=!0){const o=De(this.treeProducts);o.forEach(r=>{this.expandCollapseRecursive(r,t)}),this.treeProducts=o}services(){this.costReportsService.additionalExpensesModal("old",this.treeProducts[0].data.id,this.additionalExpenses).subscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b.gz),e.Y36(ce),e.Y36(J.v),e.Y36(Ne))},n.\u0275cmp=e.Xpm({type:n,selectors:[["pek-reports-old-cost-report"]],decls:28,vars:13,consts:[[1,"page"],[1,"page__header"],[1,"page__title"],[3,"module","isActive"],[1,"page__content"],[1,"mb-4"],[1,"page__card","mb-4"],[1,"row","pt-3"],["class","d-flex justify-content-center",4,"ngIf"],["class","col-6",4,"ngFor","ngForOf"],["class","additional-none pl-3",4,"ngIf"],[1,"cost-page-header","mb-4"],[1,"d-flex"],["pButton","","type","button","icon","pi pi-angle-down","label","Expand All",1,"mr-2",3,"disabled","click"],["pButton","","type","button","icon","pi pi-angle-up","label","Collapse All",1,"mr-2",3,"disabled","click"],["pButton","","type","button",3,"icon","label","disabled","click"],[1,"page__card","cost-report-table"],["selectionMode","single",3,"value","selection","resizableColumns","selectionChange"],["tt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"d-flex","justify-content-center"],[1,"pi","pi-spin","pi-spinner",2,"font-size","2.25rem"],[1,"col-6"],[1,"additional-none","pl-3"],["pButton","","type","button","icon","pi pi-plus","label","Additional Expenses",1,"ml-auto",3,"disabled","click"],[1,"th-code",2,"width","23%"],[2,"width","11%"],[1,"text-center",2,"width","6%"],[1,"text-center",2,"width","3%"],[1,"text-center",2,"width","5%"],[2,"width","9%"],[3,"ttRow","ttSelectableRow"],[3,"ngStyle"],[3,"rowNode"],[1,"drag-cursor"],[1,"text-center"],[4,"ngIf"],["class","p-0",3,"m-0",4,"ngIf"],[1,"p-0"],["routerLinkActive","router-link-active",4,"ngFor","ngForOf"],["routerLinkActive","router-link-active"],["rel","noopener noreferrer",3,"routerLink"],[4,"ngFor","ngForOf"],[1,"text-center","p-4"],["class","pi pi-spin pi-spinner","style","font-size: 2.25rem",4,"ngIf"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"pek-module-icon",3),e.TgZ(4,"h1"),e._uU(5,"Cost Report"),e.qZA()()()(),e.TgZ(6,"div",4)(7,"h2",5),e._uU(8,"Additional Expenses"),e.qZA(),e.TgZ(9,"div",6)(10,"div",7),e.YNc(11,W_,2,0,"div",8),e.YNc(12,X_,4,4,"div",9),e.YNc(13,eu,3,0,"div",10),e.qZA()(),e.TgZ(14,"div",11)(15,"h2"),e._uU(16,"Cost Report"),e.qZA(),e.TgZ(17,"div",12)(18,"button",13),e.NdJ("click",function(){return o.expandCollapse()}),e.qZA(),e.TgZ(19,"button",14),e.NdJ("click",function(){return o.expandCollapse(!1)}),e.qZA(),e.TgZ(20,"button",15),e.NdJ("click",function(){return o.onToggleHide()}),e.qZA()()(),e.TgZ(21,"div",16)(22,"p-treeTable",17,18),e.NdJ("selectionChange",function(a){return o.selectedNode=a}),e.YNc(24,tu,2,1,"ng-template",19),e.YNc(25,nu,31,0,"ng-template",20),e.YNc(26,ku,42,33,"ng-template",21),e.YNc(27,Mu,4,3,"ng-template",22),e.qZA()()()),2&t&&(e.xp6(3),e.Q6J("module","reports")("isActive",!0),e.xp6(8),e.Q6J("ngIf",o.loading),e.xp6(1),e.Q6J("ngForOf",o.additionalExpenses),e.xp6(1),e.Q6J("ngIf",0===o.additionalExpenses.length&&!o.loading),e.xp6(5),e.Q6J("disabled",o.loading),e.xp6(1),e.Q6J("disabled",o.loading),e.xp6(1),e.Q6J("icon",o.hide?"pi pi-eye":"pi pi-eye-slash")("label",o.hide?"Show All":"Hide zeros")("disabled",o.loading),e.xp6(2),e.Q6J("value",o.treeProducts)("selection",o.selectedNode)("resizableColumns",!0))},dependencies:[m.sg,m.O5,m.PC,b.yS,b.Od,v.Hq,Z.jx,w.iw,w.gc,w.V4,w.e2,A.D,m.uU,M.U],styles:[".cost-page-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.cost-report-table[_ngcontent-%COMP%]     li{list-style:none;margin-bottom:5px}.cost-report-table[_ngcontent-%COMP%]     li:last-child{margin-bottom:0}.cost-report-table[_ngcontent-%COMP%]     li:focus{outline:none}.cost-report-table[_ngcontent-%COMP%]     .p-treetable-wrapper td{font-size:14px!important}.cost-report-table[_ngcontent-%COMP%]     .p-treetable-wrapper th{font-size:14px!important}h2[_ngcontent-%COMP%]{font-size:1.1875rem;font-weight:600}.additional-none[_ngcontent-%COMP%]{font-weight:500}.th-code[_ngcontent-%COMP%]{padding-left:44px!important}ul[_ngcontent-%COMP%]{margin:5px 0}.info-list[_ngcontent-%COMP%]{margin:0!important;padding:0!important}.hide[_ngcontent-%COMP%]{display:none}"]}),n})()},{path:"currencies",title:"Currencies",component:D},{path:"additional-expenses",title:"Additional Expenses",component:G},{path:"filters",title:"Filters",component:fn},{path:"payments-checker",title:"Payments Checker",component:so},{path:"item-card",title:"Item Card",component:j},{path:"in",title:"In",component:V},{path:"wh-balance",title:"Warehouse Balance",component:H},{path:"out",title:"Out",component:K},{path:"",redirectTo:"invoices",pathMatch:"full"},{path:"configs",children:[{path:"",redirectTo:"company-number",pathMatch:"full"},{path:"company-number",title:"Company Accounting Number",component:z},{path:"nomenclature-number",title:"Nomenclature Accounting Number",component:W},{path:"technologies-number",title:"Technologies Accounting Number",component:X},{path:"purchase-categories-number",title:"Purchase Categories Accounting Number",component:Xr},{path:"auxiliary-invoices-number",title:"Auxiliary Invoices Accounting Number",component:aa},{path:"accounting-categories",title:"Accounting Categories",component:ee},{path:"correlation",title:"Correlation of Accounting Categories",component:ka}]}]}];let Ou=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[b.Bz.forChild(Yu),b.Bz]}),n})();var Eu=d(7175),Lu=d(6984),Bu=d(7509),Du=d(1676),$e=d(5288),Ge=d(609);let $u=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.ez,Ou,Eu.x,v.hJ,k.W6,T.U$,Lu.m]}),n})();e.B6R(Bu.m,[m.O5,v.Hq,Z.jx,T.iA,x.ZT,x.xY,x.H8,$e.R,Ge.U],[]),e.B6R(Du.Q,[m.O5,v.Hq,Z.jx,T.iA,x.ZT,x.xY,x.H8,$e.R,Ge.U],[])},2660:(je,ge,d)=>{d.d(ge,{Q:()=>Y});var m=d(4650),b=d(4006),e=d(5698),Ce=d(855),Ze=d(6895),F=d(666);function C(v,k){if(1&v){const Z=m.EpF();m.TgZ(0,"p-dropdown",2),m.NdJ("ngModelChange",function(A){m.CHM(Z);const le=m.oxw();return m.KtG(le.currency=A)})("ngModelChange",function(A){m.CHM(Z);const le=m.oxw();return m.KtG(le.onChange(A))}),m.qZA()}if(2&v){const Z=m.oxw();m.Q6J("filter",!0)("showClear",Z.showClear)("ngModel",Z.currency)("options",Z.currencies)("disabled",Z.isLoading||Z.isDisabled)}}function Te(v,k){1&v&&(m.TgZ(0,"div",3),m._UZ(1,"i",4),m.qZA())}let Y=(()=>{class v{constructor(Z){this.currencyService=Z,this.valueChange=new m.vpe,this.isLoading=!0}ngOnInit(){this.getAll()}getAll(){this.currencyService.get().pipe((0,e.q)(1)).subscribe(Z=>{this.currencies=Z,this.isLoading=!1})}onChange(Z){this.setValue(Z)}registerOnChange(Z){this.valueChange.subscribe(Z)}registerOnTouched(Z){}setValue(Z){this.currency=Z,this.valueChange.emit(this.currencies.find(T=>T.code===this.currency))}writeValue(Z){this.currency=Z}}return v.\u0275fac=function(Z){return new(Z||v)(m.Y36(Ce.t))},v.\u0275cmp=m.Xpm({type:v,selectors:[["pek-currency-picker"]],inputs:{currency:"currency",showClear:"showClear",isDisabled:"isDisabled"},outputs:{valueChange:"valueChange"},features:[m._Bn([{provide:b.JU,useExisting:(0,m.Gpc)(()=>v),multi:!0}])],decls:3,vars:2,consts:[["optionValue","code","optionLabel","name","placeholder","Choose Currency",3,"filter","showClear","ngModel","options","disabled","ngModelChange",4,"ngIf","ngIfElse"],["spinner",""],["optionValue","code","optionLabel","name","placeholder","Choose Currency",3,"filter","showClear","ngModel","options","disabled","ngModelChange"],[1,"spinner-input"],[1,"pi","pi-spin","pi-spinner",2,"font-size","1.25rem"]],template:function(Z,T){if(1&Z&&(m.YNc(0,C,1,5,"p-dropdown",0),m.YNc(1,Te,2,0,"ng-template",null,1,m.W1O)),2&Z){const A=m.MAs(2);m.Q6J("ngIf",!T.isLoading)("ngIfElse",A)}},dependencies:[Ze.O5,b.JJ,F.Lt,b.On]}),v})()}}]);